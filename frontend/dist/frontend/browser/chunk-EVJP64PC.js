import{a as ke,b as Re,c as Ne,d as Ue,e as Ae,f as Pe,g as je}from"./chunk-XX45TBNI.js";import{a as fe,b as be,c as H,d as ge,e as q,f as he,g as Ce,h as B,i as Me,j as _e,k as Se,l as ve,m as ye,n as De,o as we,p as Te,q as xe,r as Ee,s as Ie,t as Fe,u as Oe,v as Ve,w as He,x as qe,y as Be,z as Le}from"./chunk-K5ZG3GAK.js";import{c as ue}from"./chunk-FFAAVIVD.js";import{a as V}from"./chunk-E75IIMLS.js";import{a as A,b as ie,c as oe,g as P,h as j}from"./chunk-NQ23PRK7.js";import"./chunk-ZZO4XKTB.js";import"./chunk-T5UCPTXZ.js";import{a as O,b as ae,d as re,e as u,g as ne,h as le,k as me,l as se,m as pe,o as de,q as ce}from"./chunk-274QBDMQ.js";import{P as ee,T as N,U as te,V as U,c as Y}from"./chunk-XT6BZMKU.js";import{Bb as b,F as y,Kb as d,La as W,Q as D,Ub as a,Vb as o,Wb as p,Xb as C,Yb as M,_b as Q,ac as c,bc as I,f as h,fc as F,ga as z,gc as k,hc as R,ib as m,la as J,lc as Z,ma as w,mc as l,nb as G,nc as g,oc as K,s as v,uc as X,va as T,wa as x,wb as E}from"./chunk-DHFLL7AS.js";var _=class i{constructor(e){this.http=e}API_URL="http://161.132.41.184:8000/api/users";unsubscribe=null;getAuthState(){return h(this,null,function*(){})}getUsers(e){return this.http.get(this.API_URL+"/all",{headers:{codrr_token:e.token}})}update(e){return this.http.put(this.API_URL+"/edit/"+e.id,{username:e.username,email:e.email,password:e.password,role:e.role},{headers:{"Content-Type":"application/json",codrr_token:e.token}})}insert(e){return this.http.post(this.API_URL+"/register",{age:1,firstName:"test",lastName:"test",username:e.username,email:e.email,password:e.password,role:e.role},{headers:{"Content-Type":"application/json",codrr_token:e.token}})}remove(e,t){return this.http.delete(this.API_URL+"/delete/"+e,{headers:{"Content-Type":"application/json",codrr_token:t.token}})}ngOnDestroy(){this.unsubscribe?.()}static \u0275fac=function(t){return new(t||i)(J(Y))};static \u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"})};var L=class i{constructor(e,t){this.fb=e;this.data=t;this.dialogRef=this.data.dialog,this.action=t.obj.action,this.getUsers=t.getUsers,this.dataSource=t.dataSource,t.obj.action==="update"?this.myForm=this.fb.group({id:[t.obj.id,[]],username:[t.obj.username,[u.required]],email:[t.obj.email,[u.required]],password:["",[]],role:[t.obj.role,u.required]}):this.myForm=this.fb.group({username:["",[u.required]],email:["",[u.required]],password:["",[u.required]],role:["CUSTOMER",u.required]})}myForm;dialogRef;action;userService=w(_);getUsers;dataSource;hidePassword=W(!0);onSubmit(e){return h(this,null,function*(){if(console.log("Valid?",e.valid),e.valid){let t=localStorage.getItem("user"),n=t?JSON.parse(t):null;if(console.log("user",n),!n)return;this.action==="update"?this.userService.update({id:e.value.id,username:e.value.username,email:e.value.email,password:e.value.password,role:e.value.role,token:n.token}).subscribe({next:r=>{console.log(r);let s=v("Data received"),f=y(2e3);s.pipe(D(()=>f)).subscribe(S=>{console.log(S),this.getUsers(this.dataSource)})},error:r=>{console.log(r)}}):this.userService.insert({username:e.value.username,email:e.value.email,password:e.value.password,role:e.value.role,token:n.token}).subscribe({next:r=>{console.log(r);let s=v("Data received"),f=y(2e3);s.pipe(D(()=>f)).subscribe(S=>{console.log(S),this.getUsers(this.dataSource)})},error:r=>{console.log(r)}}),this.dialogRef.closeAll()}})}static \u0275fac=function(t){return new(t||i)(G(de),G(ke))};static \u0275cmp=E({type:i,selectors:[["app-sample-dialog"]],decls:38,vars:3,consts:[["mat-dialog-title",""],[1,"mb-6",3,"ngSubmit","formGroup"],[1,"max-w-3xl","p-2","rounded-lg","mat-elevation-z3","mb-6","bg-surface-container"],[1,"grid","grid-cols-1","md:grid-cols-1","gap-3","mb-0"],["matInput","","formControlName","username"],["appFieldError",""],["matInput","","formControlName","email"],["matInput","","placeholder","Ingrese su contrase\xF1a","formControlName","password",3,"type"],["mat-icon-button","","matSuffix","","type","button",1,"mr-1",3,"click"],["formControlName","role"],["value","ADMIN"],["value","MOTORIZED"],["value","CUSTOMER"],["mat-stroked-button","","matDialogClose","",1,"mb-3","mt-2"],["type","submit","mat-flat-button","",1,"mb-3","mt-2"]],template:function(t,n){t&1&&(a(0,"h2",0),l(1,"Formulario Usuario"),o(),a(2,"mat-dialog-content")(3,"form",1),c("ngSubmit",function(){return n.onSubmit(n.myForm)}),a(4,"div",2)(5,"div",3)(6,"mat-form-field")(7,"mat-label"),l(8,"Nombre"),o(),p(9,"input",4)(10,"mat-error",5),o(),a(11,"mat-form-field")(12,"mat-label"),l(13,"Correo"),o(),p(14,"input",6),o(),a(15,"mat-form-field")(16,"mat-label"),l(17,"contrase\xF1a"),o(),p(18,"input",7),a(19,"button",8),c("click",function(){return n.hidePassword.set(!n.hidePassword())}),a(20,"mat-icon"),l(21),o()()(),a(22,"mat-form-field")(23,"mat-label"),l(24,"Rol"),o(),a(25,"mat-select",9)(26,"mat-option",10),l(27,"Administrador"),o(),a(28,"mat-option",11),l(29,"Motorizado"),o(),a(30,"mat-option",12),l(31,"Cliente"),o()(),p(32,"mat-error",5),o()(),a(33,"mat-dialog-actions")(34,"button",13),l(35," Cerrar "),o(),a(36,"button",14),l(37," Guardar "),o()()()()()),t&2&&(m(3),d("formGroup",n.myForm),m(15),d("type",n.hidePassword()?"password":"text"),m(3),g(n.hidePassword()?"visibility_off":"visibility"))},dependencies:[je,Ne,Ue,Pe,Ae,j,P,A,ie,oe,U,N,ee,V,be,fe,ue,ce,me,re,ne,le,se,pe,O],encapsulation:2})};var Je=()=>[5,10,25,100];function We(i,e){i&1&&(a(0,"th",19),l(1,"ID"),o())}function Ze(i,e){if(i&1&&(a(0,"td",20),l(1),o()),i&2){let t=e.$implicit;m(),g(t.id)}}function Ke(i,e){i&1&&(a(0,"th",19),l(1,"Nombre"),o())}function Xe(i,e){if(i&1&&(a(0,"td",20),l(1),o()),i&2){let t=e.$implicit;m(),g(t.username)}}function Ye(i,e){i&1&&(a(0,"th",19),l(1,"Correo"),o())}function et(i,e){if(i&1&&(a(0,"td",20),l(1),o()),i&2){let t=e.$implicit;m(),g(t.email)}}function tt(i,e){i&1&&(a(0,"th",19),l(1,"Rol"),o())}function it(i,e){if(i&1&&(a(0,"td",20),l(1),o()),i&2){let t=e.$implicit;m(),g(t.role)}}function ot(i,e){i&1&&(a(0,"th",21),l(1,"Actions"),o())}function at(i,e){if(i&1){let t=Q();a(0,"td",20)(1,"button",22),c("click",function(){let r=T(t).$implicit,s=I();return x(s.openDialog("update",r))}),a(2,"mat-icon",23),l(3,"edit"),o()(),a(4,"button",24)(5,"mat-icon",25),c("click",function(){let r=T(t).$implicit,s=I();return x(s.remove(r.id))}),l(6,"delete"),o()()()}}function rt(i,e){i&1&&p(0,"tr",26)}function nt(i,e){i&1&&p(0,"tr",27)}function lt(i,e){if(i&1&&(a(0,"tr",28)(1,"td",29),l(2),o()()),i&2){I();let t=Z(12);m(2),K(' No data matching the filter "',t.value,'" ')}}var $=class i{displayedColumns=["id","username","email","role","actions"];dataSource;paginator;sort;table;userService=w(_);dialog=w(Re);constructor(){this.dataSource=new Fe,this.getUsers(this.dataSource),this.table=this.table}getUsers(e){return h(this,null,function*(){let t=localStorage.getItem("user"),n=t?JSON.parse(t):null;n&&this.userService.getUsers(n).subscribe({next:r=>{console.log("data",r),e.data=r},error:r=>{console.log(r)}})})}openDialog(e,t){t.action=e,this.dialog.open(L,{data:{dialog:this.dialog,width:"250px",obj:t,getUsers:this.getUsers,dataSource:this.dataSource}})}remove(e){let t=localStorage.getItem("user"),n=t?JSON.parse(t):null;n&&window.confirm("\xBFEst\xE1 seguro que desea eliminar este registro?")&&this.userService.remove(e,n).subscribe({next:r=>{console.log("data",r);let s=v("Data received"),f=y(2e3);s.pipe(D(()=>f)).subscribe(S=>{console.log(S),this.getUsers(this.dataSource)})},error:r=>{console.log(r)}})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}applyFilter(e){let t=e.target.value;this.dataSource.filter=t.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=E({type:i,selectors:[["app-table"]],viewQuery:function(t,n){if(t&1&&(F(H,5),F(q,5),F(B,5)),t&2){let r;k(r=R())&&(n.paginator=r.first),k(r=R())&&(n.sort=r.first),k(r=R())&&(n.table=r.first)}},decls:34,vars:5,consts:[["input",""],["appearance","outlined",1,"example-card"],[1,"flex","gap-3","mt-3"],["mat-button","","mat-flat-button","",1,"mb-3","mt-2",3,"click"],["matInput","","placeholder","Ex. Mia",3,"keyup"],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","username"],["matColumnDef","email"],["matColumnDef","role"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of users",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-mini-fab","","matTooltip","Click to Edit",3,"click"],["aria-label","Edit"],["mat-mini-fab","","matTooltip","Click to Delete","color","error",1,"iconbutton"],["aria-label","Delete",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(t,n){if(t&1){let r=Q();a(0,"mat-card",1)(1,"mat-card-header")(2,"mat-card-title"),l(3," Configuraci\xF3n / usuarios"),o(),p(4,"mat-card-subtitle"),o(),a(5,"mat-card-content",2)(6,"button",3),c("click",function(){return T(r),x(n.openDialog("Add",{}))}),l(7," Nuevo Usuario "),o(),a(8,"mat-form-field")(9,"mat-label"),l(10,"Filter"),o(),a(11,"input",4,0),c("keyup",function(f){return T(r),x(n.applyFilter(f))}),o()(),a(13,"div",5)(14,"table",6),C(15,7),b(16,We,2,0,"th",8)(17,Ze,2,1,"td",9),M(),C(18,10),b(19,Ke,2,0,"th",8)(20,Xe,2,1,"td",9),M(),C(21,11),b(22,Ye,2,0,"th",8)(23,et,2,1,"td",9),M(),C(24,12),b(25,tt,2,0,"th",8)(26,it,2,1,"td",9),M(),C(27,13),b(28,ot,2,0,"th",14)(29,at,7,0,"td",9),M(),b(30,rt,1,0,"tr",15)(31,nt,1,0,"tr",16)(32,lt,3,1,"tr",17),o(),p(33,"mat-paginator",18),o()()()}t&2&&(m(14),d("dataSource",n.dataSource),m(16),d("matHeaderRowDef",n.displayedColumns),m(),d("matRowDefColumns",n.displayedColumns),m(2),d("pageSizeOptions",X(4,Je)))},dependencies:[j,P,A,Ie,B,_e,De,Se,Me,we,ve,ye,Te,xe,Ee,ge,H,V,Ce,q,he,ae,O,Le,Oe,He,Be,qe,Ve,U,N,te],styles:[".example-card-footer[_ngcontent-%COMP%]{padding:16px}"]})};export{$ as default};
