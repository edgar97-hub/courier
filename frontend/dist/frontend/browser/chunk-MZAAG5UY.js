import{a as xe,b as Ee,c as Fe,d as Ie,e as ke,f as Re,g as Ne}from"./chunk-XX45TBNI.js";import{b as pe,c as H,d as de,e as O,f as ue,g as fe,h as B,i as be,j as ge,k as he,l as Me,m as Ce,n as _e,o as Se,p as ye,q as De,r as ve,s as Te,t as we,u as Ue,v as Ve,w as je,x as Ae,y as Pe,z as He}from"./chunk-K5ZG3GAK.js";import"./chunk-FFAAVIVD.js";import{a as P}from"./chunk-E75IIMLS.js";import{a as V,b as ee,g as j,h as A}from"./chunk-NQ23PRK7.js";import"./chunk-ZZO4XKTB.js";import"./chunk-T5UCPTXZ.js";import{a as te,b as ie,d as oe,e as w,g as ae,h as re,k as ne,l as le,m as me,o as se,q as ce}from"./chunk-274QBDMQ.js";import{T as N,U as Z,V as U,c as Y}from"./chunk-XT6BZMKU.js";import{Bb as b,F as C,Kb as d,La as J,Q as _,Ub as n,Vb as r,Wb as c,Xb as v,Yb as T,_b as G,ac as u,bc as E,f,fc as F,ga as $,gc as I,hc as k,ib as s,la as z,lc as W,ma as S,mc as l,nb as q,nc as R,oc as K,s as M,uc as X,va as y,wa as D,wb as x}from"./chunk-DHFLL7AS.js";var g=class i{constructor(e){this.http=e}API_URL="http://161.132.41.184:8000/api/districts";unsubscribe=null;getAuthState(){return f(this,null,function*(){})}getUsers(e){return this.http.get(this.API_URL+"/all",{headers:{codrr_token:e.token}})}update(e){return this.http.put(this.API_URL+"/edit/"+e.id,{name:e.name,price:e.price},{headers:{"Content-Type":"application/json",codrr_token:e.token}})}insert(e){return this.http.post(this.API_URL+"/register",{name:e.name,price:e.price},{headers:{"Content-Type":"application/json",codrr_token:e.token}})}remove(e,t){return this.http.delete(this.API_URL+"/delete/"+e,{headers:{"Content-Type":"application/json",codrr_token:t.token}})}ngOnDestroy(){this.unsubscribe?.()}static \u0275fac=function(t){return new(t||i)(z(Y))};static \u0275prov=$({token:i,factory:i.\u0275fac,providedIn:"root"})};var L=class i{constructor(e,t){this.fb=e;this.data=t;this.dialogRef=this.data.dialog,this.action=t.obj.action,this.getUsers=t.getUsers,this.dataSource=t.dataSource,t.obj.action==="update"?this.myForm=this.fb.group({id:[t.obj.id,[]],name:[t.obj.name,[w.required]],price:[t.obj.price,[w.required]]}):this.myForm=this.fb.group({name:["",[w.required]],price:["",[w.required]]})}myForm;dialogRef;action;userService=S(g);getUsers;dataSource;hidePassword=J(!0);onSubmit(e){return f(this,null,function*(){if(console.log("Valid?",e.valid),e.valid){let t=localStorage.getItem("user"),a=t?JSON.parse(t):null;if(console.log("user",a),!a)return;this.action==="update"?this.userService.update({id:e.value.id,name:e.value.name,price:e.value.price,token:a.token}).subscribe({next:o=>{console.log(o);let m=M("Data received"),p=C(1e3);m.pipe(_(()=>p)).subscribe(h=>{console.log(h),this.getUsers(this.dataSource)})},error:o=>{console.log(o)}}):this.userService.insert({name:e.value.name,price:e.value.price,token:a.token}).subscribe({next:o=>{console.log(o);let m=M("Data received"),p=C(1e3);m.pipe(_(()=>p)).subscribe(h=>{console.log(h),this.getUsers(this.dataSource)})},error:o=>{console.log(o)}}),this.dialogRef.closeAll()}})}static \u0275fac=function(t){return new(t||i)(q(se),q(xe))};static \u0275cmp=x({type:i,selectors:[["app-sample-dialog"]],decls:21,vars:1,consts:[["mat-dialog-title",""],[1,"flex","mb-10",3,"ngSubmit","formGroup"],[1,"max-w-3xl","p-2","rounded-lg","mat-elevation-z3","mb-6","bg-surface-container"],[1,"grid","grid-cols-1","md:grid-cols-1","gap-3","mb-0"],["matInput","","formControlName","name"],["appFieldError",""],["matInput","","formControlName","price"],["mat-stroked-button","","matDialogClose","",1,"mb-3","mt-2"],["type","submit","mat-flat-button","",1,"mb-3","mt-2"]],template:function(t,a){t&1&&(n(0,"h2",0),l(1,"Formulario Distrito"),r(),n(2,"mat-dialog-content")(3,"form",1),u("ngSubmit",function(){return a.onSubmit(a.myForm)}),n(4,"div",2)(5,"div",3)(6,"mat-form-field")(7,"mat-label"),l(8,"Nombre"),r(),c(9,"input",4)(10,"mat-error",5),r(),n(11,"mat-form-field")(12,"mat-label"),l(13,"Precio"),r(),c(14,"input",6)(15,"mat-error",5),r()(),n(16,"mat-dialog-actions")(17,"button",7),l(18," Cerrar "),r(),n(19,"button",8),l(20," Guardar "),r()()()()()),t&2&&(s(3),d("formGroup",a.myForm))},dependencies:[Ne,Fe,Ie,Re,ke,A,j,V,ee,U,N,P,pe,ce,ne,oe,ae,re,le,me],encapsulation:2})};var Ge=()=>[5,10,25,100];function Qe(i,e){i&1&&(n(0,"th",18),l(1,"ID"),r())}function $e(i,e){if(i&1&&(n(0,"td",19),l(1),r()),i&2){let t=e.$implicit;s(),R(t.id)}}function ze(i,e){i&1&&(n(0,"th",18),l(1,"Nombre"),r())}function Je(i,e){if(i&1&&(n(0,"td",19),l(1),r()),i&2){let t=e.$implicit;s(),R(t.name)}}function We(i,e){i&1&&(n(0,"th",18),l(1,"Precio"),r())}function Ke(i,e){if(i&1&&(n(0,"td",19),l(1),r()),i&2){let t=e.$implicit;s(),R(t.price)}}function Xe(i,e){i&1&&(n(0,"th",20),l(1,"Actions"),r())}function Ye(i,e){if(i&1){let t=G();n(0,"td",19)(1,"button",21),u("click",function(){let o=y(t).$implicit,m=E();return D(m.openDialog("update",o))}),n(2,"mat-icon",22),l(3,"edit"),r()(),n(4,"button",23)(5,"mat-icon",24),u("click",function(){let o=y(t).$implicit,m=E();return D(m.remove(o.id))}),l(6,"delete"),r()()()}}function Ze(i,e){i&1&&c(0,"tr",25)}function et(i,e){i&1&&c(0,"tr",26)}function tt(i,e){if(i&1&&(n(0,"tr",27)(1,"td",28),l(2),r()()),i&2){E();let t=W(12);s(2),K(' No hay datos que coincidan con el filtro "',t.value,'" ')}}var Q=class i{displayedColumns=["id","name","price","actions"];dataSource;paginator;sort;table;userService=S(g);dialog=S(Ee);constructor(){this.dataSource=new we,this.getUsers(this.dataSource),this.table=this.table}getUsers(e){return f(this,null,function*(){let t=localStorage.getItem("user"),a=t?JSON.parse(t):null;a&&this.userService.getUsers(a).subscribe({next:o=>{console.log("data",o),e.data=o},error:o=>{console.log(o)}})})}openDialog(e,t){t.action=e,this.dialog.open(L,{data:{dialog:this.dialog,width:"250px",obj:t,getUsers:this.getUsers,dataSource:this.dataSource}})}remove(e){let t=localStorage.getItem("user"),a=t?JSON.parse(t):null;a&&window.confirm("\xBFEst\xE1 seguro que desea eliminar este registro?")&&this.userService.remove(e,a).subscribe({next:o=>{console.log("data",o);let m=M("Data received"),p=C(1e3);m.pipe(_(()=>p)).subscribe(h=>{console.log(h),this.getUsers(this.dataSource)})},error:o=>{console.log(o)}})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}applyFilter(e){let t=e.target.value;this.dataSource.filter=t.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=x({type:i,selectors:[["app-table"]],viewQuery:function(t,a){if(t&1&&(F(H,5),F(O,5),F(B,5)),t&2){let o;I(o=k())&&(a.paginator=o.first),I(o=k())&&(a.sort=o.first),I(o=k())&&(a.table=o.first)}},decls:31,vars:5,consts:[["input",""],["appearance","outlined",1,"example-card"],[1,"flex","gap-3","mt-3"],["mat-button","","mat-flat-button","",1,"mb-3","mt-2",3,"click"],["matInput","","placeholder","Ex. Mia",3,"keyup"],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","price"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-mini-fab","","matTooltip","Click to Edit",3,"click"],["aria-label","Edit"],["mat-mini-fab","","matTooltip","Click to Delete","color","error",1,"iconbutton"],["aria-label","Delete",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(t,a){if(t&1){let o=G();n(0,"mat-card",1)(1,"mat-card-header")(2,"mat-card-title"),l(3," Configuraci\xF3n / distritos"),r(),c(4,"mat-card-subtitle"),r(),n(5,"mat-card-content",2)(6,"button",3),u("click",function(){return y(o),D(a.openDialog("Add",{}))}),l(7," Nuevo Distrito "),r(),n(8,"mat-form-field")(9,"mat-label"),l(10,"Filter"),r(),n(11,"input",4,0),u("keyup",function(p){return y(o),D(a.applyFilter(p))}),r()(),n(13,"div",5)(14,"table",6),v(15,7),b(16,Qe,2,0,"th",8)(17,$e,2,1,"td",9),T(),v(18,10),b(19,ze,2,0,"th",8)(20,Je,2,1,"td",9),T(),v(21,11),b(22,We,2,0,"th",8)(23,Ke,2,1,"td",9),T(),v(24,12),b(25,Xe,2,0,"th",13)(26,Ye,7,0,"td",9),T(),b(27,Ze,1,0,"tr",14)(28,et,1,0,"tr",15)(29,tt,3,1,"tr",16),r(),c(30,"mat-paginator",17),r()()()}t&2&&(s(14),d("dataSource",a.dataSource),s(13),d("matHeaderRowDef",a.displayedColumns),s(),d("matRowDefColumns",a.displayedColumns),s(2),d("pageSizeOptions",X(4,Ge)))},dependencies:[A,j,V,Te,B,ge,_e,he,be,Se,Me,Ce,ye,De,ve,de,H,P,fe,O,ue,ie,te,He,Ue,je,Pe,Ae,Ve,U,N,Z],encapsulation:2})};export{Q as default};
