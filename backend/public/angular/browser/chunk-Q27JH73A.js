import{a as T,b as L,c as Se,d as pe,e as ht,f as bt,h as O,i as Ct,j as ce,k as vt,l as ue,m as xt}from"./chunk-4O74X3N7.js";import"./chunk-F5X5MWHG.js";import{a as Lt}from"./chunk-TU7U4WBH.js";import{a as we,b as ie}from"./chunk-PZCJVKX2.js";import{b as re,c as ne}from"./chunk-FBL4ZQT7.js";import{C as ai,D as si,E as Be,F as li,G as je,H as mi,I as di,a as Bt,b as jt,c as Vt,e as Ht,f as zt,g as qt,h as Re,i as Gt,j as Qt,k as Kt,l as Yt,m as Wt,n as Zt,o as Jt,p as Xt,q as ei,r as ti,s as ii,t as ri,u as ni,y as oi}from"./chunk-PHEAMHGW.js";import{b as Nt,c as At}from"./chunk-TOVRHTJN.js";import{a as Le,b as $e}from"./chunk-NJ6D5PLM.js";import{a as $t,b as Rt}from"./chunk-CDCWUO36.js";import{a as Te,b as kt,e as Oe,h as Fe,i as ke,n as Ne,o as Ae}from"./chunk-MYNWWTJH.js";import{a as Ee,b as Me,d as Ie,e as ye,f as Et,g as De,h as z}from"./chunk-BGY2FCVT.js";import{b as Mt,d as Pe,f as It,g as yt,l as Dt,o as wt,p as Pt,r as Tt,s as Ot,u as Ft}from"./chunk-3KYPZUCO.js";import{a as D,b as x}from"./chunk-DTY45AJM.js";import{h as q,j as G,m as M}from"./chunk-VBCWU2N4.js";import{$ as A,$a as C,$b as gt,Ab as _,Ac as dt,Bb as b,Ca as Y,Cc as _t,E as K,Fb as at,G as E,Gb as st,Gc as xe,Hb as lt,Ia as ut,Ic as N,Jc as Ue,Kb as mt,Lb as o,Mb as p,Nb as S,Nc as H,Oc as Ut,P as ot,Pc as St,Sa as s,Vb as ve,Wa as de,Xb as w,Yb as P,_ as ee,a as g,b as h,ba as U,c as pt,fb as u,ga as Ce,ib as ft,j as R,jb as d,k as be,la as c,pc as k,r as F,rc as V,s as J,sb as n,ta as ct,tb as t,ua as B,ub as m,v as X,va as j,vb as I,wb as y,wc as v,yb as te}from"./chunk-AXAGG6HT.js";var oe=T("[User Page/API] Load Users"),Ve=T("[User API] Load Users Success",L()),He=T("[User API] Load Users Failure",L()),ae=T("[User Create Page] Create User",L()),fe=T("[User API] Create User Success",L()),ze=T("[User API] Create User Failure",L()),se=T("[User Page] Delete User",L()),qe=T("[User API] Delete User Success",L()),Ge=T("[User API] Delete User Failure",L()),Qe=T("[User Store] Clear User Error");var Ye=ht("users"),pi=pe(Ye,r=>r.users),ci=pe(Ye,r=>r.isLoading),We=pe(Ye,r=>r.error),ui=pe(Ye,r=>r.isSubmitting);var xi=()=>[5,10,25,100];function Ui(r,e){r&1&&(n(0,"div",10),m(1,"mat-progress-spinner",11),t())}function Si(r,e){r&1&&(n(0,"th",25),o(1,"N\xB0"),t())}function Ei(r,e){if(r&1&&(n(0,"td",26),o(1),t()),r&2){let i=e.$implicit;s(),p(i.code)}}function Mi(r,e){r&1&&(n(0,"th",25),o(1,"Username"),t())}function Ii(r,e){if(r&1&&(n(0,"td",26),o(1),t()),r&2){let i=e.$implicit;s(),p(i.username)}}function yi(r,e){r&1&&(n(0,"th",25),o(1,"Name"),t())}function Di(r,e){if(r&1&&(n(0,"td",26),o(1),t()),r&2){let i=e.$implicit;s(),p(i.name)}}function wi(r,e){r&1&&(n(0,"th",25),o(1,"Email"),t())}function Pi(r,e){if(r&1&&(n(0,"td",26),o(1),t()),r&2){let i=e.$implicit;s(),p(i.email)}}function Ti(r,e){r&1&&(n(0,"th",25),o(1,"Role"),t())}function Oi(r,e){if(r&1&&(n(0,"td",26),o(1),t()),r&2){let i=e.$implicit;s(),p(i.role||"N/A")}}function Fi(r,e){r&1&&(n(0,"th",27),o(1,"Actions"),t())}function ki(r,e){if(r&1){let i=te();n(0,"td",26)(1,"button",28),_("click",function(){let l=B(i).$implicit,f=b(2);return j(f.onEdit(l))}),n(2,"mat-icon"),o(3,"edit"),t()(),n(4,"button",29),_("click",function(){let l=B(i).$implicit,f=b(2);return j(f.onDelete(l))}),n(5,"mat-icon"),o(6,"delete"),t()()()}}function Ni(r,e){r&1&&m(0,"tr",30)}function Ai(r,e){r&1&&m(0,"tr",31)}function Li(r,e){if(r&1&&(n(0,"tr",32)(1,"td",33),o(2),t()()),r&2){let i=b(2),a=mt(6);s(),ft("colspan",i.displayedColumns.length),s(),S(' No data matching the filter "',a.value,'" ')}}function $i(r,e){if(r&1&&(n(0,"table",12),I(1,13),u(2,Si,2,0,"th",14)(3,Ei,2,1,"td",15),y(),I(4,16),u(5,Mi,2,0,"th",14)(6,Ii,2,1,"td",15),y(),I(7,17),u(8,yi,2,0,"th",14)(9,Di,2,1,"td",15),y(),I(10,18),u(11,wi,2,0,"th",14)(12,Pi,2,1,"td",15),y(),I(13,19),u(14,Ti,2,0,"th",14)(15,Oi,2,1,"td",15),y(),I(16,20),u(17,Fi,2,0,"th",21)(18,ki,7,0,"td",15),y(),u(19,Ni,1,0,"tr",22)(20,Ai,1,0,"tr",23)(21,Li,3,2,"tr",24),t()),r&2){let i=b();d("dataSource",i.dataSource),s(19),d("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky",!0),s(),d("matRowDefColumns",i.displayedColumns)}}function Ri(r,e){r&1&&(n(0,"div",34),o(1," No users found. Try dispatching the load action or check your API. "),t())}var Ze=class r{users=[];isLoading=!1;displayedColumns=["code","username","email","rol","actions"];dataSource=new ni;paginator;sort;ngOnChanges(e){e.users&&this.users?(console.log("UserTableComponent: Users received via @Input()",this.users),this.dataSource.data=this.users):e.users&&!this.users&&(this.dataSource.data=[])}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.dataSource.sortingDataAccessor=(e,i)=>e[i]}applyFilter(e){let i=e.target.value;this.dataSource.filter=i.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}viewUser=new Y;editUser=new Y;deleteUser=new Y;onView(e){this.viewUser.emit(e)}onEdit(e){this.editUser.emit(e)}onDelete(e){this.deleteUser.emit(e)}static \u0275fac=function(i){return new(i||r)};static \u0275cmp=C({type:r,selectors:[["app-user-table"]],viewQuery:function(i,a){if(i&1&&(at(Be,5),at(je,5)),i&2){let l;st(l=lt())&&(a.paginator=l.first),st(l=lt())&&(a.sort=l.first)}},inputs:{users:"users",isLoading:"isLoading"},outputs:{viewUser:"viewUser",editUser:"editUser",deleteUser:"deleteUser"},features:[ct],decls:13,vars:5,consts:[["input",""],[1,"table-container","mat-elevation-z4"],[1,"table-header"],["appearance","outline",1,"filter-field"],["matInput","","placeholder","Search...",3,"keyup"],["matSuffix",""],["class","spinner-container",4,"ngIf"],["mat-table","","matSort","","class","user-data-table",3,"dataSource",4,"ngIf"],["class","no-data-message",4,"ngIf"],["showFirstLastButtons","","aria-label","Select page of users",3,"pageSizeOptions"],[1,"spinner-container"],["mode","indeterminate","diameter","50"],["mat-table","","matSort","",1,"user-data-table",3,"dataSource"],["matColumnDef","code"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","username"],["matColumnDef","name"],["matColumnDef","email"],["matColumnDef","rol"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","","color","accent","matTooltip","Edit User",3,"click"],["mat-icon-button","","color","warn","matTooltip","Delete User",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],[1,"mat-cell"],[1,"no-data-message"]],template:function(i,a){if(i&1){let l=te();n(0,"div",1)(1,"div",2)(2,"mat-form-field",3)(3,"mat-label"),o(4,"Filter Users"),t(),n(5,"input",4,0),_("keyup",function(Z){return B(l),j(a.applyFilter(Z))}),t(),n(7,"mat-icon",5),o(8,"search"),t()()(),u(9,Ui,2,0,"div",6)(10,$i,22,4,"table",7)(11,Ri,2,0,"div",8),m(12,"mat-paginator",9),t()}if(i&2){let l=mt(6);s(9),d("ngIf",a.isLoading),s(),d("ngIf",!a.isLoading&&a.dataSource.data.length>0),s(),d("ngIf",!a.isLoading&&a.dataSource.data.length===0&&!l.value),s(),d("pageSizeOptions",ve(4,xi))}},dependencies:[v,k,ri,Gt,Kt,Jt,Yt,Qt,Xt,Wt,Zt,ei,ti,ii,li,Be,di,je,mi,ke,Fe,Te,Oe,Ae,Ne,x,D,M,q,ie,we,Rt,$t],styles:[".table-container[_ngcontent-%COMP%]{margin:20px;overflow:auto;border-radius:8px;background-color:#fff}.table-header[_ngcontent-%COMP%]{padding:16px;display:flex;justify-content:space-between;align-items:center;background-color:#f5f5f5;border-top-left-radius:8px;border-top-right-radius:8px}.filter-field[_ngcontent-%COMP%]{width:100%;max-width:400px;font-size:.9em}.user-data-table[_ngcontent-%COMP%]{width:100%}th.mat-header-cell[_ngcontent-%COMP%], td.mat-cell[_ngcontent-%COMP%]{padding:12px 16px;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:#e0e0e0}th.mat-header-cell[_ngcontent-%COMP%]{font-weight:500;color:#333;background-color:#fafafa}tr.mat-row[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}.mat-mdc-paginator[_ngcontent-%COMP%]{background-color:#f5f5f5;border-bottom-left-radius:8px;border-bottom-right-radius:8px}.spinner-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:50px;min-height:200px}.no-data-message[_ngcontent-%COMP%]{text-align:center;padding:30px;color:#757575;font-style:italic}td.mat-cell[_ngcontent-%COMP%]   button.mat-icon-button[_ngcontent-%COMP%]{margin-right:4px}"]})};var Je=class r{constructor(e,i){this.dialogRef=e;this.data=i}onConfirm(){this.dialogRef.close(!0)}onDismiss(){this.dialogRef.close(!1)}static \u0275fac=function(i){return new(i||r)(de(Bt),de(jt))};static \u0275cmp=C({type:r,selectors:[["app-confirm-dialog"]],decls:10,vars:4,consts:[["mat-dialog-title","",1,"dialog-title"],[1,"dialog-content"],["align","end",1,"dialog-actions"],["mat-stroked-button","",3,"click"],["mat-flat-button","","color","warn","cdkFocusInitial","",3,"click"]],template:function(i,a){i&1&&(n(0,"h2",0),o(1),t(),n(2,"mat-dialog-content",1)(3,"p"),o(4),t()(),n(5,"mat-dialog-actions",2)(6,"button",3),_("click",function(){return a.onDismiss()}),o(7),t(),n(8,"button",4),_("click",function(){return a.onConfirm()}),o(9),t()()),i&2&&(s(),S(" ",a.data.title," "),s(3),p(a.data.message),s(3),S(" ",a.data.cancelText||"Cancel"," "),s(2),S(" ",a.data.confirmText||"Delete"," "))},dependencies:[v,Re,Ht,qt,zt,M,G,x],styles:[".dialog-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-weight:500;color:#d32f2f}.dialog-content[_ngcontent-%COMP%]{line-height:1.6;color:#555}.dialog-actions[_ngcontent-%COMP%]{padding-top:16px}.title-icon[_ngcontent-%COMP%]{vertical-align:middle}"]})};var Bi=()=>[],Xe=class r{store=c(Se);router=c(N);dialog=c(Vt);users$;isLoading$;error$;destroy$=new R;constructor(){this.users$=this.store.select(pi).pipe(U(e=>console.log("UserListPageComponent: Users from store:",e))),this.isLoading$=this.store.select(ci).pipe(U(e=>console.log("UserListPageComponent: IsLoading from store:",e))),this.error$=this.store.select(We).pipe(K(e=>!!e),U(e=>{console.error("UserListPageComponent: Error from store:",e)}))}ngOnInit(){console.log("UserListPageComponent: ngOnInit - dispatching loadUsers"),this.store.dispatch(oe())}handleViewUser(e){this.router.navigate(["/users",e.id])}handleEditUser(e){this.router.navigate(["/configuracion/users","edit",e.id])}handleDeleteUser(e){this.dialog.open(Je,{width:"350px",data:{title:"Confirm Delete",message:`Are you sure you want to delete user "${e.username}" (ID: ${e.id})? This action cannot be undone.`}}).afterClosed().pipe(K(a=>!!a),A(this.destroy$)).subscribe(()=>{this.performDelete(e)})}performDelete(e){this.store.dispatch(se({userId:e.id||""}))}navigateToCreate(){this.router.navigate(["/configuracion/users/edit/0"])}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(i){return new(i||r)};static \u0275cmp=C({type:r,selectors:[["app-user-list-page"]],decls:11,vars:7,consts:[[1,"page-container"],[1,"page-header"],["mat-flat-button","","color","primary",3,"click"],[3,"viewUser","editUser","deleteUser","users","isLoading"]],template:function(i,a){if(i&1&&(n(0,"div",0)(1,"div",1)(2,"h1"),o(3,"Gesti\xF3n de usuarios"),t(),n(4,"button",2),_("click",function(){return a.navigateToCreate()}),n(5,"mat-icon"),o(6,"add_circle_outline"),t(),o(7," Crear nuevo usuario "),t()(),n(8,"app-user-table",3),w(9,"async"),w(10,"async"),_("viewUser",function(f){return a.handleViewUser(f)})("editUser",function(f){return a.handleEditUser(f)})("deleteUser",function(f){return a.handleDeleteUser(f)}),t()()),i&2){let l;s(8),d("users",P(9,2,a.users$)||ve(6,Bi))("isLoading",(l=P(10,4,a.isLoading$))!==null&&l!==void 0?l:!1)}},dependencies:[v,V,H,Ze,M,G,x,D,Re,ne],styles:[".page-container[_ngcontent-%COMP%]{padding:24px;background-color:#f9f9f9;min-height:calc(100vh - 64px)}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid #e0e0e0}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:2em;font-weight:500;color:#3f51b5}.page-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-weight:500}"]})};function Hi(r,e){r&1&&(n(0,"mat-error"),o(1," Nombre de usuario es requerido. "),t())}function zi(r,e){r&1&&(n(0,"mat-error"),o(1," Email es requerido. "),t())}function qi(r,e){r&1&&(n(0,"mat-error"),o(1," Formato de email inv\xE1lido. "),t())}function Gi(r,e){r&1&&(n(0,"mat-error"),o(1," Rol es requerido. "),t())}function Qi(r,e){r&1&&(I(0),m(1,"mat-divider",19),n(2,"div",2)(3,"h3",3)(4,"mat-icon"),o(5,"featured_play_list"),t(),o(6," Caracter\xEDstica del Negocio "),t(),n(7,"div",20)(8,"mat-form-field",5)(9,"mat-label"),o(10,"Tipo de Negocio"),t(),m(11,"input",21),t(),n(12,"mat-form-field",5)(13,"mat-label"),o(14,"Nombre del Negocio"),t(),m(15,"input",22),t()(),n(16,"mat-form-field",23)(17,"mat-label"),o(18,"Distrito del Negocio"),t(),m(19,"input",24),t(),n(20,"mat-form-field",23)(21,"mat-label"),o(22,"Direcci\xF3n del Negocio"),t(),m(23,"input",25),t(),n(24,"div",20)(25,"mat-form-field",5)(26,"mat-label"),o(27,"N\xFAmero de tel\xE9fono del Negocio"),t(),m(28,"input",26),t(),n(29,"mat-form-field",5)(30,"mat-label"),o(31,"Sector del Negocio"),t(),m(32,"input",27),t()(),n(33,"div",20)(34,"mat-form-field",5)(35,"mat-label"),o(36,"Tipo de documento del Negocio"),t(),m(37,"input",28),t(),n(38,"mat-form-field",5)(39,"mat-label"),o(40,"Correo electr\xF3nico del Negocio"),t(),m(41,"input",29),t()(),n(42,"div",20)(43,"mat-form-field",5)(44,"mat-label"),o(45,"N\xFAmero de documento del Negocio"),t(),m(46,"input",30),t()(),n(47,"div",31)(48,"label",32),o(49,"Asume el 5% POS"),t(),n(50,"mat-checkbox",33),o(51," Confirmar "),t()()(),m(52,"mat-divider",19),n(53,"div",2)(54,"h3",3)(55,"mat-icon"),o(56,"attribution"),t(),o(57," Informaci\xF3n del Propietario "),t(),n(58,"div",20)(59,"mat-form-field",5)(60,"mat-label"),o(61,"Nombre del propietario"),t(),m(62,"input",34),t(),n(63,"mat-form-field",5)(64,"mat-label"),o(65,"N\xFAmero de tel\xE9fono del propietario"),t(),m(66,"input",35),t()(),n(67,"div",20)(68,"mat-form-field",5)(69,"mat-label"),o(70,"Tipo de documento del propietario"),t(),m(71,"input",36),t(),n(72,"mat-form-field",5)(73,"mat-label"),o(74,"N\xFAmero de documento del propietario"),t(),m(75,"input",37),t()(),n(76,"div",20)(77,"mat-form-field",5)(78,"mat-label"),o(79,"Direcci\xF3n de correo electr\xF3nico del propietario"),t(),m(80,"input",38),t()()(),m(81,"mat-divider",19),n(82,"div",2)(83,"h3",3)(84,"mat-icon"),o(85,"account_balance"),t(),o(86," Cuenta bancaria "),t(),n(87,"mat-form-field",23)(88,"mat-label"),o(89,"Cuenta bancaria"),t(),m(90,"input",39),t()(),y())}var me=class r{constructor(e){this.fb=e}userToEdit=null;isLoading=!1;formSubmit=new Y;formCancel=new Y;userForm;hidePassword=ut(!0);ngOnInit(){this.initForm(),this.userToEdit&&this.userForm.patchValue(this.userToEdit),this.userForm.get("role")?.valueChanges.subscribe(e=>{this.handleRoleChange(e)})}get roleControl(){return this.userForm.get("role")}handleRoleChange(e){}initForm(){this.userForm=this.fb.group({id:[null],username:["",Pe.required],email:["",[Pe.required,Pe.email]],password:["",[]],role:["CUSTOMER"],business_type:["",[]],business_name:["",[]],business_district:["",[]],business_address:["",[]],business_phone_number:["",[]],business_sector:["",[]],business_document_type:["",[]],business_email:["",[]],assumes_5_percent_pos:[!1,[]],business_document_number:["",[]],owner_name:["",[]],owner_phone_number:["",[]],owner_document_type:["",[]],owner_document_number:["",[]],owner_email_address:["",[]],owner_bank_account:["",[]]})}get username(){return this.userForm.get("username")}get email(){return this.userForm.get("email")}onSubmit(){if(this.userForm.valid)if(this.userToEdit&&this.userToEdit.id){let i=h(g(g({},this.userToEdit),this.userForm.value),{id:this.userToEdit.id});console.log("formData",i),this.formSubmit.emit(i)}else{let e=this.userForm.value,{id:i}=e,a=pt(e,["id"]);this.formSubmit.emit(a)}else this.userForm.markAllAsTouched()}onCancel(){this.formCancel.emit()}static \u0275fac=function(i){return new(i||r)(de(Ot))};static \u0275cmp=C({type:r,selectors:[["app-user-form"]],inputs:{userToEdit:"userToEdit",isLoading:"isLoading"},outputs:{formSubmit:"formSubmit",formCancel:"formCancel"},decls:51,vars:10,consts:[[1,"multi-section-form-card"],[3,"ngSubmit","formGroup"],[1,"form-section"],[1,"section-title"],[1,"form-grid"],["appearance","outline",1,"form-field","small-field"],["matInput","","formControlName","username","autocomplete","off","required",""],[4,"ngIf"],["matInput","","formControlName","email","type","email","required",""],["matInput","","placeholder","Ingrese su contrase\xF1a","formControlName","password","autocomplete","new-password",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["formControlName","role","required",""],["value","ADMIN"],["value","MOTORIZED"],["value","CUSTOMER"],["value","RECEPTIONIST"],["align","end",1,"form-actions-sticky"],["mat-stroked-button","","type","button",3,"click"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],[1,"section-divider"],[1,"form-grid","two-columns"],["matInput","","formControlName","business_type"],["matInput","","formControlName","business_name"],["appearance","outline",1,"form-field","small-field","full-width-mobile"],["matInput","","formControlName","business_district"],["matInput","","formControlName","business_address"],["matInput","","formControlName","business_phone_number"],["matInput","","formControlName","business_sector"],["matInput","","formControlName","business_document_type"],["matInput","","formControlName","business_email"],["matInput","","formControlName","business_document_number"],[1,"form-field-group"],[1,"checkbox-group-label"],["formControlName","assumes_5_percent_pos","color","primary",1,"small-checkbox"],["matInput","","formControlName","owner_name"],["matInput","","formControlName","owner_phone_number"],["matInput","","formControlName","owner_document_type"],["matInput","","formControlName","owner_document_number"],["matInput","","formControlName","owner_email_address"],["matInput","","formControlName","owner_bank_account"]],template:function(i,a){if(i&1&&(n(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),o(3,"Formulario de usuario"),t(),n(4,"mat-card-subtitle"),o(5,"Complete todas las secciones del formulario"),t()(),n(6,"mat-card-content")(7,"form",1),_("ngSubmit",function(){return a.onSubmit()}),n(8,"div",2)(9,"h3",3)(10,"mat-icon"),o(11,"person_outline"),t(),o(12," Informaci\xF3n B\xE1sica "),t(),n(13,"div",4)(14,"mat-form-field",5)(15,"mat-label"),o(16,"Nombre de Usuario"),t(),m(17,"input",6),u(18,Hi,2,0,"mat-error",7),t(),n(19,"mat-form-field",5)(20,"mat-label"),o(21,"Email"),t(),m(22,"input",8),u(23,zi,2,0,"mat-error",7)(24,qi,2,0,"mat-error",7),t(),n(25,"mat-form-field",5)(26,"mat-label"),o(27,"contrase\xF1a"),t(),m(28,"input",9),n(29,"button",10),_("click",function(){return a.hidePassword.set(!a.hidePassword())}),n(30,"mat-icon"),o(31),t()()(),n(32,"mat-form-field",5)(33,"mat-label"),o(34,"Rol"),t(),n(35,"mat-select",11)(36,"mat-option",12),o(37,"Administrador"),t(),n(38,"mat-option",13),o(39,"Motorizado"),t(),n(40,"mat-option",14),o(41,"Cliente"),t(),n(42,"mat-option",15),o(43,"Recepcionista"),t()(),u(44,Gi,2,0,"mat-error",7),t()()(),u(45,Qi,91,0,"ng-container",7),n(46,"mat-card-actions",16)(47,"button",17),_("click",function(){return a.onCancel()}),o(48," Cancelar "),t(),n(49,"button",18),o(50),t()()()()()),i&2){let l,f,Z,he;s(7),d("formGroup",a.userForm),s(11),d("ngIf",((l=a.userForm.get("username"))==null?null:l.invalid)&&((l=a.userForm.get("username"))==null?null:l.touched)),s(5),d("ngIf",((f=a.userForm.get("email"))==null?null:f.hasError("required"))&&((f=a.userForm.get("email"))==null?null:f.touched)),s(),d("ngIf",((Z=a.userForm.get("email"))==null?null:Z.hasError("email"))&&((Z=a.userForm.get("email"))==null?null:Z.touched)),s(4),d("type",a.hidePassword()?"password":"text"),s(3),p(a.hidePassword()?"visibility_off":"visibility"),s(13),d("ngIf",((he=a.userForm.get("role"))==null?null:he.invalid)&&((he=a.userForm.get("role"))==null?null:he.touched)),s(),d("ngIf",a.roleControl.value==="CUSTOMER"),s(4),d("disabled",a.isLoading||a.userForm.invalid),s(),S(" ",a.isLoading?"Guardando...":"Guardar Todo"," ")}},dependencies:[v,k,Ft,Dt,Mt,It,yt,Tt,wt,Pt,ke,Fe,Te,kt,Oe,Ae,Ne,M,G,q,z,Ee,Et,Ie,De,ye,Me,si,ai,oi,x,D,$e,Le,At,Nt],styles:[".multi-section-form-card[_ngcontent-%COMP%]{max-width:900px;margin:24px auto;padding:16px 24px;border-radius:8px}mat-card-title[_ngcontent-%COMP%]{font-size:1.5em;margin-bottom:4px}mat-card-subtitle[_ngcontent-%COMP%]{margin-bottom:24px;color:#0009}.form-section[_ngcontent-%COMP%]{margin-bottom:32px}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:1.2em;font-weight:500;color:#3f51b5;margin-bottom:20px;display:flex;align-items:center;gap:8px;border-bottom:1px solid #e0e0e0;padding-bottom:8px}.section-divider[_ngcontent-%COMP%]{margin-top:16px;margin-bottom:32px}.form-grid[_ngcontent-%COMP%]{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(250px,1fr))}@media (min-width: 600px){.form-grid.two-columns[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}.form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-form-field-input-control, .form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-floating-label, .form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-select-value{font-size:.875em}.form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-form-field-infix{padding-top:.8em!important;padding-bottom:.6em!important;min-height:auto!important}.form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-floating-label.mdc-floating-label--float-above{transform:translateY(-1.85em) scale(.75)!important}.form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-input-element{padding-top:0;margin-top:0}.form-field-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-top:8px}.form-field-group[_ngcontent-%COMP%]   .checkbox-group-label[_ngcontent-%COMP%]{font-size:.9em;color:#0009;margin-bottom:4px;font-weight:500}.small-checkbox[_ngcontent-%COMP%]     .mdc-form-field{font-size:.9em}.mat-card-actions.form-actions-sticky[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #e0e0e0;background-color:#fff}"]})};var et=class r{store=c(Se);router=c(N);isSubmitting$;error$;destroy$=new R;constructor(){this.isSubmitting$=this.store.select(ui),this.error$=this.store.select(We)}ngOnInit(){this.store.dispatch(Qe())}handleFormSubmit(e){console.log("UserCreatePageComponent: Form submitted",e),this.store.dispatch(ae({user:e}))}handleFormCancel(){this.router.navigate(["/users"])}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(i){return new(i||r)};static \u0275cmp=C({type:r,selectors:[["app-user-create-page"]],decls:9,vars:4,consts:[[1,"page-container","form-page-container"],[1,"page-header"],["mat-icon-button","","routerLink","/users","matTooltip","Back to User List","aria-label","Back to user list"],[3,"formSubmit","formCancel","userToEdit","isLoading"]],template:function(i,a){i&1&&(n(0,"div",0)(1,"div",1)(2,"button",2)(3,"mat-icon"),o(4,"arrow_back"),t()(),n(5,"h1"),o(6,"Create New User"),t()(),n(7,"app-user-form",3),w(8,"async"),_("formSubmit",function(f){return a.handleFormSubmit(f)})("formCancel",function(){return a.handleFormCancel()}),t()()),i&2&&(s(7),d("userToEdit",null)("isLoading",!!P(8,2,a.isSubmitting$)))},dependencies:[v,V,H,Ue,me,x,D,M,q],styles:[".page-container[_ngcontent-%COMP%]{padding:24px;background-color:#f9f9f9}.form-page-container[_ngcontent-%COMP%]{max-width:700px;margin:30px auto;background-color:#fff;border-radius:8px;box-shadow:0 2px 10px #0000001a;padding:24px}.page-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid #e0e0e0}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 0 16px;font-size:1.6em;font-weight:500;color:#3f51b5}"]})};var Q=class r{apiUrl=Ut.apiUrl+"/users";http=c(_t);authService=c(St);constructor(){console.log("UserService (NgRx integrated) initialized")}getAuthHeaders(){let e=this.authService.getAccessToken();return e?new dt({"Content-Type":"application/json",codrr_token:e}):new dt({"Content-Type":"application/json"})}getUsers(){let e=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.get(`${this.apiUrl}/all`,{headers:e}).pipe(X(i=>i||[]),E(this.handleError)):J(()=>new Error("Not authenticated to fetch users."))}getUserById(e){let i=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.get(`${this.apiUrl}/${e}`,{headers:i}).pipe(E(this.handleError)):J(()=>new Error("Not authenticated to fetch user by ID."))}createUser(e){let i=this.getAuthHeaders();return this.http.post(this.apiUrl+"/register",e,{headers:i}).pipe(U(a=>console.log("UserService: User created via API",a)),E(this.handleError))}updateUser(e){let i=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.put(`${this.apiUrl}/edit/${e.id}`,e,{headers:i}).pipe(E(this.handleError)):J(()=>new Error("Not authenticated to update user."))}deleteUser(e){let i=this.getAuthHeaders();return this.authService.getAccessToken()?(console.log(`UserService: Deleting user via API, ID: ${e}`),this.http.delete(`${this.apiUrl}/delete/${e}`,{headers:i}).pipe(E(this.handleError))):J(()=>new Error("Not authenticated to delete user."))}handleError(e){let i="An unknown error occurred in UserService!";return e.error instanceof ErrorEvent?i=`Client-side error: ${e.error.message}`:(i=`Server-side error Code: ${e.status}
Message: ${e.message}`,e.status===401?i="Unauthorized. Your session may have expired or you lack permissions.":e.status===403&&(i="Forbidden. You do not have permission for this action.")),console.error("UserService API Error:",i,e),J(()=>new Error(i))}static \u0275fac=function(i){return new(i||r)};static \u0275prov=Ce({token:r,factory:r.\u0275fac,providedIn:"root"})};function Yi(r,e){if(r&1&&(n(0,"h1"),o(1),t()),r&2){let i=b();s(),S(" ",i.isLoading?"Loading User...":i.isEditMode?"Edit User":"User Details"," ")}}function Wi(r,e){if(r&1){let i=te();n(0,"button",8),_("click",function(){B(i);let l=b();return j(l.navigateToEdit())}),n(1,"mat-icon"),o(2,"edit"),t(),o(3," Edit User "),t()}}function Zi(r,e){r&1&&(n(0,"div",9),m(1,"mat-progress-spinner",10),t())}function Ji(r,e){if(r&1){let i=te();I(0),n(1,"div",11)(2,"app-user-form",12),w(3,"async"),_("formSubmit",function(l){B(i);let f=b();return j(f.handleFormSubmit(l))})("formCancel",function(){B(i);let l=b();return j(l.handleFormCancel())}),t()(),y()}if(r&2){let i=b();s(2),d("userToEdit",P(3,2,i.user$))("isLoading",i.isLoading)}}function Xi(r,e){if(r&1&&(n(0,"p",13),o(1),t()),r&2){let i=b();s(),S(" User with ID ",i.userId," not found or could not be loaded. ")}}var tt=class r{route=c(xe);router=c(N);userService=c(Q);snackBar=c(re);userSubject=new be(null);user$=this.userSubject.asObservable();isLoading=!0;isEditMode=!1;userId=null;destroy$=new R;ngOnInit(){this.route.paramMap.pipe(A(this.destroy$),U(()=>{this.isLoading=!0,this.userSubject.next(null)}),ee(e=>{let i=e.get("id");return i&&i!=="0"?(this.userId=i,this.isEditMode=this.router.url.includes(`/edit/${this.userId}`),this.userService.getUserById(this.userId)):(this.isLoading=!1,F(null))}),E(e=>(this.isLoading=!1,this.snackBar.open("Error fetching user data.","Close",{duration:3e3,panelClass:["error-snackbar"]}),this.router.navigate(["/users"]),F(null))),K(e=>e!==null)).subscribe(e=>{this.isLoading=!1,console.log("user",e),e?this.userSubject.next(e):this.userId&&(this.snackBar.open(`User with ID ${this.userId} not found.`,"Close",{duration:3e3}),this.router.navigate(["/users"]))})}navigateToEdit(){this.userId&&this.router.navigate(["/users","edit",this.userId])}navigateToView(){this.userId&&this.router.navigate(["/users",this.userId])}handleFormSubmit(e){let i;this.userId?(i=h(g({},e),{id:this.userId}),this.isLoading=!0,this.userService.updateUser(i).pipe(A(this.destroy$)).subscribe({next:a=>{this.isLoading=!1,this.userSubject.next(a),this.snackBar.open("\xA1Actualizado exitosamente!","OK",{duration:3e3,verticalPosition:"top",panelClass:["success-snackbar"]}),this.isEditMode=!1,this.router.navigate(["/configuracion/users"])},error:a=>{this.isLoading=!1,this.snackBar.open("Error al actualizar el usuario. Int\xE9ntalo de nuevo.","Retry",{duration:5e3,verticalPosition:"top",panelClass:["error-snackbar"]}),console.error("Error updating user:",a)}})):(i=g({},e),this.isLoading=!0,this.userService.createUser(i).pipe(A(this.destroy$)).subscribe({next:a=>{this.isLoading=!1,this.userSubject.next(a),this.snackBar.open("\xA1Actualizado exitosamente!","OK",{duration:3e3,verticalPosition:"top",panelClass:["success-snackbar"]}),this.isEditMode=!1,this.router.navigate(["/configuracion/users"])},error:a=>{this.isLoading=!1,this.snackBar.open("Error al actualizar el usuario. Int\xE9ntalo de nuevo.","Retry",{duration:5e3,verticalPosition:"top",panelClass:["error-snackbar"]}),console.error("Error updating user:",a)}}))}handleFormCancel(){this.isEditMode=!1,this.router.navigate(["/configuracion/users"])}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(i){return new(i||r)};static \u0275cmp=C({type:r,selectors:[["app-user-detail-page"]],decls:13,vars:8,consts:[["loadingOrMissingTitle",""],[1,"page-container","detail-page-container"],[1,"page-header"],["mat-icon-button","","routerLink","/configuracion/users","matTooltip","Back to User List","aria-label","Back to user list"],["mat-stroked-button","","color","accent",3,"click",4,"ngIf"],["class","spinner-container",4,"ngIf"],[4,"ngIf"],["class","not-found-message",4,"ngIf"],["mat-stroked-button","","color","accent",3,"click"],[1,"spinner-container"],["mode","indeterminate","diameter","60"],[1,"form-wrapper"],[3,"formSubmit","formCancel","userToEdit","isLoading"],[1,"not-found-message"]],template:function(i,a){i&1&&(n(0,"div",1)(1,"div",2)(2,"button",3)(3,"mat-icon"),o(4,"arrow_back"),t()(),u(5,Yi,2,1,"ng-template",null,0,gt)(7,Wi,4,0,"button",4),w(8,"async"),t(),u(9,Zi,2,0,"div",5)(10,Ji,4,4,"ng-container",6)(11,Xi,2,1,"p",7),w(12,"async"),t()),i&2&&(s(7),d("ngIf",!a.isLoading&&P(8,4,a.user$)&&!a.isEditMode),s(2),d("ngIf",a.isLoading),s(),d("ngIf",!a.isLoading),s(),d("ngIf",!a.isLoading&&!P(12,6,a.user$)&&a.userId))},dependencies:[v,k,V,H,Ue,me,M,G,q,x,D,ie,we,ne,z],encapsulation:2})};var gi={users:[],isLoading:!1,isSubmitting:!1,error:null};var _i=Ct(gi,O(oe,r=>h(g({},r),{isLoading:!0,error:null})),O(Ve,(r,{users:e})=>h(g({},r),{users:e,isLoading:!1})),O(He,(r,{error:e})=>h(g({},r),{users:[],isLoading:!1,error:e})),O(ae,r=>h(g({},r),{isSubmitting:!0,error:null})),O(fe,(r,{user:e})=>h(g({},r),{users:[...r.users,e],isSubmitting:!1})),O(ze,(r,{error:e})=>h(g({},r),{isSubmitting:!1,error:e})),O(Qe,r=>h(g({},r),{error:null})),O(se,r=>h(g({},r),{isLoading:!0,error:null})),O(qe,(r,{userId:e})=>h(g({},r),{users:r.users.filter(i=>i.id!==e),isLoading:!1})),O(Ge,(r,{error:e})=>h(g({},r),{isLoading:!1,error:e})));var it=class r{actions$=c(vt);userService=c(Q);snackBar=c(re);router=c(N);loadUsers$=ce(()=>this.actions$.pipe(ue(oe),U(()=>console.log("UserEffects: loadUsers action dispatched")),ot(()=>this.userService.getUsers().pipe(X(e=>(console.log("UserEffects: Users received from service",e),Ve({users:e}))),E(e=>{let i=e.message||"Failed to load users from effect.";return console.error("UserEffects: Error loading users",e),this.snackBar.open(i,"Close",{duration:7e3,panelClass:["error-snackbar"]}),F(He({error:i}))})))));createUser$=ce(()=>this.actions$.pipe(ue(ae),U(e=>console.log("UserEffects: createUser action dispatched with user:",e.user)),ot(e=>this.userService.createUser(e.user).pipe(X(i=>(console.log("UserEffects: User created via service",i),fe({user:i}))),E(i=>{let a=i.message||"Failed to create user.";return console.error("UserEffects: Error creating user",i),F(ze({error:a}))})))));createUserSuccess$=ce(()=>this.actions$.pipe(ue(fe),U(e=>{console.log("UserEffects: createUserSuccess action, navigating for user:",e.user),this.snackBar.open(`User "${e.user.username}" created successfully!`,"OK",{duration:3e3,verticalPosition:"top",panelClass:["success-snackbar"]}),this.router.navigate(["/users"])})),{dispatch:!1});deleteUser$=ce(()=>this.actions$.pipe(ue(se),ee(e=>this.userService.deleteUser(e.userId).pipe(U(()=>{this.snackBar.open("User deleted successfully!","OK",{duration:3e3,panelClass:["success-snackbar"],verticalPosition:"top"})}),X(()=>qe({userId:e.userId})),E(i=>{let a=i.message||"An unexpected error occurred.";return this.snackBar.open(a,"Close",{duration:5e3,panelClass:["error-snackbar"],verticalPosition:"top"}),F(Ge({error:a}))})))));static \u0275fac=function(i){return new(i||r)};static \u0275prov=Ce({token:r,factory:r.\u0275fac})};var hi=[bt({name:"users",reducer:_i}),xt(it)];function er(r,e){if(r&1&&(I(0),m(1,"mat-divider",10),n(2,"div",3)(3,"h3",4)(4,"mat-icon"),o(5,"featured_play_list"),t(),o(6," Caracter\xEDstica del Negocio "),t(),n(7,"div",11)(8,"div",6)(9,"span",7),o(10,"Tipo de Negocio:"),t(),n(11,"span",8),o(12),t()(),n(13,"div",6)(14,"span",7),o(15,"Nombre del Negocio:"),t(),n(16,"span",8),o(17),t()()(),n(18,"div",12)(19,"span",7),o(20,"Distrito del Negocio:"),t(),n(21,"span",8),o(22),t()(),n(23,"div",12)(24,"span",7),o(25,"Direcci\xF3n del Negocio:"),t(),n(26,"span",8),o(27),t()(),n(28,"div",11)(29,"div",6)(30,"span",7),o(31,"N\xFAmero de tel\xE9fono del Negocio:"),t(),n(32,"span",8),o(33),t()(),n(34,"div",6)(35,"span",7),o(36,"Sector del Negocio:"),t(),n(37,"span",8),o(38),t()()(),n(39,"div",11)(40,"div",6)(41,"span",7),o(42,"Tipo de documento del Negocio:"),t(),n(43,"span",8),o(44),t()(),n(45,"div",6)(46,"span",7),o(47,"Correo electr\xF3nico del Negocio:"),t(),n(48,"span",8),o(49),t()()(),n(50,"div",11)(51,"div",6)(52,"span",7),o(53,"N\xFAmero de documento del Negocio:"),t(),n(54,"span",8),o(55),t()(),m(56,"div",6),t(),n(57,"div",6)(58,"span",7),o(59,"Asume el 5% POS:"),t(),n(60,"span",8),o(61),t()()(),m(62,"mat-divider",10),n(63,"div",3)(64,"h3",4)(65,"mat-icon"),o(66,"attribution"),t(),o(67," Informaci\xF3n del Propietario "),t(),n(68,"div",11)(69,"div",6)(70,"span",7),o(71,"Nombre del propietario:"),t(),n(72,"span",8),o(73),t()(),n(74,"div",6)(75,"span",7),o(76,"N\xFAmero de tel\xE9fono del propietario:"),t(),n(77,"span",8),o(78),t()()(),n(79,"div",11)(80,"div",6)(81,"span",7),o(82,"Tipo de documento del propietario:"),t(),n(83,"span",8),o(84),t()(),n(85,"div",6)(86,"span",7),o(87,"N\xFAmero de documento del propietario:"),t(),n(88,"span",8),o(89),t()()(),n(90,"div",5)(91,"div",6)(92,"span",7),o(93,"Direcci\xF3n de correo electr\xF3nico del propietario:"),t(),n(94,"span",8),o(95),t()()()(),m(96,"mat-divider",10),n(97,"div",3)(98,"h3",4)(99,"mat-icon"),o(100,"account_balance"),t(),o(101," Cuenta bancaria "),t(),n(102,"div",12)(103,"span",7),o(104,"Cuenta bancaria:"),t(),n(105,"span",8),o(106),t()()(),y()),r&2){let i=b(2);s(12),p(i.userData.business_type||"N/A"),s(5),p(i.userData.business_name||"N/A"),s(5),p(i.userData.business_district||"N/A"),s(5),p(i.userData.business_address||"N/A"),s(6),p(i.userData.business_phone_number||"N/A"),s(5),p(i.userData.business_sector||"N/A"),s(6),p(i.userData.business_document_type||"N/A"),s(5),p(i.userData.business_email||"N/A"),s(6),p(i.userData.business_document_number||"N/A"),s(6),p(i.formatBoolean(i.userData.assumes_5_percent_pos)),s(12),p(i.userData.owner_name||"N/A"),s(5),p(i.userData.owner_phone_number||"N/A"),s(6),p(i.userData.owner_document_type||"N/A"),s(5),p(i.userData.owner_document_number||"N/A"),s(6),p(i.userData.owner_email_address||"N/A"),s(11),p(i.userData.owner_bank_account||"N/A")}}function tr(r,e){if(r&1&&(n(0,"mat-card",2)(1,"mat-card-header")(2,"mat-card-title"),o(3),t(),n(4,"mat-card-subtitle"),o(5,"Informaci\xF3n registrada"),t()(),n(6,"mat-card-content")(7,"div",3)(8,"h3",4)(9,"mat-icon"),o(10,"person_outline"),t(),o(11," Informaci\xF3n B\xE1sica "),t(),n(12,"div",5)(13,"div",6)(14,"span",7),o(15,"Nombre de Usuario:"),t(),n(16,"span",8),o(17),t()(),n(18,"div",6)(19,"span",7),o(20,"Email:"),t(),n(21,"span",8),o(22),t()(),n(23,"div",6)(24,"span",7),o(25,"Rol:"),t(),n(26,"span",8),o(27),t()()()(),u(28,er,107,16,"ng-container",9),t()()),r&2){let i=b();s(3),S("Detalles del Usuario: ",i.userData.username,""),s(14),p(i.userData.username||"N/A"),s(5),p(i.userData.email||"N/A"),s(5),p(i.userData.role||"N/A"),s(),d("ngIf",i.isCustomerRole)}}function ir(r,e){r&1&&(n(0,"div",13),o(1,` No hay informaci\xF3n de usuario para mostrar.
`),t())}var rt=class r{userData;get isCustomerRole(){return this.userData?.role==="CUSTOMER"}formatBoolean(e){return e==null?"N/A":e?"S\xED":"No"}static \u0275fac=function(i){return new(i||r)};static \u0275cmp=C({type:r,selectors:[["app-user-display"]],inputs:{userData:"userData"},decls:2,vars:2,consts:[["class","multi-section-form-card readonly-mode",4,"ngIf"],["class","no-data-message",4,"ngIf"],[1,"multi-section-form-card","readonly-mode"],[1,"form-section"],[1,"section-title"],[1,"details-grid"],[1,"detail-item"],[1,"detail-label"],[1,"detail-value"],[4,"ngIf"],[1,"section-divider"],[1,"details-grid","two-columns"],[1,"detail-item","full-width-mobile"],[1,"no-data-message"]],template:function(i,a){i&1&&u(0,tr,29,5,"mat-card",0)(1,ir,2,0,"div",1),i&2&&(d("ngIf",a.userData),s(),d("ngIf",!a.userData))},dependencies:[v,k,z,Ee,Ie,De,ye,Me,x,D,$e,Le],styles:[".multi-section-form-card.readonly-mode[_ngcontent-%COMP%]{max-width:900px;margin:24px auto;padding:16px 24px;border-radius:8px;background-color:#fff;box-shadow:0 2px 4px #0000000d}mat-card-title[_ngcontent-%COMP%]{font-size:1.5em;margin-bottom:4px}mat-card-subtitle[_ngcontent-%COMP%]{margin-bottom:24px;color:#0000008a}.form-section[_ngcontent-%COMP%]{margin-bottom:28px}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:1.15em;font-weight:500;color:#3f51b5;margin-bottom:16px;display:flex;align-items:center;gap:8px;padding-bottom:8px;border-bottom:1px solid #e0e0e0}.section-divider[_ngcontent-%COMP%]{margin-top:12px;margin-bottom:28px}.details-grid[_ngcontent-%COMP%]{display:grid;gap:10px 20px;grid-template-columns:repeat(auto-fit,minmax(280px,1fr))}@media (min-width: 768px){.details-grid.two-columns[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}.detail-item[_ngcontent-%COMP%]{padding:4px 0;display:flex;flex-direction:column;margin-bottom:8px}.detail-label[_ngcontent-%COMP%]{font-size:.78em;color:#0009;margin-bottom:3px;font-weight:500;text-transform:uppercase;letter-spacing:.3px}.detail-value[_ngcontent-%COMP%], .detail-value-multiline[_ngcontent-%COMP%]{font-size:.92em;color:#000000de;word-break:break-word;line-height:1.45}.detail-value-multiline[_ngcontent-%COMP%]{white-space:pre-wrap;background-color:#f9f9f9;padding:8px 12px;border-radius:4px;border:1px solid #efefef;min-height:40px;margin-top:2px}@media (max-width: 599px){.full-width-mobile[_ngcontent-%COMP%]{grid-column:1/-1}}.no-data-message[_ngcontent-%COMP%]{text-align:center;padding:40px;font-style:italic;color:#757575}.mat-card-actions.form-actions-sticky[_ngcontent-%COMP%]{padding:16px 24px!important;border-top:1px solid #e0e0e0}"]})};function rr(r,e){if(r&1&&(n(0,"p",3),o(1),t()),r&2){let i=b();s(),S(" User with ID ",i.userId," not found or could not be loaded. ")}}var nt=class r{route=c(xe);router=c(N);userService=c(Q);snackBar=c(re);appStore=c(Lt);userSubject=new be(null);user$=this.userSubject.asObservable();userDataToDisplay=null;isLoading=!0;isEditMode=!1;userId=null;destroy$=new R;ngOnInit(){this.route.paramMap.pipe(A(this.destroy$),U(()=>{this.isLoading=!0,this.userSubject.next(null)}),ee(e=>this.appStore.currentUser()?.id?(this.userId=this.appStore.currentUser()?.id||"",this.userService.getUserById(this.userId)):(this.snackBar.open("User ID not provided in URL.","Close",{duration:3e3}),this.router.navigate(["/users"]),F(null))),E(e=>(this.isLoading=!1,this.snackBar.open("Error fetching user data.","Close",{duration:3e3,panelClass:["error-snackbar"]}),this.router.navigate(["/users"]),F(null))),K(e=>e!==null)).subscribe(e=>{this.isLoading=!1,e?(this.userSubject.next(e),this.userDataToDisplay=e):this.userId&&(this.snackBar.open(`User with ID ${this.userId} not found.`,"Close",{duration:3e3}),this.router.navigate(["/users"]))})}navigateToEdit(){this.userId&&this.router.navigate(["/users","edit",this.userId])}navigateToView(){this.userId&&this.router.navigate(["/users",this.userId])}handleFormSubmit(e){if(!this.userId){this.snackBar.open("No se puede actualizar el usuario: falta el ID de usuario.","Close",{duration:3e3,panelClass:["error-snackbar"]});return}this.isLoading=!0;let i=h(g({},e),{id:this.userId});this.userService.updateUser(i).pipe(A(this.destroy$)).subscribe({next:a=>{this.isLoading=!1,this.userSubject.next(a),this.snackBar.open("\xA1Actualizado exitosamente!","OK",{duration:3e3,verticalPosition:"top",panelClass:["success-snackbar"]}),this.isEditMode=!1,this.router.navigate(["/configuracion/users"])},error:a=>{this.isLoading=!1,this.snackBar.open("Error al actualizar el usuario. Int\xE9ntalo de nuevo.","Retry",{duration:5e3,verticalPosition:"top",panelClass:["error-snackbar"]}),console.error("Error updating user:",a)}})}handleFormCancel(){this.isEditMode=!1,this.router.navigate(["/configuracion/users"])}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(i){return new(i||r)};static \u0275cmp=C({type:r,selectors:[["app-user-detail-page"]],decls:4,vars:4,consts:[[1,"page-container","detail-page-container"],[3,"userData"],["class","not-found-message",4,"ngIf"],[1,"not-found-message"]],template:function(i,a){i&1&&(n(0,"div",0),m(1,"app-user-display",1),u(2,rr,2,1,"p",2),w(3,"async"),t()),i&2&&(s(),d("userData",a.userDataToDisplay),s(),d("ngIf",!a.isLoading&&!P(3,2,a.user$)&&a.userId))},dependencies:[v,k,V,H,rt,M,x,ie,ne,z],encapsulation:2})};var oa=[{path:"",providers:[...hi],children:[{path:"",component:Xe,title:"User List"},{path:"create",component:et,title:"Create New User"},{path:"edit/:id",component:tt,title:"Edit User"},{path:"detail",component:nt,title:"User Details"}]}];export{oa as USERS_ROUTES};
