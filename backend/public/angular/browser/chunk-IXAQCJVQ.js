import"./chunk-F5X5MWHG.js";import{a as gt,b as ft}from"./chunk-PZCJVKX2.js";import{a as ai,b as Mt,c as Tt}from"./chunk-FBL4ZQT7.js";import{A as Fi,B as qt,E as Pt,F as Ii,G as At,H as ki,I as Li,c as ui,h as hi,i as gi,j as fi,k as _i,l as vi,m as bi,n as Ci,o as Si,p as yi,q as wi,r as Oi,s as Di,t as Mi,u as Ti,v as Ei,w as Pi,x as Ai,y as Et,z as xi}from"./chunk-PHEAMHGW.js";import{b as wt,c as Ot}from"./chunk-TOVRHTJN.js";import{a as mi,b as pi}from"./chunk-CDCWUO36.js";import{a as _t,b as ei,d as ii,e as oi,g as ri,h as vt,i as bt,n as Ct,o as St}from"./chunk-MYNWWTJH.js";import{a as pt,b as He,d as ut,f as $e,g as je,h as ht}from"./chunk-BGY2FCVT.js";import{a as ze,b as qe,d as T,f as Ue,g as Ge,l as We,m as Ke,o as Ye,p as Qe,q as Xe,r as Ze,s as Je,u as ti}from"./chunk-3KYPZUCO.js";import{a as K,b as k}from"./chunk-DTY45AJM.js";import{B as ci,F as Dt,I as di,h as W,j as yt,m as I,o as ni,y as si,z as li}from"./chunk-VBCWU2N4.js";import{$ as N,$a as O,Ab as g,Ac as $t,Bb as v,Bc as Ee,Ca as b,Cb as ye,Cc as Pe,D as it,Da as le,Db as we,E as Lt,Eb as Vt,Fb as q,G as D,Ga as Nt,Gb as A,Gc as Ae,H as ee,Hb as x,I as ie,Ic as lt,Kb as X,La as ce,Lb as c,M as ot,Mb as y,Nb as nt,Nc as ct,O as oe,Oa as de,Ob as Oe,Oc as xe,Pc as Fe,Sa as m,Ta as me,Tc as Ie,Ub as Bt,Uc as ke,Va as pe,Vb as De,Wa as ue,Wc as Le,Xb as U,Ya as he,Yb as at,Z as rt,_ as j,_b as Me,a as tt,ab as ge,b as Xt,ba as w,bb as fe,c as Zt,cc as Ht,ec as $,fa as re,fb as h,fd as Re,g as et,ga as ne,h as kt,ha as ae,ia as Rt,ib as Q,j as E,jb as p,k as Jt,la as d,lb as _e,mb as ve,nd as Ne,ob as V,od as dt,pb as be,pc as G,pd as Ve,qb as Ce,r as S,ra as se,rb as Se,rc as st,rd as jt,s as P,sb as a,sd as mt,ta as z,tb as s,ua as f,ub as C,ud as Be,v as Y,va as _,vb as B,vc as Te,wb as H,wc as F,wd as zt,y as te,yb as M}from"./chunk-AXAGG6HT.js";var Ui=()=>[5,10,20,50];function Gi(r,i){r&1&&(a(0,"div",23),C(1,"mat-progress-spinner",24),s())}function Wi(r,i){r&1&&(a(0,"th",25),c(1,"N\xB0"),s())}function Ki(r,i){if(r&1&&(a(0,"td",26),c(1),s()),r&2){let t=i.$implicit;m(),y(t.code||"N/A")}}function Yi(r,i){r&1&&(a(0,"th",27),c(1," Nombre Distrito "),s())}function Qi(r,i){if(r&1&&(a(0,"td",26),c(1),s()),r&2){let t=i.$implicit;m(),y(t.name)}}function Xi(r,i){r&1&&(a(0,"th",28),c(1," Rango Peso (kg) "),s())}function Zi(r,i){if(r&1&&(a(0,"td",26),c(1),s()),r&2){let t=i.$implicit;m(),Oe(" ",t.weight_from," - ",t.weight_to," ")}}function Ji(r,i){r&1&&(a(0,"th",29),c(1," Precio Tarifa "),s())}function to(r,i){if(r&1&&(a(0,"td",30),c(1),U(2,"currency"),s()),r&2){let t=i.$implicit;m(),nt(" ",Me(2,1,t.price,"PEN","S/ ","1.2-2")," ")}}function eo(r,i){r&1&&(a(0,"th",31),c(1," Est\xE1ndar "),s())}function io(r,i){if(r&1&&(a(0,"td",32),C(1,"mat-checkbox",33),s()),r&2){let t=i.$implicit;m(),p("checked",t.isStandard)}}function oo(r,i){r&1&&(a(0,"th",34),c(1," Acciones "),s())}function ro(r,i){if(r&1){let t=M();a(0,"td",35)(1,"button",36),g("click",function(){let o=f(t).$implicit,n=v();return _(n.onEdit(o))}),a(2,"mat-icon"),c(3,"edit"),s()(),a(4,"button",37),g("click",function(){let o=f(t).$implicit,n=v();return _(n.onDelete(o))}),a(5,"mat-icon"),c(6,"delete_outline"),s()()()}}function no(r,i){r&1&&C(0,"tr",38)}function ao(r,i){r&1&&C(0,"tr",39)}function so(r,i){if(r&1&&(a(0,"tr",40)(1,"td",41),c(2," No se encontraron distritos que coincidan con la b\xFAsqueda. "),s()()),r&2){let t=v();m(),Q("colspan",t.displayedColumns.length)}}var xt=class r{districts=[];isLoading=!1;totalCount=0;pageSize=10;pageIndex=0;pageChanged=new b;sortChanged=new b;editDistrict=new b;deleteDistrict=new b;displayedColumns=["code","name","weight_range","price","isStandard","actions"];dataSource=new Ti;paginator;sort;ngOnChanges(i){i.districts&&this.districts&&(this.dataSource.data=this.districts)}ngAfterViewInit(){this.sort&&this.sort.sortChange.subscribe(i=>{this.paginator&&(this.paginator.pageIndex=0),this.sortChanged.emit(i)})}onEdit(i){this.editDistrict.emit(i)}onDelete(i){this.deleteDistrict.emit(i)}handlePageEvent(i){this.pageChanged.emit(i)}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=O({type:r,selectors:[["app-district-table"]],viewQuery:function(t,e){if(t&1&&(q(Pt,5),q(At,5)),t&2){let o;A(o=x())&&(e.paginator=o.first),A(o=x())&&(e.sort=o.first)}},inputs:{districts:"districts",isLoading:"isLoading",totalCount:"totalCount",pageSize:"pageSize",pageIndex:"pageIndex"},outputs:{pageChanged:"pageChanged",sortChanged:"sortChanged",editDistrict:"editDistrict",deleteDistrict:"deleteDistrict"},features:[z],decls:25,vars:10,consts:[[1,"table-container","mat-elevation-z4"],["class","spinner-overlay",4,"ngIf"],["mat-table","","matSort","","aria-label","Lista de Distritos y Tarifas",1,"districts-table",3,"matSortChange","dataSource"],["matColumnDef","code"],["mat-header-cell","","mat-sort-header","code",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","name",4,"matHeaderCellDef"],["matColumnDef","weight_range"],["mat-header-cell","","mat-sort-header","weight_from",4,"matHeaderCellDef"],["matColumnDef","price"],["mat-header-cell","","mat-sort-header","price","class","align-right",4,"matHeaderCellDef"],["mat-cell","","class","align-right amount-cell",4,"matCellDef"],["matColumnDef","isStandard"],["mat-header-cell","","mat-sort-header","isStandard","class","align-center",4,"matHeaderCellDef"],["mat-cell","","class","align-center",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","actions-column-header",4,"matHeaderCellDef"],["mat-cell","","class","actions-cell",4,"matCellDef"],["mat-header-row","","class","header-row-sticky",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","data-row",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","","aria-label","Seleccione p\xE1gina de distritos",3,"page","length","pageSize","pageIndex","pageSizeOptions"],[1,"spinner-overlay"],["mode","indeterminate","diameter","50"],["mat-header-cell","","mat-sort-header","code"],["mat-cell",""],["mat-header-cell","","mat-sort-header","name"],["mat-header-cell","","mat-sort-header","weight_from"],["mat-header-cell","","mat-sort-header","price",1,"align-right"],["mat-cell","",1,"align-right","amount-cell"],["mat-header-cell","","mat-sort-header","isStandard",1,"align-center"],["mat-cell","",1,"align-center"],["disabled","true","color","primary",3,"checked"],["mat-header-cell","",1,"actions-column-header"],["mat-cell","",1,"actions-cell"],["mat-icon-button","","color","primary","matTooltip","Editar Distrito/Tarifa",3,"click"],["mat-icon-button","","color","warn","matTooltip","Eliminar Distrito/Tarifa",3,"click"],["mat-header-row","",1,"header-row-sticky"],["mat-row","",1,"data-row"],[1,"mat-row"],[1,"no-data-cell"]],template:function(t,e){t&1&&(a(0,"div",0),h(1,Gi,2,0,"div",1),a(2,"table",2),g("matSortChange",function(n){return e.sortChanged.emit(n)}),B(3,3),h(4,Wi,2,0,"th",4)(5,Ki,2,1,"td",5),H(),B(6,6),h(7,Yi,2,0,"th",7)(8,Qi,2,1,"td",5),H(),B(9,8),h(10,Xi,2,0,"th",9)(11,Zi,2,2,"td",5),H(),B(12,10),h(13,Ji,2,0,"th",11)(14,to,3,6,"td",12),H(),B(15,13),h(16,eo,2,0,"th",14)(17,io,2,1,"td",15),H(),B(18,16),h(19,oo,2,0,"th",17)(20,ro,7,0,"td",18),H(),h(21,no,1,0,"tr",19)(22,ao,1,0,"tr",20)(23,so,3,1,"tr",21),s(),a(24,"mat-paginator",22),g("page",function(n){return e.handlePageEvent(n)}),s()()),t&2&&(m(),p("ngIf",e.isLoading),m(),p("dataSource",e.dataSource),m(19),p("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),m(),p("matRowDefColumns",e.displayedColumns),m(2),p("length",e.totalCount)("pageSize",e.pageSize)("pageIndex",e.pageIndex)("pageSizeOptions",De(9,Ui)))},dependencies:[F,G,Te,Mi,gi,_i,Si,vi,fi,yi,bi,Ci,wi,Oi,Di,Ii,Pt,Li,At,ki,ft,gt,I,W,k,K,pi,mi,Ot,wt],styles:["[_nghost-%COMP%]{display:block}.table-container[_ngcontent-%COMP%]{position:relative;overflow:auto;border-radius:10px;background-color:#fff;margin-top:20px;box-shadow:0 3px 15px #00000012;transition:box-shadow .3s ease}.table-container[_ngcontent-%COMP%]:hover{box-shadow:0 5px 20px #0000001a}.spinner-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background-color:#fffc;display:flex;justify-content:center;align-items:center;z-index:100;border-radius:10px}.districts-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th.mat-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#37474f;background-color:#f8f9fa;padding:12px 16px;border-bottom:1px solid #dee2e6;font-size:.85rem;letter-spacing:.5px}td.mat-cell[_ngcontent-%COMP%]{padding:10px 16px;border-bottom:1px solid #f1f3f5;color:#495057;font-size:.9rem}.header-row-sticky[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10;background-color:#f8f9fa}.data-row[_ngcontent-%COMP%]{transition:background-color .2s ease}.data-row[_ngcontent-%COMP%]:hover{background-color:#eef2f7}.align-right[_ngcontent-%COMP%]{text-align:right;justify-content:flex-end}.align-center[_ngcontent-%COMP%]{text-align:center;justify-content:center}.amount-cell[_ngcontent-%COMP%]{font-weight:500}.actions-column-header[_ngcontent-%COMP%]{text-align:center!important;width:120px}.actions-cell[_ngcontent-%COMP%]{text-align:center;white-space:nowrap}.actions-cell[_ngcontent-%COMP%]   button.mat-icon-button[_ngcontent-%COMP%]{margin:0 3px}.no-data-cell[_ngcontent-%COMP%]{text-align:center;padding:40px;font-style:italic;color:#6c757d;font-size:1rem}.mat-mdc-paginator[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom-left-radius:10px;border-bottom-right-radius:10px;color:#495057;border-top:1px solid #dee2e6}"]})};var L=class r{apiUrl=xe.apiUrl+"/districts";http=d(Pe);authService=d(Fe);districtNamesSubject=new Jt([]);districtNames$=this.districtNamesSubject.asObservable();loadedDistrictNames=!1;constructor(){this.loadDistrictNamesForAutocomplete().subscribe()}getAuthHeaders(){let i=this.authService.getAccessToken();return i?new $t({"Content-Type":"application/json",codrr_token:i}):new $t({"Content-Type":"application/json"})}getDistricts(i=1,t=10,e="name",o="asc",n){let l=this.getAuthHeaders();if(!this.authService.getAccessToken())return P(()=>new Error("Not authenticated to fetch users."));let u=new Ee().set("page_number",parseInt(i.toString())||1).set("page_size",t.toString()).set("sort_field",e).set("sort_directionr",o);return n&&(u=u.set("search",n)),this.http.get(this.apiUrl,{params:u,headers:l}).pipe(w(R=>console.log("Fetched districts:",R)),D(this.handleError))}getDistrictById(i){let t=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.get(`${this.apiUrl}/${i}`,{headers:t}).pipe(w(e=>{console.log("SERVICE: HTTP GET successful, received district:",e)}),ot(300),D(e=>(console.error("SERVICE: HTTP GET failed:",e),this.handleError(e)))):P(()=>new Error("Not authenticated to fetch users."))}createDistrict(i){let t=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.post(this.apiUrl+"/register",i,{headers:t}).pipe(w(e=>{console.log("Created district:",e),this.addDistrictNameToAutocomplete(e.name)}),D(this.handleError)):P(()=>new Error("Not authenticated to fetch users."))}updateDistrict(i,t){let R=t,{id:e,createdAt:o,updatedAt:n}=R,l=Zt(R,["id","createdAt","updatedAt"]),u=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.put(`${this.apiUrl}/edit/${i}`,l,{headers:u}).pipe(w(Qt=>{console.log("Updated district:",Qt),this.addDistrictNameToAutocomplete(Qt.name)}),D(this.handleError)):P(()=>new Error("Not authenticated to fetch users."))}deleteDistrict(i){let t=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.delete(`${this.apiUrl}/delete/${i}`,{headers:t}).pipe(w(()=>console.log(`Deleted district with id: ${i}`)),D(this.handleError)):P(()=>new Error("Not authenticated to fetch users."))}loadDistrictNamesForAutocomplete(){if(this.loadedDistrictNames&&this.districtNamesSubject.value.length>0)return this.districtNames$;let i=this.getAuthHeaders();return this.authService.getAccessToken()?(console.log("DistrictService: Loading district names for autocomplete..."),this.http.get(`${this.apiUrl}?limit=1000`,{headers:i}).pipe(Y(t=>{let e=t?.items.map(n=>n.name),o=[...new Set(e)].sort();return this.districtNamesSubject.next(o),this.loadedDistrictNames=!0,console.log("DistrictService: Loaded unique names:",o),o}),D(t=>(console.error("Error loading district names for autocomplete",t),this.loadedDistrictNames=!1,S([]))))):P(()=>new Error("Not authenticated to fetch users."))}addDistrictNameToAutocomplete(i){let t=this.districtNamesSubject.value;if(i&&!t.includes(i)){let e=[...t,i].sort();this.districtNamesSubject.next(e)}}filterDistrictNames(i){let t=i.toLowerCase();return this.districtNames$.pipe(Y(e=>e.filter(o=>o.toLowerCase().includes(t))))}handleError(i){console.error("API Error:",i);let t="An error occurred. Please try again later.";return i.error instanceof ErrorEvent?t=`Client-side error: ${i.error.message}`:i.status===404?t="The requested resource was not found.":i.status===400&&i.error?.message?Array.isArray(i.error.message)?t=i.error.message.join(", "):t=i.error.message:i.status===500&&(t="A server error occurred. Please contact support."),P(()=>new Error(t))}static \u0275fac=function(t){return new(t||r)};static \u0275prov=ne({token:r,factory:r.\u0275fac,providedIn:"root"})};function po(r,i){if(r&1){let t=M();a(0,"button",12),g("click",function(){f(t);let o=v(),n=X(15);return _(o.clearSearch(n))}),a(1,"mat-icon"),c(2,"close"),s()()}}function uo(r,i){r&1&&(a(0,"mat-icon",13),c(1,"search"),s())}var Ft=class r{districtService=d(L);router=d(lt);snackBar=d(Mt);dialog=d(ui);districts=[];totalDistricts=0;isLoading=!1;destroy$=new E;currentPageIndex=0;currentPageSize=10;currentSortField="name";currentSortDirection="asc";currentSearchTerm="";searchSubject=new E;ngOnInit(){this.loadDistricts(),this.searchSubject.pipe(ee(500),oe(),N(this.destroy$)).subscribe(i=>{this.currentSearchTerm=i,this.currentPageIndex=0,this.loadDistricts()})}loadDistricts(){this.isLoading=!0,this.districtService.getDistricts(this.currentPageIndex,this.currentPageSize,this.currentSortField,this.currentSortDirection,this.currentSearchTerm).pipe(N(this.destroy$)).subscribe({next:i=>{this.districts=i.items,this.totalDistricts=i.total_count,this.isLoading=!1},error:i=>{this.isLoading=!1,this.snackBar.open(`Error cargando distritos: ${i.message||"Intente de nuevo"}`,"Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}})}onSearchTermChange(i){let t=i.target.value;this.searchSubject.next(t)}clearSearch(i){i.value="",this.searchSubject.next("")}onPageChanged(i){this.currentPageIndex=i.pageIndex,this.currentPageSize=i.pageSize,this.loadDistricts()}onSortChanged(i){this.currentSortField=i.active,this.currentSortDirection=i.direction,this.currentPageIndex=0,this.loadDistricts()}navigateToCreate(){this.router.navigate(["/configuracion/districts/create"])}navigateToEdit(i){this.router.navigate(["/configuracion/districts/edit",i.id])}confirmAndDeleteDistrict(i){confirm(`\xBFEst\xE1 seguro de que desea eliminar el distrito/tarifa "${i.name}" (C\xF3digo: ${i.code||i.id})?`)&&this.deleteDistrict(i)}deleteDistrict(i){this.isLoading=!0,this.districtService.deleteDistrict(i.id).pipe(N(this.destroy$)).subscribe({next:()=>{this.snackBar.open(`Distrito "${i.name}" eliminado correctamente.`,"OK",{duration:3e3,panelClass:["success-snackbar"]}),this.currentPageIndex=0,this.loadDistricts()},error:t=>{this.isLoading=!1,this.snackBar.open(`Error al eliminar distrito: ${t.message||"Intente de nuevo"}`,"Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=O({type:r,selectors:[["app-district-list-page"]],decls:19,vars:7,consts:[["searchInput",""],["fxLayout","column","fxLayoutGap","24px",1,"page-container"],["fxLayout","row","fxLayoutAlign","space-between center",1,"page-header"],[1,"page-title"],["mat-flat-button","","color","primary",1,"create-button",3,"click"],["appearance","outlined",1,"filter-card"],["fxLayout","row","fxLayoutAlign","start center"],["appearance","outline","fxFlex","",1,"search-field"],["matInput","","placeholder","Ej: Carabayllo, Lince, 101...",3,"keyup"],["mat-icon-button","","matSuffix","","aria-label","Limpiar b\xFAsqueda",3,"click",4,"ngIf"],["matSuffix","",4,"ngIf"],[3,"pageChanged","sortChanged","editDistrict","deleteDistrict","districts","isLoading","totalCount","pageSize","pageIndex"],["mat-icon-button","","matSuffix","","aria-label","Limpiar b\xFAsqueda",3,"click"],["matSuffix",""]],template:function(t,e){if(t&1){let o=M();a(0,"div",1)(1,"div",2)(2,"h1",3),c(3,"Gesti\xF3n de Distritos y Tarifas"),s(),a(4,"button",4),g("click",function(){return f(o),_(e.navigateToCreate())}),a(5,"mat-icon"),c(6,"add_circle_outline"),s(),a(7,"span"),c(8,"Nuevo Distrito/Tarifa"),s()()(),a(9,"mat-card",5)(10,"mat-card-content",6)(11,"mat-form-field",7)(12,"mat-label"),c(13,"Buscar por nombre o c\xF3digo"),s(),a(14,"input",8,0),g("keyup",function(l){return f(o),_(e.onSearchTermChange(l))}),s(),h(16,po,3,0,"button",9)(17,uo,2,0,"mat-icon",10),s()()(),a(18,"app-district-table",11),g("pageChanged",function(l){return f(o),_(e.onPageChanged(l))})("sortChanged",function(l){return f(o),_(e.onSortChanged(l))})("editDistrict",function(l){return f(o),_(e.navigateToEdit(l))})("deleteDistrict",function(l){return f(o),_(e.confirmAndDeleteDistrict(l))}),s()()}if(t&2){let o=X(15);m(16),p("ngIf",o.value),m(),p("ngIf",!o.value),m(),p("districts",e.districts)("isLoading",e.isLoading)("totalCount",e.totalDistricts)("pageSize",e.currentPageSize)("pageIndex",e.currentPageIndex)}},dependencies:[F,G,ct,xt,I,yt,W,k,K,Tt,hi,bt,vt,_t,oi,St,Ct,ht,pt,ut],styles:["[_nghost-%COMP%]{display:block}.page-container[_ngcontent-%COMP%]{padding:28px 32px;background-color:var(--sys-background, #f4f6f8);color:var(--sys-on-background, #2c3e50);min-height:calc(100vh - 64px);box-sizing:border-box}.page-header[_ngcontent-%COMP%]{margin-bottom:28px;padding-bottom:20px;border-bottom:1px solid var(--sys-outline-variant, #e0e0e6)}.page-header[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{margin:0;font-size:2em;font-weight:600;color:var(--sys-primary, #303f9f);letter-spacing:-.5px}.page-header[_ngcontent-%COMP%]   .create-button[_ngcontent-%COMP%]{font-weight:500}.page-header[_ngcontent-%COMP%]   .create-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.filter-card[_ngcontent-%COMP%]{margin-bottom:28px;background-color:var(--sys-surface-container-low, #ffffff);border:1px solid var(--sys-outline-variant, transparent);border-radius:8px}.filter-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:16px 20px!important}.search-field[_ngcontent-%COMP%]{width:100%}"]})};var _o=["panel"],vo=["*"];function bo(r,i){if(r&1&&(a(0,"div",1,0),we(2),s()),r&2){let t=i.id,e=v();ve(e._classList),_e("mat-mdc-autocomplete-visible",e.showPanel)("mat-mdc-autocomplete-hidden",!e.showPanel)("mat-autocomplete-panel-animations-enabled",!e._animationsDisabled)("mat-primary",e._color==="primary")("mat-accent",e._color==="accent")("mat-warn",e._color==="warn"),p("id",e.id),Q("aria-label",e.ariaLabel||null)("aria-labelledby",e._getPanelAriaLabelledby(t))}}var Kt=class{source;option;constructor(i,t){this.source=i,this.option=t}},Bi=new Rt("mat-autocomplete-default-options",{providedIn:"root",factory:Co});function Co(){return{autoActiveFirstOption:!1,autoSelectActiveOption:!1,hideSingleSelectionIndicator:!1,requireSelection:!1,hasBackdrop:!1}}var Hi=(()=>{class r{_changeDetectorRef=d(Ht);_elementRef=d(Nt);_defaults=d(Bi);_animationsDisabled=d(ce,{optional:!0})==="NoopAnimations";_activeOptionChanges=et.EMPTY;_keyManager;showPanel=!1;get isOpen(){return this._isOpen&&this.showPanel}_isOpen=!1;_latestOpeningTrigger;_setColor(t){this._color=t,this._changeDetectorRef.markForCheck()}_color;template;panel;options;optionGroups;ariaLabel;ariaLabelledby;displayWith=null;autoActiveFirstOption;autoSelectActiveOption;requireSelection;panelWidth;disableRipple;optionSelected=new b;opened=new b;closed=new b;optionActivated=new b;set classList(t){this._classList=t,this._elementRef.nativeElement.className=""}_classList;get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(t){this._hideSingleSelectionIndicator=t,this._syncParentProperties()}_hideSingleSelectionIndicator;_syncParentProperties(){if(this.options)for(let t of this.options)t._changeDetectorRef.markForCheck()}id=d(Ne).getId("mat-autocomplete-");inertGroups;constructor(){let t=d(Le);this.inertGroups=t?.SAFARI||!1,this.autoActiveFirstOption=!!this._defaults.autoActiveFirstOption,this.autoSelectActiveOption=!!this._defaults.autoSelectActiveOption,this.requireSelection=!!this._defaults.requireSelection,this._hideSingleSelectionIndicator=this._defaults.hideSingleSelectionIndicator??!1}ngAfterContentInit(){this._keyManager=new Ve(this.options).withWrap().skipPredicate(this._skipPredicate),this._activeOptionChanges=this._keyManager.change.subscribe(t=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[t]||null})}),this._setVisibility()}ngOnDestroy(){this._keyManager?.destroy(),this._activeOptionChanges.unsubscribe()}_setScrollTop(t){this.panel&&(this.panel.nativeElement.scrollTop=t)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options?.length,this._changeDetectorRef.markForCheck()}_emitSelectEvent(t){let e=new Kt(this,t);this.optionSelected.emit(e)}_getPanelAriaLabelledby(t){if(this.ariaLabel)return null;let e=t?t+" ":"";return this.ariaLabelledby?e+this.ariaLabelledby:t}_skipPredicate(){return!1}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=O({type:r,selectors:[["mat-autocomplete"]],contentQueries:function(e,o,n){if(e&1&&(Vt(n,Et,5),Vt(n,Pi,5)),e&2){let l;A(l=x())&&(o.options=l),A(l=x())&&(o.optionGroups=l)}},viewQuery:function(e,o){if(e&1&&(q(me,7),q(_o,5)),e&2){let n;A(n=x())&&(o.template=n.first),A(n=x())&&(o.panel=n.first)}},hostAttrs:[1,"mat-mdc-autocomplete"],inputs:{ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:[2,"autoActiveFirstOption","autoActiveFirstOption",$],autoSelectActiveOption:[2,"autoSelectActiveOption","autoSelectActiveOption",$],requireSelection:[2,"requireSelection","requireSelection",$],panelWidth:"panelWidth",disableRipple:[2,"disableRipple","disableRipple",$],classList:[0,"class","classList"],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",$]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},exportAs:["matAutocomplete"],features:[Bt([{provide:Ei,useExisting:r}])],ngContentSelectors:vo,decls:1,vars:0,consts:[["panel",""],["role","listbox",1,"mat-mdc-autocomplete-panel","mdc-menu-surface","mdc-menu-surface--open",3,"id"]],template:function(e,o){e&1&&(ye(),h(0,bo,3,17,"ng-template"))},styles:[`div.mat-mdc-autocomplete-panel{width:100%;max-height:256px;visibility:hidden;transform-origin:center top;overflow:auto;padding:8px 0;box-sizing:border-box;position:relative;border-radius:var(--mat-autocomplete-container-shape, var(--mat-sys-corner-extra-small));box-shadow:var(--mat-autocomplete-container-elevation-shadow, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12));background-color:var(--mat-autocomplete-background-color, var(--mat-sys-surface-container))}@media(forced-colors: active){div.mat-mdc-autocomplete-panel{outline:solid 1px}}.cdk-overlay-pane:not(.mat-mdc-autocomplete-panel-above) div.mat-mdc-autocomplete-panel{border-top-left-radius:0;border-top-right-radius:0}.mat-mdc-autocomplete-panel-above div.mat-mdc-autocomplete-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:center bottom}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-visible{visibility:visible}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-hidden{visibility:hidden;pointer-events:none}@keyframes _mat-autocomplete-enter{from{opacity:0;transform:scaleY(0.8)}to{opacity:1;transform:none}}.mat-autocomplete-panel-animations-enabled{animation:_mat-autocomplete-enter 120ms cubic-bezier(0, 0, 0.2, 1)}mat-autocomplete{display:none}
`],encapsulation:2,changeDetection:0})}return r})();var So={provide:ze,useExisting:re(()=>Yt),multi:!0};var $i=new Rt("mat-autocomplete-scroll-strategy",{providedIn:"root",factory:()=>{let r=d(Dt);return()=>r.scrollStrategies.reposition()}});function yo(r){return()=>r.scrollStrategies.reposition()}var wo={provide:$i,deps:[Dt],useFactory:yo},Yt=(()=>{class r{_environmentInjector=d(se);_element=d(Nt);_overlay=d(Dt);_viewContainerRef=d(he);_zone=d(le);_changeDetectorRef=d(Ht);_dir=d(Be,{optional:!0});_formField=d(ri,{optional:!0,host:!0});_viewportRuler=d(si);_scrollStrategy=d($i);_renderer=d(pe);_defaults=d(Bi,{optional:!0});_overlayRef;_portal;_componentDestroyed=!1;_initialized=new E;_keydownSubscription;_outsideClickSubscription;_cleanupWindowBlur;_previousValue;_valueOnAttach;_valueOnLastKeydown;_positionStrategy;_manuallyFloatingLabel=!1;_closingActionsSubscription;_viewportSubscription=et.EMPTY;_breakpointObserver=d(Re);_handsetLandscapeSubscription=et.EMPTY;_canOpenOnNextFocus=!0;_valueBeforeAutoSelection;_pendingAutoselectedOption;_closeKeyEventStream=new E;_windowBlurHandler=()=>{this._canOpenOnNextFocus=this.panelOpen||!this._hasFocus()};_onChange=()=>{};_onTouched=()=>{};autocomplete;position="auto";connectedTo;autocompleteAttribute="off";autocompleteDisabled;constructor(){}_aboveClass="mat-mdc-autocomplete-panel-above";ngAfterViewInit(){this._initialized.next(),this._initialized.complete(),this._cleanupWindowBlur=this._renderer.listen("window","blur",this._windowBlurHandler)}ngOnChanges(t){t.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){this._cleanupWindowBlur?.(),this._handsetLandscapeSubscription.unsubscribe(),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete(),this._clearFromModal()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}_overlayAttached=!1;openPanel(){this._openPanelInternal()}closePanel(){this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this._zone.run(()=>{this.autocomplete.closed.emit()}),this.autocomplete._latestOpeningTrigger===this&&(this.autocomplete._isOpen=!1,this.autocomplete._latestOpeningTrigger=null),this._overlayAttached=!1,this._pendingAutoselectedOption=null,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._updatePanelState(),this._componentDestroyed||this._changeDetectorRef.detectChanges(),this._trackedModal&&mt(this._trackedModal,"aria-owns",this.autocomplete.id))}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return it(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe(Lt(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe(Lt(()=>this._overlayAttached)):S()).pipe(Y(t=>t instanceof Ai?t:null))}optionSelections=te(()=>{let t=this.autocomplete?this.autocomplete.options:null;return t?t.changes.pipe(rt(t),j(()=>it(...t.map(e=>e.onSelectionChange)))):this._initialized.pipe(j(()=>this.optionSelections))});get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return new kt(t=>{let e=n=>{let l=ke(n),u=this._formField?this._formField.getConnectedOverlayOrigin().nativeElement:null,R=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;this._overlayAttached&&l!==this._element.nativeElement&&!this._hasFocus()&&(!u||!u.contains(l))&&(!R||!R.contains(l))&&this._overlayRef&&!this._overlayRef.overlayElement.contains(l)&&t.next(n)},o=[this._renderer.listen("document","click",e),this._renderer.listen("document","auxclick",e),this._renderer.listen("document","touchend",e)];return()=>{o.forEach(n=>n())}})}writeValue(t){Promise.resolve(null).then(()=>this._assignOptionValue(t))}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this._element.nativeElement.disabled=t}_handleKeydown(t){let e=t.keyCode,o=dt(t);if(e===27&&!o&&t.preventDefault(),this._valueOnLastKeydown=this._element.nativeElement.value,this.activeOption&&e===13&&this.panelOpen&&!o)this.activeOption._selectViaInteraction(),this._resetActiveItem(),t.preventDefault();else if(this.autocomplete){let n=this.autocomplete._keyManager.activeItem,l=e===38||e===40;e===9||l&&!o&&this.panelOpen?this.autocomplete._keyManager.onKeydown(t):l&&this._canOpen()&&this._openPanelInternal(this._valueOnLastKeydown),(l||this.autocomplete._keyManager.activeItem!==n)&&(this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0),this.autocomplete.autoSelectActiveOption&&this.activeOption&&(this._pendingAutoselectedOption||(this._valueBeforeAutoSelection=this._valueOnLastKeydown),this._pendingAutoselectedOption=this.activeOption,this._assignOptionValue(this.activeOption.value)))}}_handleInput(t){let e=t.target,o=e.value;if(e.type==="number"&&(o=o==""?null:parseFloat(o)),this._previousValue!==o){if(this._previousValue=o,this._pendingAutoselectedOption=null,(!this.autocomplete||!this.autocomplete.requireSelection)&&this._onChange(o),!o)this._clearPreviousSelectedOption(null,!1);else if(this.panelOpen&&!this.autocomplete.requireSelection){let n=this.autocomplete.options?.find(l=>l.selected);if(n){let l=this._getDisplayValue(n.value);o!==l&&n.deselect(!1)}}if(this._canOpen()&&this._hasFocus()){let n=this._valueOnLastKeydown??this._element.nativeElement.value;this._valueOnLastKeydown=null,this._openPanelInternal(n)}}}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(this._previousValue),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_handleClick(){this._canOpen()&&!this.panelOpen&&this._openPanelInternal()}_hasFocus(){return Ie()===this._element.nativeElement}_floatLabel(t=!1){this._formField&&this._formField.floatLabel==="auto"&&(t?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField&&(this._formField.floatLabel="auto"),this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){let t=new kt(o=>{de(()=>{o.next()},{injector:this._environmentInjector})}),e=this.autocomplete.options?.changes.pipe(w(()=>this._positionStrategy.reapplyLastPosition()),ot(0))??S();return it(t,e).pipe(j(()=>this._zone.run(()=>{let o=this.panelOpen;return this._resetActiveItem(),this._updatePanelState(),this._changeDetectorRef.detectChanges(),this.panelOpen&&this._overlayRef.updatePosition(),o!==this.panelOpen&&(this.panelOpen?this._emitOpened():this.autocomplete.closed.emit()),this.panelClosingActions})),ie(1)).subscribe(o=>this._setValueAndClose(o))}_emitOpened(){this.autocomplete.opened.emit()}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_getDisplayValue(t){let e=this.autocomplete;return e&&e.displayWith?e.displayWith(t):t}_assignOptionValue(t){let e=this._getDisplayValue(t);t==null&&this._clearPreviousSelectedOption(null,!1),this._updateNativeInputValue(e??"")}_updateNativeInputValue(t){this._formField?this._formField._control.value=t:this._element.nativeElement.value=t,this._previousValue=t}_setValueAndClose(t){let e=this.autocomplete,o=t?t.source:this._pendingAutoselectedOption;o?(this._clearPreviousSelectedOption(o),this._assignOptionValue(o.value),this._onChange(o.value),e._emitSelectEvent(o),this._element.nativeElement.focus()):e.requireSelection&&this._element.nativeElement.value!==this._valueOnAttach&&(this._clearPreviousSelectedOption(null),this._assignOptionValue(null),this._onChange(null)),this.closePanel()}_clearPreviousSelectedOption(t,e){this.autocomplete?.options?.forEach(o=>{o!==t&&o.selected&&o.deselect(e)})}_openPanelInternal(t=this._element.nativeElement.value){if(this._attachOverlay(t),this._floatLabel(),this._trackedModal){let e=this.autocomplete.id;jt(this._trackedModal,"aria-owns",e)}}_attachOverlay(t){this.autocomplete;let e=this._overlayRef;e?(this._positionStrategy.setOrigin(this._getConnectedElement()),e.updateSize({width:this._getPanelWidth()})):(this._portal=new ni(this.autocomplete.template,this._viewContainerRef,{id:this._formField?.getLabelId()}),e=this._overlay.create(this._getOverlayConfig()),this._overlayRef=e,this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&e&&e.updateSize({width:this._getPanelWidth()})}),this._handsetLandscapeSubscription=this._breakpointObserver.observe(ai.HandsetLandscape).subscribe(n=>{n.matches?this._positionStrategy.withFlexibleDimensions(!0).withGrowAfterOpen(!0).withViewportMargin(8):this._positionStrategy.withFlexibleDimensions(!1).withGrowAfterOpen(!1).withViewportMargin(0)})),e&&!e.hasAttached()&&(e.attach(this._portal),this._valueOnAttach=t,this._valueOnLastKeydown=null,this._closingActionsSubscription=this._subscribeToClosingActions());let o=this.panelOpen;this.autocomplete._isOpen=this._overlayAttached=!0,this.autocomplete._latestOpeningTrigger=this,this.autocomplete._setColor(this._formField?.color),this._updatePanelState(),this._applyModalPanelOwnership(),this.panelOpen&&o!==this.panelOpen&&this._emitOpened()}_handlePanelKeydown=t=>{(t.keyCode===27&&!dt(t)||t.keyCode===38&&dt(t,"altKey"))&&(this._pendingAutoselectedOption&&(this._updateNativeInputValue(this._valueBeforeAutoSelection??""),this._pendingAutoselectedOption=null),this._closeKeyEventStream.next(),this._resetActiveItem(),t.stopPropagation(),t.preventDefault())};_updatePanelState(){if(this.autocomplete._setVisibility(),this.panelOpen){let t=this._overlayRef;this._keydownSubscription||(this._keydownSubscription=t.keydownEvents().subscribe(this._handlePanelKeydown)),this._outsideClickSubscription||(this._outsideClickSubscription=t.outsidePointerEvents().subscribe())}else this._keydownSubscription?.unsubscribe(),this._outsideClickSubscription?.unsubscribe(),this._keydownSubscription=this._outsideClickSubscription=null}_getOverlayConfig(){return new ci({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir??void 0,hasBackdrop:this._defaults?.hasBackdrop,backdropClass:this._defaults?.backdropClass,panelClass:this._defaults?.overlayPanelClass})}_getOverlayPosition(){let t=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(t),this._positionStrategy=t,t}_setStrategyPositions(t){let e=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],o=this._aboveClass,n=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:o},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:o}],l;this.position==="above"?l=n:this.position==="below"?l=e:l=[...e,...n],t.withPositions(l)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){let t=this.autocomplete;if(t.autoActiveFirstOption){let e=-1;for(let o=0;o<t.options.length;o++)if(!t.options.get(o).disabled){e=o;break}t._keyManager.setActiveItem(e)}else t._keyManager.setActiveItem(-1)}_canOpen(){let t=this._element.nativeElement;return!t.readOnly&&!t.disabled&&!this.autocompleteDisabled}_scrollToOption(t){let e=this.autocomplete,o=xi(t,e.options,e.optionGroups);if(t===0&&o===1)e._setScrollTop(0);else if(e.panel){let n=e.options.toArray()[t];if(n){let l=n._getHostElement(),u=Fi(l.offsetTop,l.offsetHeight,e._getScrollTop(),e.panel.nativeElement.offsetHeight);e._setScrollTop(u)}}}_trackedModal=null;_applyModalPanelOwnership(){let t=this._element.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!t)return;let e=this.autocomplete.id;this._trackedModal&&mt(this._trackedModal,"aria-owns",e),jt(t,"aria-owns",e),this._trackedModal=t}_clearFromModal(){if(this._trackedModal){let t=this.autocomplete.id;mt(this._trackedModal,"aria-owns",t),this._trackedModal=null}}static \u0275fac=function(e){return new(e||r)};static \u0275dir=fe({type:r,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-mdc-autocomplete-trigger"],hostVars:7,hostBindings:function(e,o){e&1&&g("focusin",function(){return o._handleFocus()})("blur",function(){return o._onTouched()})("input",function(l){return o._handleInput(l)})("keydown",function(l){return o._handleKeydown(l)})("click",function(){return o._handleClick()}),e&2&&Q("autocomplete",o.autocompleteAttribute)("role",o.autocompleteDisabled?null:"combobox")("aria-autocomplete",o.autocompleteDisabled?null:"list")("aria-activedescendant",o.panelOpen&&o.activeOption?o.activeOption.id:null)("aria-expanded",o.autocompleteDisabled?null:o.panelOpen.toString())("aria-controls",o.autocompleteDisabled||!o.panelOpen||o.autocomplete==null?null:o.autocomplete.id)("aria-haspopup",o.autocompleteDisabled?null:"listbox")},inputs:{autocomplete:[0,"matAutocomplete","autocomplete"],position:[0,"matAutocompletePosition","position"],connectedTo:[0,"matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:[0,"autocomplete","autocompleteAttribute"],autocompleteDisabled:[2,"matAutocompleteDisabled","autocompleteDisabled",$]},exportAs:["matAutocompleteTrigger"],features:[Bt([So]),z]})}return r})(),ji=(()=>{class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=ge({type:r});static \u0275inj=ae({providers:[wo],imports:[di,qt,zt,li,qt,zt]})}return r})();function Do(r,i){if(r&1&&(a(0,"mat-option",7),c(1),s()),r&2){let t=i.$implicit;p("value",t),m(),y(t)}}function Mo(r,i){r&1&&(a(0,"mat-error"),c(1,"El nombre del distrito es obligatorio."),s())}function To(r,i){r&1&&(a(0,"mat-error"),c(1,"Peso Desde es obligatorio."),s())}function Eo(r,i){r&1&&(a(0,"mat-error"),c(1,"Debe ser mayor o igual a 0."),s())}function Po(r,i){if(r&1&&(a(0,"mat-error"),c(1),s()),r&2){let t=v();m(),y(t.weightFromCtrl==null||t.weightFromCtrl.errors==null?null:t.weightFromCtrl.errors.weightOrder)}}function Ao(r,i){if(r&1&&(a(0,"mat-error"),c(1),s()),r&2){let t=v();m(),y(t.weightFromCtrl==null||t.weightFromCtrl.errors==null?null:t.weightFromCtrl.errors.weightOrder)}}function xo(r,i){if(r&1&&(a(0,"mat-error"),c(1),s()),r&2){let t=v();m(),y(t.weightToCtrl==null||t.weightToCtrl.errors==null?null:t.weightToCtrl.errors.weightOrder)}}var It=class r{constructor(i){this.fb=i}districtToEdit=null;isLoading=!1;formSubmit=new b;formCancel=new b;districtForm;districtService=d(L);filteredDistrictNames$=S([]);ngOnInit(){this.initForm(),this.setupNameAutocomplete()}ngOnChanges(i){i.districtToEdit&&this.districtToEdit&&this.districtForm?this.districtForm.patchValue({code:this.districtToEdit.code||null,name:this.districtToEdit.name,weight_from:this.districtToEdit.weight_from,weight_to:this.districtToEdit.weight_to,price:this.districtToEdit.price,isStandard:this.districtToEdit.isStandard}):i.districtToEdit&&!this.districtToEdit&&this.districtForm&&this.districtForm.reset({isStandard:!1})}initForm(){this.districtForm=this.fb.group({code:[null],name:["",T.required],weight_from:[0,[T.required,T.min(0),this.weightRangeCrossValidator]],weight_to:[0,[T.required,T.min(0),this.weightRangeCrossValidator]],price:[0,[T.required,T.min(0)]],isStandard:[!1,T.required]}),this.districtToEdit&&this.districtForm.patchValue(this.districtToEdit)}weightRangeCrossValidator=i=>{let t=i.get("weight_from"),e=i.get("weight_to");if(!t||!e||!t.value||!e.value)return null;let o=parseFloat(t.value),n=parseFloat(e.value),l=null;if(t.hasError("weightOrder")){let u=tt({},t.errors);delete u.weightOrder,t.setErrors(Object.keys(u).length>0?u:null,{emitEvent:!1})}if(e.hasError("weightOrder")){let u=tt({},e.errors);delete u.weightOrder,e.setErrors(Object.keys(u).length>0?u:null,{emitEvent:!1})}if(o>n&&n!==0){let u=t.errors||{};t.setErrors(Xt(tt({},u),{weightOrder:"Desde no puede ser mayor que Hasta"})),l={weightRangeInvalid:!0}}return l};setupNameAutocomplete(){this.districtForm.get("name")&&(this.filteredDistrictNames$=this.districtForm.get("name").valueChanges.pipe(rt(""),j(i=>typeof i=="string"&&i.length>0?this.districtService.filterDistrictNames(i):this.districtService.districtNames$)))}onDistrictNameSelected(i){}onSubmit(){if(this.districtForm.valid){let i=this.districtForm.value,t={name:i.name,weight_from:parseFloat(i.weight_from),weight_to:parseFloat(i.weight_to),price:parseFloat(i.price),isStandard:i.isStandard};i.code!==null&&i.code!==void 0&&i.code!==""&&(t.code=parseInt(i.code,10)),this.formSubmit.emit(t)}else this.districtForm.markAllAsTouched()}onCancelClick(){this.formCancel.emit()}get nameCtrl(){return this.districtForm.get("name")}get weightFromCtrl(){return this.districtForm.get("weight_from")}get weightToCtrl(){return this.districtForm.get("weight_to")}get priceCtrl(){return this.districtForm.get("price")}static \u0275fac=function(t){return new(t||r)(ue(Je))};static \u0275cmp=O({type:r,selectors:[["app-district-form"]],inputs:{districtToEdit:"districtToEdit",isLoading:"isLoading"},outputs:{formSubmit:"formSubmit",formCancel:"formCancel"},features:[z],decls:45,vars:13,consts:[["autoDistrictName","matAutocomplete"],["novalidate","",1,"district-form-container",3,"ngSubmit","formGroup"],["appearance","outlined"],[1,"form-row"],["appearance","outline",1,"full-width-field"],["matInput","","formControlName","name","required","","placeholder","Ej: Carabayllo",3,"matAutocomplete"],[3,"optionSelected"],[3,"value"],["appearance","outline",1,"form-field"],["matInput","","formControlName","weight_from","type","number","min","0","step","0.01","required","","placeholder","0.00"],["matInput","","formControlName","weight_to","type","number","min","0","step","0.01","required","","placeholder","0.00"],["matInput","","formControlName","price","type","number","min","0","step","0.01","required","","placeholder","0.00"],["matTextPrefix",""],["formControlName","isStandard","color","primary",1,"standard-checkbox"],["align","end"],["mat-stroked-button","","type","button",3,"click"],["mat-flat-button","","color","primary","type","submit",3,"disabled"]],template:function(t,e){if(t&1){let o=M();a(0,"form",1),g("ngSubmit",function(){return f(o),_(e.onSubmit())}),a(1,"mat-card",2)(2,"mat-card-header")(3,"mat-card-title"),c(4),s()(),a(5,"mat-card-content")(6,"div",3)(7,"mat-form-field",4)(8,"mat-label"),c(9,"Nombre del Distrito"),s(),C(10,"input",5),a(11,"mat-autocomplete",6,0),g("optionSelected",function(l){return f(o),_(e.onDistrictNameSelected(l))}),Ce(13,Do,2,2,"mat-option",7,be),U(15,"async"),s(),h(16,Mo,2,0,"mat-error"),s()(),a(17,"div",3)(18,"mat-form-field",8)(19,"mat-label"),c(20,"Peso Desde (kg)"),s(),C(21,"input",9),h(22,To,2,0,"mat-error")(23,Eo,2,0,"mat-error")(24,Po,2,1,"mat-error"),s(),a(25,"mat-form-field",8)(26,"mat-label"),c(27,"Peso Hasta (kg)"),s(),C(28,"input",10),h(29,Ao,2,1,"mat-error"),s()(),a(30,"mat-form-field",4)(31,"mat-label"),c(32,"Precio Tarifa (S/)"),s(),C(33,"input",11),a(34,"span",12),c(35,"S/\xA0"),s(),h(36,xo,2,1,"mat-error"),s(),a(37,"div",3)(38,"mat-checkbox",13),c(39," \xBFEs tarifa est\xE1ndar para este distrito? "),s()()(),a(40,"mat-card-actions",14)(41,"button",15),g("click",function(){return f(o),_(e.onCancelClick())}),c(42," Cancelar "),s(),a(43,"button",16),c(44),s()()()()}if(t&2){let o=X(12);p("formGroup",e.districtForm),m(4),y(e.districtToEdit?"Editar Distrito/Tarifa":"Crear Nuevo Distrito/Tarifa"),m(6),p("matAutocomplete",o),m(3),Se(at(15,11,e.filteredDistrictNames$)),m(3),V(e.nameCtrl!=null&&e.nameCtrl.hasError("required")&&(e.nameCtrl!=null&&e.nameCtrl.touched||e.nameCtrl!=null&&e.nameCtrl.dirty)?16:-1),m(6),V(e.weightFromCtrl!=null&&e.weightFromCtrl.hasError("required")&&(e.weightFromCtrl!=null&&e.weightFromCtrl.touched||e.weightFromCtrl!=null&&e.weightFromCtrl.dirty)?22:-1),m(),V(e.weightFromCtrl!=null&&e.weightFromCtrl.hasError("min")&&(e.weightFromCtrl!=null&&e.weightFromCtrl.touched||e.weightFromCtrl!=null&&e.weightFromCtrl.dirty)?23:-1),m(),V(e.weightFromCtrl!=null&&e.weightFromCtrl.hasError("weightOrder")&&(e.weightFromCtrl!=null&&e.weightFromCtrl.touched||e.weightFromCtrl!=null&&e.weightFromCtrl.dirty)?24:-1),m(5),V(e.weightFromCtrl!=null&&e.weightFromCtrl.hasError("weightOrder")&&(e.weightFromCtrl!=null&&e.weightFromCtrl.touched||e.weightFromCtrl!=null&&e.weightFromCtrl.dirty)?29:-1),m(7),V(e.weightToCtrl!=null&&e.weightToCtrl.hasError("weightOrder")&&(e.weightToCtrl!=null&&e.weightToCtrl.touched||e.weightToCtrl!=null&&e.weightToCtrl.dirty)?36:-1),m(7),p("disabled",e.isLoading||e.districtForm.invalid),m(),nt(" ",e.isLoading?"Guardando...":e.districtToEdit?"Actualizar":"Crear"," ")}},dependencies:[F,st,ti,We,qe,Ke,Ue,Ge,Ze,Xe,Ye,Qe,bt,vt,_t,ei,ii,St,Ct,I,yt,Ot,wt,ji,Hi,Et,Yt,k,ht,pt,$e,ut,je,He],styles:[".district-form-container[_ngcontent-%COMP%]{padding:10px 0}mat-card[_ngcontent-%COMP%]{border-radius:8px}mat-card-header[_ngcontent-%COMP%]{padding-bottom:16px;margin-bottom:20px}mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:1.4em;font-weight:500}mat-card-content[_ngcontent-%COMP%]{padding-top:0}.form-row[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:0}.form-field[_ngcontent-%COMP%], .full-width-field[_ngcontent-%COMP%]{margin-bottom:16px}.form-field[_ngcontent-%COMP%]{flex:1}.full-width-field[_ngcontent-%COMP%]{width:100%}.standard-checkbox[_ngcontent-%COMP%]{margin-top:8px;margin-bottom:20px}mat-card-actions[_ngcontent-%COMP%]{padding:16px 0 0;margin-top:24px}mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-weight:500}"]})};function Fo(r,i){r&1&&(a(0,"div",5),C(1,"mat-progress-spinner",6),a(2,"p"),c(3,"Cargando datos del distrito..."),s()())}function Io(r,i){if(r&1){let t=M();a(0,"app-district-form",7),U(1,"async"),g("formSubmit",function(o){f(t);let n=v();return _(n.handleSubmit(o))})("formCancel",function(){f(t);let o=v();return _(o.handleCancel())}),s()}if(r&2){let t=v();p("districtToEdit",t.districtId?at(1,2,t.districtToEdit$):null)("isLoading",t.isSaving)}}var J=class r{route=d(Ae);router=d(lt);districtService=d(L);snackBar=d(Mt);districtToEdit$=S(null);isLoading=!1;isSaving=!1;pageTitle="Crear Nuevo Distrito/Tarifa";districtId=null;destroy$=new E;ngOnInit(){this.districtId=this.route.snapshot.paramMap.get("id"),console.log("DistrictFormPage - ngOnInit - districtId from route:",this.districtId),this.districtId?(this.pageTitle="Editar Distrito/Tarifa",this.isLoading=!0,this.districtToEdit$=this.districtService.getDistrictById(this.districtId).pipe(N(this.destroy$),w(i=>{console.log("COMPONENT: Received district data in tap():",i),i||(this.snackBar.open("No se encontraron datos para el distrito.","Cerrar",{duration:5e3,panelClass:["error-snackbar"]}),this.router.navigate(["/configuracion/districts"])),this.isLoading=!1}),D(i=>(this.isLoading=!1,this.snackBar.open(`Error cargando distrito: ${i.message||"Intente de nuevo"}`,"Cerrar",{duration:5e3,panelClass:["error-snackbar"]}),this.router.navigate(["/districts"]),S(null)))),this.districtToEdit$.subscribe({next:i=>console.log("COMPONENT (MANUAL SUB): Data received:",i),error:i=>console.error("COMPONENT (MANUAL SUB): Error received:",i),complete:()=>console.log("COMPONENT (MANUAL SUB): Observable completed.")})):(this.pageTitle="Crear Nuevo Distrito/Tarifa",this.districtToEdit$=S(null),this.isLoading=!1)}handleSubmit(i){this.isSaving=!0;let t;this.districtId?t=this.districtService.updateDistrict(this.districtId,i):t=this.districtService.createDistrict(i),t.pipe(N(this.destroy$)).subscribe({next:e=>{this.isSaving=!1;let o=this.districtId?"actualizado":"creado";this.snackBar.open(`${o} correctamente.`,"OK",{duration:3e3,panelClass:["success-snackbar"]}),this.router.navigate(["/configuracion/districts"])},error:e=>{this.isSaving=!1,this.snackBar.open(`Error al guardar distrito: ${e.message||"Intente de nuevo"}`,"Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}})}handleCancel(){this.router.navigate(["/configuracion/districts"])}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=O({type:r,selectors:[["app-district-form-page"]],decls:9,vars:3,consts:[[1,"page-container","form-page-container"],[1,"page-header"],["mat-icon-button","","matTooltip","Volver a la Lista","aria-label","Volver a la lista de distritos",3,"click"],["class","loading-indicator",4,"ngIf"],[3,"districtToEdit","isLoading","formSubmit","formCancel",4,"ngIf"],[1,"loading-indicator"],["mode","indeterminate","diameter","40"],[3,"formSubmit","formCancel","districtToEdit","isLoading"]],template:function(t,e){t&1&&(a(0,"div",0)(1,"div",1)(2,"button",2),g("click",function(){return e.handleCancel()}),a(3,"mat-icon"),c(4,"arrow_back"),s()(),a(5,"h1"),c(6),s()(),h(7,Fo,4,0,"div",3)(8,Io,2,4,"app-district-form",4),s()),t&2&&(m(6),y(e.pageTitle),m(),p("ngIf",e.isLoading),m(),p("ngIf",!e.isLoading))},dependencies:[F,G,st,ct,It,Tt,ft,gt,k,K,I,W],styles:[".page-container[_ngcontent-%COMP%]{padding:24px;background-color:#f9fafb}.form-page-container[_ngcontent-%COMP%]{max-width:750px;margin:20px auto;background-color:#fff;border-radius:8px;padding:24px 30px}.page-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:24px;padding-bottom:16px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 0 12px;font-size:1.6em;font-weight:500}.loading-indicator[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px}.loading-indicator[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:10px}"]})};var na=[{path:"",component:Ft,title:"Distritos y Tarifas"},{path:"create",component:J,title:"Nuevo Distrito/Tarifa"},{path:"edit/:id",component:J,title:"Editar Distrito/Tarifa"}];export{na as DISTRICTS_ROUTES};
