import{a as xo,b as vo,c as wo,d as yo}from"./chunk-QOA43XBJ.js";import{a as wf,b as yf}from"./chunk-FJPYZE7Q.js";import"./chunk-F5X5MWHG.js";import{b as vf}from"./chunk-QSNR5F4X.js";import{a as Xa,b as ja}from"./chunk-PZCJVKX2.js";import{b as Qa,c as cn}from"./chunk-FBL4ZQT7.js";import{C as ai,D as ii,E as No,F as kf,G as Lo,H as Ef,I as Sf,a as fn,b as Co,c as ko,e as un,f as hn,g as mn,h as ti,i as Eo,j as So,k as Do,l as To,m as Ao,n as Fo,o as Oo,p as Mo,q as Io,r as Po,s as bf,t as Ro,u as Cf,y as ri}from"./chunk-PHEAMHGW.js";import{a as of,b as lf,c as cf}from"./chunk-TOVRHTJN.js";import{a as bo,b as dn,e as _f,f as gf,i as xf}from"./chunk-NJ6D5PLM.js";import{a as Ja,b as ei,c as pf}from"./chunk-CDCWUO36.js";import{a as fa,b as qa,c as Qd,d as Jd,e as mo,g as ef,h as ua,i as ha,j as tf,k as rf,n as ln,o as Za}from"./chunk-MYNWWTJH.js";import{a as Vd,b as Ud,d as Hd,g as Wd,h as Gd}from"./chunk-BGY2FCVT.js";import{a as co,b as nn,c as zd,d as ot,f as da,g as sn,h as Yd,j as rc,k as $d,l as fo,m as uo,n as Xd,o as Ei,p as on,q as jd,r as Kd,s as ho,t as qd,u as Ka}from"./chunk-3KYPZUCO.js";import{a as xr,b as er}from"./chunk-DTY45AJM.js";import{B as uf,E as hf,F as go,I as mf,b as Zd,f as af,g as po,h as Da,i as nf,j as Rt,k as sf,m as dt,n as ac,q as ic,r as df,y as ff,z as _o}from"./chunk-VBCWU2N4.js";import{$ as gt,$a as Ye,$b as Ed,$c as Rd,Aa as Qs,Ab as ye,Ac as ec,Bb as be,Bc as tc,C as dd,Ca as ke,Cb as Ga,Cc as Td,D as wi,Da as ka,Db as za,E as fd,Eb as Ki,Fb as zt,G as oa,Ga as Sr,Gb as yt,H as ud,Hb as bt,I as Zs,Ia as qt,Ic as no,Jc as Ad,Kb as Tr,La as Js,Lb as b,M as jl,Mb as Dt,Nb as Ce,Nc as so,O as Xi,Oa as bi,Ob as Jn,Oc as rn,Pb as Cd,Pc as Fd,Q as hd,Qb as qi,Qc as Od,Ra as vd,Rb as Zi,Rc as Md,Sa as P,Sb as Qi,Sc as oo,Tc as Id,Ua as ql,Ub as ur,Uc as rs,Va as Zn,Vb as Jl,Vc as Jt,Wa as ji,Wb as kd,Wc as Pd,Xa as wd,Xb as Ve,Ya as eo,Yb as Bt,Yc as an,Z as Ha,Zb as It,_ as md,_b as Ya,_c as $a,a as na,ab as Lr,ac as Sd,ad as Nd,b as $i,ba as Wa,bb as Br,bd as Ea,c as od,cb as yd,cc as Zt,cd as lo,db as Zl,ec as Pt,f as Xn,fa as Kn,fb as me,fc as es,g as jt,ga as Er,h as jn,ha as Nr,hc as Dd,ia as Kt,ib as xt,j as Pe,jb as j,k as qs,ka as pd,kb as to,kc as ts,kd as Ld,la as Y,lb as Dr,mb as Ql,md as Bd,n as ld,na as _d,nc as la,nd as Ci,oa as gd,ob as Qn,oc as ca,od as ki,pc as Qt,qb as ro,r as vi,rb as ao,rc as Ji,s as sa,sb as v,sc as en,ta as qr,tb as x,tc as gr,u as cd,ua as De,ub as Ae,uc as io,ud as Sa,v as Ua,va as Te,vb as vt,vc as tn,wa as qn,wb as wt,wc as Tt,wd as Zr,xa as Kl,ya as xd,yb as tt,za as yi,zb as bd}from"./chunk-AXAGG6HT.js";var nc=new Kt("MAT_DATE_LOCALE",{providedIn:"root",factory:Zp});function Zp(){return Y(Sd)}var pn="Method not implemented",tr=class{locale;_localeChanges=new Pe;localeChanges=this._localeChanges;setTime(r,e,a,i){throw new Error(pn)}getHours(r){throw new Error(pn)}getMinutes(r){throw new Error(pn)}getSeconds(r){throw new Error(pn)}parseTime(r,e){throw new Error(pn)}addSeconds(r,e){throw new Error(pn)}getValidDateOrNull(r){return this.isDateInstance(r)&&this.isValid(r)?r:null}deserialize(r){return r==null||this.isDateInstance(r)&&this.isValid(r)?r:this.invalid()}setLocale(r){this.locale=r,this._localeChanges.next()}compareDate(r,e){return this.getYear(r)-this.getYear(e)||this.getMonth(r)-this.getMonth(e)||this.getDate(r)-this.getDate(e)}compareTime(r,e){return this.getHours(r)-this.getHours(e)||this.getMinutes(r)-this.getMinutes(e)||this.getSeconds(r)-this.getSeconds(e)}sameDate(r,e){if(r&&e){let a=this.isValid(r),i=this.isValid(e);return a&&i?!this.compareDate(r,e):a==i}return r==e}sameTime(r,e){if(r&&e){let a=this.isValid(r),i=this.isValid(e);return a&&i?!this.compareTime(r,e):a==i}return r==e}clampDate(r,e,a){return e&&this.compareDate(r,e)<0?e:a&&this.compareDate(r,a)>0?a:r}},ni=new Kt("mat-date-formats");var Jp=["mat-calendar-body",""];function e_(t,r){return this._trackRow(r)}var Pf=(t,r)=>r.id;function t_(t,r){if(t&1&&(v(0,"tr",0)(1,"td",3),b(2),x()()),t&2){let e=be();P(),to("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),xt("colspan",e.numCols),P(),Ce(" ",e.label," ")}}function r_(t,r){if(t&1&&(v(0,"td",3),b(1),x()),t&2){let e=be(2);to("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),xt("colspan",e._firstRowOffset),P(),Ce(" ",e._firstRowOffset>=e.labelMinRequiredCells?e.label:""," ")}}function a_(t,r){if(t&1){let e=tt();v(0,"td",6)(1,"button",7),ye("click",function(i){let n=De(e).$implicit,s=be(2);return Te(s._cellClicked(n,i))})("focus",function(i){let n=De(e).$implicit,s=be(2);return Te(s._emitActiveDateChange(n,i))}),v(2,"span",8),b(3),x(),Ae(4,"span",9),x()()}if(t&2){let e=r.$implicit,a=r.$index,i=be().$index,n=be();to("width",n._cellWidth)("padding-top",n._cellPadding)("padding-bottom",n._cellPadding),xt("data-mat-row",i)("data-mat-col",a),P(),Dr("mat-calendar-body-disabled",!e.enabled)("mat-calendar-body-active",n._isActiveCell(i,a))("mat-calendar-body-range-start",n._isRangeStart(e.compareValue))("mat-calendar-body-range-end",n._isRangeEnd(e.compareValue))("mat-calendar-body-in-range",n._isInRange(e.compareValue))("mat-calendar-body-comparison-bridge-start",n._isComparisonBridgeStart(e.compareValue,i,a))("mat-calendar-body-comparison-bridge-end",n._isComparisonBridgeEnd(e.compareValue,i,a))("mat-calendar-body-comparison-start",n._isComparisonStart(e.compareValue))("mat-calendar-body-comparison-end",n._isComparisonEnd(e.compareValue))("mat-calendar-body-in-comparison-range",n._isInComparisonRange(e.compareValue))("mat-calendar-body-preview-start",n._isPreviewStart(e.compareValue))("mat-calendar-body-preview-end",n._isPreviewEnd(e.compareValue))("mat-calendar-body-in-preview",n._isInPreview(e.compareValue)),j("ngClass",e.cssClasses)("tabindex",n._isActiveCell(i,a)?0:-1),xt("aria-label",e.ariaLabel)("aria-disabled",!e.enabled||null)("aria-pressed",n._isSelected(e.compareValue))("aria-current",n.todayValue===e.compareValue?"date":null)("aria-describedby",n._getDescribedby(e.compareValue)),P(),Dr("mat-calendar-body-selected",n._isSelected(e.compareValue))("mat-calendar-body-comparison-identical",n._isComparisonIdentical(e.compareValue))("mat-calendar-body-today",n.todayValue===e.compareValue),P(),Ce(" ",e.displayValue," ")}}function i_(t,r){if(t&1&&(v(0,"tr",1),me(1,r_,2,6,"td",4),ro(2,a_,5,48,"td",5,Pf),x()),t&2){let e=r.$implicit,a=r.$index,i=be();P(),Qn(a===0&&i._firstRowOffset?1:-1),P(),ao(e)}}function n_(t,r){if(t&1&&(v(0,"th",2)(1,"span",6),b(2),x(),v(3,"span",3),b(4),x()()),t&2){let e=r.$implicit;P(2),Dt(e.long),P(2),Dt(e.narrow)}}var s_=["*"];function o_(t,r){}function l_(t,r){if(t&1){let e=tt();v(0,"mat-month-view",4),Qi("activeDateChange",function(i){De(e);let n=be();return Zi(n.activeDate,i)||(n.activeDate=i),Te(i)}),ye("_userSelection",function(i){De(e);let n=be();return Te(n._dateSelected(i))})("dragStarted",function(i){De(e);let n=be();return Te(n._dragStarted(i))})("dragEnded",function(i){De(e);let n=be();return Te(n._dragEnded(i))}),x()}if(t&2){let e=be();qi("activeDate",e.activeDate),j("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)("comparisonStart",e.comparisonStart)("comparisonEnd",e.comparisonEnd)("startDateAccessibleName",e.startDateAccessibleName)("endDateAccessibleName",e.endDateAccessibleName)("activeDrag",e._activeDrag)}}function c_(t,r){if(t&1){let e=tt();v(0,"mat-year-view",5),Qi("activeDateChange",function(i){De(e);let n=be();return Zi(n.activeDate,i)||(n.activeDate=i),Te(i)}),ye("monthSelected",function(i){De(e);let n=be();return Te(n._monthSelectedInYearView(i))})("selectedChange",function(i){De(e);let n=be();return Te(n._goToDateInView(i,"month"))}),x()}if(t&2){let e=be();qi("activeDate",e.activeDate),j("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function d_(t,r){if(t&1){let e=tt();v(0,"mat-multi-year-view",6),Qi("activeDateChange",function(i){De(e);let n=be();return Zi(n.activeDate,i)||(n.activeDate=i),Te(i)}),ye("yearSelected",function(i){De(e);let n=be();return Te(n._yearSelectedInMultiYearView(i))})("selectedChange",function(i){De(e);let n=be();return Te(n._goToDateInView(i,"year"))}),x()}if(t&2){let e=be();qi("activeDate",e.activeDate),j("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function f_(t,r){}var u_=["button"],h_=[[["","matDatepickerToggleIcon",""]]],m_=["[matDatepickerToggleIcon]"];function p_(t,r){t&1&&(qn(),v(0,"svg",2),Ae(1,"path",3),x())}var wn=(()=>{class t{changes=new Pe;calendarLabel="Calendar";openCalendarLabel="Open calendar";closeCalendarLabel="Close calendar";prevMonthLabel="Previous month";nextMonthLabel="Next month";prevYearLabel="Previous year";nextYearLabel="Next year";prevMultiYearLabel="Previous 24 years";nextMultiYearLabel="Next 24 years";switchToMonthViewLabel="Choose date";switchToMultiYearViewLabel="Choose month and year";startDateLabel="Start date";endDateLabel="End date";comparisonDateLabel="Comparison range";formatYearRange(e,a){return`${e} \u2013 ${a}`}formatYearRangeLabel(e,a){return`${e} to ${a}`}static \u0275fac=function(a){return new(a||t)};static \u0275prov=Er({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),__=0,ns=class{value;displayValue;ariaLabel;enabled;cssClasses;compareValue;rawValue;id=__++;constructor(r,e,a,i,n={},s=r,o){this.value=r,this.displayValue=e,this.ariaLabel=a,this.enabled=i,this.cssClasses=n,this.compareValue=s,this.rawValue=o}},g_={passive:!1,capture:!0},Bo={passive:!0,capture:!0},Df={passive:!0},vn=(()=>{class t{_elementRef=Y(Sr);_ngZone=Y(ka);_platform=Y(Pd);_intl=Y(wn);_eventCleanups;_skipNextFocus;_focusActiveCellAfterViewChecked=!1;label;rows;todayValue;startValue;endValue;labelMinRequiredCells;numCols=7;activeCell=0;ngAfterViewChecked(){this._focusActiveCellAfterViewChecked&&(this._focusActiveCell(),this._focusActiveCellAfterViewChecked=!1)}isRange=!1;cellAspectRatio=1;comparisonStart;comparisonEnd;previewStart=null;previewEnd=null;startDateAccessibleName;endDateAccessibleName;selectedValueChange=new ke;previewChange=new ke;activeDateChange=new ke;dragStarted=new ke;dragEnded=new ke;_firstRowOffset;_cellPadding;_cellWidth;_startDateLabelId;_endDateLabelId;_comparisonStartDateLabelId;_comparisonEndDateLabelId;_didDragSinceMouseDown=!1;_injector=Y(yi);comparisonDateAccessibleName=this._intl.comparisonDateLabel;_trackRow=e=>e;constructor(){let e=Y(Zn),a=Y(Ci);this._startDateLabelId=a.getId("mat-calendar-body-start-"),this._endDateLabelId=a.getId("mat-calendar-body-end-"),this._comparisonStartDateLabelId=a.getId("mat-calendar-body-comparison-start-"),this._comparisonEndDateLabelId=a.getId("mat-calendar-body-comparison-end-"),Y(Ea).load(po),this._ngZone.runOutsideAngular(()=>{let i=this._elementRef.nativeElement,n=[Jt(e,i,"touchmove",this._touchmoveHandler,g_),Jt(e,i,"mouseenter",this._enterHandler,Bo),Jt(e,i,"focus",this._enterHandler,Bo),Jt(e,i,"mouseleave",this._leaveHandler,Bo),Jt(e,i,"blur",this._leaveHandler,Bo),Jt(e,i,"mousedown",this._mousedownHandler,Df),Jt(e,i,"touchstart",this._mousedownHandler,Df)];this._platform.isBrowser&&n.push(e.listen("window","mouseup",this._mouseupHandler),e.listen("window","touchend",this._touchendHandler)),this._eventCleanups=n})}_cellClicked(e,a){this._didDragSinceMouseDown||e.enabled&&this.selectedValueChange.emit({value:e.value,event:a})}_emitActiveDateChange(e,a){e.enabled&&this.activeDateChange.emit({value:e.value,event:a})}_isSelected(e){return this.startValue===e||this.endValue===e}ngOnChanges(e){let a=e.numCols,{rows:i,numCols:n}=this;(e.rows||a)&&(this._firstRowOffset=i&&i.length&&i[0].length?n-i[0].length:0),(e.cellAspectRatio||a||!this._cellPadding)&&(this._cellPadding=`${50*this.cellAspectRatio/n}%`),(a||!this._cellWidth)&&(this._cellWidth=`${100/n}%`)}ngOnDestroy(){this._eventCleanups.forEach(e=>e())}_isActiveCell(e,a){let i=e*this.numCols+a;return e&&(i-=this._firstRowOffset),i==this.activeCell}_focusActiveCell(e=!0){bi(()=>{setTimeout(()=>{let a=this._elementRef.nativeElement.querySelector(".mat-calendar-body-active");a&&(e||(this._skipNextFocus=!0),a.focus())})},{injector:this._injector})}_scheduleFocusActiveCellAfterViewChecked(){this._focusActiveCellAfterViewChecked=!0}_isRangeStart(e){return lc(e,this.startValue,this.endValue)}_isRangeEnd(e){return cc(e,this.startValue,this.endValue)}_isInRange(e){return dc(e,this.startValue,this.endValue,this.isRange)}_isComparisonStart(e){return lc(e,this.comparisonStart,this.comparisonEnd)}_isComparisonBridgeStart(e,a,i){if(!this._isComparisonStart(e)||this._isRangeStart(e)||!this._isInRange(e))return!1;let n=this.rows[a][i-1];if(!n){let s=this.rows[a-1];n=s&&s[s.length-1]}return n&&!this._isRangeEnd(n.compareValue)}_isComparisonBridgeEnd(e,a,i){if(!this._isComparisonEnd(e)||this._isRangeEnd(e)||!this._isInRange(e))return!1;let n=this.rows[a][i+1];if(!n){let s=this.rows[a+1];n=s&&s[0]}return n&&!this._isRangeStart(n.compareValue)}_isComparisonEnd(e){return cc(e,this.comparisonStart,this.comparisonEnd)}_isInComparisonRange(e){return dc(e,this.comparisonStart,this.comparisonEnd,this.isRange)}_isComparisonIdentical(e){return this.comparisonStart===this.comparisonEnd&&e===this.comparisonStart}_isPreviewStart(e){return lc(e,this.previewStart,this.previewEnd)}_isPreviewEnd(e){return cc(e,this.previewStart,this.previewEnd)}_isInPreview(e){return dc(e,this.previewStart,this.previewEnd,this.isRange)}_getDescribedby(e){if(!this.isRange)return null;if(this.startValue===e&&this.endValue===e)return`${this._startDateLabelId} ${this._endDateLabelId}`;if(this.startValue===e)return this._startDateLabelId;if(this.endValue===e)return this._endDateLabelId;if(this.comparisonStart!==null&&this.comparisonEnd!==null){if(e===this.comparisonStart&&e===this.comparisonEnd)return`${this._comparisonStartDateLabelId} ${this._comparisonEndDateLabelId}`;if(e===this.comparisonStart)return this._comparisonStartDateLabelId;if(e===this.comparisonEnd)return this._comparisonEndDateLabelId}return null}_enterHandler=e=>{if(this._skipNextFocus&&e.type==="focus"){this._skipNextFocus=!1;return}if(e.target&&this.isRange){let a=this._getCellFromElement(e.target);a&&this._ngZone.run(()=>this.previewChange.emit({value:a.enabled?a:null,event:e}))}};_touchmoveHandler=e=>{if(!this.isRange)return;let a=Tf(e),i=a?this._getCellFromElement(a):null;a!==e.target&&(this._didDragSinceMouseDown=!0),oc(e.target)&&e.preventDefault(),this._ngZone.run(()=>this.previewChange.emit({value:i?.enabled?i:null,event:e}))};_leaveHandler=e=>{this.previewEnd!==null&&this.isRange&&(e.type!=="blur"&&(this._didDragSinceMouseDown=!0),e.target&&this._getCellFromElement(e.target)&&!(e.relatedTarget&&this._getCellFromElement(e.relatedTarget))&&this._ngZone.run(()=>this.previewChange.emit({value:null,event:e})))};_mousedownHandler=e=>{if(!this.isRange)return;this._didDragSinceMouseDown=!1;let a=e.target&&this._getCellFromElement(e.target);!a||!this._isInRange(a.compareValue)||this._ngZone.run(()=>{this.dragStarted.emit({value:a.rawValue,event:e})})};_mouseupHandler=e=>{if(!this.isRange)return;let a=oc(e.target);if(!a){this._ngZone.run(()=>{this.dragEnded.emit({value:null,event:e})});return}a.closest(".mat-calendar-body")===this._elementRef.nativeElement&&this._ngZone.run(()=>{let i=this._getCellFromElement(a);this.dragEnded.emit({value:i?.rawValue??null,event:e})})};_touchendHandler=e=>{let a=Tf(e);a&&this._mouseupHandler({target:a})};_getCellFromElement(e){let a=oc(e);if(a){let i=a.getAttribute("data-mat-row"),n=a.getAttribute("data-mat-col");if(i&&n)return this.rows[parseInt(i)][parseInt(n)]}return null}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=Ye({type:t,selectors:[["","mat-calendar-body",""]],hostAttrs:[1,"mat-calendar-body"],inputs:{label:"label",rows:"rows",todayValue:"todayValue",startValue:"startValue",endValue:"endValue",labelMinRequiredCells:"labelMinRequiredCells",numCols:"numCols",activeCell:"activeCell",isRange:"isRange",cellAspectRatio:"cellAspectRatio",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",previewStart:"previewStart",previewEnd:"previewEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedValueChange:"selectedValueChange",previewChange:"previewChange",activeDateChange:"activeDateChange",dragStarted:"dragStarted",dragEnded:"dragEnded"},exportAs:["matCalendarBody"],features:[qr],attrs:Jp,decls:11,vars:11,consts:[["aria-hidden","true"],["role","row"],[1,"mat-calendar-body-hidden-label",3,"id"],[1,"mat-calendar-body-label"],[1,"mat-calendar-body-label",3,"paddingTop","paddingBottom"],["role","gridcell",1,"mat-calendar-body-cell-container",3,"width","paddingTop","paddingBottom"],["role","gridcell",1,"mat-calendar-body-cell-container"],["type","button",1,"mat-calendar-body-cell",3,"click","focus","ngClass","tabindex"],[1,"mat-calendar-body-cell-content","mat-focus-indicator"],["aria-hidden","true",1,"mat-calendar-body-cell-preview"]],template:function(a,i){a&1&&(me(0,t_,3,6,"tr",0),ro(1,i_,4,1,"tr",1,e_,!0),v(3,"span",2),b(4),x(),v(5,"span",2),b(6),x(),v(7,"span",2),b(8),x(),v(9,"span",2),b(10),x()),a&2&&(Qn(i._firstRowOffset<i.labelMinRequiredCells?0:-1),P(),ao(i.rows),P(2),j("id",i._startDateLabelId),P(),Ce(" ",i.startDateAccessibleName,`
`),P(),j("id",i._endDateLabelId),P(),Ce(" ",i.endDateAccessibleName,`
`),P(),j("id",i._comparisonStartDateLabelId),P(),Jn(" ",i.comparisonDateAccessibleName," ",i.startDateAccessibleName,`
`),P(),j("id",i._comparisonEndDateLabelId),P(),Jn(" ",i.comparisonDateAccessibleName," ",i.endDateAccessibleName,`
`))},dependencies:[la],styles:[`.mat-calendar-body{min-width:224px}.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-outline-color, var(--mat-sys-primary))}.mat-calendar-body-label{height:0;line-height:0;text-align:start;padding-left:4.7142857143%;padding-right:4.7142857143%;font-size:var(--mat-datepicker-calendar-body-label-text-size, var(--mat-sys-title-small-size));font-weight:var(--mat-datepicker-calendar-body-label-text-weight, var(--mat-sys-title-small-weight));color:var(--mat-datepicker-calendar-body-label-text-color, var(--mat-sys-on-surface))}.mat-calendar-body-hidden-label{display:none}.mat-calendar-body-cell-container{position:relative;height:0;line-height:0}.mat-calendar-body-cell{position:absolute;top:0;left:0;width:100%;height:100%;background:none;text-align:center;outline:none;font-family:inherit;margin:0;font-family:var(--mat-datepicker-calendar-text-font, var(--mat-sys-body-medium-font));font-size:var(--mat-datepicker-calendar-text-size, var(--mat-sys-body-medium-size));-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-calendar-body-cell::-moz-focus-inner{border:0}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-cell-preview{content:"";position:absolute;top:5%;left:0;z-index:0;box-sizing:border-box;display:block;height:90%;width:100%}.mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-start::after,.mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,.mat-calendar-body-comparison-start::after,.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:5%;width:95%;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,[dir=rtl] .mat-calendar-body-comparison-start::after,[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:0;border-radius:0;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,.mat-calendar-body-comparison-end::after,.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}[dir=rtl] .mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,[dir=rtl] .mat-calendar-body-comparison-end::after,[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{left:5%;border-radius:0;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-comparison-bridge-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-bridge-end.mat-calendar-body-range-start::after{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end.mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-end.mat-calendar-body-range-start::after{width:90%}.mat-calendar-body-in-preview{color:var(--mat-datepicker-calendar-date-preview-state-outline-color, var(--mat-sys-primary))}.mat-calendar-body-in-preview .mat-calendar-body-cell-preview{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:0;border-right:dashed 1px}.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:0;border-left:dashed 1px}.mat-calendar-body-disabled{cursor:default}.mat-calendar-body-disabled>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){color:var(--mat-datepicker-calendar-date-disabled-state-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-calendar-body-disabled>.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-disabled-state-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}@media(forced-colors: active){.mat-calendar-body-disabled{opacity:.5}}.mat-calendar-body-cell-content{top:5%;left:5%;z-index:1;display:flex;align-items:center;justify-content:center;box-sizing:border-box;width:90%;height:90%;line-height:1;border-width:1px;border-style:solid;border-radius:999px;color:var(--mat-datepicker-calendar-date-text-color, var(--mat-sys-on-surface));border-color:var(--mat-datepicker-calendar-date-outline-color, transparent)}.mat-calendar-body-cell-content.mat-focus-indicator{position:absolute}@media(forced-colors: active){.mat-calendar-body-cell-content{border:none}}.cdk-keyboard-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical),.cdk-program-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-focus-state-background-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent))}@media(hover: hover){.mat-calendar-body-cell:not(.mat-calendar-body-disabled):hover>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-hover-state-background-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent))}}.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-state-background-color, var(--mat-sys-primary));color:var(--mat-datepicker-calendar-date-selected-state-text-color, var(--mat-sys-on-primary))}.mat-calendar-body-disabled>.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-disabled-state-background-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-calendar-body-selected.mat-calendar-body-today{box-shadow:inset 0 0 0 1px var(--mat-datepicker-calendar-date-today-selected-state-outline-color, var(--mat-sys-primary))}.mat-calendar-body-in-range::before{background:var(--mat-datepicker-calendar-date-in-range-state-background-color, var(--mat-sys-primary-container))}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color, var(--mat-sys-tertiary-container))}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color, var(--mat-sys-tertiary-container))}.mat-calendar-body-comparison-bridge-start::before,[dir=rtl] .mat-calendar-body-comparison-bridge-end::before{background:linear-gradient(to right, var(--mat-datepicker-calendar-date-in-range-state-background-color, var(--mat-sys-primary-container)) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color, var(--mat-sys-tertiary-container)) 50%)}.mat-calendar-body-comparison-bridge-end::before,[dir=rtl] .mat-calendar-body-comparison-bridge-start::before{background:linear-gradient(to left, var(--mat-datepicker-calendar-date-in-range-state-background-color, var(--mat-sys-primary-container)) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color, var(--mat-sys-tertiary-container)) 50%)}.mat-calendar-body-in-range>.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range.mat-calendar-body-in-range::after{background:var(--mat-datepicker-calendar-date-in-overlap-range-state-background-color, var(--mat-sys-secondary-container))}.mat-calendar-body-comparison-identical.mat-calendar-body-selected,.mat-calendar-body-in-comparison-range>.mat-calendar-body-selected{background:var(--mat-datepicker-calendar-date-in-overlap-range-selected-state-background-color, var(--mat-sys-secondary))}@media(forced-colors: active){.mat-datepicker-popup:not(:empty),.mat-calendar-body-cell:not(.mat-calendar-body-in-range) .mat-calendar-body-selected{outline:solid 1px}.mat-calendar-body-today{outline:dotted 1px}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-selected{background:none}.mat-calendar-body-in-range::before,.mat-calendar-body-comparison-bridge-start::before,.mat-calendar-body-comparison-bridge-end::before{border-top:solid 1px;border-bottom:solid 1px}.mat-calendar-body-range-start::before{border-left:solid 1px}[dir=rtl] .mat-calendar-body-range-start::before{border-left:0;border-right:solid 1px}.mat-calendar-body-range-end::before{border-right:solid 1px}[dir=rtl] .mat-calendar-body-range-end::before{border-right:0;border-left:solid 1px}.mat-calendar-body-in-comparison-range::before{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-comparison-start::before{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-comparison-start::before{border-left:0;border-right:dashed 1px}.mat-calendar-body-comparison-end::before{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-comparison-end::before{border-right:0;border-left:dashed 1px}}
`],encapsulation:2,changeDetection:0})}return t})();function sc(t){return t?.nodeName==="TD"}function oc(t){let r;return sc(t)?r=t:sc(t.parentNode)?r=t.parentNode:sc(t.parentNode?.parentNode)&&(r=t.parentNode.parentNode),r?.getAttribute("data-mat-row")!=null?r:null}function lc(t,r,e){return e!==null&&r!==e&&t<e&&t===r}function cc(t,r,e){return r!==null&&r!==e&&t>=r&&t===e}function dc(t,r,e,a){return a&&r!==null&&e!==null&&r!==e&&t>=r&&t<=e}function Tf(t){let r=t.changedTouches[0];return document.elementFromPoint(r.clientX,r.clientY)}var Vr=class{start;end;_disableStructuralEquivalency;constructor(r,e){this.start=r,this.end=e}},ss=(()=>{class t{selection;_adapter;_selectionChanged=new Pe;selectionChanged=this._selectionChanged;constructor(e,a){this.selection=e,this._adapter=a,this.selection=e}updateSelection(e,a){let i=this.selection;this.selection=e,this._selectionChanged.next({selection:e,source:a,oldValue:i})}ngOnDestroy(){this._selectionChanged.complete()}_isValidDateInstance(e){return this._adapter.isDateInstance(e)&&this._adapter.isValid(e)}static \u0275fac=function(a){wd()};static \u0275prov=Er({token:t,factory:t.\u0275fac})}return t})(),x_=(()=>{class t extends ss{constructor(e){super(null,e)}add(e){super.updateSelection(e,this)}isValid(){return this.selection!=null&&this._isValidDateInstance(this.selection)}isComplete(){return this.selection!=null}clone(){let e=new t(this._adapter);return e.updateSelection(this.selection,this),e}static \u0275fac=function(a){return new(a||t)(pd(tr))};static \u0275prov=Er({token:t,factory:t.\u0275fac})}return t})();function v_(t,r){return t||new x_(r)}var Rf={provide:ss,deps:[[new _d,new gd,ss],tr],useFactory:v_};var Nf=new Kt("MAT_DATE_RANGE_SELECTION_STRATEGY");var fc=7,w_=0,Af=(()=>{class t{_changeDetectorRef=Y(Zt);_dateFormats=Y(ni,{optional:!0});_dateAdapter=Y(tr,{optional:!0});_dir=Y(Sa,{optional:!0});_rangeStrategy=Y(Nf,{optional:!0});_rerenderSubscription=jt.EMPTY;_selectionKeyPressed;get activeDate(){return this._activeDate}set activeDate(e){let a=this._activeDate,i=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(i,this.minDate,this.maxDate),this._hasSameMonthAndYear(a,this._activeDate)||this._init()}_activeDate;get selected(){return this._selected}set selected(e){e instanceof Vr?this._selected=e:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setRanges(this._selected)}_selected;get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_minDate;get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_maxDate;dateFilter;dateClass;comparisonStart;comparisonEnd;startDateAccessibleName;endDateAccessibleName;activeDrag=null;selectedChange=new ke;_userSelection=new ke;dragStarted=new ke;dragEnded=new ke;activeDateChange=new ke;_matCalendarBody;_monthLabel;_weeks;_firstWeekOffset;_rangeStart;_rangeEnd;_comparisonRangeStart;_comparisonRangeEnd;_previewStart;_previewEnd;_isRange;_todayDate;_weekdays;constructor(){Y(Ea).load(lo),this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Ha(null)).subscribe(()=>this._init())}ngOnChanges(e){let a=e.comparisonStart||e.comparisonEnd;a&&!a.firstChange&&this._setRanges(this.selected),e.activeDrag&&!this.activeDrag&&this._clearPreview()}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_dateSelected(e){let a=e.value,i=this._getDateFromDayOfMonth(a),n,s;this._selected instanceof Vr?(n=this._getDateInCurrentMonth(this._selected.start),s=this._getDateInCurrentMonth(this._selected.end)):n=s=this._getDateInCurrentMonth(this._selected),(n!==a||s!==a)&&this.selectedChange.emit(i),this._userSelection.emit({value:i,event:e.event}),this._clearPreview(),this._changeDetectorRef.markForCheck()}_updateActiveDate(e){let a=e.value,i=this._activeDate;this.activeDate=this._getDateFromDayOfMonth(a),this._dateAdapter.compareDate(i,this.activeDate)&&this.activeDateChange.emit(this._activeDate)}_handleCalendarBodyKeydown(e){let a=this._activeDate,i=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,i?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,i?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,-7);break;case 40:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,7);break;case 36:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,1-this._dateAdapter.getDate(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,this._dateAdapter.getNumDaysInMonth(this._activeDate)-this._dateAdapter.getDate(this._activeDate));break;case 33:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,-1):this._dateAdapter.addCalendarMonths(this._activeDate,-1);break;case 34:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,1):this._dateAdapter.addCalendarMonths(this._activeDate,1);break;case 13:case 32:this._selectionKeyPressed=!0,this._canSelect(this._activeDate)&&e.preventDefault();return;case 27:this._previewEnd!=null&&!ki(e)&&(this._clearPreview(),this.activeDrag?this.dragEnded.emit({value:null,event:e}):(this.selectedChange.emit(null),this._userSelection.emit({value:null,event:e})),e.preventDefault(),e.stopPropagation());return;default:return}this._dateAdapter.compareDate(a,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(e.keyCode===32||e.keyCode===13)&&(this._selectionKeyPressed&&this._canSelect(this._activeDate)&&this._dateSelected({value:this._dateAdapter.getDate(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setRanges(this.selected),this._todayDate=this._getCellCompareValue(this._dateAdapter.today()),this._monthLabel=this._dateFormats.display.monthLabel?this._dateAdapter.format(this.activeDate,this._dateFormats.display.monthLabel):this._dateAdapter.getMonthNames("short")[this._dateAdapter.getMonth(this.activeDate)].toLocaleUpperCase();let e=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),1);this._firstWeekOffset=(fc+this._dateAdapter.getDayOfWeek(e)-this._dateAdapter.getFirstDayOfWeek())%fc,this._initWeekdays(),this._createWeekCells(),this._changeDetectorRef.markForCheck()}_focusActiveCell(e){this._matCalendarBody._focusActiveCell(e)}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_previewChanged({event:e,value:a}){if(this._rangeStrategy){let i=a?a.rawValue:null,n=this._rangeStrategy.createPreview(i,this.selected,e);if(this._previewStart=this._getCellCompareValue(n.start),this._previewEnd=this._getCellCompareValue(n.end),this.activeDrag&&i){let s=this._rangeStrategy.createDrag?.(this.activeDrag.value,this.selected,i,e);s&&(this._previewStart=this._getCellCompareValue(s.start),this._previewEnd=this._getCellCompareValue(s.end))}this._changeDetectorRef.detectChanges()}}_dragEnded(e){if(this.activeDrag)if(e.value){let a=this._rangeStrategy?.createDrag?.(this.activeDrag.value,this.selected,e.value,e.event);this.dragEnded.emit({value:a??null,event:e.event})}else this.dragEnded.emit({value:null,event:e.event})}_getDateFromDayOfMonth(e){return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),e)}_initWeekdays(){let e=this._dateAdapter.getFirstDayOfWeek(),a=this._dateAdapter.getDayOfWeekNames("narrow"),n=this._dateAdapter.getDayOfWeekNames("long").map((s,o)=>({long:s,narrow:a[o],id:w_++}));this._weekdays=n.slice(e).concat(n.slice(0,e))}_createWeekCells(){let e=this._dateAdapter.getNumDaysInMonth(this.activeDate),a=this._dateAdapter.getDateNames();this._weeks=[[]];for(let i=0,n=this._firstWeekOffset;i<e;i++,n++){n==fc&&(this._weeks.push([]),n=0);let s=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),i+1),o=this._shouldEnableDate(s),l=this._dateAdapter.format(s,this._dateFormats.display.dateA11yLabel),c=this.dateClass?this.dateClass(s,"month"):void 0;this._weeks[this._weeks.length-1].push(new ns(i+1,a[i],l,o,c,this._getCellCompareValue(s),s))}}_shouldEnableDate(e){return!!e&&(!this.minDate||this._dateAdapter.compareDate(e,this.minDate)>=0)&&(!this.maxDate||this._dateAdapter.compareDate(e,this.maxDate)<=0)&&(!this.dateFilter||this.dateFilter(e))}_getDateInCurrentMonth(e){return e&&this._hasSameMonthAndYear(e,this.activeDate)?this._dateAdapter.getDate(e):null}_hasSameMonthAndYear(e,a){return!!(e&&a&&this._dateAdapter.getMonth(e)==this._dateAdapter.getMonth(a)&&this._dateAdapter.getYear(e)==this._dateAdapter.getYear(a))}_getCellCompareValue(e){if(e){let a=this._dateAdapter.getYear(e),i=this._dateAdapter.getMonth(e),n=this._dateAdapter.getDate(e);return new Date(a,i,n).getTime()}return null}_isRtl(){return this._dir&&this._dir.value==="rtl"}_setRanges(e){e instanceof Vr?(this._rangeStart=this._getCellCompareValue(e.start),this._rangeEnd=this._getCellCompareValue(e.end),this._isRange=!0):(this._rangeStart=this._rangeEnd=this._getCellCompareValue(e),this._isRange=!1),this._comparisonRangeStart=this._getCellCompareValue(this.comparisonStart),this._comparisonRangeEnd=this._getCellCompareValue(this.comparisonEnd)}_canSelect(e){return!this.dateFilter||this.dateFilter(e)}_clearPreview(){this._previewStart=this._previewEnd=null}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=Ye({type:t,selectors:[["mat-month-view"]],viewQuery:function(a,i){if(a&1&&zt(vn,5),a&2){let n;yt(n=bt())&&(i._matCalendarBody=n.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName",activeDrag:"activeDrag"},outputs:{selectedChange:"selectedChange",_userSelection:"_userSelection",dragStarted:"dragStarted",dragEnded:"dragEnded",activeDateChange:"activeDateChange"},exportAs:["matMonthView"],features:[qr],decls:8,vars:14,consts:[["role","grid",1,"mat-calendar-table"],[1,"mat-calendar-table-header"],["scope","col"],["aria-hidden","true"],["colspan","7",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","previewChange","dragStarted","dragEnded","keyup","keydown","label","rows","todayValue","startValue","endValue","comparisonStart","comparisonEnd","previewStart","previewEnd","isRange","labelMinRequiredCells","activeCell","startDateAccessibleName","endDateAccessibleName"],[1,"cdk-visually-hidden"]],template:function(a,i){a&1&&(v(0,"table",0)(1,"thead",1)(2,"tr"),ro(3,n_,5,2,"th",2,Pf),x(),v(5,"tr",3),Ae(6,"th",4),x()(),v(7,"tbody",5),ye("selectedValueChange",function(s){return i._dateSelected(s)})("activeDateChange",function(s){return i._updateActiveDate(s)})("previewChange",function(s){return i._previewChanged(s)})("dragStarted",function(s){return i.dragStarted.emit(s)})("dragEnded",function(s){return i._dragEnded(s)})("keyup",function(s){return i._handleCalendarBodyKeyup(s)})("keydown",function(s){return i._handleCalendarBodyKeydown(s)}),x()()),a&2&&(P(3),ao(i._weekdays),P(4),j("label",i._monthLabel)("rows",i._weeks)("todayValue",i._todayDate)("startValue",i._rangeStart)("endValue",i._rangeEnd)("comparisonStart",i._comparisonRangeStart)("comparisonEnd",i._comparisonRangeEnd)("previewStart",i._previewStart)("previewEnd",i._previewEnd)("isRange",i._isRange)("labelMinRequiredCells",3)("activeCell",i._dateAdapter.getDate(i.activeDate)-1)("startDateAccessibleName",i.startDateAccessibleName)("endDateAccessibleName",i.endDateAccessibleName))},dependencies:[vn],encapsulation:2,changeDetection:0})}return t})(),Ar=24,uc=4,Ff=(()=>{class t{_changeDetectorRef=Y(Zt);_dateAdapter=Y(tr,{optional:!0});_dir=Y(Sa,{optional:!0});_rerenderSubscription=jt.EMPTY;_selectionKeyPressed;get activeDate(){return this._activeDate}set activeDate(e){let a=this._activeDate,i=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(i,this.minDate,this.maxDate),Lf(this._dateAdapter,a,this._activeDate,this.minDate,this.maxDate)||this._init()}_activeDate;get selected(){return this._selected}set selected(e){e instanceof Vr?this._selected=e:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedYear(e)}_selected;get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_minDate;get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_maxDate;dateFilter;dateClass;selectedChange=new ke;yearSelected=new ke;activeDateChange=new ke;_matCalendarBody;_years;_todayYear;_selectedYear;constructor(){this._dateAdapter,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Ha(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_init(){this._todayYear=this._dateAdapter.getYear(this._dateAdapter.today());let a=this._dateAdapter.getYear(this._activeDate)-as(this._dateAdapter,this.activeDate,this.minDate,this.maxDate);this._years=[];for(let i=0,n=[];i<Ar;i++)n.push(a+i),n.length==uc&&(this._years.push(n.map(s=>this._createCellForYear(s))),n=[]);this._changeDetectorRef.markForCheck()}_yearSelected(e){let a=e.value,i=this._dateAdapter.createDate(a,0,1),n=this._getDateFromYear(a);this.yearSelected.emit(i),this.selectedChange.emit(n)}_updateActiveDate(e){let a=e.value,i=this._activeDate;this.activeDate=this._getDateFromYear(a),this._dateAdapter.compareDate(i,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){let a=this._activeDate,i=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,i?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,i?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-uc);break;case 40:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,uc);break;case 36:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-as(this._dateAdapter,this.activeDate,this.minDate,this.maxDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,Ar-as(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)-1);break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?-Ar*10:-Ar);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?Ar*10:Ar);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(a,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked(),e.preventDefault()}_handleCalendarBodyKeyup(e){(e.keyCode===32||e.keyCode===13)&&(this._selectionKeyPressed&&this._yearSelected({value:this._dateAdapter.getYear(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_getActiveCell(){return as(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getDateFromYear(e){let a=this._dateAdapter.getMonth(this.activeDate),i=this._dateAdapter.getNumDaysInMonth(this._dateAdapter.createDate(e,a,1));return this._dateAdapter.createDate(e,a,Math.min(this._dateAdapter.getDate(this.activeDate),i))}_createCellForYear(e){let a=this._dateAdapter.createDate(e,0,1),i=this._dateAdapter.getYearName(a),n=this.dateClass?this.dateClass(a,"multi-year"):void 0;return new ns(e,i,i,this._shouldEnableYear(e),n)}_shouldEnableYear(e){if(e==null||this.maxDate&&e>this._dateAdapter.getYear(this.maxDate)||this.minDate&&e<this._dateAdapter.getYear(this.minDate))return!1;if(!this.dateFilter)return!0;let a=this._dateAdapter.createDate(e,0,1);for(let i=a;this._dateAdapter.getYear(i)==e;i=this._dateAdapter.addCalendarDays(i,1))if(this.dateFilter(i))return!0;return!1}_isRtl(){return this._dir&&this._dir.value==="rtl"}_setSelectedYear(e){if(this._selectedYear=null,e instanceof Vr){let a=e.start||e.end;a&&(this._selectedYear=this._dateAdapter.getYear(a))}else e&&(this._selectedYear=this._dateAdapter.getYear(e))}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=Ye({type:t,selectors:[["mat-multi-year-view"]],viewQuery:function(a,i){if(a&1&&zt(vn,5),a&2){let n;yt(n=bt())&&(i._matCalendarBody=n.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",activeDateChange:"activeDateChange"},exportAs:["matMultiYearView"],decls:5,vars:7,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","keyup","keydown","rows","todayValue","startValue","endValue","numCols","cellAspectRatio","activeCell"]],template:function(a,i){a&1&&(v(0,"table",0)(1,"thead",1)(2,"tr"),Ae(3,"th",2),x()(),v(4,"tbody",3),ye("selectedValueChange",function(s){return i._yearSelected(s)})("activeDateChange",function(s){return i._updateActiveDate(s)})("keyup",function(s){return i._handleCalendarBodyKeyup(s)})("keydown",function(s){return i._handleCalendarBodyKeydown(s)}),x()()),a&2&&(P(4),j("rows",i._years)("todayValue",i._todayYear)("startValue",i._selectedYear)("endValue",i._selectedYear)("numCols",4)("cellAspectRatio",4/7)("activeCell",i._getActiveCell()))},dependencies:[vn],encapsulation:2,changeDetection:0})}return t})();function Lf(t,r,e,a,i){let n=t.getYear(r),s=t.getYear(e),o=Bf(t,a,i);return Math.floor((n-o)/Ar)===Math.floor((s-o)/Ar)}function as(t,r,e,a){let i=t.getYear(r);return y_(i-Bf(t,e,a),Ar)}function Bf(t,r,e){let a=0;return e?a=t.getYear(e)-Ar+1:r&&(a=t.getYear(r)),a}function y_(t,r){return(t%r+r)%r}var Of=(()=>{class t{_changeDetectorRef=Y(Zt);_dateFormats=Y(ni,{optional:!0});_dateAdapter=Y(tr,{optional:!0});_dir=Y(Sa,{optional:!0});_rerenderSubscription=jt.EMPTY;_selectionKeyPressed;get activeDate(){return this._activeDate}set activeDate(e){let a=this._activeDate,i=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(i,this.minDate,this.maxDate),this._dateAdapter.getYear(a)!==this._dateAdapter.getYear(this._activeDate)&&this._init()}_activeDate;get selected(){return this._selected}set selected(e){e instanceof Vr?this._selected=e:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedMonth(e)}_selected;get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_minDate;get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_maxDate;dateFilter;dateClass;selectedChange=new ke;monthSelected=new ke;activeDateChange=new ke;_matCalendarBody;_months;_yearLabel;_todayMonth;_selectedMonth;constructor(){this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Ha(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_monthSelected(e){let a=e.value,i=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),a,1);this.monthSelected.emit(i);let n=this._getDateFromMonth(a);this.selectedChange.emit(n)}_updateActiveDate(e){let a=e.value,i=this._activeDate;this.activeDate=this._getDateFromMonth(a),this._dateAdapter.compareDate(i,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){let a=this._activeDate,i=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,i?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,i?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-this._dateAdapter.getMonth(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,11-this._dateAdapter.getMonth(this._activeDate));break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?-10:-1);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10:1);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(a,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(e.keyCode===32||e.keyCode===13)&&(this._selectionKeyPressed&&this._monthSelected({value:this._dateAdapter.getMonth(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setSelectedMonth(this.selected),this._todayMonth=this._getMonthInCurrentYear(this._dateAdapter.today()),this._yearLabel=this._dateAdapter.getYearName(this.activeDate);let e=this._dateAdapter.getMonthNames("short");this._months=[[0,1,2,3],[4,5,6,7],[8,9,10,11]].map(a=>a.map(i=>this._createCellForMonth(i,e[i]))),this._changeDetectorRef.markForCheck()}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getMonthInCurrentYear(e){return e&&this._dateAdapter.getYear(e)==this._dateAdapter.getYear(this.activeDate)?this._dateAdapter.getMonth(e):null}_getDateFromMonth(e){let a=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),i=this._dateAdapter.getNumDaysInMonth(a);return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,Math.min(this._dateAdapter.getDate(this.activeDate),i))}_createCellForMonth(e,a){let i=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),n=this._dateAdapter.format(i,this._dateFormats.display.monthYearA11yLabel),s=this.dateClass?this.dateClass(i,"year"):void 0;return new ns(e,a.toLocaleUpperCase(),n,this._shouldEnableMonth(e),s)}_shouldEnableMonth(e){let a=this._dateAdapter.getYear(this.activeDate);if(e==null||this._isYearAndMonthAfterMaxDate(a,e)||this._isYearAndMonthBeforeMinDate(a,e))return!1;if(!this.dateFilter)return!0;let i=this._dateAdapter.createDate(a,e,1);for(let n=i;this._dateAdapter.getMonth(n)==e;n=this._dateAdapter.addCalendarDays(n,1))if(this.dateFilter(n))return!0;return!1}_isYearAndMonthAfterMaxDate(e,a){if(this.maxDate){let i=this._dateAdapter.getYear(this.maxDate),n=this._dateAdapter.getMonth(this.maxDate);return e>i||e===i&&a>n}return!1}_isYearAndMonthBeforeMinDate(e,a){if(this.minDate){let i=this._dateAdapter.getYear(this.minDate),n=this._dateAdapter.getMonth(this.minDate);return e<i||e===i&&a<n}return!1}_isRtl(){return this._dir&&this._dir.value==="rtl"}_setSelectedMonth(e){e instanceof Vr?this._selectedMonth=this._getMonthInCurrentYear(e.start)||this._getMonthInCurrentYear(e.end):this._selectedMonth=this._getMonthInCurrentYear(e)}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=Ye({type:t,selectors:[["mat-year-view"]],viewQuery:function(a,i){if(a&1&&zt(vn,5),a&2){let n;yt(n=bt())&&(i._matCalendarBody=n.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",monthSelected:"monthSelected",activeDateChange:"activeDateChange"},exportAs:["matYearView"],decls:5,vars:9,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","keyup","keydown","label","rows","todayValue","startValue","endValue","labelMinRequiredCells","numCols","cellAspectRatio","activeCell"]],template:function(a,i){a&1&&(v(0,"table",0)(1,"thead",1)(2,"tr"),Ae(3,"th",2),x()(),v(4,"tbody",3),ye("selectedValueChange",function(s){return i._monthSelected(s)})("activeDateChange",function(s){return i._updateActiveDate(s)})("keyup",function(s){return i._handleCalendarBodyKeyup(s)})("keydown",function(s){return i._handleCalendarBodyKeydown(s)}),x()()),a&2&&(P(4),j("label",i._yearLabel)("rows",i._months)("todayValue",i._todayMonth)("startValue",i._selectedMonth)("endValue",i._selectedMonth)("labelMinRequiredCells",2)("numCols",4)("cellAspectRatio",4/7)("activeCell",i._dateAdapter.getMonth(i.activeDate)))},dependencies:[vn],encapsulation:2,changeDetection:0})}return t})(),Vf=(()=>{class t{_intl=Y(wn);calendar=Y(hc);_dateAdapter=Y(tr,{optional:!0});_dateFormats=Y(ni,{optional:!0});constructor(){Y(Ea).load(lo);let e=Y(Zt);this.calendar.stateChanges.subscribe(()=>e.markForCheck())}get periodButtonText(){return this.calendar.currentView=="month"?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():this.calendar.currentView=="year"?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRange(...this._formatMinAndMaxYearLabels())}get periodButtonDescription(){return this.calendar.currentView=="month"?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():this.calendar.currentView=="year"?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRangeLabel(...this._formatMinAndMaxYearLabels())}get periodButtonLabel(){return this.calendar.currentView=="month"?this._intl.switchToMultiYearViewLabel:this._intl.switchToMonthViewLabel}get prevButtonLabel(){return{month:this._intl.prevMonthLabel,year:this._intl.prevYearLabel,"multi-year":this._intl.prevMultiYearLabel}[this.calendar.currentView]}get nextButtonLabel(){return{month:this._intl.nextMonthLabel,year:this._intl.nextYearLabel,"multi-year":this._intl.nextMultiYearLabel}[this.calendar.currentView]}currentPeriodClicked(){this.calendar.currentView=this.calendar.currentView=="month"?"multi-year":"month"}previousClicked(){this.calendar.activeDate=this.calendar.currentView=="month"?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,-1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,this.calendar.currentView=="year"?-1:-Ar)}nextClicked(){this.calendar.activeDate=this.calendar.currentView=="month"?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,this.calendar.currentView=="year"?1:Ar)}previousEnabled(){return this.calendar.minDate?!this.calendar.minDate||!this._isSameView(this.calendar.activeDate,this.calendar.minDate):!0}nextEnabled(){return!this.calendar.maxDate||!this._isSameView(this.calendar.activeDate,this.calendar.maxDate)}_isSameView(e,a){return this.calendar.currentView=="month"?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(a)&&this._dateAdapter.getMonth(e)==this._dateAdapter.getMonth(a):this.calendar.currentView=="year"?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(a):Lf(this._dateAdapter,e,a,this.calendar.minDate,this.calendar.maxDate)}_formatMinAndMaxYearLabels(){let a=this._dateAdapter.getYear(this.calendar.activeDate)-as(this._dateAdapter,this.calendar.activeDate,this.calendar.minDate,this.calendar.maxDate),i=a+Ar-1,n=this._dateAdapter.getYearName(this._dateAdapter.createDate(a,0,1)),s=this._dateAdapter.getYearName(this._dateAdapter.createDate(i,0,1));return[n,s]}_periodButtonLabelId=Y(Ci).getId("mat-calendar-period-label-");static \u0275fac=function(a){return new(a||t)};static \u0275cmp=Ye({type:t,selectors:[["mat-calendar-header"]],exportAs:["matCalendarHeader"],ngContentSelectors:s_,decls:17,vars:11,consts:[[1,"mat-calendar-header"],[1,"mat-calendar-controls"],["aria-live","polite",1,"cdk-visually-hidden",3,"id"],["mat-button","","type","button",1,"mat-calendar-period-button",3,"click"],["aria-hidden","true"],["viewBox","0 0 10 5","focusable","false","aria-hidden","true",1,"mat-calendar-arrow"],["points","0,0 5,5 10,0"],[1,"mat-calendar-spacer"],["mat-icon-button","","type","button",1,"mat-calendar-previous-button",3,"click","disabled"],["viewBox","0 0 24 24","focusable","false","aria-hidden","true"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-calendar-next-button",3,"click","disabled"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"]],template:function(a,i){a&1&&(Ga(),v(0,"div",0)(1,"div",1)(2,"span",2),b(3),x(),v(4,"button",3),ye("click",function(){return i.currentPeriodClicked()}),v(5,"span",4),b(6),x(),qn(),v(7,"svg",5),Ae(8,"polygon",6),x()(),Kl(),Ae(9,"div",7),za(10),v(11,"button",8),ye("click",function(){return i.previousClicked()}),qn(),v(12,"svg",9),Ae(13,"path",10),x()(),Kl(),v(14,"button",11),ye("click",function(){return i.nextClicked()}),qn(),v(15,"svg",9),Ae(16,"path",12),x()()()()),a&2&&(P(2),j("id",i._periodButtonLabelId),P(),Dt(i.periodButtonDescription),P(),xt("aria-label",i.periodButtonLabel)("aria-describedby",i._periodButtonLabelId),P(2),Dt(i.periodButtonText),P(),Dr("mat-calendar-invert",i.calendar.currentView!=="month"),P(4),j("disabled",!i.previousEnabled()),xt("aria-label",i.prevButtonLabel),P(3),j("disabled",!i.nextEnabled()),xt("aria-label",i.nextButtonLabel))},dependencies:[Rt,Da],encapsulation:2,changeDetection:0})}return t})(),hc=(()=>{class t{_dateAdapter=Y(tr,{optional:!0});_dateFormats=Y(ni,{optional:!0});_changeDetectorRef=Y(Zt);headerComponent;_calendarHeaderPortal;_intlChanges;_moveFocusOnNextTick=!1;get startAt(){return this._startAt}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_startAt;startView="month";get selected(){return this._selected}set selected(e){e instanceof Vr?this._selected=e:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_selected;get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_minDate;get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_maxDate;dateFilter;dateClass;comparisonStart;comparisonEnd;startDateAccessibleName;endDateAccessibleName;selectedChange=new ke;yearSelected=new ke;monthSelected=new ke;viewChanged=new ke(!0);_userSelection=new ke;_userDragDrop=new ke;monthView;yearView;multiYearView;get activeDate(){return this._clampedActiveDate}set activeDate(e){this._clampedActiveDate=this._dateAdapter.clampDate(e,this.minDate,this.maxDate),this.stateChanges.next(),this._changeDetectorRef.markForCheck()}_clampedActiveDate;get currentView(){return this._currentView}set currentView(e){let a=this._currentView!==e?e:null;this._currentView=e,this._moveFocusOnNextTick=!0,this._changeDetectorRef.markForCheck(),a&&this.viewChanged.emit(a)}_currentView;_activeDrag=null;stateChanges=new Pe;constructor(){this._intlChanges=Y(wn).changes.subscribe(()=>{this._changeDetectorRef.markForCheck(),this.stateChanges.next()})}ngAfterContentInit(){this._calendarHeaderPortal=new ac(this.headerComponent||Vf),this.activeDate=this.startAt||this._dateAdapter.today(),this._currentView=this.startView}ngAfterViewChecked(){this._moveFocusOnNextTick&&(this._moveFocusOnNextTick=!1,this.focusActiveCell())}ngOnDestroy(){this._intlChanges.unsubscribe(),this.stateChanges.complete()}ngOnChanges(e){let a=e.minDate&&!this._dateAdapter.sameDate(e.minDate.previousValue,e.minDate.currentValue)?e.minDate:void 0,i=e.maxDate&&!this._dateAdapter.sameDate(e.maxDate.previousValue,e.maxDate.currentValue)?e.maxDate:void 0,n=a||i||e.dateFilter;if(n&&!n.firstChange){let s=this._getCurrentViewComponent();s&&(this._moveFocusOnNextTick=!0,this._changeDetectorRef.detectChanges(),s._init())}this.stateChanges.next()}focusActiveCell(){this._getCurrentViewComponent()._focusActiveCell(!1)}updateTodaysDate(){this._getCurrentViewComponent()._init()}_dateSelected(e){let a=e.value;(this.selected instanceof Vr||a&&!this._dateAdapter.sameDate(a,this.selected))&&this.selectedChange.emit(a),this._userSelection.emit(e)}_yearSelectedInMultiYearView(e){this.yearSelected.emit(e)}_monthSelectedInYearView(e){this.monthSelected.emit(e)}_goToDateInView(e,a){this.activeDate=e,this.currentView=a}_dragStarted(e){this._activeDrag=e}_dragEnded(e){this._activeDrag&&(e.value&&this._userDragDrop.emit(e),this._activeDrag=null)}_getCurrentViewComponent(){return this.monthView||this.yearView||this.multiYearView}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=Ye({type:t,selectors:[["mat-calendar"]],viewQuery:function(a,i){if(a&1&&(zt(Af,5),zt(Of,5),zt(Ff,5)),a&2){let n;yt(n=bt())&&(i.monthView=n.first),yt(n=bt())&&(i.yearView=n.first),yt(n=bt())&&(i.multiYearView=n.first)}},hostAttrs:[1,"mat-calendar"],inputs:{headerComponent:"headerComponent",startAt:"startAt",startView:"startView",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",_userSelection:"_userSelection",_userDragDrop:"_userDragDrop"},exportAs:["matCalendar"],features:[ur([Rf]),qr],decls:5,vars:2,consts:[[3,"cdkPortalOutlet"],["cdkMonitorSubtreeFocus","","tabindex","-1",1,"mat-calendar-content"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass"],[3,"activeDateChange","_userSelection","dragStarted","dragEnded","activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag"],[3,"activeDateChange","monthSelected","selectedChange","activeDate","selected","dateFilter","maxDate","minDate","dateClass"],[3,"activeDateChange","yearSelected","selectedChange","activeDate","selected","dateFilter","maxDate","minDate","dateClass"]],template:function(a,i){if(a&1&&(me(0,o_,0,0,"ng-template",0),v(1,"div",1),me(2,l_,1,11,"mat-month-view",2)(3,c_,1,6,"mat-year-view",3)(4,d_,1,6,"mat-multi-year-view",3),x()),a&2){let n;j("cdkPortalOutlet",i._calendarHeaderPortal),P(2),Qn((n=i.currentView)==="month"?2:n==="year"?3:n==="multi-year"?4:-1)}},dependencies:[ic,Nd,Af,Of,Ff],styles:[`.mat-calendar{display:block;line-height:normal;font-family:var(--mat-datepicker-calendar-text-font, var(--mat-sys-body-medium-font));font-size:var(--mat-datepicker-calendar-text-size, var(--mat-sys-body-medium-size))}.mat-calendar-header{padding:8px 8px 0 8px}.mat-calendar-content{padding:0 8px 8px 8px;outline:none}.mat-calendar-controls{display:flex;align-items:center;margin:5% calc(4.7142857143% - 16px)}.mat-calendar-spacer{flex:1 1 auto}.mat-calendar-period-button{min-width:0;margin:0 8px;font-size:var(--mat-datepicker-calendar-period-button-text-size, var(--mat-sys-title-small-size));font-weight:var(--mat-datepicker-calendar-period-button-text-weight, var(--mat-sys-title-small-weight));--mdc-text-button-label-text-color:var(--mat-datepicker-calendar-period-button-text-color, var(--mat-sys-on-surface-variant))}.mat-calendar-arrow{display:inline-block;width:10px;height:5px;margin:0 0 0 5px;vertical-align:middle;fill:var(--mat-datepicker-calendar-period-button-icon-color, var(--mat-sys-on-surface-variant))}.mat-calendar-arrow.mat-calendar-invert{transform:rotate(180deg)}[dir=rtl] .mat-calendar-arrow{margin:0 5px 0 0}@media(forced-colors: active){.mat-calendar-arrow{fill:CanvasText}}.mat-datepicker-content .mat-calendar-previous-button:not(.mat-mdc-button-disabled),.mat-datepicker-content .mat-calendar-next-button:not(.mat-mdc-button-disabled){color:var(--mat-datepicker-calendar-navigation-button-icon-color, var(--mat-sys-on-surface-variant))}[dir=rtl] .mat-calendar-previous-button,[dir=rtl] .mat-calendar-next-button{transform:rotate(180deg)}.mat-calendar-table{border-spacing:0;border-collapse:collapse;width:100%}.mat-calendar-table-header th{text-align:center;padding:0 0 8px 0;color:var(--mat-datepicker-calendar-header-text-color, var(--mat-sys-on-surface-variant));font-size:var(--mat-datepicker-calendar-header-text-size, var(--mat-sys-title-small-size));font-weight:var(--mat-datepicker-calendar-header-text-weight, var(--mat-sys-title-small-weight))}.mat-calendar-table-header-divider{position:relative;height:1px}.mat-calendar-table-header-divider::after{content:"";position:absolute;top:0;left:-8px;right:-8px;height:1px;background:var(--mat-datepicker-calendar-header-divider-color, transparent)}.mat-calendar-body-cell-content::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px)*-1)}.mat-calendar-body-cell:focus .mat-focus-indicator::before{content:""}
`],encapsulation:2,changeDetection:0})}return t})(),Uf=new Kt("mat-datepicker-scroll-strategy",{providedIn:"root",factory:()=>{let t=Y(go);return()=>t.scrollStrategies.reposition()}});function b_(t){return()=>t.scrollStrategies.reposition()}var C_={provide:Uf,deps:[go],useFactory:b_},Hf=(()=>{class t{_elementRef=Y(Sr);_animationsDisabled=Y(Js,{optional:!0})==="NoopAnimations";_changeDetectorRef=Y(Zt);_globalModel=Y(ss);_dateAdapter=Y(tr);_ngZone=Y(ka);_rangeSelectionStrategy=Y(Nf,{optional:!0});_stateChanges;_model;_eventCleanups;_animationFallback;_calendar;color;datepicker;comparisonStart;comparisonEnd;startDateAccessibleName;endDateAccessibleName;_isAbove;_animationDone=new Pe;_isAnimating=!1;_closeButtonText;_closeButtonFocused;_actionsPortal=null;_dialogLabelId;constructor(){if(Y(Ea).load(lo),this._closeButtonText=Y(wn).closeCalendarLabel,!this._animationsDisabled){let e=this._elementRef.nativeElement,a=Y(Zn);this._eventCleanups=this._ngZone.runOutsideAngular(()=>[a.listen(e,"animationstart",this._handleAnimationEvent),a.listen(e,"animationend",this._handleAnimationEvent),a.listen(e,"animationcancel",this._handleAnimationEvent)])}}ngAfterViewInit(){this._stateChanges=this.datepicker.stateChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()}),this._calendar.focusActiveCell()}ngOnDestroy(){clearTimeout(this._animationFallback),this._eventCleanups?.forEach(e=>e()),this._stateChanges?.unsubscribe(),this._animationDone.complete()}_handleUserSelection(e){let a=this._model.selection,i=e.value,n=a instanceof Vr;if(n&&this._rangeSelectionStrategy){let s=this._rangeSelectionStrategy.selectionFinished(i,a,e.event);this._model.updateSelection(s,this)}else i&&(n||!this._dateAdapter.sameDate(i,a))&&this._model.add(i);(!this._model||this._model.isComplete())&&!this._actionsPortal&&this.datepicker.close()}_handleUserDragDrop(e){this._model.updateSelection(e.value,this)}_startExitAnimation(){this._elementRef.nativeElement.classList.add("mat-datepicker-content-exit"),this._animationsDisabled?this._animationDone.next():(clearTimeout(this._animationFallback),this._animationFallback=setTimeout(()=>{this._isAnimating||this._animationDone.next()},200))}_handleAnimationEvent=e=>{let a=this._elementRef.nativeElement;e.target!==a||!e.animationName.startsWith("_mat-datepicker-content")||(clearTimeout(this._animationFallback),this._isAnimating=e.type==="animationstart",a.classList.toggle("mat-datepicker-content-animating",this._isAnimating),this._isAnimating||this._animationDone.next())};_getSelected(){return this._model.selection}_applyPendingSelection(){this._model!==this._globalModel&&this._globalModel.updateSelection(this._model.selection,this)}_assignActions(e,a){this._model=e?this._globalModel.clone():this._globalModel,this._actionsPortal=e,a&&this._changeDetectorRef.detectChanges()}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=Ye({type:t,selectors:[["mat-datepicker-content"]],viewQuery:function(a,i){if(a&1&&zt(hc,5),a&2){let n;yt(n=bt())&&(i._calendar=n.first)}},hostAttrs:[1,"mat-datepicker-content"],hostVars:6,hostBindings:function(a,i){a&2&&(Ql(i.color?"mat-"+i.color:""),Dr("mat-datepicker-content-touch",i.datepicker.touchUi)("mat-datepicker-content-animations-enabled",!i._animationsDisabled))},inputs:{color:"color"},exportAs:["matDatepickerContent"],decls:5,vars:26,consts:[["cdkTrapFocus","","role","dialog",1,"mat-datepicker-content-container"],[3,"yearSelected","monthSelected","viewChanged","_userSelection","_userDragDrop","id","startAt","startView","minDate","maxDate","dateFilter","headerComponent","selected","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName"],[3,"cdkPortalOutlet"],["type","button","mat-raised-button","",1,"mat-datepicker-close-button",3,"focus","blur","click","color"]],template:function(a,i){if(a&1&&(v(0,"div",0)(1,"mat-calendar",1),ye("yearSelected",function(s){return i.datepicker._selectYear(s)})("monthSelected",function(s){return i.datepicker._selectMonth(s)})("viewChanged",function(s){return i.datepicker._viewChanged(s)})("_userSelection",function(s){return i._handleUserSelection(s)})("_userDragDrop",function(s){return i._handleUserDragDrop(s)}),x(),me(2,f_,0,0,"ng-template",2),v(3,"button",3),ye("focus",function(){return i._closeButtonFocused=!0})("blur",function(){return i._closeButtonFocused=!1})("click",function(){return i.datepicker.close()}),b(4),x()()),a&2){let n;Dr("mat-datepicker-content-container-with-custom-header",i.datepicker.calendarHeaderComponent)("mat-datepicker-content-container-with-actions",i._actionsPortal),xt("aria-modal",!0)("aria-labelledby",(n=i._dialogLabelId)!==null&&n!==void 0?n:void 0),P(),Ql(i.datepicker.panelClass),j("id",i.datepicker.id)("startAt",i.datepicker.startAt)("startView",i.datepicker.startView)("minDate",i.datepicker._getMinDate())("maxDate",i.datepicker._getMaxDate())("dateFilter",i.datepicker._getDateFilter())("headerComponent",i.datepicker.calendarHeaderComponent)("selected",i._getSelected())("dateClass",i.datepicker.dateClass)("comparisonStart",i.comparisonStart)("comparisonEnd",i.comparisonEnd)("startDateAccessibleName",i.startDateAccessibleName)("endDateAccessibleName",i.endDateAccessibleName),P(),j("cdkPortalOutlet",i._actionsPortal),P(),Dr("cdk-visually-hidden",!i._closeButtonFocused),j("color",i.color||"primary"),P(),Dt(i._closeButtonText)}},dependencies:[Ld,hc,ic,Rt],styles:[`@keyframes _mat-datepicker-content-dropdown-enter{from{opacity:0;transform:scaleY(0.8)}to{opacity:1;transform:none}}@keyframes _mat-datepicker-content-dialog-enter{from{opacity:0;transform:scale(0.8)}to{opacity:1;transform:none}}@keyframes _mat-datepicker-content-exit{from{opacity:1}to{opacity:0}}.mat-datepicker-content{display:block;border-radius:4px;background-color:var(--mat-datepicker-calendar-container-background-color, var(--mat-sys-surface-container-high));color:var(--mat-datepicker-calendar-container-text-color, var(--mat-sys-on-surface));box-shadow:var(--mat-datepicker-calendar-container-elevation-shadow, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12));border-radius:var(--mat-datepicker-calendar-container-shape, var(--mat-sys-corner-large))}.mat-datepicker-content.mat-datepicker-content-animations-enabled{animation:_mat-datepicker-content-dropdown-enter 120ms cubic-bezier(0, 0, 0.2, 1)}.mat-datepicker-content .mat-calendar{width:296px;height:354px}.mat-datepicker-content .mat-datepicker-content-container-with-custom-header .mat-calendar{height:auto}.mat-datepicker-content .mat-datepicker-close-button{position:absolute;top:100%;left:0;margin-top:8px}.mat-datepicker-content-animating .mat-datepicker-content .mat-datepicker-close-button{display:none}.mat-datepicker-content-container{display:flex;flex-direction:column;justify-content:space-between}.mat-datepicker-content-touch{display:block;max-height:80vh;box-shadow:var(--mat-datepicker-calendar-container-touch-elevation-shadow, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12));border-radius:var(--mat-datepicker-calendar-container-touch-shape, var(--mat-sys-corner-extra-large));position:relative;overflow:visible}.mat-datepicker-content-touch.mat-datepicker-content-animations-enabled{animation:_mat-datepicker-content-dialog-enter 150ms cubic-bezier(0, 0, 0.2, 1)}.mat-datepicker-content-touch .mat-datepicker-content-container{min-height:312px;max-height:788px;min-width:250px;max-width:750px}.mat-datepicker-content-touch .mat-calendar{width:100%;height:auto}.mat-datepicker-content-exit.mat-datepicker-content-animations-enabled{animation:_mat-datepicker-content-exit 100ms linear}@media all and (orientation: landscape){.mat-datepicker-content-touch .mat-datepicker-content-container{width:64vh;height:80vh}}@media all and (orientation: portrait){.mat-datepicker-content-touch .mat-datepicker-content-container{width:80vw;height:100vw}.mat-datepicker-content-touch .mat-datepicker-content-container-with-actions{height:115vw}}
`],encapsulation:2,changeDetection:0})}return t})(),Mf=(()=>{class t{_overlay=Y(go);_viewContainerRef=Y(eo);_dateAdapter=Y(tr,{optional:!0});_dir=Y(Sa,{optional:!0});_model=Y(ss);_scrollStrategy=Y(Uf);_inputStateChanges=jt.EMPTY;_document=Y(ts);calendarHeaderComponent;get startAt(){return this._startAt||(this.datepickerInput?this.datepickerInput.getStartValue():null)}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}_startAt;startView="month";get color(){return this._color||(this.datepickerInput?this.datepickerInput.getThemePalette():void 0)}set color(e){this._color=e}_color;touchUi=!1;get disabled(){return this._disabled===void 0&&this.datepickerInput?this.datepickerInput.disabled:!!this._disabled}set disabled(e){e!==this._disabled&&(this._disabled=e,this.stateChanges.next(void 0))}_disabled;xPosition="start";yPosition="below";restoreFocus=!0;yearSelected=new ke;monthSelected=new ke;viewChanged=new ke(!0);dateClass;openedStream=new ke;closedStream=new ke;get panelClass(){return this._panelClass}set panelClass(e){this._panelClass=Zd(e)}_panelClass;get opened(){return this._opened}set opened(e){e?this.open():this.close()}_opened=!1;id=Y(Ci).getId("mat-datepicker-");_getMinDate(){return this.datepickerInput&&this.datepickerInput.min}_getMaxDate(){return this.datepickerInput&&this.datepickerInput.max}_getDateFilter(){return this.datepickerInput&&this.datepickerInput.dateFilter}_overlayRef;_componentRef;_focusedElementBeforeOpen=null;_backdropHarnessClass=`${this.id}-backdrop`;_actionsPortal;datepickerInput;stateChanges=new Pe;_injector=Y(yi);_changeDetectorRef=Y(Zt);constructor(){this._dateAdapter,this._model.selectionChanged.subscribe(()=>{this._changeDetectorRef.markForCheck()})}ngOnChanges(e){let a=e.xPosition||e.yPosition;if(a&&!a.firstChange&&this._overlayRef){let i=this._overlayRef.getConfig().positionStrategy;i instanceof hf&&(this._setConnectedPositions(i),this.opened&&this._overlayRef.updatePosition())}this.stateChanges.next(void 0)}ngOnDestroy(){this._destroyOverlay(),this.close(),this._inputStateChanges.unsubscribe(),this.stateChanges.complete()}select(e){this._model.add(e)}_selectYear(e){this.yearSelected.emit(e)}_selectMonth(e){this.monthSelected.emit(e)}_viewChanged(e){this.viewChanged.emit(e)}registerInput(e){return this.datepickerInput,this._inputStateChanges.unsubscribe(),this.datepickerInput=e,this._inputStateChanges=e.stateChanges.subscribe(()=>this.stateChanges.next(void 0)),this._model}registerActions(e){this._actionsPortal,this._actionsPortal=e,this._componentRef?.instance._assignActions(e,!0)}removeActions(e){e===this._actionsPortal&&(this._actionsPortal=null,this._componentRef?.instance._assignActions(null,!0))}open(){this._opened||this.disabled||this._componentRef?.instance._isAnimating||(this.datepickerInput,this._focusedElementBeforeOpen=Id(),this._openOverlay(),this._opened=!0,this.openedStream.emit())}close(){if(!this._opened||this._componentRef?.instance._isAnimating)return;let e=this.restoreFocus&&this._focusedElementBeforeOpen&&typeof this._focusedElementBeforeOpen.focus=="function",a=()=>{this._opened&&(this._opened=!1,this.closedStream.emit())};if(this._componentRef){let{instance:i,location:n}=this._componentRef;i._animationDone.pipe(Zs(1)).subscribe(()=>{let s=this._document.activeElement;e&&(!s||s===this._document.activeElement||n.nativeElement.contains(s))&&this._focusedElementBeforeOpen.focus(),this._focusedElementBeforeOpen=null,this._destroyOverlay()}),i._startExitAnimation()}e?setTimeout(a):a()}_applyPendingSelection(){this._componentRef?.instance?._applyPendingSelection()}_forwardContentValues(e){e.datepicker=this,e.color=this.color,e._dialogLabelId=this.datepickerInput.getOverlayLabelId(),e._assignActions(this._actionsPortal,!1)}_openOverlay(){this._destroyOverlay();let e=this.touchUi,a=new ac(Hf,this._viewContainerRef),i=this._overlayRef=this._overlay.create(new uf({positionStrategy:e?this._getDialogStrategy():this._getDropdownStrategy(),hasBackdrop:!0,backdropClass:[e?"cdk-overlay-dark-backdrop":"mat-overlay-transparent-backdrop",this._backdropHarnessClass],direction:this._dir||"ltr",scrollStrategy:e?this._overlay.scrollStrategies.block():this._scrollStrategy(),panelClass:`mat-datepicker-${e?"dialog":"popup"}`}));this._getCloseStream(i).subscribe(n=>{n&&n.preventDefault(),this.close()}),i.keydownEvents().subscribe(n=>{let s=n.keyCode;(s===38||s===40||s===37||s===39||s===33||s===34)&&n.preventDefault()}),this._componentRef=i.attach(a),this._forwardContentValues(this._componentRef.instance),e||bi(()=>{i.updatePosition()},{injector:this._injector})}_destroyOverlay(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=this._componentRef=null)}_getDialogStrategy(){return this._overlay.position().global().centerHorizontally().centerVertically()}_getDropdownStrategy(){let e=this._overlay.position().flexibleConnectedTo(this.datepickerInput.getConnectedOverlayOrigin()).withTransformOriginOn(".mat-datepicker-content").withFlexibleDimensions(!1).withViewportMargin(8).withLockedPosition();return this._setConnectedPositions(e)}_setConnectedPositions(e){let a=this.xPosition==="end"?"end":"start",i=a==="start"?"end":"start",n=this.yPosition==="above"?"bottom":"top",s=n==="top"?"bottom":"top";return e.withPositions([{originX:a,originY:s,overlayX:a,overlayY:n},{originX:a,originY:n,overlayX:a,overlayY:s},{originX:i,originY:s,overlayX:i,overlayY:n},{originX:i,originY:n,overlayX:i,overlayY:s}])}_getCloseStream(e){let a=["ctrlKey","shiftKey","metaKey"];return wi(e.backdropClick(),e.detachments(),e.keydownEvents().pipe(fd(i=>i.keyCode===27&&!ki(i)||this.datepickerInput&&ki(i,"altKey")&&i.keyCode===38&&a.every(n=>!ki(i,n)))))}static \u0275fac=function(a){return new(a||t)};static \u0275dir=Br({type:t,inputs:{calendarHeaderComponent:"calendarHeaderComponent",startAt:"startAt",startView:"startView",color:"color",touchUi:[2,"touchUi","touchUi",Pt],disabled:[2,"disabled","disabled",Pt],xPosition:"xPosition",yPosition:"yPosition",restoreFocus:[2,"restoreFocus","restoreFocus",Pt],dateClass:"dateClass",panelClass:"panelClass",opened:[2,"opened","opened",Pt]},outputs:{yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",openedStream:"opened",closedStream:"closed"},features:[qr]})}return t})(),Go=(()=>{class t extends Mf{static \u0275fac=(()=>{let e;return function(i){return(e||(e=xd(t)))(i||t)}})();static \u0275cmp=Ye({type:t,selectors:[["mat-datepicker"]],exportAs:["matDatepicker"],features:[ur([Rf,{provide:Mf,useExisting:t}]),Zl],decls:0,vars:0,template:function(a,i){},encapsulation:2,changeDetection:0})}return t})(),_n=class{target;targetElement;value;constructor(r,e){this.target=r,this.targetElement=e,this.value=this.target.value}},k_=(()=>{class t{_elementRef=Y(Sr);_dateAdapter=Y(tr,{optional:!0});_dateFormats=Y(ni,{optional:!0});_isInitialized;get value(){return this._model?this._getValueFromModel(this._model.selection):this._pendingValue}set value(e){this._assignValueProgrammatically(e)}_model;get disabled(){return!!this._disabled||this._parentDisabled()}set disabled(e){let a=e,i=this._elementRef.nativeElement;this._disabled!==a&&(this._disabled=a,this.stateChanges.next(void 0)),a&&this._isInitialized&&i.blur&&i.blur()}_disabled;dateChange=new ke;dateInput=new ke;stateChanges=new Pe;_onTouched=()=>{};_validatorOnChange=()=>{};_cvaOnChange=()=>{};_valueChangesSubscription=jt.EMPTY;_localeSubscription=jt.EMPTY;_pendingValue;_parseValidator=()=>this._lastValueValid?null:{matDatepickerParse:{text:this._elementRef.nativeElement.value}};_filterValidator=e=>{let a=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e.value));return!a||this._matchesFilter(a)?null:{matDatepickerFilter:!0}};_minValidator=e=>{let a=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e.value)),i=this._getMinDate();return!i||!a||this._dateAdapter.compareDate(i,a)<=0?null:{matDatepickerMin:{min:i,actual:a}}};_maxValidator=e=>{let a=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e.value)),i=this._getMaxDate();return!i||!a||this._dateAdapter.compareDate(i,a)>=0?null:{matDatepickerMax:{max:i,actual:a}}};_getValidators(){return[this._parseValidator,this._minValidator,this._maxValidator,this._filterValidator]}_registerModel(e){this._model=e,this._valueChangesSubscription.unsubscribe(),this._pendingValue&&this._assignValue(this._pendingValue),this._valueChangesSubscription=this._model.selectionChanged.subscribe(a=>{if(this._shouldHandleChangeEvent(a)){let i=this._getValueFromModel(a.selection);this._lastValueValid=this._isValidValue(i),this._cvaOnChange(i),this._onTouched(),this._formatValue(i),this.dateInput.emit(new _n(this,this._elementRef.nativeElement)),this.dateChange.emit(new _n(this,this._elementRef.nativeElement))}})}_lastValueValid=!1;constructor(){this._localeSubscription=this._dateAdapter.localeChanges.subscribe(()=>{this._assignValueProgrammatically(this.value)})}ngAfterViewInit(){this._isInitialized=!0}ngOnChanges(e){E_(e,this._dateAdapter)&&this.stateChanges.next(void 0)}ngOnDestroy(){this._valueChangesSubscription.unsubscribe(),this._localeSubscription.unsubscribe(),this.stateChanges.complete()}registerOnValidatorChange(e){this._validatorOnChange=e}validate(e){return this._validator?this._validator(e):null}writeValue(e){this._assignValueProgrammatically(e)}registerOnChange(e){this._cvaOnChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_onKeydown(e){let a=["ctrlKey","shiftKey","metaKey"];ki(e,"altKey")&&e.keyCode===40&&a.every(n=>!ki(e,n))&&!this._elementRef.nativeElement.readOnly&&(this._openPopup(),e.preventDefault())}_onInput(e){let a=this._lastValueValid,i=this._dateAdapter.parse(e,this._dateFormats.parse.dateInput);this._lastValueValid=this._isValidValue(i),i=this._dateAdapter.getValidDateOrNull(i);let n=!this._dateAdapter.sameDate(i,this.value);!i||n?this._cvaOnChange(i):(e&&!this.value&&this._cvaOnChange(i),a!==this._lastValueValid&&this._validatorOnChange()),n&&(this._assignValue(i),this.dateInput.emit(new _n(this,this._elementRef.nativeElement)))}_onChange(){this.dateChange.emit(new _n(this,this._elementRef.nativeElement))}_onBlur(){this.value&&this._formatValue(this.value),this._onTouched()}_formatValue(e){this._elementRef.nativeElement.value=e!=null?this._dateAdapter.format(e,this._dateFormats.display.dateInput):""}_assignValue(e){this._model?(this._assignValueToModel(e),this._pendingValue=null):this._pendingValue=e}_isValidValue(e){return!e||this._dateAdapter.isValid(e)}_parentDisabled(){return!1}_assignValueProgrammatically(e){e=this._dateAdapter.deserialize(e),this._lastValueValid=this._isValidValue(e),e=this._dateAdapter.getValidDateOrNull(e),this._assignValue(e),this._formatValue(e)}_matchesFilter(e){let a=this._getDateFilter();return!a||a(e)}static \u0275fac=function(a){return new(a||t)};static \u0275dir=Br({type:t,inputs:{value:"value",disabled:[2,"disabled","disabled",Pt]},outputs:{dateChange:"dateChange",dateInput:"dateInput"},features:[qr]})}return t})();function E_(t,r){let e=Object.keys(t);for(let a of e){let{previousValue:i,currentValue:n}=t[a];if(r.isDateInstance(i)&&r.isDateInstance(n)){if(!r.sameDate(i,n))return!0}else return!0}return!1}var S_={provide:co,useExisting:Kn(()=>yn),multi:!0},D_={provide:zd,useExisting:Kn(()=>yn),multi:!0},yn=(()=>{class t extends k_{_formField=Y(ef,{optional:!0});_closedSubscription=jt.EMPTY;_openedSubscription=jt.EMPTY;set matDatepicker(e){e&&(this._datepicker=e,this._ariaOwns.set(e.opened?e.id:null),this._closedSubscription=e.closedStream.subscribe(()=>{this._onTouched(),this._ariaOwns.set(null)}),this._openedSubscription=e.openedStream.subscribe(()=>{this._ariaOwns.set(e.id)}),this._registerModel(e.registerInput(this)))}_datepicker;_ariaOwns=qt(null);get min(){return this._min}set min(e){let a=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e));this._dateAdapter.sameDate(a,this._min)||(this._min=a,this._validatorOnChange())}_min;get max(){return this._max}set max(e){let a=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e));this._dateAdapter.sameDate(a,this._max)||(this._max=a,this._validatorOnChange())}_max;get dateFilter(){return this._dateFilter}set dateFilter(e){let a=this._matchesFilter(this.value);this._dateFilter=e,this._matchesFilter(this.value)!==a&&this._validatorOnChange()}_dateFilter;_validator;constructor(){super(),this._validator=ot.compose(super._getValidators())}getConnectedOverlayOrigin(){return this._formField?this._formField.getConnectedOverlayOrigin():this._elementRef}getOverlayLabelId(){return this._formField?this._formField.getLabelId():this._elementRef.nativeElement.getAttribute("aria-labelledby")}getThemePalette(){return this._formField?this._formField.color:void 0}getStartValue(){return this.value}ngOnDestroy(){super.ngOnDestroy(),this._closedSubscription.unsubscribe(),this._openedSubscription.unsubscribe()}_openPopup(){this._datepicker&&this._datepicker.open()}_getValueFromModel(e){return e}_assignValueToModel(e){this._model&&this._model.updateSelection(e,this)}_getMinDate(){return this._min}_getMaxDate(){return this._max}_getDateFilter(){return this._dateFilter}_shouldHandleChangeEvent(e){return e.source!==this}static \u0275fac=function(a){return new(a||t)};static \u0275dir=Br({type:t,selectors:[["input","matDatepicker",""]],hostAttrs:[1,"mat-datepicker-input"],hostVars:6,hostBindings:function(a,i){a&1&&ye("input",function(s){return i._onInput(s.target.value)})("change",function(){return i._onChange()})("blur",function(){return i._onBlur()})("keydown",function(s){return i._onKeydown(s)}),a&2&&(bd("disabled",i.disabled),xt("aria-haspopup",i._datepicker?"dialog":null)("aria-owns",i._ariaOwns())("min",i.min?i._dateAdapter.toIso8601(i.min):null)("max",i.max?i._dateAdapter.toIso8601(i.max):null)("data-mat-calendar",i._datepicker?i._datepicker.id:null))},inputs:{matDatepicker:"matDatepicker",min:"min",max:"max",dateFilter:[0,"matDatepickerFilter","dateFilter"]},exportAs:["matDatepickerInput"],features:[ur([S_,D_,{provide:rf,useExisting:t}]),Zl]})}return t})(),T_=(()=>{class t{static \u0275fac=function(a){return new(a||t)};static \u0275dir=Br({type:t,selectors:[["","matDatepickerToggleIcon",""]]})}return t})(),ls=(()=>{class t{_intl=Y(wn);_changeDetectorRef=Y(Zt);_stateChanges=jt.EMPTY;datepicker;tabIndex;ariaLabel;get disabled(){return this._disabled===void 0&&this.datepicker?this.datepicker.disabled:!!this._disabled}set disabled(e){this._disabled=e}_disabled;disableRipple;_customIcon;_button;constructor(){let e=Y(new Qs("tabindex"),{optional:!0}),a=Number(e);this.tabIndex=a||a===0?a:null}ngOnChanges(e){e.datepicker&&this._watchStateChanges()}ngOnDestroy(){this._stateChanges.unsubscribe()}ngAfterContentInit(){this._watchStateChanges()}_open(e){this.datepicker&&!this.disabled&&(this.datepicker.open(),e.stopPropagation())}_watchStateChanges(){let e=this.datepicker?this.datepicker.stateChanges:vi(),a=this.datepicker&&this.datepicker.datepickerInput?this.datepicker.datepickerInput.stateChanges:vi(),i=this.datepicker?wi(this.datepicker.openedStream,this.datepicker.closedStream):vi();this._stateChanges.unsubscribe(),this._stateChanges=wi(this._intl.changes,e,a,i).subscribe(()=>this._changeDetectorRef.markForCheck())}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=Ye({type:t,selectors:[["mat-datepicker-toggle"]],contentQueries:function(a,i,n){if(a&1&&Ki(n,T_,5),a&2){let s;yt(s=bt())&&(i._customIcon=s.first)}},viewQuery:function(a,i){if(a&1&&zt(u_,5),a&2){let n;yt(n=bt())&&(i._button=n.first)}},hostAttrs:[1,"mat-datepicker-toggle"],hostVars:8,hostBindings:function(a,i){a&1&&ye("click",function(s){return i._open(s)}),a&2&&(xt("tabindex",null)("data-mat-calendar",i.datepicker?i.datepicker.id:null),Dr("mat-datepicker-toggle-active",i.datepicker&&i.datepicker.opened)("mat-accent",i.datepicker&&i.datepicker.color==="accent")("mat-warn",i.datepicker&&i.datepicker.color==="warn"))},inputs:{datepicker:[0,"for","datepicker"],tabIndex:"tabIndex",ariaLabel:[0,"aria-label","ariaLabel"],disabled:[2,"disabled","disabled",Pt],disableRipple:"disableRipple"},exportAs:["matDatepickerToggle"],features:[qr],ngContentSelectors:m_,decls:4,vars:7,consts:[["button",""],["mat-icon-button","","type","button",3,"disabled","disableRipple"],["viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false","aria-hidden","true",1,"mat-datepicker-toggle-default-icon"],["d","M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"]],template:function(a,i){a&1&&(Ga(h_),v(0,"button",1,0),me(2,p_,2,0,":svg:svg",2),za(3),x()),a&2&&(j("disabled",i.disabled)("disableRipple",i.disableRipple),xt("aria-haspopup",i.datepicker?"dialog":null)("aria-label",i.ariaLabel||i._intl.openCalendarLabel)("tabindex",i.disabled?-1:i.tabIndex)("aria-expanded",i.datepicker?i.datepicker.opened:null),P(2),Qn(i._customIcon?-1:2))},dependencies:[Da],styles:[`.mat-datepicker-toggle{pointer-events:auto;color:var(--mat-datepicker-toggle-icon-color, var(--mat-sys-on-surface-variant))}.mat-datepicker-toggle-active{color:var(--mat-datepicker-toggle-active-state-icon-color, var(--mat-sys-on-surface-variant))}@media(forced-colors: active){.mat-datepicker-toggle-default-icon{color:CanvasText}}
`],encapsulation:2,changeDetection:0})}return t})();var zo=(()=>{class t{static \u0275fac=function(a){return new(a||t)};static \u0275mod=Lr({type:t});static \u0275inj=Nr({providers:[wn,C_],imports:[dt,mf,Bd,df,Zr,Hf,ls,Vf,_o]})}return t})();var _c=(()=>{class t{static \u0275fac=function(a){return new(a||t)};static \u0275mod=Lr({type:t});static \u0275inj=Nr({imports:[Zr,Zr]})}return t})();var A_=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/,F_=/^(\d?\d)[:.](\d?\d)(?:[:.](\d?\d))?\s*(AM|PM)?$/i;function gc(t,r){let e=Array(t);for(let a=0;a<t;a++)e[a]=r(a);return e}var O_=(()=>{class t extends tr{useUtcForDisplay=!1;_matDateLocale=Y(nc,{optional:!0});constructor(){super();let e=Y(nc,{optional:!0});e!==void 0&&(this._matDateLocale=e),super.setLocale(this._matDateLocale)}getYear(e){return e.getFullYear()}getMonth(e){return e.getMonth()}getDate(e){return e.getDate()}getDayOfWeek(e){return e.getDay()}getMonthNames(e){let a=new Intl.DateTimeFormat(this.locale,{month:e,timeZone:"utc"});return gc(12,i=>this._format(a,new Date(2017,i,1)))}getDateNames(){let e=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return gc(31,a=>this._format(e,new Date(2017,0,a+1)))}getDayOfWeekNames(e){let a=new Intl.DateTimeFormat(this.locale,{weekday:e,timeZone:"utc"});return gc(7,i=>this._format(a,new Date(2017,0,i+1)))}getYearName(e){let a=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._format(a,e)}getFirstDayOfWeek(){if(typeof Intl<"u"&&Intl.Locale){let e=new Intl.Locale(this.locale),a=(e.getWeekInfo?.()||e.weekInfo)?.firstDay??0;return a===7?0:a}return 0}getNumDaysInMonth(e){return this.getDate(this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+1,0))}clone(e){return new Date(e.getTime())}createDate(e,a,i){let n=this._createDateWithOverflow(e,a,i);return n.getMonth()!=a,n}today(){return new Date}parse(e,a){return typeof e=="number"?new Date(e):e?new Date(Date.parse(e)):null}format(e,a){if(!this.isValid(e))throw Error("NativeDateAdapter: Cannot format invalid date.");let i=new Intl.DateTimeFormat(this.locale,$i(na({},a),{timeZone:"utc"}));return this._format(i,e)}addCalendarYears(e,a){return this.addCalendarMonths(e,a*12)}addCalendarMonths(e,a){let i=this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+a,this.getDate(e));return this.getMonth(i)!=((this.getMonth(e)+a)%12+12)%12&&(i=this._createDateWithOverflow(this.getYear(i),this.getMonth(i),0)),i}addCalendarDays(e,a){return this._createDateWithOverflow(this.getYear(e),this.getMonth(e),this.getDate(e)+a)}toIso8601(e){return[e.getUTCFullYear(),this._2digit(e.getUTCMonth()+1),this._2digit(e.getUTCDate())].join("-")}deserialize(e){if(typeof e=="string"){if(!e)return null;if(A_.test(e)){let a=new Date(e);if(this.isValid(a))return a}}return super.deserialize(e)}isDateInstance(e){return e instanceof Date}isValid(e){return!isNaN(e.getTime())}invalid(){return new Date(NaN)}setTime(e,a,i,n){let s=this.clone(e);return s.setHours(a,i,n,0),s}getHours(e){return e.getHours()}getMinutes(e){return e.getMinutes()}getSeconds(e){return e.getSeconds()}parseTime(e,a){if(typeof e!="string")return e instanceof Date?new Date(e.getTime()):null;let i=e.trim();if(i.length===0)return null;let n=this._parseTimeString(i);if(n===null){let s=i.replace(/[^0-9:(AM|PM)]/gi,"").trim();s.length>0&&(n=this._parseTimeString(s))}return n||this.invalid()}addSeconds(e,a){return new Date(e.getTime()+a*1e3)}_createDateWithOverflow(e,a,i){let n=new Date;return n.setFullYear(e,a,i),n.setHours(0,0,0,0),n}_2digit(e){return("00"+e).slice(-2)}_format(e,a){let i=new Date;return i.setUTCFullYear(a.getFullYear(),a.getMonth(),a.getDate()),i.setUTCHours(a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()),e.format(i)}_parseTimeString(e){let a=e.toUpperCase().match(F_);if(a){let i=parseInt(a[1]),n=parseInt(a[2]),s=a[3]==null?void 0:parseInt(a[3]),o=a[4];if(i===12?i=o==="AM"?0:i:o==="PM"&&(i+=12),xc(i,0,23)&&xc(n,0,59)&&(s==null||xc(s,0,59)))return this.setTime(this.today(),i,n,s||0)}return null}static \u0275fac=function(a){return new(a||t)};static \u0275prov=Er({token:t,factory:t.\u0275fac})}return t})();function xc(t,r,e){return!isNaN(t)&&t>=r&&t<=e}var M_={parse:{dateInput:null,timeInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},timeInput:{hour:"numeric",minute:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"},timeOptionLabel:{hour:"numeric",minute:"numeric"}}};var Gf=(()=>{class t{static \u0275fac=function(a){return new(a||t)};static \u0275mod=Lr({type:t});static \u0275inj=Nr({providers:[cs()]})}return t})();function cs(t=M_){return[{provide:tr,useClass:O_},{provide:ni,useValue:t}]}var vr=class t{apiUrlOrders=rn.apiUrl+"/orders";apiUrl=rn.apiUrl+"/districts";apiUrlSettings=rn.apiUrl+"/settings";http=Y(Td);authService=Y(Fd);constructor(){}getAuthHeaders(){let r=this.authService.getAccessToken();return r?new ec({"Content-Type":"application/json",codrr_token:r}):new ec({"Content-Type":"application/json"})}getOrders(r,e=1,a=10,i="id",n="desc"){let s=new tc().set("page_number",e.toString()).set("page_size",a.toString()).set("sort_field",i).set("sort_direction",n);r&&(r.start_date&&(s=s.set("start_date",r.start_date)),r.end_date&&(s=s.set("end_date",r.end_date)),r.status&&(s=s.set("status",r.status)),r.search_term&&r.search_term.trim()!==""&&(s=s.set("search_term",r.search_term.trim())));let o=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.get(this.apiUrlOrders,{params:s,headers:o}).pipe(Ua(l=>l),oa(this.handleError)):sa(()=>new Error("Not authenticated to fetch users."))}getOrders2(r,e="id",a="desc"){let i=new tc().set("sort_field",e).set("sort_direction",a);r&&(r.start_date&&(i=i.set("start_date",r.start_date)),r.end_date&&(i=i.set("end_date",r.end_date)),r.status&&(i=i.set("status",r.status)),r.search_term&&r.search_term.trim()!==""&&(i=i.set("search_term",r.search_term.trim())));let n=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.get(this.apiUrlOrders+"/filtered-orders",{params:i,headers:n}).pipe(Ua(s=>s.items),oa(this.handleError)):sa(()=>new Error("Not authenticated to fetch users."))}getOrderStatuses(){return new jn(r=>{r.next(["REGISTRADO","RECOGIDO","EN TRANSITO","CANCELADO"]),r.complete()})}getDeliveryDistricts(){let r=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.get(`${this.apiUrl}/all`,{headers:r}).pipe(oa(this.handleError)):sa(()=>new Error("Not authenticated to fetch users."))}updateOrderStatus(r,e,a){let i=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.post(`${this.apiUrlOrders}/update-order-status`,{orderId:r,newStatus:e,reason:a},{headers:i}).pipe(oa(this.handleError)):sa(()=>new Error("Not authenticated to fetch users."))}getMaxPackageDimensions(){let r=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.get(`${this.apiUrlSettings}/all`,{headers:r}).pipe(Wa(e=>console.log("OrderService: API response for max dimensions:",e)),Ua(e=>{if(console.log("apiResponse",e),e.length){let a="Est\xE1ndar : "+e[0].standard_measurements_length+"cmx"+e[0].standard_measurements_width+"cmx"+e[0].standard_measurements_height+"cm "+e[0].standard_measurements_weight+"kg",i="MEDIDAS MAXIMAS (Largo "+e[0].maximum_measurements_length+" cm x Ancho "+e[0].maximum_measurements_width+" cm x Alto "+e[0].maximum_measurements_height+" cm) y PESO MAXIMO ("+e[0].maximum_measurements_weight+" kilogramos)";return{max_length_cm:e[0].maximum_measurements_length,max_width_cm:e[0].maximum_measurements_width,max_height_cm:e[0].maximum_measurements_height,max_weight_kg:e[0].maximum_measurements_weight,sta_length_cm:e[0].standard_measurements_length,sta_width_cm:e[0].standard_measurements_width,sta_height_cm:e[0].standard_measurements_height,sta_weight_kg:e[0].standard_measurements_weight,volumetric_factor:e[0].volumetric_factor,standard_package_info:a,info_text:i}}return{max_length_cm:0,max_width_cm:0,max_height_cm:0,max_weight_kg:0,sta_length_cm:0,sta_width_cm:0,sta_height_cm:0,sta_weight_kg:0,volumetric_factor:0,standard_package_info:"",info_text:""}}),oa(e=>(console.error("OrderService: API error fetching max package dimensions. Details:",e.message),vi({max_length_cm:30,max_width_cm:25,max_height_cm:45,max_weight_kg:5,standard_package_info:"Est\xE1ndar : 30cmx15cmx20cm 1.5kg",info_text:"MEDIDAS MAXIMAS (Largo 30 cm x Ancho 25 cm x Alto 45 cm) y PESO MAXIMO (5 kilogramos)"}).pipe(jl(200))))):sa(()=>new Error("Not authenticated to fetch users."))}calculateShippingCost(r){console.log("packageData",r),console.log("OrderService: Calculating shipping cost (simulated) for",r);let e=8;return r.package_size_type==="custom"&&(e=10,(r.package_weight_kg||0)>2&&(e+=5),((r.package_length_cm||0)>30||(r.package_width_cm||0)>25||(r.package_height_cm||0)>20)&&(e+=4)),r.delivery_district_id==="D003"&&(e+=2),vi({shipping_cost:e}).pipe(jl(500))}createBatchOrders(r){let e=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.post(`${this.apiUrlOrders}/batch-create`,r,{headers:e}).pipe(oa(this.handleError)):sa(()=>new Error("Not authenticated to fetch users."))}importOrdersFromParsedJson(r){console.log("OrderService: Sending parsed JSON to backend for import",r);let e=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.post(`${this.apiUrlOrders}/import-batch-json`,r,{headers:e}).pipe(oa(this.handleImportError)):sa(()=>new Error("Not authenticated to fetch users."))}handleImportError(r){console.error("API Import Error:",r);let e={success:!1,message:"Error de comunicaci\xF3n con el servidor durante la importaci\xF3n.",errors:[{row:0,message:`Error: ${r.status} - ${r.statusText||"Error desconocido"}`}]};return r.error&&typeof r.error=="object"&&"message"in r.error&&(e=na(na({},e),r.error)),sa(()=>e)}handleError(r){let e="An unknown error occurred!";return r.error instanceof ErrorEvent?e=`Error: ${r.error.message}`:(e=`Error Code: ${r.status}
Message: ${r.message||r.error?.message||"Server error"}`,r.status===0&&(e="Could not connect to the server. Please check your network or if the server is running.")),console.error("API Error in OrderService:",r),sa(()=>new Error(e))}static \u0275fac=function(e){return new(e||t)};static \u0275prov=Er({token:t,factory:t.\u0275fac,providedIn:"root"})};function I_(t,r){if(t&1&&(v(0,"mat-option",8),b(1),x()),t&2){let e=r.$implicit;j("value",e),P(),Ce(" ",e," ")}}var Yo=class t{filtersChanged=new ke;filterForm;orderStatuses$;orderService=Y(vr);fb=Y(ho);datePipe=Y(gr);destroy$=new Pe;constructor(){this.filterForm=this.fb.group({start_date:[null],end_date:[null],status:[null],search_term:[""]}),this.orderStatuses$=this.orderService.getOrderStatuses()}ngOnInit(){this.filterForm.valueChanges.pipe(gt(this.destroy$),ud(400),Xi((r,e)=>JSON.stringify(r)===JSON.stringify(e))).subscribe(()=>{this.applyFilters()})}applyFilters(){let r=this.filterForm.value,e={start_date:r.start_date?this.datePipe.transform(r.start_date,"yyyy-MM-dd"):null,end_date:r.end_date?this.datePipe.transform(r.end_date,"yyyy-MM-dd"):null,status:r.status||null,search_term:r.search_term?.trim()||null};console.log("OrderFiltersComponent: Emitting filters",e),this.filtersChanged.emit(e)}clearFilters(){this.filterForm.reset({start_date:null,end_date:null,status:null,search_term:""})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=Ye({type:t,selectors:[["app-order-filters"]],outputs:{filtersChanged:"filtersChanged"},features:[ur([cs(),gr])],decls:32,vars:9,consts:[["startDatePicker",""],["endDatePicker",""],[1,"filters-container",3,"formGroup"],["appearance","outline"],["matInput","","formControlName","start_date","placeholder","mm/dd/yyyy",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","end_date","placeholder","mm/dd/yyyy",3,"matDatepicker"],["formControlName","status","placeholder","Seleccione estado..."],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"filter-actions"],["mat-stroked-button","","color","primary","type","button",3,"click"],["mat-stroked-button","","type","button",3,"click"]],template:function(e,a){if(e&1){let i=tt();v(0,"form",2)(1,"mat-form-field",3)(2,"mat-label"),b(3,"Fecha de entrega inicio"),x(),Ae(4,"input",4)(5,"mat-datepicker-toggle",5)(6,"mat-datepicker",null,0),x(),v(8,"mat-form-field",3)(9,"mat-label"),b(10,"Fecha de entrega fin"),x(),Ae(11,"input",6)(12,"mat-datepicker-toggle",5)(13,"mat-datepicker",null,1),x(),v(15,"mat-form-field",3)(16,"mat-label"),b(17,"Estado"),x(),v(18,"mat-select",7)(19,"mat-option",8),b(20,"Todos"),x(),me(21,I_,2,2,"mat-option",9),Ve(22,"async"),x()(),v(23,"div",10)(24,"button",11),ye("click",function(){return De(i),Te(a.applyFilters())}),v(25,"mat-icon"),b(26,"search"),x(),b(27," Buscar "),x(),v(28,"button",12),ye("click",function(){return De(i),Te(a.clearFilters())}),v(29,"mat-icon"),b(30,"clear_all"),x(),b(31," Limpiar "),x()()()}if(e&2){let i=Tr(7),n=Tr(14);j("formGroup",a.filterForm),P(4),j("matDatepicker",i),P(),j("for",i),P(6),j("matDatepicker",n),P(),j("for",n),P(7),j("value",null),P(2),j("ngForOf",Bt(22,7,a.orderStatuses$))}},dependencies:[Tt,ca,Ji,Ka,fo,nn,da,sn,Ei,on,ha,ua,fa,mo,Za,ln,zo,Go,yn,ls,Gf,ii,ai,ri,dt,Rt,er,xr],styles:[".filters-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:16px;align-items:flex-start;padding:16px;background-color:#fff;border-radius:8px;margin-bottom:20px;box-shadow:0 1px 3px #00000014}mat-form-field[_ngcontent-%COMP%]{min-width:200px;flex-grow:1}.filter-actions[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;padding-top:8px}@media (max-width: 768px){mat-form-field[_ngcontent-%COMP%]{width:calc(50% - 8px);min-width:unset}.filter-actions[_ngcontent-%COMP%]{width:100%;justify-content:flex-end;padding-top:16px}}@media (max-width: 480px){mat-form-field[_ngcontent-%COMP%]{width:100%}}"]})};var Si=(l=>(l.REGISTRADO="REGISTRADO",l.RECOGIDO="RECOGIDO",l.EN_ALMACEN="EN ALMACEN",l.EN_TRANSITO="EN TRANSITO",l.ENTREGADO="ENTREGADO",l.CANCELADO="CANCELADO",l.RECHAZADO="RECHAZADO",l.REPROGRAMADO="REPROGRAMADO",l))(Si||{});function P_(t,r){if(t&1&&(v(0,"mat-option",14),b(1),Ve(2,"titlecase"),x()),t&2){let e=r.$implicit;j("value",e),P(),Ce(" ",Bt(2,2,e)," ")}}function R_(t,r){t&1&&(v(0,"mat-error"),b(1,"Debe seleccionar un nuevo estado."),x())}var jo=class t{constructor(r,e){this.dialogRef=r;this.data=e}selectedStatus;reason="";showReasonField=!1;formSubmitted=!1;OrderStatusEnum=Si;ngOnInit(){}onStatusChange(r){this.selectedStatus=r.value,this.checkIfReasonIsNeeded(this.selectedStatus)}checkIfReasonIsNeeded(r){if(!r){this.showReasonField=!1;return}this.showReasonField=this.isReasonMandatory(r)}isReasonMandatory(r){let e=r||this.selectedStatus;return e?["CANCELADO","REPROGRAMADO"].includes(e):!1}getStatusClass(r){if(!r)return"status-desconocido";let e=r.toLowerCase().replace(/[\s_]+/g,"-");return console.log("`status-${formattedStatus}`",`status-${e}`),`status-${e}`}isConfirmDisabled(){return!!(!this.selectedStatus||this.isReasonMandatory(this.selectedStatus)&&(!this.reason||this.reason.trim()===""))}onConfirm(){this.formSubmitted=!0,!this.isConfirmDisabled()&&this.dialogRef.close({newStatus:this.selectedStatus,reason:this.showReasonField?this.reason.trim():void 0})}onCancel(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||t)(ji(fn),ji(Co))};static \u0275cmp=Ye({type:t,selectors:[["app-change-status-dialog"]],decls:24,vars:9,consts:[[1,"dialog-container"],[1,"dialog-header"],["mat-dialog-title",""],[1,"order-code-chip"],[1,"dialog-content"],[1,"current-status-container"],[1,"status-badge",3,"ngClass"],["appearance","outline",1,"full-width","select-status-field"],["name","newStatus","required","",3,"ngModelChange","selectionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["align","end",1,"dialog-actions"],["mat-stroked-button","",1,"cancel-button",3,"click"],["mat-flat-button","","color","primary",1,"confirm-button",3,"click","disabled"],[3,"value"]],template:function(e,a){e&1&&(v(0,"div",0)(1,"div",1)(2,"h2",2),b(3,"Cambiar Estado del Pedido"),x(),v(4,"span",3),b(5),x()(),v(6,"mat-dialog-content",4)(7,"div",5)(8,"span"),b(9,"Estado Actual:"),x(),v(10,"span",6),b(11),Ve(12,"titlecase"),x()(),v(13,"mat-form-field",7)(14,"mat-label"),b(15,"Seleccionar Nuevo Estado"),x(),v(16,"mat-select",8),Qi("ngModelChange",function(n){return Zi(a.selectedStatus,n)||(a.selectedStatus=n),n}),ye("selectionChange",function(n){return a.onStatusChange(n)}),me(17,P_,3,4,"mat-option",9),x(),me(18,R_,2,0,"mat-error",10),x()(),v(19,"mat-dialog-actions",11)(20,"button",12),ye("click",function(){return a.onCancel()}),b(21," Cancelar "),x(),v(22,"button",13),ye("click",function(){return a.onConfirm()}),b(23," Confirmar Cambio "),x()()()),e&2&&(P(5),Ce("Pedido N\xB0: ",a.data.order.code,""),P(5),j("ngClass",a.getStatusClass(a.data.order.status)),P(),Ce(" ",Bt(12,7,a.data.order.status)," "),P(5),qi("ngModel",a.selectedStatus),P(),j("ngForOf",a.data.availableStatuses),P(),j("ngIf",a.formSubmitted&&!a.selectedStatus),P(4),j("disabled",a.isConfirmDisabled()))},dependencies:[Tt,la,ca,Qt,en,qd,da,Kd,$d,ti,un,mn,hn,ha,ua,fa,qa,ii,ai,ri,Za,dt,Rt,tf],styles:[".dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:80vh}.dialog-header[_ngcontent-%COMP%]{padding:20px 24px 0;border-bottom:1px solid rgba(0,0,0,.12);margin-bottom:20px}.dialog-header[_ngcontent-%COMP%]   h2.mat-mdc-dialog-title[_ngcontent-%COMP%]{margin-bottom:4px;font-size:1.5em;font-weight:500;color:#333}.order-code-chip[_ngcontent-%COMP%]{display:inline-block;font-size:.85em;color:#555;background-color:#f0f0f0;padding:4px 10px;border-radius:16px;margin-bottom:16px;font-family:Consolas,Monaco,monospace}.dialog-content[_ngcontent-%COMP%]{padding:0 24px 20px;overflow-y:auto;flex-grow:1}.current-status-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:24px;font-size:1em;color:#444}.current-status-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{margin-right:8px}.status-badge[_ngcontent-%COMP%]{padding:5px 12px;border-radius:16px;font-size:.8rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;display:inline-flex;align-items:center;line-height:1;color:#fff}.status-registrado[_ngcontent-%COMP%]{background-color:#6610f2;color:#fff}.status-recogido[_ngcontent-%COMP%]{background-color:#fd7e14;color:#fff}.status-en-almacen[_ngcontent-%COMP%]{background-color:#0d6efd;color:#fff}.status-en-transito[_ngcontent-%COMP%]{background-color:#0c1a77;color:#d0c8c8}.status-entregado[_ngcontent-%COMP%]{background-color:#198754;color:#fff}.status-no-entregado[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.status-cancelado[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.status-rechazado[_ngcontent-%COMP%]{background-color:#ff6b6b;color:#fff}.status-reprogramado[_ngcontent-%COMP%]{background-color:#adb5bd;color:#212529}.full-width[_ngcontent-%COMP%]{width:100%}.select-status-field[_ngcontent-%COMP%]{margin-bottom:20px}.reason-field[_ngcontent-%COMP%]{margin-top:10px}.reason-field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{min-height:60px}.dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid rgba(0,0,0,.12);background-color:#f9f9f9}.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{margin-right:8px}[_nghost-%COMP%]     .mat-mdc-form-field-subscript-wrapper{min-height:1.25em;height:auto}"]})};var Ko=class{tracker;columnIndex=0;rowIndex=0;get rowCount(){return this.rowIndex+1}get rowspan(){let r=Math.max(...this.tracker);return r>1?this.rowCount+r-1:this.rowCount}positions;update(r,e){this.columnIndex=0,this.rowIndex=0,this.tracker=new Array(r),this.tracker.fill(0,0,this.tracker.length),this.positions=e.map(a=>this._trackTile(a))}_trackTile(r){let e=this._findMatchingGap(r.colspan);return this._markTilePosition(e,r),this.columnIndex=e+r.colspan,new wc(this.rowIndex,e)}_findMatchingGap(r){r>this.tracker.length;let e=-1,a=-1;do{if(this.columnIndex+r>this.tracker.length){this._nextRow(),e=this.tracker.indexOf(0,this.columnIndex),a=this._findGapEndIndex(e);continue}if(e=this.tracker.indexOf(0,this.columnIndex),e==-1){this._nextRow(),e=this.tracker.indexOf(0,this.columnIndex),a=this._findGapEndIndex(e);continue}a=this._findGapEndIndex(e),this.columnIndex=e+1}while(a-e<r||a==0);return Math.max(e,0)}_nextRow(){this.columnIndex=0,this.rowIndex++;for(let r=0;r<this.tracker.length;r++)this.tracker[r]=Math.max(0,this.tracker[r]-1)}_findGapEndIndex(r){for(let e=r+1;e<this.tracker.length;e++)if(this.tracker[e]!=0)return e;return this.tracker.length}_markTilePosition(r,e){for(let a=0;a<e.colspan;a++)this.tracker[r+a]=e.rowspan}},wc=class{row;col;constructor(r,e){this.row=r,this.col=e}};var $f=["*"];var N_=`.mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}.mat-grid-tile-header{font-size:var(--mat-grid-list-tile-header-primary-text-size, var(--mat-sys-body-large))}.mat-grid-tile-header .mat-line{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;box-sizing:border-box}.mat-grid-tile-header .mat-line:nth-child(n+2){font-size:var(--mat-grid-list-tile-header-secondary-text-size, var(--mat-sys-body-medium))}.mat-grid-tile-footer{font-size:var(--mat-grid-list-tile-footer-primary-text-size, var(--mat-sys-body-large))}.mat-grid-tile-footer .mat-line{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;box-sizing:border-box}.mat-grid-tile-footer .mat-line:nth-child(n+2){font-size:var(--mat-grid-list-tile-footer-secondary-text-size, var(--mat-sys-body-medium))}.mat-grid-tile-content{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}
`,Xf=new Kt("MAT_GRID_LIST"),kc=(()=>{class t{_element=Y(Sr);_gridList=Y(Xf,{optional:!0});_rowspan=1;_colspan=1;constructor(){}get rowspan(){return this._rowspan}set rowspan(e){this._rowspan=Math.round(an(e))}get colspan(){return this._colspan}set colspan(e){this._colspan=Math.round(an(e))}_setStyle(e,a){this._element.nativeElement.style[e]=a}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=Ye({type:t,selectors:[["mat-grid-tile"]],hostAttrs:[1,"mat-grid-tile"],hostVars:2,hostBindings:function(a,i){a&2&&xt("rowspan",i.rowspan)("colspan",i.colspan)},inputs:{rowspan:"rowspan",colspan:"colspan"},exportAs:["matGridTile"],ngContentSelectors:$f,decls:2,vars:0,consts:[[1,"mat-grid-tile-content"]],template:function(a,i){a&1&&(Ga(),v(0,"div",0),za(1),x())},styles:[`.mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}.mat-grid-tile-header{font-size:var(--mat-grid-list-tile-header-primary-text-size, var(--mat-sys-body-large))}.mat-grid-tile-header .mat-line{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;box-sizing:border-box}.mat-grid-tile-header .mat-line:nth-child(n+2){font-size:var(--mat-grid-list-tile-header-secondary-text-size, var(--mat-sys-body-medium))}.mat-grid-tile-footer{font-size:var(--mat-grid-list-tile-footer-primary-text-size, var(--mat-sys-body-large))}.mat-grid-tile-footer .mat-line{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;box-sizing:border-box}.mat-grid-tile-footer .mat-line:nth-child(n+2){font-size:var(--mat-grid-list-tile-footer-secondary-text-size, var(--mat-sys-body-medium))}.mat-grid-tile-content{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}
`],encapsulation:2,changeDetection:0})}return t})();var L_=/^-?\d+((\.\d+)?[A-Za-z%$]?)+$/,ds=class{_gutterSize;_rows=0;_rowspan=0;_cols;_direction;init(r,e,a,i){this._gutterSize=jf(r),this._rows=e.rowCount,this._rowspan=e.rowspan,this._cols=a,this._direction=i}getBaseTileSize(r,e){return`(${r}% - (${this._gutterSize} * ${e}))`}getTilePosition(r,e){return e===0?"0":Di(`(${r} + ${this._gutterSize}) * ${e}`)}getTileSize(r,e){return`(${r} * ${e}) + (${e-1} * ${this._gutterSize})`}setStyle(r,e,a){let i=100/this._cols,n=(this._cols-1)/this._cols;this.setColStyles(r,a,i,n),this.setRowStyles(r,e,i,n)}setColStyles(r,e,a,i){let n=this.getBaseTileSize(a,i),s=this._direction==="rtl"?"right":"left";r._setStyle(s,this.getTilePosition(n,e)),r._setStyle("width",Di(this.getTileSize(n,r.colspan)))}getGutterSpan(){return`${this._gutterSize} * (${this._rowspan} - 1)`}getTileSpan(r){return`${this._rowspan} * ${this.getTileSize(r,1)}`}getComputedHeight(){return null}},yc=class extends ds{fixedRowHeight;constructor(r){super(),this.fixedRowHeight=r}init(r,e,a,i){super.init(r,e,a,i),this.fixedRowHeight=jf(this.fixedRowHeight),L_.test(this.fixedRowHeight)}setRowStyles(r,e){r._setStyle("top",this.getTilePosition(this.fixedRowHeight,e)),r._setStyle("height",Di(this.getTileSize(this.fixedRowHeight,r.rowspan)))}getComputedHeight(){return["height",Di(`${this.getTileSpan(this.fixedRowHeight)} + ${this.getGutterSpan()}`)]}reset(r){r._setListStyle(["height",null]),r._tiles&&r._tiles.forEach(e=>{e._setStyle("top",null),e._setStyle("height",null)})}},bc=class extends ds{rowHeightRatio;baseTileHeight;constructor(r){super(),this._parseRatio(r)}setRowStyles(r,e,a,i){let n=a/this.rowHeightRatio;this.baseTileHeight=this.getBaseTileSize(n,i),r._setStyle("marginTop",this.getTilePosition(this.baseTileHeight,e)),r._setStyle("paddingTop",Di(this.getTileSize(this.baseTileHeight,r.rowspan)))}getComputedHeight(){return["paddingBottom",Di(`${this.getTileSpan(this.baseTileHeight)} + ${this.getGutterSpan()}`)]}reset(r){r._setListStyle(["paddingBottom",null]),r._tiles.forEach(e=>{e._setStyle("marginTop",null),e._setStyle("paddingTop",null)})}_parseRatio(r){let e=r.split(":");e.length,this.rowHeightRatio=parseFloat(e[0])/parseFloat(e[1])}},Cc=class extends ds{setRowStyles(r,e){let a=100/this._rowspan,i=(this._rows-1)/this._rows,n=this.getBaseTileSize(a,i);r._setStyle("top",this.getTilePosition(n,e)),r._setStyle("height",Di(this.getTileSize(n,r.rowspan)))}reset(r){r._tiles&&r._tiles.forEach(e=>{e._setStyle("top",null),e._setStyle("height",null)})}};function Di(t){return`calc(${t})`}function jf(t){return t.match(/([A-Za-z%]+)$/)?t:`${t}px`}var B_="fit",Kf=(()=>{class t{_element=Y(Sr);_dir=Y(Sa,{optional:!0});_cols;_tileCoordinator;_rowHeight;_gutter="1px";_tileStyler;_tiles;constructor(){}get cols(){return this._cols}set cols(e){this._cols=Math.max(1,Math.round(an(e)))}get gutterSize(){return this._gutter}set gutterSize(e){this._gutter=`${e??""}`}get rowHeight(){return this._rowHeight}set rowHeight(e){let a=`${e??""}`;a!==this._rowHeight&&(this._rowHeight=a,this._setTileStyler(this._rowHeight))}ngOnInit(){this._checkCols(),this._checkRowHeight()}ngAfterContentChecked(){this._layoutTiles()}_checkCols(){this.cols}_checkRowHeight(){this._rowHeight||this._setTileStyler("1:1")}_setTileStyler(e){this._tileStyler&&this._tileStyler.reset(this),e===B_?this._tileStyler=new Cc:e&&e.indexOf(":")>-1?this._tileStyler=new bc(e):this._tileStyler=new yc(e)}_layoutTiles(){this._tileCoordinator||(this._tileCoordinator=new Ko);let e=this._tileCoordinator,a=this._tiles.filter(n=>!n._gridList||n._gridList===this),i=this._dir?this._dir.value:"ltr";this._tileCoordinator.update(this.cols,a),this._tileStyler.init(this.gutterSize,e,this.cols,i),a.forEach((n,s)=>{let o=e.positions[s];this._tileStyler.setStyle(n,o.row,o.col)}),this._setListStyle(this._tileStyler.getComputedHeight())}_setListStyle(e){e&&(this._element.nativeElement.style[e[0]]=e[1])}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=Ye({type:t,selectors:[["mat-grid-list"]],contentQueries:function(a,i,n){if(a&1&&Ki(n,kc,5),a&2){let s;yt(s=bt())&&(i._tiles=s)}},hostAttrs:[1,"mat-grid-list"],hostVars:1,hostBindings:function(a,i){a&2&&xt("cols",i.cols)},inputs:{cols:"cols",gutterSize:"gutterSize",rowHeight:"rowHeight"},exportAs:["matGridList"],features:[ur([{provide:Xf,useExisting:t}])],ngContentSelectors:$f,decls:2,vars:0,template:function(a,i){a&1&&(Ga(),v(0,"div"),za(1),x())},styles:[N_],encapsulation:2,changeDetection:0})}return t})(),qf=(()=>{class t{static \u0275fac=function(a){return new(a||t)};static \u0275mod=Lr({type:t});static \u0275inj=Nr({imports:[_c,Zr,_c,Zr]})}return t})();function du(t){let r=t.cloneNode(!0),e=r.querySelectorAll("[id]"),a=t.nodeName.toLowerCase();r.removeAttribute("id");for(let i=0;i<e.length;i++)e[i].removeAttribute("id");return a==="canvas"?Jf(t,r):(a==="input"||a==="select"||a==="textarea")&&Qf(t,r),Zf("canvas",t,r,Jf),Zf("input, textarea, select",t,r,Qf),r}function Zf(t,r,e,a){let i=r.querySelectorAll(t);if(i.length){let n=e.querySelectorAll(t);for(let s=0;s<i.length;s++)a(i[s],n[s])}}var U_=0;function Qf(t,r){r.type!=="file"&&(r.value=t.value),r.type==="radio"&&r.name&&(r.name=`mat-clone-${r.name}-${U_++}`)}function Jf(t,r){let e=r.getContext("2d");if(e)try{e.drawImage(t,0,0)}catch{}}function Ic(t){let r=t.getBoundingClientRect();return{top:r.top,right:r.right,bottom:r.bottom,left:r.left,width:r.width,height:r.height,x:r.x,y:r.y}}function Dc(t,r,e){let{top:a,bottom:i,left:n,right:s}=t;return e>=a&&e<=i&&r>=n&&r<=s}function hs(t,r,e){t.top+=r,t.bottom=t.top+t.height,t.left+=e,t.right=t.left+t.width}function eu(t,r,e,a){let{top:i,right:n,bottom:s,left:o,width:l,height:c}=t,d=l*r,f=c*r;return a>i-f&&a<s+f&&e>o-d&&e<n+d}var qo=class{_document;positions=new Map;constructor(r){this._document=r}clear(){this.positions.clear()}cache(r){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),r.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:Ic(e)})})}handleScroll(r){let e=rs(r),a=this.positions.get(e);if(!a)return null;let i=a.scrollPosition,n,s;if(e===this._document){let c=this.getViewportScrollPosition();n=c.top,s=c.left}else n=e.scrollTop,s=e.scrollLeft;let o=i.top-n,l=i.left-s;return this.positions.forEach((c,d)=>{c.clientRect&&e!==d&&e.contains(d)&&hs(c.clientRect,o,l)}),i.top=n,i.left=s,{top:o,left:l}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function fu(t,r){let e=t.rootNodes;if(e.length===1&&e[0].nodeType===r.ELEMENT_NODE)return e[0];let a=r.createElement("div");return e.forEach(i=>a.appendChild(i)),a}function Pc(t,r,e){for(let a in r)if(r.hasOwnProperty(a)){let i=r[a];i?t.setProperty(a,i,e?.has(a)?"important":""):t.removeProperty(a)}return t}function Cn(t,r){let e=r?"":"none";Pc(t.style,{"touch-action":r?"":"none","-webkit-user-drag":r?"":"none","-webkit-tap-highlight-color":r?"":"transparent","user-select":e,"-ms-user-select":e,"-webkit-user-select":e,"-moz-user-select":e})}function tu(t,r,e){Pc(t.style,{position:r?"":"fixed",top:r?"":"0",opacity:r?"":"0",left:r?"":"-999em"},e)}function Zo(t,r){return r&&r!="none"?t+" "+r:t}function ru(t,r){t.style.width=`${r.width}px`,t.style.height=`${r.height}px`,t.style.transform=Qo(r.left,r.top)}function Qo(t,r){return`translate3d(${Math.round(t)}px, ${Math.round(r)}px, 0)`}function au(t){let r=t.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(t)*r}function H_(t){let r=getComputedStyle(t),e=Ec(r,"transition-property"),a=e.find(o=>o==="transform"||o==="all");if(!a)return 0;let i=e.indexOf(a),n=Ec(r,"transition-duration"),s=Ec(r,"transition-delay");return au(n[i])+au(s[i])}function Ec(t,r){return t.getPropertyValue(r).split(",").map(a=>a.trim())}var W_=new Set(["position"]),Tc=class{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_renderer;_previewEmbeddedView;_preview;get element(){return this._preview}constructor(r,e,a,i,n,s,o,l,c,d){this._document=r,this._rootElement=e,this._direction=a,this._initialDomRect=i,this._previewTemplate=n,this._previewClass=s,this._pickupPositionOnPage=o,this._initialTransform=l,this._zIndex=c,this._renderer=d}attach(r){this._preview=this._createPreview(),r.appendChild(this._preview),iu(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(r){this._preview.style.transform=r}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(r){this._preview.classList.add(r)}getTransitionDuration(){return H_(this._preview)}addEventListener(r,e){return this._renderer.listen(this._preview,r,e)}_createPreview(){let r=this._previewTemplate,e=this._previewClass,a=r?r.template:null,i;if(a&&r){let n=r.matchSize?this._initialDomRect:null,s=r.viewContainer.createEmbeddedView(a,r.context);s.detectChanges(),i=fu(s,this._document),this._previewEmbeddedView=s,r.matchSize?ru(i,n):i.style.transform=Qo(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else i=du(this._rootElement),ru(i,this._initialDomRect),this._initialTransform&&(i.style.transform=this._initialTransform);return Pc(i.style,{"pointer-events":"none",margin:iu(i)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},W_),Cn(i,!1),i.classList.add("cdk-drag-preview"),i.setAttribute("popover","manual"),i.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(n=>i.classList.add(n)):i.classList.add(e)),i}};function iu(t){return"showPopover"in t}var G_={passive:!0},nu={passive:!1},z_={passive:!1,capture:!0},Y_=800,su=new Set(["position"]),Ac=class{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_renderer;_rootElementCleanups;_cleanupShadowRootSelectStart;_preview;_previewContainer;_placeholderRef;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_anchor;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=qt(!1);_hasMoved;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new Pe;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement;_rootElementTapHighlight;_pointerMoveSubscription=jt.EMPTY;_pointerUpSubscription=jt.EMPTY;_scrollSubscription=jt.EMPTY;_resizeSubscription=jt.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef;_cachedShadowRoot;lockAxis;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(r){r!==this._disabled&&(this._disabled=r,this._toggleNativeDragInteractions(),this._handles.forEach(e=>Cn(e,r)))}_disabled=!1;beforeStarted=new Pe;started=new Pe;released=new Pe;ended=new Pe;entered=new Pe;exited=new Pe;dropped=new Pe;moved=this._moveEvents;data;constrainPosition;constructor(r,e,a,i,n,s,o){this._config=e,this._document=a,this._ngZone=i,this._viewportRuler=n,this._dragDropRegistry=s,this._renderer=o,this.withRootElement(r).withParent(e.parentDragRef||null),this._parentPositions=new qo(a),s.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(r){this._handles=r.map(a=>$a(a)),this._handles.forEach(a=>Cn(a,this.disabled)),this._toggleNativeDragInteractions();let e=new Set;return this._disabledHandles.forEach(a=>{this._handles.indexOf(a)>-1&&e.add(a)}),this._disabledHandles=e,this}withPreviewTemplate(r){return this._previewTemplate=r,this}withPlaceholderTemplate(r){return this._placeholderTemplate=r,this}withRootElement(r){let e=$a(r);return e!==this._rootElement&&(this._removeRootElementListeners(),this._rootElementCleanups=this._ngZone.runOutsideAngular(()=>[Jt(this._renderer,e,"mousedown",this._pointerDown,nu),Jt(this._renderer,e,"touchstart",this._pointerDown,G_),Jt(this._renderer,e,"dragstart",this._nativeDragStart,nu)]),this._initialTransform=void 0,this._rootElement=e),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(r){return this._boundaryElement=r?$a(r):null,this._resizeSubscription.unsubscribe(),r&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(r){return this._parentDragRef=r,this}dispose(){this._removeRootElementListeners(),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(r){!this._disabledHandles.has(r)&&this._handles.indexOf(r)>-1&&(this._disabledHandles.add(r),Cn(r,!0))}enableHandle(r){this._disabledHandles.has(r)&&(this._disabledHandles.delete(r),Cn(r,this.disabled))}withDirection(r){return this._direction=r,this}_withDropContainer(r){this._dropContainer=r}getFreeDragPosition(){let r=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:r.x,y:r.y}}setFreeDragPosition(r){return this._activeTransform={x:0,y:0},this._passiveTransform.x=r.x,this._passiveTransform.y=r.y,this._dropContainer||this._applyRootElementTransform(r.x,r.y),this}withPreviewContainer(r){return this._previewContainer=r,this}_sortFromLastPointerPosition(){let r=this._lastKnownPointerPosition;r&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(r),r)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._cleanupShadowRootSelectStart?.(),this._cleanupShadowRootSelectStart=void 0}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_pointerDown=r=>{if(this.beforeStarted.next(),this._handles.length){let e=this._getTargetHandle(r);e&&!this._disabledHandles.has(e)&&!this.disabled&&this._initializeDragSequence(e,r)}else this.disabled||this._initializeDragSequence(this._rootElement,r)};_pointerMove=r=>{let e=this._getPointerPositionOnPage(r);if(!this._hasStartedDragging()){let i=Math.abs(e.x-this._pickupPositionOnPage.x),n=Math.abs(e.y-this._pickupPositionOnPage.y);if(i+n>=this._config.dragStartThreshold){let o=Date.now()>=this._dragStartTime+this._getDragStartDelay(r),l=this._dropContainer;if(!o){this._endDragSequence(r);return}(!l||!l.isDragging()&&!l.isReceiving())&&(r.cancelable&&r.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(r)))}return}r.cancelable&&r.preventDefault();let a=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(a),this._dropContainer)this._updateActiveDropContainer(a,e);else{let i=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,n=this._activeTransform;n.x=a.x-i.x+this._passiveTransform.x,n.y=a.y-i.y+this._passiveTransform.y,this._applyRootElementTransform(n.x,n.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:a,event:r,distance:this._getDragDistance(a),delta:this._pointerDirectionDelta})})};_pointerUp=r=>{this._endDragSequence(r)};_endDragSequence(r){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:r}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(r),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let e=this._getPointerPositionOnPage(r);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e,event:r})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(r){fs(r)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let e=this._getShadowRoot(),a=this._dropContainer;if(e&&this._ngZone.runOutsideAngular(()=>{this._cleanupShadowRootSelectStart=Jt(this._renderer,e,"selectstart",$_,z_)}),a){let i=this._rootElement,n=i.parentNode,s=this._placeholder=this._createPlaceholderElement(),o=this._anchor=this._anchor||this._document.createComment("");n.insertBefore(o,i),this._initialTransform=i.style.transform||"",this._preview=new Tc(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3,this._renderer),this._preview.attach(this._getPreviewInsertionPoint(n,e)),tu(i,!1,su),this._document.body.appendChild(n.replaceChild(s,i)),this.started.next({source:this,event:r}),a.start(),this._initialContainer=a,this._initialIndex=a.getItemIndex(this)}else this.started.next({source:this,event:r}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(a?a.getScrollableParents():[])}_initializeDragSequence(r,e){this._parentDragRef&&e.stopPropagation();let a=this.isDragging(),i=fs(e),n=!i&&e.button!==0,s=this._rootElement,o=rs(e),l=!i&&this._lastTouchEventTime&&this._lastTouchEventTime+Y_>Date.now(),c=i?Md(e):Od(e);if(o&&o.draggable&&e.type==="mousedown"&&e.preventDefault(),a||n||l||c)return;if(this._handles.length){let h=s.style;this._rootElementTapHighlight=h.webkitTapHighlightColor||"",h.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(h=>this._updateOnScroll(h)),this._boundaryElement&&(this._boundaryRect=Ic(this._boundaryElement));let d=this._previewTemplate;this._pickupPositionInElement=d&&d.template&&!d.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,r,e);let f=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:f.x,y:f.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(r){tu(this._rootElement,!0,su),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let e=this._dropContainer,a=e.getItemIndex(this),i=this._getPointerPositionOnPage(r),n=this._getDragDistance(i),s=e._isOverContainer(i.x,i.y);this.ended.next({source:this,distance:n,dropPoint:i,event:r}),this.dropped.next({item:this,currentIndex:a,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:s,distance:n,dropPoint:i,event:r}),e.drop(this,a,this._initialIndex,this._initialContainer,s,n,i,r),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:r,y:e},{x:a,y:i}){let n=this._initialContainer._getSiblingContainerFromPosition(this,r,e);!n&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(r,e)&&(n=this._initialContainer),n&&n!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=n,this._dropContainer.enter(this,r,e,n===this._initialContainer&&n.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:n,currentIndex:n.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(a,i),this._dropContainer._sortItem(this,r,e,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(r,e):this._applyPreviewTransform(r-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let r=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(r.left,r.top);let e=this._preview.getTransitionDuration();return e===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(a=>{let i=o=>{(!o||this._preview&&rs(o)===this._preview.element&&o.propertyName==="transform")&&(s(),a(),clearTimeout(n))},n=setTimeout(i,e*1.5),s=this._preview.addEventListener("transitionend",i)}))}_createPlaceholderElement(){let r=this._placeholderTemplate,e=r?r.template:null,a;return e?(this._placeholderRef=r.viewContainer.createEmbeddedView(e,r.context),this._placeholderRef.detectChanges(),a=fu(this._placeholderRef,this._document)):a=du(this._rootElement),a.style.pointerEvents="none",a.classList.add("cdk-drag-placeholder"),a}_getPointerPositionInElement(r,e,a){let i=e===this._rootElement?null:e,n=i?i.getBoundingClientRect():r,s=fs(a)?a.targetTouches[0]:a,o=this._getViewportScrollPosition(),l=s.pageX-n.left-o.left,c=s.pageY-n.top-o.top;return{x:n.left-r.left+l,y:n.top-r.top+c}}_getPointerPositionOnPage(r){let e=this._getViewportScrollPosition(),a=fs(r)?r.touches[0]||r.changedTouches[0]||{pageX:0,pageY:0}:r,i=a.pageX-e.left,n=a.pageY-e.top;if(this._ownerSVGElement){let s=this._ownerSVGElement.getScreenCTM();if(s){let o=this._ownerSVGElement.createSVGPoint();return o.x=i,o.y=n,o.matrixTransform(s.inverse())}}return{x:i,y:n}}_getConstrainedPointerPosition(r){let e=this._dropContainer?this._dropContainer.lockAxis:null,{x:a,y:i}=this.constrainPosition?this.constrainPosition(r,this,this._initialDomRect,this._pickupPositionInElement):r;if(this.lockAxis==="x"||e==="x"?i=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||e==="y")&&(a=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:n,y:s}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,o=this._boundaryRect,{width:l,height:c}=this._getPreviewRect(),d=o.top+s,f=o.bottom-(c-s),h=o.left+n,m=o.right-(l-n);a=ou(a,h,m),i=ou(i,d,f)}return{x:a,y:i}}_updatePointerDirectionDelta(r){let{x:e,y:a}=r,i=this._pointerDirectionDelta,n=this._pointerPositionAtLastDirectionChange,s=Math.abs(e-n.x),o=Math.abs(a-n.y);return s>this._config.pointerDirectionChangeThreshold&&(i.x=e>n.x?1:-1,n.x=e),o>this._config.pointerDirectionChangeThreshold&&(i.y=a>n.y?1:-1,n.y=a),i}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let r=this._handles.length>0||!this.isDragging();r!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=r,Cn(this._rootElement,r))}_removeRootElementListeners(){this._rootElementCleanups?.forEach(r=>r()),this._rootElementCleanups=void 0}_applyRootElementTransform(r,e){let a=1/this.scale,i=Qo(r*a,e*a),n=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=n.transform&&n.transform!="none"?n.transform:""),n.transform=Zo(i,this._initialTransform)}_applyPreviewTransform(r,e){let a=this._previewTemplate?.template?void 0:this._initialTransform,i=Qo(r,e);this._preview.setTransform(Zo(i,a))}_getDragDistance(r){let e=this._pickupPositionOnPage;return e?{x:r.x-e.x,y:r.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:r,y:e}=this._passiveTransform;if(r===0&&e===0||this.isDragging()||!this._boundaryElement)return;let a=this._rootElement.getBoundingClientRect(),i=this._boundaryElement.getBoundingClientRect();if(i.width===0&&i.height===0||a.width===0&&a.height===0)return;let n=i.left-a.left,s=a.right-i.right,o=i.top-a.top,l=a.bottom-i.bottom;i.width>a.width?(n>0&&(r+=n),s>0&&(r-=s)):r=0,i.height>a.height?(o>0&&(e+=o),l>0&&(e-=l)):e=0,(r!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:r})}_getDragStartDelay(r){let e=this.dragStartDelay;return typeof e=="number"?e:fs(r)?e.touch:e?e.mouse:0}_updateOnScroll(r){let e=this._parentPositions.handleScroll(r);if(e){let a=rs(r);this._boundaryRect&&a!==this._boundaryElement&&a.contains(this._boundaryElement)&&hs(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=oo(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(r,e){let a=this._previewContainer||"global";if(a==="parent")return r;if(a==="global"){let i=this._document;return e||i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement||i.body}return $a(a)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=r=>{if(this._handles.length){let e=this._getTargetHandle(r);e&&!this._disabledHandles.has(e)&&!this.disabled&&r.preventDefault()}else this.disabled||r.preventDefault()};_getTargetHandle(r){return this._handles.find(e=>r.target&&(r.target===e||e.contains(r.target)))}};function ou(t,r,e){return Math.max(r,Math.min(e,t))}function fs(t){return t.type[0]==="t"}function $_(t){t.preventDefault()}function uu(t,r,e){let a=lu(r,t.length-1),i=lu(e,t.length-1);if(a===i)return;let n=t[a],s=i<a?-1:1;for(let o=a;o!==i;o+=s)t[o]=t[o+s];t[i]=n}function lu(t,r){return Math.max(0,Math.min(r,t))}var Jo=class{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction;constructor(r){this._dragDropRegistry=r}_previousSwap={drag:null,delta:0,overlaps:!1};start(r){this.withItems(r)}sort(r,e,a,i){let n=this._itemPositions,s=this._getItemIndexFromPointerPosition(r,e,a,i);if(s===-1&&n.length>0)return null;let o=this.orientation==="horizontal",l=n.findIndex(_=>_.drag===r),c=n[s],d=n[l].clientRect,f=c.clientRect,h=l>s?1:-1,m=this._getItemOffsetPx(d,f,h),p=this._getSiblingOffsetPx(l,n,h),u=n.slice();return uu(n,l,s),n.forEach((_,E)=>{if(u[E]===_)return;let k=_.drag===r,w=k?m:p,L=k?r.getPlaceholderElement():_.drag.getRootElement();_.offset+=w;let U=Math.round(_.offset*(1/_.drag.scale));o?(L.style.transform=Zo(`translate3d(${U}px, 0, 0)`,_.initialTransform),hs(_.clientRect,0,w)):(L.style.transform=Zo(`translate3d(0, ${U}px, 0)`,_.initialTransform),hs(_.clientRect,w,0))}),this._previousSwap.overlaps=Dc(f,e,a),this._previousSwap.drag=c.drag,this._previousSwap.delta=o?i.x:i.y,{previousIndex:l,currentIndex:s}}enter(r,e,a,i){let n=i==null||i<0?this._getItemIndexFromPointerPosition(r,e,a):i,s=this._activeDraggables,o=s.indexOf(r),l=r.getPlaceholderElement(),c=s[n];if(c===r&&(c=s[n+1]),!c&&(n==null||n===-1||n<s.length-1)&&this._shouldEnterAsFirstChild(e,a)&&(c=s[0]),o>-1&&s.splice(o,1),c&&!this._dragDropRegistry.isDragging(c)){let d=c.getRootElement();d.parentElement.insertBefore(l,d),s.splice(n,0,r)}else this._element.appendChild(l),s.push(r);l.style.transform="",this._cacheItemPositions()}withItems(r){this._activeDraggables=r.slice(),this._cacheItemPositions()}withSortPredicate(r){this._sortPredicate=r}reset(){this._activeDraggables?.forEach(r=>{let e=r.getRootElement();if(e){let a=this._itemPositions.find(i=>i.drag===r)?.initialTransform;e.style.transform=a||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(r){return(this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions).findIndex(a=>a.drag===r)}updateOnScroll(r,e){this._itemPositions.forEach(({clientRect:a})=>{hs(a,r,e)}),this._itemPositions.forEach(({drag:a})=>{this._dragDropRegistry.isDragging(a)&&a._sortFromLastPointerPosition()})}withElementContainer(r){this._element=r}_cacheItemPositions(){let r=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(e=>{let a=e.getVisibleElement();return{drag:e,offset:0,initialTransform:a.style.transform||"",clientRect:Ic(a)}}).sort((e,a)=>r?e.clientRect.left-a.clientRect.left:e.clientRect.top-a.clientRect.top)}_getItemOffsetPx(r,e,a){let i=this.orientation==="horizontal",n=i?e.left-r.left:e.top-r.top;return a===-1&&(n+=i?e.width-r.width:e.height-r.height),n}_getSiblingOffsetPx(r,e,a){let i=this.orientation==="horizontal",n=e[r].clientRect,s=e[r+a*-1],o=n[i?"width":"height"]*a;if(s){let l=i?"left":"top",c=i?"right":"bottom";a===-1?o-=s.clientRect[l]-n[c]:o+=n[l]-s.clientRect[c]}return o}_shouldEnterAsFirstChild(r,e){if(!this._activeDraggables.length)return!1;let a=this._itemPositions,i=this.orientation==="horizontal";if(a[0].drag!==this._activeDraggables[0]){let s=a[a.length-1].clientRect;return i?r>=s.right:e>=s.bottom}else{let s=a[0].clientRect;return i?r<=s.left:e<=s.top}}_getItemIndexFromPointerPosition(r,e,a,i){let n=this.orientation==="horizontal",s=this._itemPositions.findIndex(({drag:o,clientRect:l})=>{if(o===r)return!1;if(i){let c=n?i.x:i.y;if(o===this._previousSwap.drag&&this._previousSwap.overlaps&&c===this._previousSwap.delta)return!1}return n?e>=Math.floor(l.left)&&e<Math.floor(l.right):a>=Math.floor(l.top)&&a<Math.floor(l.bottom)});return s===-1||!this._sortPredicate(s,r)?-1:s}},Fc=class{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(r,e){this._document=r,this._dragDropRegistry=e}start(r){let e=this._element.childNodes;this._relatedNodes=[];for(let a=0;a<e.length;a++){let i=e[a];this._relatedNodes.push([i,i.nextSibling])}this.withItems(r)}sort(r,e,a,i){let n=this._getItemIndexFromPointerPosition(r,e,a),s=this._previousSwap;if(n===-1||this._activeItems[n]===r)return null;let o=this._activeItems[n];if(s.drag===o&&s.overlaps&&s.deltaX===i.x&&s.deltaY===i.y)return null;let l=this.getItemIndex(r),c=r.getPlaceholderElement(),d=o.getRootElement();n>l?d.after(c):d.before(c),uu(this._activeItems,l,n);let f=this._getRootNode().elementFromPoint(e,a);return s.deltaX=i.x,s.deltaY=i.y,s.drag=o,s.overlaps=d===f||d.contains(f),{previousIndex:l,currentIndex:n}}enter(r,e,a,i){let n=i==null||i<0?this._getItemIndexFromPointerPosition(r,e,a):i;n===-1&&(n=this._getClosestItemIndexToPointer(r,e,a));let s=this._activeItems[n],o=this._activeItems.indexOf(r);o>-1&&this._activeItems.splice(o,1),s&&!this._dragDropRegistry.isDragging(s)?(this._activeItems.splice(n,0,r),s.getRootElement().before(r.getPlaceholderElement())):(this._activeItems.push(r),this._element.appendChild(r.getPlaceholderElement()))}withItems(r){this._activeItems=r.slice()}withSortPredicate(r){this._sortPredicate=r}reset(){let r=this._element,e=this._previousSwap;for(let a=this._relatedNodes.length-1;a>-1;a--){let[i,n]=this._relatedNodes[a];i.parentNode===r&&i.nextSibling!==n&&(n===null?r.appendChild(i):n.parentNode===r&&r.insertBefore(i,n))}this._relatedNodes=[],this._activeItems=[],e.drag=null,e.deltaX=e.deltaY=0,e.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(r){return this._activeItems.indexOf(r)}updateOnScroll(){this._activeItems.forEach(r=>{this._dragDropRegistry.isDragging(r)&&r._sortFromLastPointerPosition()})}withElementContainer(r){r!==this._element&&(this._element=r,this._rootNode=void 0)}_getItemIndexFromPointerPosition(r,e,a){let i=this._getRootNode().elementFromPoint(Math.floor(e),Math.floor(a)),n=i?this._activeItems.findIndex(s=>{let o=s.getRootElement();return i===o||o.contains(i)}):-1;return n===-1||!this._sortPredicate(n,r)?-1:n}_getRootNode(){return this._rootNode||(this._rootNode=oo(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(r,e,a){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let i=1/0,n=-1;for(let s=0;s<this._activeItems.length;s++){let o=this._activeItems[s];if(o!==r){let{x:l,y:c}=o.getRootElement().getBoundingClientRect(),d=Math.hypot(e-l,a-c);d<i&&(i=d,n=s)}}return n}},cu=.05,hu=.05,Ur=function(t){return t[t.NONE=0]="NONE",t[t.UP=1]="UP",t[t.DOWN=2]="DOWN",t}(Ur||{}),hr=function(t){return t[t.NONE=0]="NONE",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t}(hr||{}),Oc=class{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis;autoScrollDisabled=!1;autoScrollStep=2;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new Pe;entered=new Pe;exited=new Pe;dropped=new Pe;sorted=new Pe;receivingStarted=new Pe;receivingStopped=new Pe;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=jt.EMPTY;_verticalScrollDirection=Ur.NONE;_horizontalScrollDirection=hr.NONE;_scrollNode;_stopScrollTimers=new Pe;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(r,e,a,i,n){this._dragDropRegistry=e,this._ngZone=i,this._viewportRuler=n;let s=this.element=$a(r);this._document=a,this.withOrientation("vertical").withElementContainer(s),e.registerDropContainer(this),this._parentPositions=new qo(a)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(r,e,a,i){this._draggingStarted(),i==null&&this.sortingDisabled&&(i=this._draggables.indexOf(r)),this._sortStrategy.enter(r,e,a,i),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:r,container:this,currentIndex:this.getItemIndex(r)})}exit(r){this._reset(),this.exited.next({item:r,container:this})}drop(r,e,a,i,n,s,o,l={}){this._reset(),this.dropped.next({item:r,currentIndex:e,previousIndex:a,container:this,previousContainer:i,isPointerOverContainer:n,distance:s,dropPoint:o,event:l})}withItems(r){let e=this._draggables;return this._draggables=r,r.forEach(a=>a._withDropContainer(this)),this.isDragging()&&(e.filter(i=>i.isDragging()).every(i=>r.indexOf(i)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(r){return this._direction=r,this._sortStrategy instanceof Jo&&(this._sortStrategy.direction=r),this}connectedTo(r){return this._siblings=r.slice(),this}withOrientation(r){if(r==="mixed")this._sortStrategy=new Fc(this._document,this._dragDropRegistry);else{let e=new Jo(this._dragDropRegistry);e.direction=this._direction,e.orientation=r,this._sortStrategy=e}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((e,a)=>this.sortPredicate(e,a,this)),this}withScrollableParents(r){let e=this._container;return this._scrollableElements=r.indexOf(e)===-1?[e,...r]:r.slice(),this}withElementContainer(r){if(r===this._container)return this;let e=$a(this.element),a=this._scrollableElements.indexOf(this._container),i=this._scrollableElements.indexOf(r);return a>-1&&this._scrollableElements.splice(a,1),i>-1&&this._scrollableElements.splice(i,1),this._sortStrategy&&this._sortStrategy.withElementContainer(r),this._cachedShadowRoot=null,this._scrollableElements.unshift(r),this._container=r,this}getScrollableParents(){return this._scrollableElements}getItemIndex(r){return this._isDragging?this._sortStrategy.getItemIndex(r):this._draggables.indexOf(r)}isReceiving(){return this._activeSiblings.size>0}_sortItem(r,e,a,i){if(this.sortingDisabled||!this._domRect||!eu(this._domRect,cu,e,a))return;let n=this._sortStrategy.sort(r,e,a,i);n&&this.sorted.next({previousIndex:n.previousIndex,currentIndex:n.currentIndex,container:this,item:r})}_startScrollingIfNecessary(r,e){if(this.autoScrollDisabled)return;let a,i=Ur.NONE,n=hr.NONE;if(this._parentPositions.positions.forEach((s,o)=>{o===this._document||!s.clientRect||a||eu(s.clientRect,cu,r,e)&&([i,n]=X_(o,s.clientRect,this._direction,r,e),(i||n)&&(a=o))}),!i&&!n){let{width:s,height:o}=this._viewportRuler.getViewportSize(),l={width:s,height:o,top:0,right:s,bottom:o,left:0};i=mu(l,e),n=pu(l,r),a=window}a&&(i!==this._verticalScrollDirection||n!==this._horizontalScrollDirection||a!==this._scrollNode)&&(this._verticalScrollDirection=i,this._horizontalScrollDirection=n,this._scrollNode=a,(i||n)&&a?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let r=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=r.msScrollSnapType||r.scrollSnapType||"",r.scrollSnapType=r.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let r=this._container.style;r.scrollSnapType=r.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(e=>e._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),dd(0,ld).pipe(gt(this._stopScrollTimers)).subscribe(()=>{let r=this._scrollNode,e=this.autoScrollStep;this._verticalScrollDirection===Ur.UP?r.scrollBy(0,-e):this._verticalScrollDirection===Ur.DOWN&&r.scrollBy(0,e),this._horizontalScrollDirection===hr.LEFT?r.scrollBy(-e,0):this._horizontalScrollDirection===hr.RIGHT&&r.scrollBy(e,0)})};_isOverContainer(r,e){return this._domRect!=null&&Dc(this._domRect,r,e)}_getSiblingContainerFromPosition(r,e,a){return this._siblings.find(i=>i._canReceive(r,e,a))}_canReceive(r,e,a){if(!this._domRect||!Dc(this._domRect,e,a)||!this.enterPredicate(r,this))return!1;let i=this._getShadowRoot().elementFromPoint(e,a);return i?i===this._container||this._container.contains(i):!1}_startReceiving(r,e){let a=this._activeSiblings;!a.has(r)&&e.every(i=>this.enterPredicate(i,this)||this._draggables.indexOf(i)>-1)&&(a.add(r),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:r,receiver:this,items:e}))}_stopReceiving(r){this._activeSiblings.delete(r),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:r,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(r=>{if(this.isDragging()){let e=this._parentPositions.handleScroll(r);e&&this._sortStrategy.updateOnScroll(e.top,e.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let r=oo(this._container);this._cachedShadowRoot=r||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let r=this._sortStrategy.getActiveItemsSnapshot().filter(e=>e.isDragging());this._siblings.forEach(e=>e._startReceiving(this,r))}};function mu(t,r){let{top:e,bottom:a,height:i}=t,n=i*hu;return r>=e-n&&r<=e+n?Ur.UP:r>=a-n&&r<=a+n?Ur.DOWN:Ur.NONE}function pu(t,r){let{left:e,right:a,width:i}=t,n=i*hu;return r>=e-n&&r<=e+n?hr.LEFT:r>=a-n&&r<=a+n?hr.RIGHT:hr.NONE}function X_(t,r,e,a,i){let n=mu(r,i),s=pu(r,a),o=Ur.NONE,l=hr.NONE;if(n){let c=t.scrollTop;n===Ur.UP?c>0&&(o=Ur.UP):t.scrollHeight-c>t.clientHeight&&(o=Ur.DOWN)}if(s){let c=t.scrollLeft;e==="rtl"?s===hr.RIGHT?c<0&&(l=hr.RIGHT):t.scrollWidth+c>t.clientWidth&&(l=hr.LEFT):s===hr.LEFT?c>0&&(l=hr.LEFT):t.scrollWidth-c>t.clientWidth&&(l=hr.RIGHT)}return[o,l]}var us={capture:!0},Sc={passive:!1,capture:!0},j_=(()=>{class t{static \u0275fac=function(a){return new(a||t)};static \u0275cmp=Ye({type:t,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(a,i){},styles:[`@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}
`],encapsulation:2,changeDetection:0})}return t})(),Rc=(()=>{class t{_ngZone=Y(ka);_document=Y(ts);_styleLoader=Y(Ea);_renderer=Y(ql).createRenderer(null,null);_cleanupDocumentTouchmove;_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=qt([]);_globalListeners;_draggingPredicate=e=>e.isDragging();_domNodesToDirectives=null;pointerMove=new Pe;pointerUp=new Pe;scroll=new Pe;constructor(){}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._cleanupDocumentTouchmove?.(),this._cleanupDocumentTouchmove=Jt(this._renderer,this._document,"touchmove",this._persistentTouchmoveListener,Sc)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),this._dragInstances.size===0&&this._cleanupDocumentTouchmove?.()}startDragging(e,a){if(!(this._activeDragInstances().indexOf(e)>-1)&&(this._styleLoader.load(j_),this._activeDragInstances.update(i=>[...i,e]),this._activeDragInstances().length===1)){let i=a.type.startsWith("touch"),n=o=>this.pointerUp.next(o),s=[["scroll",o=>this.scroll.next(o),us],["selectstart",this._preventDefaultWhileDragging,Sc]];i?s.push(["touchend",n,us],["touchcancel",n,us]):s.push(["mouseup",n,us]),i||s.push(["mousemove",o=>this.pointerMove.next(o),Sc]),this._ngZone.runOutsideAngular(()=>{this._globalListeners=s.map(([o,l,c])=>Jt(this._renderer,this._document,o,l,c))})}}stopDragging(e){this._activeDragInstances.update(a=>{let i=a.indexOf(e);return i>-1?(a.splice(i,1),[...a]):a}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(e){return this._activeDragInstances().indexOf(e)>-1}scrolled(e){let a=[this.scroll];return e&&e!==this._document&&a.push(new jn(i=>this._ngZone.runOutsideAngular(()=>{let n=Jt(this._renderer,e,"scroll",s=>{this._activeDragInstances().length&&i.next(s)},us);return()=>{n()}}))),wi(...a)}registerDirectiveNode(e,a){this._domNodesToDirectives??=new WeakMap,this._domNodesToDirectives.set(e,a)}removeDirectiveNode(e){this._domNodesToDirectives?.delete(e)}getDragDirectiveForNode(e){return this._domNodesToDirectives?.get(e)||null}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._domNodesToDirectives=null,this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=e=>{this._activeDragInstances().length>0&&e.preventDefault()};_persistentTouchmoveListener=e=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&e.preventDefault(),this.pointerMove.next(e))};_clearGlobalListeners(){this._globalListeners?.forEach(e=>e()),this._globalListeners=void 0}static \u0275fac=function(a){return new(a||t)};static \u0275prov=Er({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),K_={dragStartThreshold:5,pointerDirectionChangeThreshold:5},_u=(()=>{class t{_document=Y(ts);_ngZone=Y(ka);_viewportRuler=Y(ff);_dragDropRegistry=Y(Rc);_renderer=Y(ql).createRenderer(null,null);constructor(){}createDrag(e,a=K_){return new Ac(e,a,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry,this._renderer)}createDropList(e){return new Oc(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static \u0275fac=function(a){return new(a||t)};static \u0275prov=Er({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Mc=new Kt("CDK_DRAG_PARENT");var gu=new Kt("CdkDragHandle"),xu=(()=>{class t{element=Y(Sr);_parentDrag=Y(Mc,{optional:!0,skipSelf:!0});_dragDropRegistry=Y(Rc);_stateChanges=new Pe;get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._stateChanges.next(this)}_disabled=!1;constructor(){this._parentDrag?._addHandle(this)}ngAfterViewInit(){if(!this._parentDrag){let e=this.element.nativeElement.parentElement;for(;e;){let a=this._dragDropRegistry.getDragDirectiveForNode(e);if(a){this._parentDrag=a,a._addHandle(this);break}e=e.parentElement}}}ngOnDestroy(){this._parentDrag?._removeHandle(this),this._stateChanges.complete()}static \u0275fac=function(a){return new(a||t)};static \u0275dir=Br({type:t,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:[2,"cdkDragHandleDisabled","disabled",Pt]},features:[ur([{provide:gu,useExisting:t}])]})}return t})(),q_=new Kt("CDK_DRAG_CONFIG"),Z_=new Kt("CdkDropList"),vu=(()=>{class t{element=Y(Sr);dropContainer=Y(Z_,{optional:!0,skipSelf:!0});_ngZone=Y(ka);_viewContainerRef=Y(eo);_dir=Y(Sa,{optional:!0});_changeDetectorRef=Y(Zt);_selfHandle=Y(gu,{optional:!0,self:!0});_parentDrag=Y(Mc,{optional:!0,skipSelf:!0});_dragDropRegistry=Y(Rc);_destroyed=new Pe;_handles=new qs([]);_previewTemplate;_placeholderTemplate;_dragRef;data;lockAxis;rootElementSelector;boundaryElement;dragStartDelay;freeDragPosition;get disabled(){return this._disabled||!!(this.dropContainer&&this.dropContainer.disabled)}set disabled(e){this._disabled=e,this._dragRef.disabled=this._disabled}_disabled;constrainPosition;previewClass;previewContainer;scale=1;started=new ke;released=new ke;ended=new ke;entered=new ke;exited=new ke;dropped=new ke;moved=new jn(e=>{let a=this._dragRef.moved.pipe(Ua(i=>({source:this,pointerPosition:i.pointerPosition,event:i.event,delta:i.delta,distance:i.distance}))).subscribe(e);return()=>{a.unsubscribe()}});_injector=Y(yi);constructor(){let e=this.dropContainer,a=Y(q_,{optional:!0}),i=Y(_u);this._dragRef=i.createDrag(this.element,{dragStartThreshold:a&&a.dragStartThreshold!=null?a.dragStartThreshold:5,pointerDirectionChangeThreshold:a&&a.pointerDirectionChangeThreshold!=null?a.pointerDirectionChangeThreshold:5,zIndex:a?.zIndex}),this._dragRef.data=this,this._dragDropRegistry.registerDirectiveNode(this.element.nativeElement,this),a&&this._assignDefaults(a),e&&(this._dragRef._withDropContainer(e._dropListRef),e.addItem(this),e._dropListRef.beforeStarted.pipe(gt(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(e){this._dragRef.setFreeDragPosition(e)}ngAfterViewInit(){bi(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(e){let a=e.rootElementSelector,i=e.freeDragPosition;a&&!a.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,i&&!i.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._dragDropRegistry.removeDirectiveNode(this.element.nativeElement),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(e){let a=this._handles.getValue();a.push(e),this._handles.next(a)}_removeHandle(e){let a=this._handles.getValue(),i=a.indexOf(e);i>-1&&(a.splice(i,1),this._handles.next(a))}_setPreviewTemplate(e){this._previewTemplate=e}_resetPreviewTemplate(e){e===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(e){this._placeholderTemplate=e}_resetPlaceholderTemplate(e){e===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let e=this.element.nativeElement,a=e;this.rootElementSelector&&(a=e.closest!==void 0?e.closest(this.rootElementSelector):e.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(a||e)}_getBoundaryElement(){let e=this.boundaryElement;return e?typeof e=="string"?this.element.nativeElement.closest(e):$a(e):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){let a=this._dir,i=this.dragStartDelay,n=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,s=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.scale=this.scale,e.dragStartDelay=typeof i=="object"&&i?i:an(i),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(n).withPreviewTemplate(s).withPreviewContainer(this.previewContainer||"global"),a&&e.withDirection(a.value)}}),e.beforeStarted.pipe(Zs(1)).subscribe(()=>{if(this._parentDrag){e.withParent(this._parentDrag._dragRef);return}let a=this.element.nativeElement.parentElement;for(;a;){let i=this._dragDropRegistry.getDragDirectiveForNode(a);if(i){e.withParent(i._dragRef);break}a=a.parentElement}})}_handleEvents(e){e.started.subscribe(a=>{this.started.emit({source:this,event:a.event}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(a=>{this.released.emit({source:this,event:a.event})}),e.ended.subscribe(a=>{this.ended.emit({source:this,distance:a.distance,dropPoint:a.dropPoint,event:a.event}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(a=>{this.entered.emit({container:a.container.data,item:this,currentIndex:a.currentIndex})}),e.exited.subscribe(a=>{this.exited.emit({container:a.container.data,item:this})}),e.dropped.subscribe(a=>{this.dropped.emit({previousIndex:a.previousIndex,currentIndex:a.currentIndex,previousContainer:a.previousContainer.data,container:a.container.data,isPointerOverContainer:a.isPointerOverContainer,item:this,distance:a.distance,dropPoint:a.dropPoint,event:a.event})})}_assignDefaults(e){let{lockAxis:a,dragStartDelay:i,constrainPosition:n,previewClass:s,boundaryElement:o,draggingDisabled:l,rootElementSelector:c,previewContainer:d}=e;this.disabled=l??!1,this.dragStartDelay=i||0,a&&(this.lockAxis=a),n&&(this.constrainPosition=n),s&&(this.previewClass=s),o&&(this.boundaryElement=o),c&&(this.rootElementSelector=c),d&&(this.previewContainer=d)}_setupHandlesListener(){this._handles.pipe(Wa(e=>{let a=e.map(i=>i.element);this._selfHandle&&this.rootElementSelector&&a.push(this.element),this._dragRef.withHandles(a)}),md(e=>wi(...e.map(a=>a._stateChanges.pipe(Ha(a))))),gt(this._destroyed)).subscribe(e=>{let a=this._dragRef,i=e.element.nativeElement;e.disabled?a.disableHandle(i):a.enableHandle(i)})}static \u0275fac=function(a){return new(a||t)};static \u0275dir=Br({type:t,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(a,i){a&2&&Dr("cdk-drag-disabled",i.disabled)("cdk-drag-dragging",i._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",Pt],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",es]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[ur([{provide:Mc,useExisting:t}]),qr]})}return t})();var wu=(()=>{class t{static \u0275fac=function(a){return new(a||t)};static \u0275mod=Lr({type:t});static \u0275inj=Nr({providers:[_u],imports:[_o]})}return t})();var el=class t{transform(r,e="-"){return r==null||typeof r=="string"&&r.trim()===""?e:r}static \u0275fac=function(e){return new(e||t)};static \u0275pipe=yd({name:"default",type:t,pure:!0})};function J_(t,r){if(t&1&&(v(0,"mat-grid-tile")(1,"div",10)(2,"mat-icon",11),b(3,"account_circle"),x(),v(4,"div")(5,"div",12),b(6,"Usuario Creador"),x(),v(7,"div",13),b(8),Ve(9,"default"),x()()()()),t&2){let e=be();P(8),Ce(" ",It(9,1,e.data.order.user==null?null:e.data.order.user.name,"N/A")," ")}}function eg(t,r){if(t&1&&(v(0,"mat-grid-tile")(1,"div",10)(2,"mat-icon",11),b(3,"explore"),x(),v(4,"div")(5,"div",12),b(6,"Coordenadas"),x(),v(7,"div",13),b(8),x()()()()),t&2){let e=be();P(8),Ce(" ",e.data.order.delivery_coordinates," ")}}function tg(t,r){t&1&&Ae(0,"mat-divider")}function rg(t,r){if(t&1&&(v(0,"mat-grid-tile")(1,"div",10)(2,"mat-icon",11),b(3,"aspect_ratio"),x(),v(4,"div")(5,"div",12),b(6,"Tama\xF1o Paquete"),x(),v(7,"div",13),b(8),Ve(9,"titlecase"),x()()()()),t&2){let e=be();P(8),Ce(" ",Bt(9,1,e.data.order.package_size_type)," ")}}function ag(t,r){if(t&1&&(v(0,"mat-grid-tile")(1,"div",10)(2,"mat-icon",11),b(3,"fitness_center"),x(),v(4,"div")(5,"div",12),b(6,"Peso (kg)"),x(),v(7,"div",13),b(8),Ve(9,"number"),x()()()()),t&2){let e=be();P(8),Ce(" ",It(9,1,e.data.order.package_weight_kg,"1.1-2")," kg ")}}function ig(t,r){if(t&1&&(v(0,"mat-grid-tile")(1,"div",10)(2,"mat-icon",11),b(3,"width_normal"),x(),v(4,"div")(5,"div",12),b(6,"Dimensiones (cm)"),x(),v(7,"div",13),b(8),x()()()()),t&2){let e=be();P(8),Cd(" An: ",e.data.order.package_width_cm," x L: ",e.data.order.package_length_cm," x Al: ",e.data.order.package_height_cm," ")}}function ng(t,r){if(t&1&&(v(0,"mat-grid-tile")(1,"div",10)(2,"mat-icon",11),b(3,"credit_card"),x(),v(4,"div")(5,"div",12),b(6,"M\xE9todo de Cobro"),x(),v(7,"div",13),b(8),Ve(9,"titlecase"),x()()()()),t&2){let e=be();P(8),Ce(" ",Bt(9,1,e.data.order.payment_method_for_collection)," ")}}function sg(t,r){if(t&1&&(v(0,"div",24)(1,"div",25)(2,"mat-icon"),b(3,"speaker_notes"),x(),b(4," Observaciones Cliente/Pedido: "),x(),v(5,"p",26),b(6),x()()),t&2){let e=be(2);P(6),Dt(e.data.order.observations)}}function og(t,r){t&1&&Ae(0,"mat-divider")}function lg(t,r){if(t&1&&(v(0,"div",24)(1,"div",25)(2,"mat-icon"),b(3,"warehouse"),x(),b(4," Tipo de Transferencia a Almac\xE9n: "),x(),v(5,"p",26),b(6),Ve(7,"titlecase"),x()()),t&2){let e=be(2);P(6),Ce(" ",Bt(7,1,e.data.order.type_order_transfer_to_warehouse)," ")}}function cg(t,r){if(t&1&&(v(0,"mat-card",6)(1,"mat-card-header",7)(2,"mat-card-title"),b(3,"Observaciones y Log\xEDstica"),x()(),v(4,"mat-card-content"),me(5,sg,7,1,"div",23)(6,og,1,0,"mat-divider",14)(7,lg,8,3,"div",23),x()()),t&2){let e=be();P(5),j("ngIf",e.data.order.observations),P(),j("ngIf",e.data.order.observations&&e.data.order.type_order_transfer_to_warehouse),P(),j("ngIf",e.data.order.type_order_transfer_to_warehouse)}}var tl=class t{constructor(r,e){this.dialogRef=r;this.data=e;console.log("data",e)}OrderStatusEnum=Si;getStatusBadgeClass(r){return r?`status-${r.toString().toLowerCase().replace(/[\s_]+/g,"-")}`:"status-desconocido"}onClose(){this.dialogRef.close()}openMaps(r){r&&window.open(`https://www.google.com/maps/search/?api=1&query=${r}`,"_blank")}callPhone(r){r&&(window.location.href=`tel:${r}`)}printOrder(){console.log("Imprimiendo pedido (simulado):",this.data.order.code),this.dialogRef.close("print")}static \u0275fac=function(e){return new(e||t)(ji(fn),ji(Co))};static \u0275cmp=Ye({type:t,selectors:[["app-order-detail-dialog"]],decls:144,vars:65,consts:[["cdkDrag","","cdkDragRootElement",".cdk-overlay-pane","cdkDragHandle",".dialog-header-draggable",1,"dialog-container"],[1,"dialog-header","dialog-header-draggable"],["mat-dialog-title",""],[1,"order-code-chip"],["mat-icon-button","","aria-label","Cerrar di\xE1logo","matTooltip","Cerrar",1,"close-button",3,"click"],["tabindex","-1",1,"dialog-content"],["appearance","outlined",1,"info-card"],[1,"compact-card-header"],[1,"status-badge-dialog",3,"ngClass"],["cols","2","rowHeight","80px"],[1,"detail-item"],[1,"detail-icon"],[1,"detail-label"],[1,"detail-value"],[4,"ngIf"],[1,"detail-item",3,"click"],[1,"detail-value","link-like"],[3,"colspan"],[1,"item-description"],[1,"detail-value","bold-value"],["appearance","outlined","class","info-card",4,"ngIf"],["align","end",1,"dialog-actions"],["mat-flat-button","","color","primary",3,"click"],["class","detail-block",4,"ngIf"],[1,"detail-block"],[1,"detail-label-block"],[1,"detail-value-block"]],template:function(e,a){e&1&&(v(0,"div",0)(1,"div",1)(2,"h2",2),b(3,"Detalles del Pedido"),x(),v(4,"span",3),b(5),x(),v(6,"button",4),ye("click",function(){return a.onClose()}),v(7,"mat-icon"),b(8,"close"),x()()(),v(9,"mat-dialog-content",5)(10,"mat-card",6)(11,"mat-card-header",7)(12,"mat-card-title"),b(13,"Informaci\xF3n General"),x(),v(14,"span",8),b(15),Ve(16,"titlecase"),x()(),v(17,"mat-card-content")(18,"mat-grid-list",9)(19,"mat-grid-tile")(20,"div",10)(21,"mat-icon",11),b(22,"local_shipping"),x(),v(23,"div")(24,"div",12),b(25,"Tipo de Env\xEDo"),x(),v(26,"div",13),b(27),Ve(28,"titlecase"),Ve(29,"default"),x()()()(),v(30,"mat-grid-tile")(31,"div",10)(32,"mat-icon",11),b(33,"calendar_today"),x(),v(34,"div")(35,"div",12),b(36,"Fecha Registro"),x(),v(37,"div",13),b(38),Ve(39,"date"),Ve(40,"default"),x()()()(),v(41,"mat-grid-tile")(42,"div",10)(43,"mat-icon",11),b(44,"event_available"),x(),v(45,"div")(46,"div",12),b(47,"Fecha Entrega Prog."),x(),v(48,"div",13),b(49),Ve(50,"date"),Ve(51,"default"),x()()()(),me(52,J_,10,4,"mat-grid-tile",14),x()()(),v(53,"mat-card",6)(54,"mat-card-header",7)(55,"mat-card-title"),b(56,"Destinatario y Entrega"),x()(),v(57,"mat-card-content")(58,"mat-grid-list",9)(59,"mat-grid-tile")(60,"div",10)(61,"mat-icon",11),b(62,"person_pin"),x(),v(63,"div")(64,"div",12),b(65,"Nombre Destinatario"),x(),v(66,"div",13),b(67),Ve(68,"default"),x()()()(),v(69,"mat-grid-tile")(70,"div",15),ye("click",function(){return a.callPhone(a.data.order.recipient_phone)}),v(71,"mat-icon",11),b(72,"phone_iphone"),x(),v(73,"div")(74,"div",12),b(75,"Tel\xE9fono Destinatario"),x(),v(76,"div",16),b(77),x()()()(),v(78,"mat-grid-tile",17)(79,"div",10)(80,"mat-icon",11),b(81,"location_on"),x(),v(82,"div")(83,"div",12),b(84,"Direcci\xF3n de Entrega"),x(),v(85,"div",13),b(86),Ve(87,"default"),x()()()(),v(88,"mat-grid-tile")(89,"div",10)(90,"mat-icon",11),b(91,"map"),x(),v(92,"div")(93,"div",12),b(94,"Distrito"),x(),v(95,"div",13),b(96),Ve(97,"titlecase"),Ve(98,"default"),x()()()(),me(99,eg,9,1,"mat-grid-tile",14),x()()(),v(100,"mat-card",6)(101,"mat-card-header",7)(102,"mat-card-title"),b(103,"Detalles del Paquete"),x()(),v(104,"mat-card-content")(105,"p",18),b(106),Ve(107,"default"),x(),me(108,tg,1,0,"mat-divider",14),v(109,"mat-grid-list",9),me(110,rg,10,3,"mat-grid-tile",14)(111,ag,10,4,"mat-grid-tile",14)(112,ig,9,3,"mat-grid-tile",14),x()()(),v(113,"mat-card",6)(114,"mat-card-header",7)(115,"mat-card-title"),b(116,"Informaci\xF3n Financiera"),x()(),v(117,"mat-card-content")(118,"mat-grid-list",9)(119,"mat-grid-tile")(120,"div",10)(121,"mat-icon",11),b(122,"payments"),x(),v(123,"div")(124,"div",12),b(125,"Monto a Cobrar Entrega"),x(),v(126,"div",19),b(127),Ve(128,"currency"),x()()()(),v(129,"mat-grid-tile")(130,"div",10)(131,"mat-icon",11),b(132,"local_atm"),x(),v(133,"div")(134,"div",12),b(135,"Costo de Env\xEDo"),x(),v(136,"div",19),b(137),Ve(138,"currency"),x()()()(),me(139,ng,10,3,"mat-grid-tile",14),x()()(),me(140,cg,8,3,"mat-card",20),x(),v(141,"mat-dialog-actions",21)(142,"button",22),ye("click",function(){return a.onClose()}),b(143,"Cerrar"),x()()()),e&2&&(P(5),Ce("N\xB0: ",a.data.order.code||a.data.order.id,""),P(9),j("ngClass",a.getStatusBadgeClass(a.data.order.status)),P(),Ce(" ",Bt(16,22,a.data.order.status)," "),P(12),Ce(" ",It(29,26,Bt(28,24,a.data.order.shipment_type),"N/A")," "),P(11),Ce(" ",It(40,32,It(39,29,a.data.order.createdAt,"dd/MM/yy HH:mm"),"N/A")," "),P(11),Ce(" ",It(51,38,It(50,35,a.data.order.delivery_date,"dd/MM/yyyy"),"No especificada")," "),P(3),j("ngIf",a.data.order.user==null?null:a.data.order.user.name),P(15),Ce(" ",It(68,41,a.data.order.recipient_name,"N/A")," "),P(10),Ce(" ",a.data.order.recipient_phone||"N/A"," "),P(),j("colspan",2),P(8),Ce(" ",It(87,44,a.data.order.delivery_address,"N/A")," "),P(10),Ce(" ",It(98,49,Bt(97,47,a.data.order.delivery_district_name),"N/A")," "),P(3),j("ngIf",a.data.order.delivery_coordinates),P(7),Ce(" ",It(107,52,a.data.order.item_description,"Sin descripci\xF3n del contenido.")," "),P(2),j("ngIf",a.data.order.package_size_type||a.data.order.package_weight_kg),P(2),j("ngIf",a.data.order.package_size_type),P(),j("ngIf",a.data.order.package_weight_kg),P(),j("ngIf",a.data.order.package_width_cm),P(15),Ce(" ",Ya(128,55,a.data.order.amount_to_collect_at_delivery||0,"PEN","S/ ","1.2-2")," "),P(10),Ce(" ",Ya(138,60,a.data.order.shipping_cost||0,"PEN","S/ ","1.2-2")," "),P(2),j("ngIf",a.data.order.payment_method_for_collection),P(),j("ngIf",a.data.order.observations||a.data.order.type_order_transfer_to_warehouse))},dependencies:[Tt,la,Qt,io,en,tn,gr,ti,un,mn,hn,dt,Rt,Da,er,xr,dn,bo,Gd,Vd,Hd,Wd,Ud,qf,Kf,kc,ei,Ja,wu,vu,xu,el],styles:["[_nghost-%COMP%]{display:block}.dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:calc(100vh - 80px)}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;border-bottom:1px solid #e0e0e0;background-color:#f5f5f5}.dialog-header-draggable[_ngcontent-%COMP%]{cursor:move}h2.mat-mdc-dialog-title[_ngcontent-%COMP%]{margin:0;font-size:1.35em;font-weight:500;color:#455a64}.order-code-chip[_ngcontent-%COMP%]{font-size:.9em;color:#3f51b5;font-weight:500;margin-left:16px;flex-grow:1}.close-button[_ngcontent-%COMP%]{min-width:auto;padding:0;line-height:normal;color:#757575}.dialog-content[_ngcontent-%COMP%]{padding:20px 24px 24px;overflow-y:auto;flex-grow:1;background-color:#fff}.info-card[_ngcontent-%COMP%]{margin-bottom:24px;border:1px solid #eeeeee!important;box-shadow:none!important;border-radius:8px}.info-card[_ngcontent-%COMP%]:last-child{margin-bottom:0}.info-card[_ngcontent-%COMP%]   mat-card-header.compact-card-header[_ngcontent-%COMP%]{padding:12px 16px;display:flex;align-items:center;justify-content:space-between;background-color:#fafafa;border-bottom:1px solid #eeeeee}.info-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:1.1em;font-weight:500;color:#546e7a;margin:0}.info-card[_ngcontent-%COMP%]   .status-badge-dialog[_ngcontent-%COMP%]{padding:4px 10px;border-radius:12px;font-size:.7rem;font-weight:600;text-transform:uppercase;color:#fff;line-height:1.2}.info-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:16px;font-size:.9rem}mat-grid-list[_ngcontent-%COMP%]{padding:0}mat-grid-tile[_ngcontent-%COMP%]     .mat-figure{align-items:flex-start;padding:8px}.detail-item[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;gap:10px}.detail-item[_ngcontent-%COMP%]   .detail-icon[_ngcontent-%COMP%]{color:#90a4ae;font-size:20px}.detail-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:column;line-height:1.4}.interactive-detail-item[_ngcontent-%COMP%]{cursor:pointer}.interactive-detail-item[_ngcontent-%COMP%]:hover   .detail-value[_ngcontent-%COMP%]{color:#3f51b5;text-decoration:underline}.link-like[_ngcontent-%COMP%]{color:#5c6bc0;font-weight:500}.detail-label[_ngcontent-%COMP%]{font-size:.75em;color:#616161;margin-bottom:2px;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.detail-value[_ngcontent-%COMP%]{color:#212121;word-break:break-word}.bold-value[_ngcontent-%COMP%]{font-weight:600;font-size:1.05em}.item-description[_ngcontent-%COMP%]{font-style:italic;color:#555;margin-bottom:12px;padding-bottom:12px;border-bottom:1px dashed #e0e0e0;font-size:.9em}.detail-block[_ngcontent-%COMP%]{margin-bottom:16px}.detail-block[_ngcontent-%COMP%]   .detail-label-block[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:.9em;font-weight:500;color:#607d8b;margin-bottom:6px}.detail-block[_ngcontent-%COMP%]   .detail-label-block[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px}.detail-block[_ngcontent-%COMP%]   .detail-value-block[_ngcontent-%COMP%]{font-size:.9em;color:#424242;padding-left:26px;white-space:pre-wrap}.dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #e0e0e0;background-color:#fafafa}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:8px}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-left:0}.status-registrado[_ngcontent-%COMP%]{background-color:#6610f2;color:#fff}.status-recogido[_ngcontent-%COMP%]{background-color:#fd7e14;color:#fff}.status-en-almacen[_ngcontent-%COMP%]{background-color:#0d6efd;color:#fff}.status-en-transito[_ngcontent-%COMP%]{background-color:#0c1a77;color:#d0c8c8}.status-entregado[_ngcontent-%COMP%]{background-color:#198754;color:#fff}.status-no-entregado[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.status-cancelado[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.status-rechazado[_ngcontent-%COMP%]{background-color:#ff6b6b;color:#fff}.status-reprogramado[_ngcontent-%COMP%]{background-color:#adb5bd;color:#212529}.status-desconocido[_ngcontent-%COMP%]{background-color:#9e9e9e;color:#fff}"]})};var ug=()=>[10,25,50,100],hg=()=>({"highlight-row":!1});function mg(t,r){t&1&&(v(0,"div",25),Ae(1,"mat-progress-spinner",26),x())}function pg(t,r){t&1&&(v(0,"th",27),b(1,"N\xB0 Pedido"),x())}function _g(t,r){if(t&1){let e=tt();v(0,"td",28)(1,"a",29),ye("click",function(){let i=De(e).$implicit,n=be();return Te(n.onViewOrderDetails(i))}),b(2),x()()}if(t&2){let e=r.$implicit;P(2),Dt(e.code)}}function gg(t,r){t&1&&(v(0,"th",27),b(1,"Tipo"),x())}function xg(t,r){if(t&1&&(v(0,"td",30),b(1),x()),t&2){let e=r.$implicit;P(),Ce(" ",e.shipment_type," ")}}function vg(t,r){t&1&&(v(0,"th",27),b(1,"Destinatario"),x())}function wg(t,r){if(t&1&&(v(0,"td",31),b(1),x()),t&2){let e=r.$implicit;j("matTooltip",e.recipient_name),P(),Ce(" ",e.recipient_name," ")}}function yg(t,r){t&1&&(v(0,"th",32),b(1," Estado "),x())}function bg(t,r){if(t&1&&(v(0,"td",30)(1,"span",33),b(2),x()()),t&2){let e=r.$implicit,a=be();P(),j("ngClass",a.getStatusClass(e.status)),P(),Ce(" ",e.status," ")}}function Cg(t,r){t&1&&(v(0,"th",27),b(1,"Distrito"),x())}function kg(t,r){if(t&1&&(v(0,"td",30),b(1),x()),t&2){let e=r.$implicit;P(),Ce(" ",e.delivery_district_name," ")}}function Eg(t,r){t&1&&(v(0,"th",27),b(1," F. Entrega Prog. "),x())}function Sg(t,r){if(t&1&&(v(0,"td",30),b(1),Ve(2,"date"),x()),t&2){let e=r.$implicit;P(),Ce(" ",e.delivery_date?It(2,1,e.delivery_date,"dd/MM/yy"):"-"," ")}}function Dg(t,r){t&1&&(v(0,"th",34),b(1," Cobrar "),x())}function Tg(t,r){if(t&1&&(v(0,"td",35),b(1),Ve(2,"currency"),x()),t&2){let e=r.$implicit;P(),Ce(" ",Ya(2,1,e.amount_to_collect_at_delivery,"PEN","S/ ","1.2-2")," ")}}function Ag(t,r){t&1&&(v(0,"th",36),b(1," Acciones "),x())}function Fg(t,r){if(t&1){let e=tt();v(0,"button",44),ye("click",function(){De(e);let i=be().$implicit,n=be();return Te(n.changeOrderStatus(i,n.OrderStatus.EN_TRANSITO))}),v(1,"mat-icon"),b(2,"local_shipping"),x()()}}function Og(t,r){if(t&1){let e=tt();v(0,"button",45),ye("click",function(){De(e);let i=be().$implicit,n=be();return Te(n.changeOrderStatus(i,n.OrderStatus.ENTREGADO))}),v(1,"mat-icon"),b(2,"check_circle_outline"),x()()}}function Mg(t,r){if(t&1){let e=tt();v(0,"button",42),ye("click",function(){De(e);let i=be().$implicit,n=be();return Te(n.openChangeStatusModal(i))}),v(1,"mat-icon"),b(2,"swap_horiz"),x(),v(3,"span"),b(4,"Cambiar Estado General"),x()()}}function Ig(t,r){if(t&1){let e=tt();v(0,"button",42),ye("click",function(){De(e);let i=be().$implicit,n=be();return Te(n.onReassignDriver(i))}),v(1,"mat-icon"),b(2,"person_pin_circle"),x(),v(3,"span"),b(4,"Reasignar Motorizado"),x()()}}function Pg(t,r){if(t&1){let e=tt();v(0,"td",37),me(1,Fg,3,0,"button",38)(2,Og,3,0,"button",39),v(3,"button",40)(4,"mat-icon"),b(5,"more_vert"),x()(),v(6,"mat-menu",41,0)(8,"button",42),ye("click",function(){let i=De(e).$implicit,n=be();return Te(n.onViewOrderDetails(i))}),v(9,"mat-icon"),b(10,"visibility"),x(),v(11,"span"),b(12,"Ver Detalles Completos"),x()(),me(13,Mg,5,0,"button",43),v(14,"button",42),ye("click",function(){let i=De(e).$implicit,n=be();return Te(n.onReschedule(i))}),v(15,"mat-icon"),b(16,"event_repeat"),x(),v(17,"span"),b(18,"Reprogramar"),x()(),me(19,Ig,5,0,"button",43),v(20,"button",42),ye("click",function(){let i=De(e).$implicit,n=be();return Te(n.onViewPdf(i))}),v(21,"mat-icon"),b(22,"picture_as_pdf"),x(),v(23,"span"),b(24,"Visualizar"),x()()()()}if(t&2){let e=r.$implicit,a=Tr(7),i=be();P(),j("ngIf",i.canMarkAs(e,i.OrderStatus.EN_TRANSITO)),P(),j("ngIf",i.canMarkAs(e,i.OrderStatus.ENTREGADO)),P(),j("matMenuTriggerFor",a),P(10),j("ngIf",i.isAdminOrDriver()),P(6),j("ngIf",i.isAdminUser())}}function Rg(t,r){t&1&&Ae(0,"tr",46)}function Ng(t,r){t&1&&Ae(0,"tr",47),t&2&&j("ngClass",Jl(1,hg))}function Lg(t,r){if(t&1&&(v(0,"tr",48)(1,"td",49),b(2," No se encontraron pedidos que coincidan con los filtros. "),x()()),t&2){let e=be();P(),xt("colspan",e.displayedColumns.length)}}var rl=class t{orders=[];isLoading=!1;totalCount=0;pageSize=10;pageIndex=0;pageChanged=new ke;sortChanged=new ke;statusChanged=new ke;viewPdfClicked=new ke;viewDetailsClicked=new ke;displayedColumns=["code","shipment_type","recipient_name","status","delivery_district_name","delivery_date","amount_to_collect_at_delivery","actions"];dataSource=new Cf;paginator;sort;dialog=Y(ko);snackBar=Y(Qa);OrderStatus=Si;constructor(){}ngOnChanges(r){r.orders&&this.orders&&(this.dataSource.data=this.orders)}ngAfterViewInit(){}canMarkAs(r,e){let a=r.status;return!1}onViewPdf(r){let e=rn.apiUrl+"/orders/"+r.id+"/pdf";window.open(e,"_blank"),this.viewPdfClicked.emit(r)}changeOrderStatus(r,e){console.log(`Changing status of order ${r.code} to ${e}`),this.statusChanged.emit({orderId:r.id,newStatus:e})}getStatusClass(r){return r?`status-${r.toLowerCase().replace(/[\s_]+/g,"-")}`:"status-desconocido"}openChangeStatusModal(r){let e=this.getAvailableStatuses(r);if(e.length===0){this.snackBar.open("No hay cambios de estado disponibles para este pedido.","OK",{duration:3e3});return}this.dialog.open(jo,{width:"450px",data:{order:r,availableStatuses:e},disableClose:!0}).afterClosed().subscribe(i=>{i&&i.newStatus?(console.log("Dialog result:",i),this.statusChanged.emit({orderId:r.id,newStatus:i.newStatus,details:i.reason?{reason:i.reason}:void 0})):console.log("Cambio de estado cancelado o sin selecci\xF3n.")})}getAvailableStatuses(r){switch(r.status){case"REGISTRADO":return["RECOGIDO","CANCELADO"];case"RECOGIDO":return["EN ALMACEN","CANCELADO"];case"EN ALMACEN":return["EN TRANSITO","CANCELADO"];case"EN TRANSITO":case"EN TRANSITO":return["ENTREGADO","CANCELADO","RECHAZADO","REPROGRAMADO"];default:return[]}}openReportIssueModal(r){console.log(`Open modal to report issue for order: ${r.code}`)}onViewOrderDetails(r){this.viewDetailsClicked.emit(r),this.dialog.open(tl,{width:"750px",maxWidth:"90vw",maxHeight:"90vh",data:{order:r},panelClass:"order-detail-dialog-responsive",autoFocus:"dialog"})}onUploadProof(r){console.log("Upload proof for order:",r.code),this.snackBar.open('Funci\xF3n "Subir Prueba" no implementada.',"OK",{duration:2e3})}onReschedule(r){console.log("Reschedule order:",r.code),this.snackBar.open('Funci\xF3n "Reprogramar" no implementada.',"OK",{duration:2e3})}onReassignDriver(r){console.log("Reassign driver for order:",r.code),this.snackBar.open('Funci\xF3n "Reasignar Motorizado" no implementada.',"OK",{duration:2e3})}isAdminOrDriver(){return!0}isAdminUser(){return!0}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=Ye({type:t,selectors:[["app-order-table"]],viewQuery:function(e,a){if(e&1&&(zt(No,5),zt(Lo,5)),e&2){let i;yt(i=bt())&&(a.paginator=i.first),yt(i=bt())&&(a.sort=i.first)}},inputs:{orders:"orders",isLoading:"isLoading",totalCount:"totalCount",pageSize:"pageSize",pageIndex:"pageIndex"},outputs:{pageChanged:"pageChanged",sortChanged:"sortChanged",statusChanged:"statusChanged",viewPdfClicked:"viewPdfClicked",viewDetailsClicked:"viewDetailsClicked"},features:[qr],decls:31,vars:10,consts:[["orderActionMenu","matMenu"],[1,"table-wrapper","mat-elevation-z4"],["class","spinner-overlay",4,"ngIf"],["mat-table","","matSort","",1,"orders-table",3,"matSortChange","dataSource"],["matColumnDef","code"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","code-cell",4,"matCellDef"],["matColumnDef","shipment_type"],["mat-cell","",4,"matCellDef"],["matColumnDef","recipient_name"],["mat-cell","","class","truncate-texts",3,"matTooltip",4,"matCellDef"],["matColumnDef","status"],["mat-header-cell","","mat-sort-header","","class","status-column-header",4,"matHeaderCellDef"],["matColumnDef","delivery_district_name"],["matColumnDef","delivery_date"],["matColumnDef","amount_to_collect_at_delivery"],["mat-header-cell","","mat-sort-header","","class","align-right",4,"matHeaderCellDef"],["mat-cell","","class","align-right amount-cell",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","actions-column-header",4,"matHeaderCellDef"],["mat-cell","","class","actions-cell",4,"matCellDef"],["mat-header-row","","class","header-row-sticky",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","data-row",3,"ngClass",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","","aria-label","Seleccione p\xE1gina de pedidos",3,"page","length","pageSize","pageIndex","pageSizeOptions"],[1,"spinner-overlay"],["mode","indeterminate","diameter","60"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"code-cell"],["matTooltip","Ver detalles del pedido",3,"click"],["mat-cell",""],["mat-cell","",1,"truncate-texts",3,"matTooltip"],["mat-header-cell","","mat-sort-header","",1,"status-column-header"],[1,"status-badge",3,"ngClass"],["mat-header-cell","","mat-sort-header","",1,"align-right"],["mat-cell","",1,"align-right","amount-cell"],["mat-header-cell","",1,"actions-column-header"],["mat-cell","",1,"actions-cell"],["mat-icon-button","","color","primary","matTooltip","Marcar como En Tr\xE1nsito",3,"click",4,"ngIf"],["mat-icon-button","","class","action-icon-delivered","matTooltip","Marcar como Entregado",3,"click",4,"ngIf"],["mat-icon-button","","aria-label","M\xE1s acciones del pedido",1,"action-icon-neutral",3,"matMenuTriggerFor"],["xPosition","before"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-icon-button","","color","primary","matTooltip","Marcar como En Tr\xE1nsito",3,"click"],["mat-icon-button","","matTooltip","Marcar como Entregado",1,"action-icon-delivered",3,"click"],["mat-header-row","",1,"header-row-sticky"],["mat-row","",1,"data-row",3,"ngClass"],[1,"mat-row"],[1,"no-data-cell"]],template:function(e,a){e&1&&(v(0,"div",1),me(1,mg,2,0,"div",2),v(2,"table",3),ye("matSortChange",function(n){return a.sortChanged.emit(n)}),vt(3,4),me(4,pg,2,0,"th",5)(5,_g,3,1,"td",6),wt(),vt(6,7),me(7,gg,2,0,"th",5)(8,xg,2,1,"td",8),wt(),vt(9,9),me(10,vg,2,0,"th",5)(11,wg,2,2,"td",10),wt(),vt(12,11),me(13,yg,2,0,"th",12)(14,bg,3,2,"td",8),wt(),vt(15,13),me(16,Cg,2,0,"th",5)(17,kg,2,1,"td",8),wt(),vt(18,14),me(19,Eg,2,0,"th",5)(20,Sg,3,4,"td",8),wt(),vt(21,15),me(22,Dg,2,0,"th",16)(23,Tg,3,6,"td",17),wt(),vt(24,18),me(25,Ag,2,0,"th",19)(26,Pg,25,5,"td",20),wt(),me(27,Rg,1,0,"tr",21)(28,Ng,1,2,"tr",22)(29,Lg,3,1,"tr",23),x(),v(30,"mat-paginator",24),ye("page",function(n){return a.pageChanged.emit(n)}),x()()),e&2&&(P(),j("ngIf",a.isLoading),P(),j("dataSource",a.dataSource),P(25),j("matHeaderRowDef",a.displayedColumns)("matHeaderRowDefSticky",!0),P(),j("matRowDefColumns",a.displayedColumns),P(2),j("length",a.totalCount)("pageSize",a.pageSize)("pageIndex",a.pageIndex)("pageSizeOptions",Jl(9,ug)))},dependencies:[Tt,la,Qt,tn,gr,Ro,Eo,Do,Oo,To,So,Mo,Ao,Fo,Io,Po,bf,kf,No,Sf,Lo,Ef,ja,Xa,dt,Da,er,xr,ei,Ja,yo,vo,xo,wo,ti,cn,dn],styles:["[_nghost-%COMP%]{display:block}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;border-radius:12px;background-color:#fff;margin-top:20px;box-shadow:0 4px 20px #00000014;transition:box-shadow .3s ease-in-out}.table-wrapper[_ngcontent-%COMP%]:hover{box-shadow:0 6px 25px #0000001f}.spinner-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background-color:#ffffffd9;display:flex;justify-content:center;align-items:center;z-index:100;border-radius:12px}.orders-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th.mat-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#37474f;background-color:#f8f9fa;padding:14px 18px;border-bottom:1px solid #dee2e6;text-transform:uppercase;font-size:.8rem;letter-spacing:.5px}td.mat-cell[_ngcontent-%COMP%]{padding:12px 18px;border-bottom:1px solid #f1f3f5;color:#495057;font-size:.9rem}.header-row-sticky[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10;background-color:#f8f9fa}.data-row[_ngcontent-%COMP%]{transition:background-color .2s ease-in-out}.data-row[_ngcontent-%COMP%]:hover{background-color:#e9ecef;cursor:pointer}.highlight-row[_ngcontent-%COMP%]{background-color:#dbeafe!important;font-weight:500}.align-right[_ngcontent-%COMP%]{text-align:right;justify-content:flex-end}.amount-cell[_ngcontent-%COMP%]{font-weight:500}.actions-column-header[_ngcontent-%COMP%]{text-align:center!important}.actions-cell[_ngcontent-%COMP%]{text-align:center;white-space:nowrap}.actions-cell[_ngcontent-%COMP%]   button.mat-icon-button[_ngcontent-%COMP%]{margin:0 2px;color:#546e7a;transition:color .2s ease}.action-icon-delivered[_ngcontent-%COMP%]{color:#4caf50}.action-icon-delivered[_ngcontent-%COMP%]:hover{color:#388e3c}.action-icon-neutral[_ngcontent-%COMP%]{color:#78909c}.action-icon-neutral[_ngcontent-%COMP%]:hover{color:#546e7a}.no-data-cell[_ngcontent-%COMP%]{text-align:center;padding:50px;font-style:italic;color:#6c757d;font-size:1rem}.mat-mdc-paginator[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom-left-radius:12px;border-bottom-right-radius:12px;color:#495057;border-top:1px solid #dee2e6;padding:8px 0}.truncate-text[_ngcontent-%COMP%]{max-width:180px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:inline-block;vertical-align:middle}.code-cell[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#3f51b5;text-decoration:none;font-weight:500}.code-cell[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.status-badge[_ngcontent-%COMP%]{padding:5px 12px;border-radius:16px;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;display:inline-flex;align-items:center;line-height:1}.status-registrado[_ngcontent-%COMP%]{background-color:#6610f2;color:#fff}.status-recogido[_ngcontent-%COMP%]{background-color:#fd7e14;color:#fff}.status-en-almacen[_ngcontent-%COMP%]{background-color:#0d6efd;color:#fff}.status-en-transito[_ngcontent-%COMP%]{background-color:#0c1a77;color:#fff}.status-entregado[_ngcontent-%COMP%]{background-color:#198754;color:#fff}.status-no-entregado[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.status-cancelado[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.status-rechazado[_ngcontent-%COMP%]{background-color:#ff6b6b;color:#fff}.status-reprogramado[_ngcontent-%COMP%]{background-color:#adb5bd;color:#212529}"]})};var Ds={};Ds.version="0.18.5";var xa=1200,Pn=1252,Bg=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],d0={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},f0=function(t){Bg.indexOf(t)!=-1&&(Pn=d0[0]=t)};function Vg(){f0(1252)}var Jr=function(t){xa=t,f0(t)};function u0(){Jr(1200),Vg()}function Qc(t){for(var r=[],e=0,a=t.length;e<a;++e)r[e]=t.charCodeAt(e);return r}function Ug(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e)+(t.charCodeAt(2*e+1)<<8));return r.join("")}function Fh(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e+1)+(t.charCodeAt(2*e)<<8));return r.join("")}var _s=function(t){var r=t.charCodeAt(0),e=t.charCodeAt(1);return r==255&&e==254?Ug(t.slice(2)):r==254&&e==255?Fh(t.slice(2)):r==65279?t.slice(1):t},al=function(r){return String.fromCharCode(r)},bu=function(r){return String.fromCharCode(r)},Ke;var ht=null,ms=!0,li="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ts(t){for(var r="",e=0,a=0,i=0,n=0,s=0,o=0,l=0,c=0;c<t.length;)e=t.charCodeAt(c++),n=e>>2,a=t.charCodeAt(c++),s=(e&3)<<4|a>>4,i=t.charCodeAt(c++),o=(a&15)<<2|i>>6,l=i&63,isNaN(a)?o=l=64:isNaN(i)&&(l=64),r+=li.charAt(n)+li.charAt(s)+li.charAt(o)+li.charAt(l);return r}function Ir(t){var r="",e=0,a=0,i=0,n=0,s=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)n=li.indexOf(t.charAt(c++)),s=li.indexOf(t.charAt(c++)),e=n<<2|s>>4,r+=String.fromCharCode(e),o=li.indexOf(t.charAt(c++)),a=(s&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(a)),l=li.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(r+=String.fromCharCode(i));return r}var Ue=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ra=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(r,e){return e?new Buffer(r,e):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function di(t){return Ue?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Cu(t){return Ue?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Or=function(r){return Ue?Ra(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)&255})};function Dl(t){if(typeof ArrayBuffer>"u")return Or(t);for(var r=new ArrayBuffer(t.length),e=new Uint8Array(r),a=0;a!=t.length;++a)e[a]=t.charCodeAt(a)&255;return r}function mi(t){if(Array.isArray(t))return t.map(function(a){return String.fromCharCode(a)}).join("");for(var r=[],e=0;e<t.length;++e)r[e]=String.fromCharCode(t[e]);return r.join("")}function Hg(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function h0(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return h0(new Uint8Array(t));for(var r=new Array(t.length),e=0;e<t.length;++e)r[e]=t[e];return r}var Wt=Ue?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:Ra(r)}))}:function(t){if(typeof Uint8Array<"u"){var r=0,e=0;for(r=0;r<t.length;++r)e+=t[r].length;var a=new Uint8Array(e),i=0;for(r=0,e=0;r<t.length;e+=i,++r)if(i=t[r].length,t[r]instanceof Uint8Array)a.set(t[r],e);else{if(typeof t[r]=="string")throw"wtf";a.set(new Uint8Array(t[r]),e)}return a}return[].concat.apply([],t.map(function(n){return Array.isArray(n)?n:[].slice.call(n)}))};function Wg(t){for(var r=[],e=0,a=t.length+250,i=di(t.length+255),n=0;n<t.length;++n){var s=t.charCodeAt(n);if(s<128)i[e++]=s;else if(s<2048)i[e++]=192|s>>6&31,i[e++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=t.charCodeAt(++n)&1023;i[e++]=240|s>>8&7,i[e++]=128|s>>2&63,i[e++]=128|o>>6&15|(s&3)<<4,i[e++]=128|o&63}else i[e++]=224|s>>12&15,i[e++]=128|s>>6&63,i[e++]=128|s&63;e>a&&(r.push(i.slice(0,e)),e=0,i=di(65535),a=65530)}return r.push(i.slice(0,e)),Wt(r)}var or=/\u0000/g,gs=/[\u0001-\u0006]/g;function Fn(t){for(var r="",e=t.length-1;e>=0;)r+=t.charAt(e--);return r}function ea(t,r){var e=""+t;return e.length>=r?e:ft("0",r-e.length)+e}function m0(t,r){var e=""+t;return e.length>=r?e:ft(" ",r-e.length)+e}function ml(t,r){var e=""+t;return e.length>=r?e:e+ft(" ",r-e.length)}function Gg(t,r){var e=""+Math.round(t);return e.length>=r?e:ft("0",r-e.length)+e}function zg(t,r){var e=""+t;return e.length>=r?e:ft("0",r-e.length)+e}var ku=Math.pow(2,32);function kn(t,r){if(t>ku||t<-ku)return Gg(t,r);var e=Math.round(t);return zg(e,r)}function pl(t,r){return r=r||0,t.length>=7+r&&(t.charCodeAt(r)|32)===103&&(t.charCodeAt(r+1)|32)===101&&(t.charCodeAt(r+2)|32)===110&&(t.charCodeAt(r+3)|32)===101&&(t.charCodeAt(r+4)|32)===114&&(t.charCodeAt(r+5)|32)===97&&(t.charCodeAt(r+6)|32)===108}var Eu=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Bc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Yg(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',t}var Fe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},Su={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$g={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _l(t,r,e){for(var a=t<0?-1:1,i=t*a,n=0,s=1,o=0,l=1,c=0,d=0,f=Math.floor(i);c<r&&(f=Math.floor(i),o=f*s+n,d=f*c+l,!(i-f<5e-8));)i=1/(i-f),n=s,s=o,l=c,c=d;if(d>r&&(c>r?(d=l,o=n):(d=c,o=s)),!e)return[0,a*o,d];var h=Math.floor(a*o/d);return[h,a*o-h*d,d]}function Ai(t,r,e){if(t>2958465||t<0)return null;var a=t|0,i=Math.floor(86400*(t-a)),n=0,s=[],o={D:a,T:i,u:86400*(t-a)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++a,++o.D)),a===60)s=e?[1317,10,29]:[1900,2,29],n=3;else if(a===0)s=e?[1317,8,29]:[1900,1,0],n=6;else{a>60&&--a;var l=new Date(1900,0,1);l.setDate(l.getDate()+a-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],n=l.getDay(),a<60&&(n=(n+6)%7),e&&(n=Qg(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=n,o}var Oh=new Date(1899,11,31,0,0,0),Xg=Oh.getTime(),jg=new Date(1900,2,1,0,0,0);function Mh(t,r){var e=t.getTime();return r?e-=1461*24*60*60*1e3:t>=jg&&(e+=24*60*60*1e3),(e-(Xg+(t.getTimezoneOffset()-Oh.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function p0(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Kg(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function qg(t){var r=t<0?12:11,e=p0(t.toFixed(12));return e.length<=r||(e=t.toPrecision(10),e.length<=r)?e:t.toExponential(5)}function Zg(t){var r=p0(t.toFixed(11));return r.length>(t<0?12:11)||r==="0"||r==="-0"?t.toPrecision(6):r}function As(t){var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return r>=-4&&r<=-1?e=t.toPrecision(10+r):Math.abs(r)<=9?e=qg(t):r===10?e=t.toFixed(10).substr(0,12):e=Zg(t),p0(Kg(e.toUpperCase()))}function Pi(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):As(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return jr(14,Mh(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function Qg(t,r){r[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function Jg(t,r,e,a){var i="",n=0,s=0,o=e.y,l,c=0;switch(t){case 98:o=e.y+543;case 121:switch(r.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(r.length){case 1:case 2:l=e.m,c=r.length;break;case 3:return Bc[e.m-1][1];case 5:return Bc[e.m-1][0];default:return Bc[e.m-1][2]}break;case 100:switch(r.length){case 1:case 2:l=e.d,c=r.length;break;case 3:return Eu[e.q][0];default:return Eu[e.q][1]}break;case 104:switch(r.length){case 1:case 2:l=1+(e.H+11)%12,c=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:l=e.H,c=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:l=e.M,c=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return e.u===0&&(r=="s"||r=="ss")?ea(e.S,r.length):(a>=2?s=a===3?1e3:100:s=a===1?10:1,n=Math.round(s*(e.S+e.u)),n>=60*s&&(n=0),r==="s"?n===0?"0":""+n/s:(i=ea(n,2+a),r==="ss"?i.substr(0,2):"."+i.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":l=e.D*24+e.H;break;case"[m]":case"[mm]":l=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":l=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+r}c=r.length===3?1:2;break;case 101:l=o,c=1;break}var d=c>0?ea(l,c):"";return d}function ci(t){var r=3;if(t.length<=r)return t;for(var e=t.length%r,a=t.substr(0,e);e!=t.length;e+=r)a+=(a.length>0?",":"")+t.substr(e,r);return a}var Ih=/%/g;function e1(t,r,e){var a=r.replace(Ih,""),i=r.length-a.length;return Oa(t,a,e*Math.pow(10,2*i))+ft("%",i)}function t1(t,r,e){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return Oa(t,r.substr(0,a),e/Math.pow(10,3*(r.length-a)))}function Ph(t,r){var e,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Ph(t,-r);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var n=Math.floor(Math.log(r)*Math.LOG10E)%i;if(n<0&&(n+=i),e=(r/Math.pow(10,n)).toPrecision(a+1+(i+n)%i),e.indexOf("e")===-1){var s=Math.floor(Math.log(r)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+n):e+="E+"+(s-n);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,i)+"."+e.substr(2+i),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(i+n)%i)+"."+d.substr(n)+"E"})}else e=r.toExponential(a);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var Rh=/# (\?+)( ?)\/( ?)(\d+)/;function r1(t,r,e){var a=parseInt(t[4],10),i=Math.round(r*a),n=Math.floor(i/a),s=i-n*a,o=a;return e+(n===0?"":""+n)+" "+(s===0?ft(" ",t[1].length+1+t[4].length):m0(s,t[1].length)+t[2]+"/"+t[3]+ea(o,t[4].length))}function a1(t,r,e){return e+(r===0?"":""+r)+ft(" ",t[1].length+2+t[4].length)}var Nh=/^#*0*\.([0#]+)/,Lh=/\).*[0#]/,Bh=/\(###\) ###\\?-####/;function mr(t){for(var r="",e,a=0;a!=t.length;++a)switch(e=t.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(e)}return r}function Du(t,r){var e=Math.pow(10,r);return""+Math.round(t*e)/e}function Tu(t,r){var e=t-Math.floor(t),a=Math.pow(10,r);return r<(""+Math.round(e*a)).length?0:Math.round(e*a)}function i1(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}function n1(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Wr(t,r,e){if(t.charCodeAt(0)===40&&!r.match(Lh)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Wr("n",a,e):"("+Wr("n",a,-e)+")"}if(r.charCodeAt(r.length-1)===44)return t1(t,r,e);if(r.indexOf("%")!==-1)return e1(t,r,e);if(r.indexOf("E")!==-1)return Ph(r,e);if(r.charCodeAt(0)===36)return"$"+Wr(t,r.substr(r.charAt(1)==" "?2:1),e);var i,n,s,o,l=Math.abs(e),c=e<0?"-":"";if(r.match(/^00+$/))return c+kn(l,r.length);if(r.match(/^[#?]+$/))return i=kn(e,0),i==="0"&&(i=""),i.length>r.length?i:mr(r.substr(0,r.length-i.length))+i;if(n=r.match(Rh))return r1(n,l,c);if(r.match(/^#+0+$/))return c+kn(l,r.length-r.indexOf("0"));if(n=r.match(Nh))return i=Du(e,n[1].length).replace(/^([^\.]+)$/,"$1."+mr(n[1])).replace(/\.$/,"."+mr(n[1])).replace(/\.(\d*)$/,function(p,u){return"."+u+ft("0",mr(n[1]).length-u.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),n=r.match(/^(0*)\.(#*)$/))return c+Du(l,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=r.match(/^#{1,3},##0(\.?)$/))return c+ci(kn(l,0));if(n=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Wr(t,r,-e):ci(""+(Math.floor(e)+i1(e,n[1].length)))+"."+ea(Tu(e,n[1].length),n[1].length);if(n=r.match(/^#,#*,#0/))return Wr(t,r.replace(/^#,#*,/,""),e);if(n=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Fn(Wr(t,r.replace(/[\\-]/g,""),e)),s=0,Fn(Fn(r.replace(/\\/g,"")).replace(/[0#]/g,function(p){return s<i.length?i.charAt(s++):p==="0"?"0":""}));if(r.match(Bh))return i=Wr(t,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(n=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(n[4].length,7),o=_l(l,Math.pow(10,s)-1,!1),i=""+c,d=Oa("n",n[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+n[2]+"/"+n[3],d=ml(o[2],s),d.length<n[4].length&&(d=mr(n[4].substr(n[4].length-d.length))+d),i+=d,i;if(n=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(n[1].length,n[4].length),7),o=_l(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?m0(o[1],s)+n[2]+"/"+n[3]+ml(o[2],s):ft(" ",2*s+1+n[2].length+n[3].length));if(n=r.match(/^[#0?]+$/))return i=kn(e,0),r.length<=i.length?i:mr(r.substr(0,r.length-i.length))+i;if(n=r.match(/^([#0?]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var f=r.indexOf(".")-s,h=r.length-i.length-f;return mr(r.substr(0,f)+i+r.substr(r.length-h))}if(n=r.match(/^00,000\.([#0]*0)$/))return s=Tu(e,n[1].length),e<0?"-"+Wr(t,r,-e):ci(n1(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?ea(0,3-p.length):"")+p})+"."+ea(s,n[1].length);switch(r){case"###,##0.00":return Wr(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var m=ci(kn(l,0));return m!=="0"?c+m:"";case"###,###.00":return Wr(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Wr(t,"#,##0.00",e).replace(/^0\./,".");default:}throw new Error("unsupported format |"+r+"|")}function s1(t,r,e){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return Oa(t,r.substr(0,a),e/Math.pow(10,3*(r.length-a)))}function o1(t,r,e){var a=r.replace(Ih,""),i=r.length-a.length;return Oa(t,a,e*Math.pow(10,2*i))+ft("%",i)}function Vh(t,r){var e,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Vh(t,-r);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var n=Math.floor(Math.log(r)*Math.LOG10E)%i;if(n<0&&(n+=i),e=(r/Math.pow(10,n)).toPrecision(a+1+(i+n)%i),!e.match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+n):e+="E+"+(s-n),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(i+n)%i)+"."+d.substr(n)+"E"})}else e=r.toExponential(a);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function pa(t,r,e){if(t.charCodeAt(0)===40&&!r.match(Lh)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?pa("n",a,e):"("+pa("n",a,-e)+")"}if(r.charCodeAt(r.length-1)===44)return s1(t,r,e);if(r.indexOf("%")!==-1)return o1(t,r,e);if(r.indexOf("E")!==-1)return Vh(r,e);if(r.charCodeAt(0)===36)return"$"+pa(t,r.substr(r.charAt(1)==" "?2:1),e);var i,n,s,o,l=Math.abs(e),c=e<0?"-":"";if(r.match(/^00+$/))return c+ea(l,r.length);if(r.match(/^[#?]+$/))return i=""+e,e===0&&(i=""),i.length>r.length?i:mr(r.substr(0,r.length-i.length))+i;if(n=r.match(Rh))return a1(n,l,c);if(r.match(/^#+0+$/))return c+ea(l,r.length-r.indexOf("0"));if(n=r.match(Nh))return i=(""+e).replace(/^([^\.]+)$/,"$1."+mr(n[1])).replace(/\.$/,"."+mr(n[1])),i=i.replace(/\.(\d*)$/,function(p,u){return"."+u+ft("0",mr(n[1]).length-u.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),n=r.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=r.match(/^#{1,3},##0(\.?)$/))return c+ci(""+l);if(n=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+pa(t,r,-e):ci(""+e)+"."+ft("0",n[1].length);if(n=r.match(/^#,#*,#0/))return pa(t,r.replace(/^#,#*,/,""),e);if(n=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Fn(pa(t,r.replace(/[\\-]/g,""),e)),s=0,Fn(Fn(r.replace(/\\/g,"")).replace(/[0#]/g,function(p){return s<i.length?i.charAt(s++):p==="0"?"0":""}));if(r.match(Bh))return i=pa(t,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(n=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(n[4].length,7),o=_l(l,Math.pow(10,s)-1,!1),i=""+c,d=Oa("n",n[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+n[2]+"/"+n[3],d=ml(o[2],s),d.length<n[4].length&&(d=mr(n[4].substr(n[4].length-d.length))+d),i+=d,i;if(n=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(n[1].length,n[4].length),7),o=_l(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?m0(o[1],s)+n[2]+"/"+n[3]+ml(o[2],s):ft(" ",2*s+1+n[2].length+n[3].length));if(n=r.match(/^[#0?]+$/))return i=""+e,r.length<=i.length?i:mr(r.substr(0,r.length-i.length))+i;if(n=r.match(/^([#0]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var f=r.indexOf(".")-s,h=r.length-i.length-f;return mr(r.substr(0,f)+i+r.substr(r.length-h))}if(n=r.match(/^00,000\.([#0]*0)$/))return e<0?"-"+pa(t,r,-e):ci(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?ea(0,3-p.length):"")+p})+"."+ea(0,n[1].length);switch(r){case"###,###":case"##,###":case"#,###":var m=ci(""+l);return m!=="0"?c+m:"";default:if(r.match(/\.[0#?]*$/))return pa(t,r.slice(0,r.lastIndexOf(".")),e)+mr(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Oa(t,r,e){return(e|0)===e?pa(t,r,e):Wr(t,r,e)}function l1(t){for(var r=[],e=!1,a=0,i=0;a<t.length;++a)switch(t.charCodeAt(a)){case 34:e=!e;break;case 95:case 42:case 92:++a;break;case 59:r[r.length]=t.substr(i,a-i),i=a+1}if(r[r.length]=t.substr(i),e===!0)throw new Error("Format |"+t+"| unterminated string ");return r}var Uh=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Bn(t){for(var r=0,e="",a="";r<t.length;)switch(e=t.charAt(r)){case"G":pl(t,r)&&(r+=6),r++;break;case'"':for(;t.charCodeAt(++r)!==34&&r<t.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(t.charAt(r+1)==="1"||t.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(t.substr(r,3).toUpperCase()==="A/P"||t.substr(r,5).toUpperCase()==="AM/PM"||t.substr(r,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++r;break;case"[":for(a=e;t.charAt(r++)!=="]"&&r<t.length;)a+=t.charAt(r);if(a.match(Uh))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++r))>-1||e=="\\"&&t.charAt(r+1)=="-"&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===e;);break;case"*":++r,(t.charAt(r)==" "||t.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function c1(t,r,e,a){for(var i=[],n="",s=0,o="",l="t",c,d,f,h="H";s<t.length;)switch(o=t.charAt(s)){case"G":if(!pl(t,s))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(n="";(f=t.charCodeAt(++s))!==34&&s<t.length;)n+=String.fromCharCode(f);i[i.length]={t:"t",v:n},++s;break;case"\\":var m=t.charAt(++s),p=m==="("||m===")"?m:"t";i[i.length]={t:p,v:m},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:r},++s;break;case"B":case"b":if(t.charAt(s+1)==="1"||t.charAt(s+1)==="2"){if(c==null&&(c=Ai(r,e,t.charAt(s+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||c==null&&(c=Ai(r,e),c==null))return"";for(n=o;++s<t.length&&t.charAt(s).toLowerCase()===o;)n+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),i[i.length]={t:o,v:n},l=o;break;case"A":case"a":case"\u4E0A":var u={t:o,v:o};if(c==null&&(c=Ai(r,e)),t.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(u.v=c.H>=12?"P":"A"),u.t="T",h="h",s+=3):t.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(u.v=c.H>=12?"PM":"AM"),u.t="T",s+=5,h="h"):t.substr(s,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(c!=null&&(u.v=c.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),u.t="T",s+=5,h="h"):(u.t="t",++s),c==null&&u.t==="T")return"";i[i.length]=u,l=o;break;case"[":for(n=o;t.charAt(s++)!=="]"&&s<t.length;)n+=t.charAt(s);if(n.slice(-1)!=="]")throw'unterminated "[" block: |'+n+"|";if(n.match(Uh)){if(c==null&&(c=Ai(r,e),c==null))return"";i[i.length]={t:"Z",v:n.toLowerCase()},l=n.charAt(1)}else n.indexOf("$")>-1&&(n=(n.match(/\$([^-\[\]]*)/)||[])[1]||"$",Bn(t)||(i[i.length]={t:"t",v:n}));break;case".":if(c!=null){for(n=o;++s<t.length&&(o=t.charAt(s))==="0";)n+=o;i[i.length]={t:"s",v:n};break}case"0":case"#":for(n=o;++s<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(s))>-1;)n+=o;i[i.length]={t:"n",v:n};break;case"?":for(n=o;t.charAt(++s)===o;)n+=o;i[i.length]={t:o,v:n},l=o;break;case"*":++s,(t.charAt(s)==" "||t.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:a===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(n=o;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;)n+=t.charAt(s);i[i.length]={t:"D",v:n};break;case" ":i[i.length]={t:o,v:o},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++s;break}var _=0,E=0,k;for(s=i.length-1,l="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=h,l="h",_<1&&(_=1);break;case"s":(k=i[s].v.match(/\.0+$/))&&(E=Math.max(E,k[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=i[s].t;break;case"m":l==="s"&&(i[s].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[s].v.match(/[Hh]/)&&(_=1),_<2&&i[s].v.match(/[Mm]/)&&(_=2),_<3&&i[s].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",L;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=Jg(i[s].t.charCodeAt(0),i[s].v,c,E),i[s].t="t";break;case"n":case"?":for(L=s+1;i[L]!=null&&((o=i[L].t)==="?"||o==="D"||(o===" "||o==="t")&&i[L+1]!=null&&(i[L+1].t==="?"||i[L+1].t==="t"&&i[L+1].v==="/")||i[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[L].v==="/"||i[L].v===" "&&i[L+1]!=null&&i[L+1].t=="?"));)i[s].v+=i[L].v,i[L]={v:"",t:";"},++L;w+=i[s].v,s=L-1;break;case"G":i[s].t="t",i[s].v=Pi(r,e);break}var U="",R,T;if(w.length>0){w.charCodeAt(0)==40?(R=r<0&&w.charCodeAt(0)===45?-r:r,T=Oa("n",w,R)):(R=r<0&&a>1?-r:r,T=Oa("n",w,R),R<0&&i[0]&&i[0].t=="t"&&(T=T.substr(1),i[0].v="-"+i[0].v)),L=T.length-1;var B=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){B=s;break}var N=i.length;if(B===i.length&&T.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(L>=i[s].v.length-1?(L-=i[s].v.length,i[s].v=T.substr(L+1,i[s].v.length)):L<0?i[s].v="":(i[s].v=T.substr(0,L+1),L=-1),i[s].t="t",N=s);L>=0&&N<i.length&&(i[N].v=T.substr(0,L+1)+i[N].v)}else if(B!==i.length&&T.indexOf("E")===-1){for(L=T.indexOf(".")-1,s=B;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(d=i[s].v.indexOf(".")>-1&&s===B?i[s].v.indexOf(".")-1:i[s].v.length-1,U=i[s].v.substr(d+1);d>=0;--d)L>=0&&(i[s].v.charAt(d)==="0"||i[s].v.charAt(d)==="#")&&(U=T.charAt(L--)+U);i[s].v=U,i[s].t="t",N=s}for(L>=0&&N<i.length&&(i[N].v=T.substr(0,L+1)+i[N].v),L=T.indexOf(".")+1,s=B;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==B)){for(d=i[s].v.indexOf(".")>-1&&s===B?i[s].v.indexOf(".")+1:0,U=i[s].v.substr(0,d);d<i[s].v.length;++d)L<T.length&&(U+=T.charAt(L++));i[s].v=U,i[s].t="t",N=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(R=a>1&&r<0&&s>0&&i[s-1].v==="-"?-r:r,i[s].v=Oa(i[s].t,i[s].v,R),i[s].t="t");var K="";for(s=0;s!==i.length;++s)i[s]!=null&&(K+=i[s].v);return K}var Au=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Fu(t,r){if(r==null)return!1;var e=parseFloat(r[2]);switch(r[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function d1(t,r){var e=l1(t),a=e.length,i=e[a-1].indexOf("@");if(a<4&&i>-1&&--a,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof r!="number")return[4,e.length===4||i>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=i>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=i>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=i>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break;case 4:break}var n=r>0?e[0]:r<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[a,n];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var s=e[0].match(Au),o=e[1].match(Au);return Fu(r,s)?[a,e[0]]:Fu(r,o)?[a,e[1]]:[a,e[s!=null&&o!=null?2:1]]}return[a,n]}function jr(t,r,e){e==null&&(e={});var a="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?a=e.dateNF:a=t;break;case"number":t==14&&e.dateNF?a=e.dateNF:a=(e.table!=null?e.table:Fe)[t],a==null&&(a=e.table&&e.table[Su[t]]||Fe[Su[t]]),a==null&&(a=$g[t]||"General");break}if(pl(a,0))return Pi(r,e);r instanceof Date&&(r=Mh(r,e.date1904));var i=d1(a,r);if(pl(i[1]))return Pi(r,e);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return c1(i[1],r,e,i[0])}function Ma(t,r){if(typeof r!="number"){r=+r||-1;for(var e=0;e<392;++e){if(Fe[e]==null){r<0&&(r=e);continue}if(Fe[e]==t){r=e;break}}r<0&&(r=391)}return Fe[r]=t,r}function Tl(t){for(var r=0;r!=392;++r)t[r]!==void 0&&Ma(t[r],r)}function Vn(){Fe=Yg()}var f1={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Hh=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function u1(t){var r=typeof t=="number"?Fe[t]:t;return r=r.replace(Hh,"(\\d+)"),new RegExp("^"+r+"$")}function h1(t,r,e){var a=-1,i=-1,n=-1,s=-1,o=-1,l=-1;(r.match(Hh)||[]).forEach(function(f,h){var m=parseInt(e[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":a=m;break;case"d":n=m;break;case"h":s=m;break;case"s":l=m;break;case"m":s>=0?o=m:i=m;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:a==-1&&i==-1&&n==-1?d:c+"T"+d}var m1=function(){var t={};t.version="1.2.0";function r(){for(var T=0,B=new Array(256),N=0;N!=256;++N)T=N,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,B[N]=T;return typeof Int32Array<"u"?new Int32Array(B):B}var e=r();function a(T){var B=0,N=0,K=0,q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(K=0;K!=256;++K)q[K]=T[K];for(K=0;K!=256;++K)for(N=T[K],B=256+K;B<4096;B+=256)N=q[B]=N>>>8^T[N&255];var V=[];for(K=1;K!=16;++K)V[K-1]=typeof Int32Array<"u"?q.subarray(K*256,K*256+256):q.slice(K*256,K*256+256);return V}var i=a(e),n=i[0],s=i[1],o=i[2],l=i[3],c=i[4],d=i[5],f=i[6],h=i[7],m=i[8],p=i[9],u=i[10],_=i[11],E=i[12],k=i[13],w=i[14];function L(T,B){for(var N=B^-1,K=0,q=T.length;K<q;)N=N>>>8^e[(N^T.charCodeAt(K++))&255];return~N}function U(T,B){for(var N=B^-1,K=T.length-15,q=0;q<K;)N=w[T[q++]^N&255]^k[T[q++]^N>>8&255]^E[T[q++]^N>>16&255]^_[T[q++]^N>>>24]^u[T[q++]]^p[T[q++]]^m[T[q++]]^h[T[q++]]^f[T[q++]]^d[T[q++]]^c[T[q++]]^l[T[q++]]^o[T[q++]]^s[T[q++]]^n[T[q++]]^e[T[q++]];for(K+=15;q<K;)N=N>>>8^e[(N^T[q++])&255];return~N}function R(T,B){for(var N=B^-1,K=0,q=T.length,V=0,se=0;K<q;)V=T.charCodeAt(K++),V<128?N=N>>>8^e[(N^V)&255]:V<2048?(N=N>>>8^e[(N^(192|V>>6&31))&255],N=N>>>8^e[(N^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,se=T.charCodeAt(K++)&1023,N=N>>>8^e[(N^(240|V>>8&7))&255],N=N>>>8^e[(N^(128|V>>2&63))&255],N=N>>>8^e[(N^(128|se>>6&15|(V&3)<<4))&255],N=N>>>8^e[(N^(128|se&63))&255]):(N=N>>>8^e[(N^(224|V>>12&15))&255],N=N>>>8^e[(N^(128|V>>6&63))&255],N=N>>>8^e[(N^(128|V&63))&255]);return~N}return t.table=e,t.bstr=L,t.buf=U,t.str=R,t}(),Se=function(){var r={};r.version="1.2.1";function e(g,S){for(var y=g.split("/"),C=S.split("/"),D=0,A=0,H=Math.min(y.length,C.length);D<H;++D){if(A=y[D].length-C[D].length)return A;if(y[D]!=C[D])return y[D]<C[D]?-1:1}return y.length-C.length}function a(g){if(g.charAt(g.length-1)=="/")return g.slice(0,-1).indexOf("/")===-1?g:a(g.slice(0,-1));var S=g.lastIndexOf("/");return S===-1?g:g.slice(0,S+1)}function i(g){if(g.charAt(g.length-1)=="/")return i(g.slice(0,-1));var S=g.lastIndexOf("/");return S===-1?g:g.slice(S+1)}function n(g,S){typeof S=="string"&&(S=new Date(S));var y=S.getHours();y=y<<6|S.getMinutes(),y=y<<5|S.getSeconds()>>>1,g.write_shift(2,y);var C=S.getFullYear()-1980;C=C<<4|S.getMonth()+1,C=C<<5|S.getDate(),g.write_shift(2,C)}function s(g){var S=g.read_shift(2)&65535,y=g.read_shift(2)&65535,C=new Date,D=y&31;y>>>=5;var A=y&15;y>>>=4,C.setMilliseconds(0),C.setFullYear(y+1980),C.setMonth(A-1),C.setDate(D);var H=S&31;S>>>=5;var Q=S&63;return S>>>=6,C.setHours(S),C.setMinutes(Q),C.setSeconds(H<<1),C}function o(g){$t(g,0);for(var S={},y=0;g.l<=g.length-4;){var C=g.read_shift(2),D=g.read_shift(2),A=g.l+D,H={};switch(C){case 21589:y=g.read_shift(1),y&1&&(H.mtime=g.read_shift(4)),D>5&&(y&2&&(H.atime=g.read_shift(4)),y&4&&(H.ctime=g.read_shift(4))),H.mtime&&(H.mt=new Date(H.mtime*1e3));break}g.l=A,S[C]=H}return S}var l;function c(){return l||(l={})}function d(g,S){if(g[0]==80&&g[1]==75)return sd(g,S);if((g[0]|32)==109&&(g[1]|32)==105)return Yp(g,S);if(g.length<512)throw new Error("CFB file size "+g.length+" < 512");var y=3,C=512,D=0,A=0,H=0,Q=0,z=0,W=[],X=g.slice(0,512);$t(X,0);var ae=f(X);switch(y=ae[0],y){case 3:C=512;break;case 4:C=4096;break;case 0:if(ae[1]==0)return sd(g,S);default:throw new Error("Major Version: Expected 3 or 4 saw "+y)}C!==512&&(X=g.slice(0,C),$t(X,28));var de=g.slice(0,C);h(X,y);var ve=X.read_shift(4,"i");if(y===3&&ve!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ve);X.l+=4,H=X.read_shift(4,"i"),X.l+=4,X.chk("00100000","Mini Stream Cutoff Size: "),Q=X.read_shift(4,"i"),D=X.read_shift(4,"i"),z=X.read_shift(4,"i"),A=X.read_shift(4,"i");for(var fe=-1,he=0;he<109&&(fe=X.read_shift(4,"i"),!(fe<0));++he)W[he]=fe;var Ie=m(g,C);_(z,A,Ie,C,W);var at=k(Ie,H,W,C);at[H].name="!Directory",D>0&&Q!==se&&(at[Q].name="!MiniFAT"),at[W[0]].name="!FAT",at.fat_addrs=W,at.ssz=C;var _r={},St=[],kr=[],Yn=[];w(H,at,Ie,St,D,_r,kr,Q),p(kr,Yn,St),St.shift();var $n={FileIndex:kr,FullPaths:Yn};return S&&S.raw&&($n.raw={header:de,sectors:Ie}),$n}function f(g){if(g[g.l]==80&&g[g.l+1]==75)return[0,0];g.chk(ge,"Header Signature: "),g.l+=16;var S=g.read_shift(2,"u");return[g.read_shift(2,"u"),S]}function h(g,S){var y=9;switch(g.l+=2,y=g.read_shift(2)){case 9:if(S!=3)throw new Error("Sector Shift: Expected 9 saw "+y);break;case 12:if(S!=4)throw new Error("Sector Shift: Expected 12 saw "+y);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+y)}g.chk("0600","Mini Sector Shift: "),g.chk("000000000000","Reserved: ")}function m(g,S){for(var y=Math.ceil(g.length/S)-1,C=[],D=1;D<y;++D)C[D-1]=g.slice(D*S,(D+1)*S);return C[y-1]=g.slice(y*S),C}function p(g,S,y){for(var C=0,D=0,A=0,H=0,Q=0,z=y.length,W=[],X=[];C<z;++C)W[C]=X[C]=C,S[C]=y[C];for(;Q<X.length;++Q)C=X[Q],D=g[C].L,A=g[C].R,H=g[C].C,W[C]===C&&(D!==-1&&W[D]!==D&&(W[C]=W[D]),A!==-1&&W[A]!==A&&(W[C]=W[A])),H!==-1&&(W[H]=C),D!==-1&&C!=W[C]&&(W[D]=W[C],X.lastIndexOf(D)<Q&&X.push(D)),A!==-1&&C!=W[C]&&(W[A]=W[C],X.lastIndexOf(A)<Q&&X.push(A));for(C=1;C<z;++C)W[C]===C&&(A!==-1&&W[A]!==A?W[C]=W[A]:D!==-1&&W[D]!==D&&(W[C]=W[D]));for(C=1;C<z;++C)if(g[C].type!==0){if(Q=C,Q!=W[Q])do Q=W[Q],S[C]=S[Q]+"/"+S[C];while(Q!==0&&W[Q]!==-1&&Q!=W[Q]);W[C]=-1}for(S[0]+="/",C=1;C<z;++C)g[C].type!==2&&(S[C]+="/")}function u(g,S,y){for(var C=g.start,D=g.size,A=[],H=C;y&&D>0&&H>=0;)A.push(S.slice(H*V,H*V+V)),D-=V,H=Ti(y,H*4);return A.length===0?Z(0):Wt(A).slice(0,g.size)}function _(g,S,y,C,D){var A=se;if(g===se){if(S!==0)throw new Error("DIFAT chain shorter than expected")}else if(g!==-1){var H=y[g],Q=(C>>>2)-1;if(!H)return;for(var z=0;z<Q&&(A=Ti(H,z*4))!==se;++z)D.push(A);_(Ti(H,C-4),S-1,y,C,D)}}function E(g,S,y,C,D){var A=[],H=[];D||(D=[]);var Q=C-1,z=0,W=0;for(z=S;z>=0;){D[z]=!0,A[A.length]=z,H.push(g[z]);var X=y[Math.floor(z*4/C)];if(W=z*4&Q,C<4+W)throw new Error("FAT boundary crossed: "+z+" 4 "+C);if(!g[X])break;z=Ti(g[X],W)}return{nodes:A,data:Wu([H])}}function k(g,S,y,C){var D=g.length,A=[],H=[],Q=[],z=[],W=C-1,X=0,ae=0,de=0,ve=0;for(X=0;X<D;++X)if(Q=[],de=X+S,de>=D&&(de-=D),!H[de]){z=[];var fe=[];for(ae=de;ae>=0;){fe[ae]=!0,H[ae]=!0,Q[Q.length]=ae,z.push(g[ae]);var he=y[Math.floor(ae*4/C)];if(ve=ae*4&W,C<4+ve)throw new Error("FAT boundary crossed: "+ae+" 4 "+C);if(!g[he]||(ae=Ti(g[he],ve),fe[ae]))break}A[de]={nodes:Q,data:Wu([z])}}return A}function w(g,S,y,C,D,A,H,Q){for(var z=0,W=C.length?2:0,X=S[g].data,ae=0,de=0,ve;ae<X.length;ae+=128){var fe=X.slice(ae,ae+128);$t(fe,64),de=fe.read_shift(2),ve=Ml(fe,0,de-W),C.push(ve);var he={name:ve,type:fe.read_shift(1),color:fe.read_shift(1),L:fe.read_shift(4,"i"),R:fe.read_shift(4,"i"),C:fe.read_shift(4,"i"),clsid:fe.read_shift(16),state:fe.read_shift(4,"i"),start:0,size:0},Ie=fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2);Ie!==0&&(he.ct=L(fe,fe.l-8));var at=fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2);at!==0&&(he.mt=L(fe,fe.l-8)),he.start=fe.read_shift(4,"i"),he.size=fe.read_shift(4,"i"),he.size<0&&he.start<0&&(he.size=he.type=0,he.start=se,he.name=""),he.type===5?(z=he.start,D>0&&z!==se&&(S[z].name="!StreamData")):he.size>=4096?(he.storage="fat",S[he.start]===void 0&&(S[he.start]=E(y,he.start,S.fat_addrs,S.ssz)),S[he.start].name=he.name,he.content=S[he.start].data.slice(0,he.size)):(he.storage="minifat",he.size<0?he.size=0:z!==se&&he.start!==se&&S[z]&&(he.content=u(he,S[z].data,(S[Q]||{}).data))),he.content&&$t(he.content,0),A[ve]=he,H.push(he)}}function L(g,S){return new Date((Ht(g,S+4)/1e7*Math.pow(2,32)+Ht(g,S)/1e7-11644473600)*1e3)}function U(g,S){return c(),d(l.readFileSync(g),S)}function R(g,S){var y=S&&S.type;switch(y||Ue&&Buffer.isBuffer(g)&&(y="buffer"),y||"base64"){case"file":return U(g,S);case"base64":return d(Or(Ir(g)),S);case"binary":return d(Or(g),S)}return d(g,S)}function T(g,S){var y=S||{},C=y.root||"Root Entry";if(g.FullPaths||(g.FullPaths=[]),g.FileIndex||(g.FileIndex=[]),g.FullPaths.length!==g.FileIndex.length)throw new Error("inconsistent CFB structure");g.FullPaths.length===0&&(g.FullPaths[0]=C+"/",g.FileIndex[0]={name:C,type:5}),y.CLSID&&(g.FileIndex[0].clsid=y.CLSID),B(g)}function B(g){var S="Sh33tJ5";if(!Se.find(g,"/"+S)){var y=Z(4);y[0]=55,y[1]=y[3]=50,y[2]=54,g.FileIndex.push({name:S,type:2,content:y,size:4,L:69,R:69,C:69}),g.FullPaths.push(g.FullPaths[0]+S),N(g)}}function N(g,S){T(g);for(var y=!1,C=!1,D=g.FullPaths.length-1;D>=0;--D){var A=g.FileIndex[D];switch(A.type){case 0:C?y=!0:(g.FileIndex.pop(),g.FullPaths.pop());break;case 1:case 2:case 5:C=!0,isNaN(A.R*A.L*A.C)&&(y=!0),A.R>-1&&A.L>-1&&A.R==A.L&&(y=!0);break;default:y=!0;break}}if(!(!y&&!S)){var H=new Date(1987,1,19),Q=0,z=Object.create?Object.create(null):{},W=[];for(D=0;D<g.FullPaths.length;++D)z[g.FullPaths[D]]=!0,g.FileIndex[D].type!==0&&W.push([g.FullPaths[D],g.FileIndex[D]]);for(D=0;D<W.length;++D){var X=a(W[D][0]);C=z[X],C||(W.push([X,{name:i(X).replace("/",""),type:1,clsid:Ee,ct:H,mt:H,content:null}]),z[X]=!0)}for(W.sort(function(ve,fe){return e(ve[0],fe[0])}),g.FullPaths=[],g.FileIndex=[],D=0;D<W.length;++D)g.FullPaths[D]=W[D][0],g.FileIndex[D]=W[D][1];for(D=0;D<W.length;++D){var ae=g.FileIndex[D],de=g.FullPaths[D];if(ae.name=i(de).replace("/",""),ae.L=ae.R=ae.C=-(ae.color=1),ae.size=ae.content?ae.content.length:0,ae.start=0,ae.clsid=ae.clsid||Ee,D===0)ae.C=W.length>1?1:-1,ae.size=0,ae.type=5;else if(de.slice(-1)=="/"){for(Q=D+1;Q<W.length&&a(g.FullPaths[Q])!=de;++Q);for(ae.C=Q>=W.length?-1:Q,Q=D+1;Q<W.length&&a(g.FullPaths[Q])!=a(de);++Q);ae.R=Q>=W.length?-1:Q,ae.type=1}else a(g.FullPaths[D+1]||"")==a(de)&&(ae.R=D+1),ae.type=2}}}function K(g,S){var y=S||{};if(y.fileType=="mad")return $p(g,y);switch(N(g),y.fileType){case"zip":return Vp(g,y)}var C=function(ve){for(var fe=0,he=0,Ie=0;Ie<ve.FileIndex.length;++Ie){var at=ve.FileIndex[Ie];if(at.content){var _r=at.content.length;_r>0&&(_r<4096?fe+=_r+63>>6:he+=_r+511>>9)}}for(var St=ve.FullPaths.length+3>>2,kr=fe+7>>3,Yn=fe+127>>7,$n=kr+he+St+Yn,xi=$n+127>>7,Xl=xi<=109?0:Math.ceil((xi-109)/127);$n+xi+Xl+127>>7>xi;)Xl=++xi<=109?0:Math.ceil((xi-109)/127);var Ca=[1,Xl,xi,Yn,St,he,fe,0];return ve.FileIndex[0].size=fe<<6,Ca[7]=(ve.FileIndex[0].start=Ca[0]+Ca[1]+Ca[2]+Ca[3]+Ca[4]+Ca[5])+(Ca[6]+7>>3),Ca}(g),D=Z(C[7]<<9),A=0,H=0;{for(A=0;A<8;++A)D.write_shift(1,oe[A]);for(A=0;A<8;++A)D.write_shift(2,0);for(D.write_shift(2,62),D.write_shift(2,3),D.write_shift(2,65534),D.write_shift(2,9),D.write_shift(2,6),A=0;A<3;++A)D.write_shift(2,0);for(D.write_shift(4,0),D.write_shift(4,C[2]),D.write_shift(4,C[0]+C[1]+C[2]+C[3]-1),D.write_shift(4,0),D.write_shift(4,4096),D.write_shift(4,C[3]?C[0]+C[1]+C[2]-1:se),D.write_shift(4,C[3]),D.write_shift(-4,C[1]?C[0]-1:se),D.write_shift(4,C[1]),A=0;A<109;++A)D.write_shift(-4,A<C[2]?C[1]+A:-1)}if(C[1])for(H=0;H<C[1];++H){for(;A<236+H*127;++A)D.write_shift(-4,A<C[2]?C[1]+A:-1);D.write_shift(-4,H===C[1]-1?se:H+1)}var Q=function(ve){for(H+=ve;A<H-1;++A)D.write_shift(-4,A+1);ve&&(++A,D.write_shift(-4,se))};for(H=A=0,H+=C[1];A<H;++A)D.write_shift(-4,xe.DIFSECT);for(H+=C[2];A<H;++A)D.write_shift(-4,xe.FATSECT);Q(C[3]),Q(C[4]);for(var z=0,W=0,X=g.FileIndex[0];z<g.FileIndex.length;++z)X=g.FileIndex[z],X.content&&(W=X.content.length,!(W<4096)&&(X.start=H,Q(W+511>>9)));for(Q(C[6]+7>>3);D.l&511;)D.write_shift(-4,xe.ENDOFCHAIN);for(H=A=0,z=0;z<g.FileIndex.length;++z)X=g.FileIndex[z],X.content&&(W=X.content.length,!(!W||W>=4096)&&(X.start=H,Q(W+63>>6)));for(;D.l&511;)D.write_shift(-4,xe.ENDOFCHAIN);for(A=0;A<C[4]<<2;++A){var ae=g.FullPaths[A];if(!ae||ae.length===0){for(z=0;z<17;++z)D.write_shift(4,0);for(z=0;z<3;++z)D.write_shift(4,-1);for(z=0;z<12;++z)D.write_shift(4,0);continue}X=g.FileIndex[A],A===0&&(X.start=X.size?X.start-1:se);var de=A===0&&y.root||X.name;if(W=2*(de.length+1),D.write_shift(64,de,"utf16le"),D.write_shift(2,W),D.write_shift(1,X.type),D.write_shift(1,X.color),D.write_shift(-4,X.L),D.write_shift(-4,X.R),D.write_shift(-4,X.C),X.clsid)D.write_shift(16,X.clsid,"hex");else for(z=0;z<4;++z)D.write_shift(4,0);D.write_shift(4,X.state||0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,X.start),D.write_shift(4,X.size),D.write_shift(4,0)}for(A=1;A<g.FileIndex.length;++A)if(X=g.FileIndex[A],X.size>=4096)if(D.l=X.start+1<<9,Ue&&Buffer.isBuffer(X.content))X.content.copy(D,D.l,0,X.size),D.l+=X.size+511&-512;else{for(z=0;z<X.size;++z)D.write_shift(1,X.content[z]);for(;z&511;++z)D.write_shift(1,0)}for(A=1;A<g.FileIndex.length;++A)if(X=g.FileIndex[A],X.size>0&&X.size<4096)if(Ue&&Buffer.isBuffer(X.content))X.content.copy(D,D.l,0,X.size),D.l+=X.size+63&-64;else{for(z=0;z<X.size;++z)D.write_shift(1,X.content[z]);for(;z&63;++z)D.write_shift(1,0)}if(Ue)D.l=D.length;else for(;D.l<D.length;)D.write_shift(1,0);return D}function q(g,S){var y=g.FullPaths.map(function(z){return z.toUpperCase()}),C=y.map(function(z){var W=z.split("/");return W[W.length-(z.slice(-1)=="/"?2:1)]}),D=!1;S.charCodeAt(0)===47?(D=!0,S=y[0].slice(0,-1)+S):D=S.indexOf("/")!==-1;var A=S.toUpperCase(),H=D===!0?y.indexOf(A):C.indexOf(A);if(H!==-1)return g.FileIndex[H];var Q=!A.match(gs);for(A=A.replace(or,""),Q&&(A=A.replace(gs,"!")),H=0;H<y.length;++H)if((Q?y[H].replace(gs,"!"):y[H]).replace(or,"")==A||(Q?C[H].replace(gs,"!"):C[H]).replace(or,"")==A)return g.FileIndex[H];return null}var V=64,se=-2,ge="d0cf11e0a1b11ae1",oe=[208,207,17,224,161,177,26,225],Ee="00000000000000000000000000000000",xe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:se,FREESECT:-1,HEADER_SIGNATURE:ge,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function He(g,S,y){c();var C=K(g,y);l.writeFileSync(S,C)}function pe(g){for(var S=new Array(g.length),y=0;y<g.length;++y)S[y]=String.fromCharCode(g[y]);return S.join("")}function we(g,S){var y=K(g,S);switch(S&&S.type||"buffer"){case"file":return c(),l.writeFileSync(S.filename,y),y;case"binary":return typeof y=="string"?y:pe(y);case"base64":return Ts(typeof y=="string"?y:pe(y));case"buffer":if(Ue)return Buffer.isBuffer(y)?y:Ra(y);case"array":return typeof y=="string"?Or(y):y}return y}var ee;function O(g){try{var S=g.InflateRaw,y=new S;if(y._processChunk(new Uint8Array([3,0]),y._finishFlushFlag),y.bytesRead)ee=g;else throw new Error("zlib does not expose bytesRead")}catch(C){console.error("cannot use native zlib: "+(C.message||C))}}function G(g,S){if(!ee)return id(g,S);var y=ee.InflateRaw,C=new y,D=C._processChunk(g.slice(g.l),C._finishFlushFlag);return g.l+=C.bytesRead,D}function I(g){return ee?ee.deflateRawSync(g):We(g)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ue=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(g){var S=(g<<1|g<<11)&139536|(g<<5|g<<15)&558144;return(S>>16|S>>8|S)&255}for(var ne=typeof Uint8Array<"u",te=ne?new Uint8Array(256):[],Re=0;Re<256;++Re)te[Re]=ie(Re);function F(g,S){var y=te[g&255];return S<=8?y>>>8-S:(y=y<<8|te[g>>8&255],S<=16?y>>>16-S:(y=y<<8|te[g>>16&255],y>>>24-S))}function qe(g,S){var y=S&7,C=S>>>3;return(g[C]|(y<=6?0:g[C+1]<<8))>>>y&3}function Ge(g,S){var y=S&7,C=S>>>3;return(g[C]|(y<=5?0:g[C+1]<<8))>>>y&7}function Ze(g,S){var y=S&7,C=S>>>3;return(g[C]|(y<=4?0:g[C+1]<<8))>>>y&15}function ze(g,S){var y=S&7,C=S>>>3;return(g[C]|(y<=3?0:g[C+1]<<8))>>>y&31}function _e(g,S){var y=S&7,C=S>>>3;return(g[C]|(y<=1?0:g[C+1]<<8))>>>y&127}function pt(g,S,y){var C=S&7,D=S>>>3,A=(1<<y)-1,H=g[D]>>>C;return y<8-C||(H|=g[D+1]<<8-C,y<16-C)||(H|=g[D+2]<<16-C,y<24-C)||(H|=g[D+3]<<24-C),H&A}function Pr(g,S,y){var C=S&7,D=S>>>3;return C<=5?g[D]|=(y&7)<<C:(g[D]|=y<<C&255,g[D+1]=(y&7)>>8-C),S+3}function aa(g,S,y){var C=S&7,D=S>>>3;return y=(y&1)<<C,g[D]|=y,S+1}function ya(g,S,y){var C=S&7,D=S>>>3;return y<<=C,g[D]|=y&255,y>>>=8,g[D+1]=y,S+8}function Gn(g,S,y){var C=S&7,D=S>>>3;return y<<=C,g[D]|=y&255,y>>>=8,g[D+1]=y&255,g[D+2]=y>>>8,S+16}function Ba(g,S){var y=g.length,C=2*y>S?2*y:S+5,D=0;if(y>=S)return g;if(Ue){var A=Cu(C);if(g.copy)g.copy(A);else for(;D<g.length;++D)A[D]=g[D];return A}else if(ne){var H=new Uint8Array(C);if(H.set)H.set(g);else for(;D<y;++D)H[D]=g[D];return H}return g.length=C,g}function Cr(g){for(var S=new Array(g),y=0;y<g;++y)S[y]=0;return S}function ba(g,S,y){var C=1,D=0,A=0,H=0,Q=0,z=g.length,W=ne?new Uint16Array(32):Cr(32);for(A=0;A<32;++A)W[A]=0;for(A=z;A<y;++A)g[A]=0;z=g.length;var X=ne?new Uint16Array(z):Cr(z);for(A=0;A<z;++A)W[D=g[A]]++,C<D&&(C=D),X[A]=0;for(W[0]=0,A=1;A<=C;++A)W[A+16]=Q=Q+W[A-1]<<1;for(A=0;A<z;++A)Q=g[A],Q!=0&&(X[A]=W[Q+16]++);var ae=0;for(A=0;A<z;++A)if(ae=g[A],ae!=0)for(Q=F(X[A],C)>>C-ae,H=(1<<C+4-ae)-1;H>=0;--H)S[Q|H<<ae]=ae&15|A<<4;return C}var Va=ne?new Uint16Array(512):Cr(512),zn=ne?new Uint16Array(32):Cr(32);if(!ne){for(var fr=0;fr<512;++fr)Va[fr]=0;for(fr=0;fr<32;++fr)zn[fr]=0}(function(){for(var g=[],S=0;S<32;S++)g.push(5);ba(g,zn,32);var y=[];for(S=0;S<=143;S++)y.push(8);for(;S<=255;S++)y.push(9);for(;S<=279;S++)y.push(7);for(;S<=287;S++)y.push(8);ba(y,Va,288)})();var ia=function(){for(var S=ne?new Uint8Array(32768):[],y=0,C=0;y<ue.length-1;++y)for(;C<ue[y+1];++C)S[C]=y;for(;C<32768;++C)S[C]=29;var D=ne?new Uint8Array(259):[];for(y=0,C=0;y<J.length-1;++y)for(;C<J[y+1];++C)D[C]=y;function A(Q,z){for(var W=0;W<Q.length;){var X=Math.min(65535,Q.length-W),ae=W+X==Q.length;for(z.write_shift(1,+ae),z.write_shift(2,X),z.write_shift(2,~X&65535);X-- >0;)z[z.l++]=Q[W++]}return z.l}function H(Q,z){for(var W=0,X=0,ae=ne?new Uint16Array(32768):[];X<Q.length;){var de=Math.min(65535,Q.length-X);if(de<10){for(W=Pr(z,W,+(X+de==Q.length)),W&7&&(W+=8-(W&7)),z.l=W/8|0,z.write_shift(2,de),z.write_shift(2,~de&65535);de-- >0;)z[z.l++]=Q[X++];W=z.l*8;continue}W=Pr(z,W,+(X+de==Q.length)+2);for(var ve=0;de-- >0;){var fe=Q[X];ve=(ve<<5^fe)&32767;var he=-1,Ie=0;if((he=ae[ve])&&(he|=X&-32768,he>X&&(he-=32768),he<X))for(;Q[he+Ie]==Q[X+Ie]&&Ie<250;)++Ie;if(Ie>2){fe=D[Ie],fe<=22?W=ya(z,W,te[fe+1]>>1)-1:(ya(z,W,3),W+=5,ya(z,W,te[fe-23]>>5),W+=3);var at=fe<8?0:fe-4>>2;at>0&&(Gn(z,W,Ie-J[fe]),W+=at),fe=S[X-he],W=ya(z,W,te[fe]>>3),W-=3;var _r=fe<4?0:fe-2>>1;_r>0&&(Gn(z,W,X-he-ue[fe]),W+=_r);for(var St=0;St<Ie;++St)ae[ve]=X&32767,ve=(ve<<5^Q[X])&32767,++X;de-=Ie-1}else fe<=143?fe=fe+48:W=aa(z,W,1),W=ya(z,W,te[fe]),ae[ve]=X&32767,++X}W=ya(z,W,0)-1}return z.l=(W+7)/8|0,z.l}return function(z,W){return z.length<8?A(z,W):H(z,W)}}();function We(g){var S=Z(50+Math.floor(g.length*1.1)),y=ia(g,S);return S.slice(0,y)}var _t=ne?new Uint16Array(32768):Cr(32768),Rr=ne?new Uint16Array(32768):Cr(32768),Mt=ne?new Uint16Array(128):Cr(128),gi=1,ad=1;function Np(g,S){var y=ze(g,S)+257;S+=5;var C=ze(g,S)+1;S+=5;var D=Ze(g,S)+4;S+=4;for(var A=0,H=ne?new Uint8Array(19):Cr(19),Q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=1,W=ne?new Uint8Array(8):Cr(8),X=ne?new Uint8Array(8):Cr(8),ae=H.length,de=0;de<D;++de)H[M[de]]=A=Ge(g,S),z<A&&(z=A),W[A]++,S+=3;var ve=0;for(W[0]=0,de=1;de<=z;++de)X[de]=ve=ve+W[de-1]<<1;for(de=0;de<ae;++de)(ve=H[de])!=0&&(Q[de]=X[ve]++);var fe=0;for(de=0;de<ae;++de)if(fe=H[de],fe!=0){ve=te[Q[de]]>>8-fe;for(var he=(1<<7-fe)-1;he>=0;--he)Mt[ve|he<<fe]=fe&7|de<<3}var Ie=[];for(z=1;Ie.length<y+C;)switch(ve=Mt[_e(g,S)],S+=ve&7,ve>>>=3){case 16:for(A=3+qe(g,S),S+=2,ve=Ie[Ie.length-1];A-- >0;)Ie.push(ve);break;case 17:for(A=3+Ge(g,S),S+=3;A-- >0;)Ie.push(0);break;case 18:for(A=11+_e(g,S),S+=7;A-- >0;)Ie.push(0);break;default:Ie.push(ve),z<ve&&(z=ve);break}var at=Ie.slice(0,y),_r=Ie.slice(y);for(de=y;de<286;++de)at[de]=0;for(de=C;de<30;++de)_r[de]=0;return gi=ba(at,_t,286),ad=ba(_r,Rr,30),S}function Lp(g,S){if(g[0]==3&&!(g[1]&3))return[di(S),2];for(var y=0,C=0,D=Cu(S||1<<18),A=0,H=D.length>>>0,Q=0,z=0;(C&1)==0;){if(C=Ge(g,y),y+=3,C>>>1)C>>1==1?(Q=9,z=5):(y=Np(g,y),Q=gi,z=ad);else{y&7&&(y+=8-(y&7));var W=g[y>>>3]|g[(y>>>3)+1]<<8;if(y+=32,W>0)for(!S&&H<A+W&&(D=Ba(D,A+W),H=D.length);W-- >0;)D[A++]=g[y>>>3],y+=8;continue}for(;;){!S&&H<A+32767&&(D=Ba(D,A+32767),H=D.length);var X=pt(g,y,Q),ae=C>>>1==1?Va[X]:_t[X];if(y+=ae&15,ae>>>=4,(ae>>>8&255)===0)D[A++]=ae;else{if(ae==256)break;ae-=257;var de=ae<8?0:ae-4>>2;de>5&&(de=0);var ve=A+J[ae];de>0&&(ve+=pt(g,y,de),y+=de),X=pt(g,y,z),ae=C>>>1==1?zn[X]:Rr[X],y+=ae&15,ae>>>=4;var fe=ae<4?0:ae-2>>1,he=ue[ae];for(fe>0&&(he+=pt(g,y,fe),y+=fe),!S&&H<ve&&(D=Ba(D,ve+100),H=D.length);A<ve;)D[A]=D[A-he],++A}}}return S?[D,y+7>>>3]:[D.slice(0,A),y+7>>>3]}function id(g,S){var y=g.slice(g.l||0),C=Lp(y,S);return g.l+=C[1],C[0]}function nd(g,S){if(g)typeof console<"u"&&console.error(S);else throw new Error(S)}function sd(g,S){var y=g;$t(y,0);var C=[],D=[],A={FileIndex:C,FullPaths:D};T(A,{root:S.root});for(var H=y.length-4;(y[H]!=80||y[H+1]!=75||y[H+2]!=5||y[H+3]!=6)&&H>=0;)--H;y.l=H+4,y.l+=4;var Q=y.read_shift(2);y.l+=6;var z=y.read_shift(4);for(y.l=z,H=0;H<Q;++H){y.l+=20;var W=y.read_shift(4),X=y.read_shift(4),ae=y.read_shift(2),de=y.read_shift(2),ve=y.read_shift(2);y.l+=8;var fe=y.read_shift(4),he=o(y.slice(y.l+ae,y.l+ae+de));y.l+=ae+de+ve;var Ie=y.l;y.l=fe+4,Bp(y,W,X,A,he),y.l=Ie}return A}function Bp(g,S,y,C,D){g.l+=2;var A=g.read_shift(2),H=g.read_shift(2),Q=s(g);if(A&8257)throw new Error("Unsupported ZIP encryption");for(var z=g.read_shift(4),W=g.read_shift(4),X=g.read_shift(4),ae=g.read_shift(2),de=g.read_shift(2),ve="",fe=0;fe<ae;++fe)ve+=String.fromCharCode(g[g.l++]);if(de){var he=o(g.slice(g.l,g.l+de));(he[21589]||{}).mt&&(Q=he[21589].mt),((D||{})[21589]||{}).mt&&(Q=D[21589].mt)}g.l+=de;var Ie=g.slice(g.l,g.l+W);switch(H){case 8:Ie=G(g,X);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+H)}var at=!1;A&8&&(z=g.read_shift(4),z==134695760&&(z=g.read_shift(4),at=!0),W=g.read_shift(4),X=g.read_shift(4)),W!=S&&nd(at,"Bad compressed size: "+S+" != "+W),X!=y&&nd(at,"Bad uncompressed size: "+y+" != "+X),$l(C,ve,Ie,{unsafe:!0,mt:Q})}function Vp(g,S){var y=S||{},C=[],D=[],A=Z(1),H=y.compression?8:0,Q=0,z=!1;z&&(Q|=8);var W=0,X=0,ae=0,de=0,ve=g.FullPaths[0],fe=ve,he=g.FileIndex[0],Ie=[],at=0;for(W=1;W<g.FullPaths.length;++W)if(fe=g.FullPaths[W].slice(ve.length),he=g.FileIndex[W],!(!he.size||!he.content||fe=="Sh33tJ5")){var _r=ae,St=Z(fe.length);for(X=0;X<fe.length;++X)St.write_shift(1,fe.charCodeAt(X)&127);St=St.slice(0,St.l),Ie[de]=m1.buf(he.content,0);var kr=he.content;H==8&&(kr=I(kr)),A=Z(30),A.write_shift(4,67324752),A.write_shift(2,20),A.write_shift(2,Q),A.write_shift(2,H),he.mt?n(A,he.mt):A.write_shift(4,0),A.write_shift(-4,Q&8?0:Ie[de]),A.write_shift(4,Q&8?0:kr.length),A.write_shift(4,Q&8?0:he.content.length),A.write_shift(2,St.length),A.write_shift(2,0),ae+=A.length,C.push(A),ae+=St.length,C.push(St),ae+=kr.length,C.push(kr),Q&8&&(A=Z(12),A.write_shift(-4,Ie[de]),A.write_shift(4,kr.length),A.write_shift(4,he.content.length),ae+=A.l,C.push(A)),A=Z(46),A.write_shift(4,33639248),A.write_shift(2,0),A.write_shift(2,20),A.write_shift(2,Q),A.write_shift(2,H),A.write_shift(4,0),A.write_shift(-4,Ie[de]),A.write_shift(4,kr.length),A.write_shift(4,he.content.length),A.write_shift(2,St.length),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(4,0),A.write_shift(4,_r),at+=A.l,D.push(A),at+=St.length,D.push(St),++de}return A=Z(22),A.write_shift(4,101010256),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,de),A.write_shift(2,de),A.write_shift(4,at),A.write_shift(4,ae),A.write_shift(2,0),Wt([Wt(C),Wt(D),A])}var Ks={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Up(g,S){if(g.ctype)return g.ctype;var y=g.name||"",C=y.match(/\.([^\.]+)$/);return C&&Ks[C[1]]||S&&(C=(y=S).match(/[\.\\]([^\.\\])+$/),C&&Ks[C[1]])?Ks[C[1]]:"application/octet-stream"}function Hp(g){for(var S=Ts(g),y=[],C=0;C<S.length;C+=76)y.push(S.slice(C,C+76));return y.join(`\r
`)+`\r
`}function Wp(g){var S=g.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(W){var X=W.charCodeAt(0).toString(16).toUpperCase();return"="+(X.length==1?"0"+X:X)});S=S.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),S.charAt(0)==`
`&&(S="=0D"+S.slice(1)),S=S.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var y=[],C=S.split(`\r
`),D=0;D<C.length;++D){var A=C[D];if(A.length==0){y.push("");continue}for(var H=0;H<A.length;){var Q=76,z=A.slice(H,H+Q);z.charAt(Q-1)=="="?Q--:z.charAt(Q-2)=="="?Q-=2:z.charAt(Q-3)=="="&&(Q-=3),z=A.slice(H,H+Q),H+=Q,H<A.length&&(z+="="),y.push(z)}}return y.join(`\r
`)}function Gp(g){for(var S=[],y=0;y<g.length;++y){for(var C=g[y];y<=g.length&&C.charAt(C.length-1)=="=";)C=C.slice(0,C.length-1)+g[++y];S.push(C)}for(var D=0;D<S.length;++D)S[D]=S[D].replace(/[=][0-9A-Fa-f]{2}/g,function(A){return String.fromCharCode(parseInt(A.slice(1),16))});return Or(S.join(`\r
`))}function zp(g,S,y){for(var C="",D="",A="",H,Q=0;Q<10;++Q){var z=S[Q];if(!z||z.match(/^\s*$/))break;var W=z.match(/^(.*?):\s*([^\s].*)$/);if(W)switch(W[1].toLowerCase()){case"content-location":C=W[2].trim();break;case"content-type":A=W[2].trim();break;case"content-transfer-encoding":D=W[2].trim();break}}switch(++Q,D.toLowerCase()){case"base64":H=Or(Ir(S.slice(Q).join("")));break;case"quoted-printable":H=Gp(S.slice(Q));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+D)}var X=$l(g,C.slice(y.length),H,{unsafe:!0});A&&(X.ctype=A)}function Yp(g,S){if(pe(g.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var y=S&&S.root||"",C=(Ue&&Buffer.isBuffer(g)?g.toString("binary"):pe(g)).split(`\r
`),D=0,A="";for(D=0;D<C.length;++D)if(A=C[D],!!/^Content-Location:/i.test(A)&&(A=A.slice(A.indexOf("file")),y||(y=A.slice(0,A.lastIndexOf("/")+1)),A.slice(0,y.length)!=y))for(;y.length>0&&(y=y.slice(0,y.length-1),y=y.slice(0,y.lastIndexOf("/")+1),A.slice(0,y.length)!=y););var H=(C[1]||"").match(/boundary="(.*?)"/);if(!H)throw new Error("MAD cannot find boundary");var Q="--"+(H[1]||""),z=[],W=[],X={FileIndex:z,FullPaths:W};T(X);var ae,de=0;for(D=0;D<C.length;++D){var ve=C[D];ve!==Q&&ve!==Q+"--"||(de++&&zp(X,C.slice(ae,D),y),ae=D)}return X}function $p(g,S){var y=S||{},C=y.boundary||"SheetJS";C="------="+C;for(var D=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+C.slice(2)+'"',"","",""],A=g.FullPaths[0],H=A,Q=g.FileIndex[0],z=1;z<g.FullPaths.length;++z)if(H=g.FullPaths[z].slice(A.length),Q=g.FileIndex[z],!(!Q.size||!Q.content||H=="Sh33tJ5")){H=H.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var W=Q.content,X=Ue&&Buffer.isBuffer(W)?W.toString("binary"):pe(W),ae=0,de=Math.min(1024,X.length),ve=0,fe=0;fe<=de;++fe)(ve=X.charCodeAt(fe))>=32&&ve<128&&++ae;var he=ae>=de*4/5;D.push(C),D.push("Content-Location: "+(y.root||"file:///C:/SheetJS/")+H),D.push("Content-Transfer-Encoding: "+(he?"quoted-printable":"base64")),D.push("Content-Type: "+Up(Q,H)),D.push(""),D.push(he?Wp(X):Hp(X))}return D.push(C+`--\r
`),D.join(`\r
`)}function Xp(g){var S={};return T(S,g),S}function $l(g,S,y,C){var D=C&&C.unsafe;D||T(g);var A=!D&&Se.find(g,S);if(!A){var H=g.FullPaths[0];S.slice(0,H.length)==H?H=S:(H.slice(-1)!="/"&&(H+="/"),H=(H+S).replace("//","/")),A={name:i(S),type:2},g.FileIndex.push(A),g.FullPaths.push(H),D||Se.utils.cfb_gc(g)}return A.content=y,A.size=y?y.length:0,C&&(C.CLSID&&(A.clsid=C.CLSID),C.mt&&(A.mt=C.mt),C.ct&&(A.ct=C.ct)),A}function jp(g,S){T(g);var y=Se.find(g,S);if(y){for(var C=0;C<g.FileIndex.length;++C)if(g.FileIndex[C]==y)return g.FileIndex.splice(C,1),g.FullPaths.splice(C,1),!0}return!1}function Kp(g,S,y){T(g);var C=Se.find(g,S);if(C){for(var D=0;D<g.FileIndex.length;++D)if(g.FileIndex[D]==C)return g.FileIndex[D].name=i(y),g.FullPaths[D]=y,!0}return!1}function qp(g){N(g,!0)}return r.find=q,r.read=R,r.parse=d,r.write=we,r.writeFile=He,r.utils={cfb_new:Xp,cfb_add:$l,cfb_del:jp,cfb_mov:Kp,cfb_gc:qp,ReadShift:vs,CheckField:nm,prep_blob:$t,bconcat:Wt,use_zlib:O,_deflateRaw:We,_inflateRaw:id,consts:xe},r}(),Tn;function p1(t){return typeof t=="string"?Dl(t):Array.isArray(t)?Hg(t):t}function Hs(t,r,e){if(typeof Tn<"u"&&Tn.writeFileSync)return e?Tn.writeFileSync(t,r,e):Tn.writeFileSync(t,r);if(typeof Deno<"u"){if(e&&typeof r=="string")switch(e){case"utf8":r=new TextEncoder(e).encode(r);break;case"binary":r=Dl(r);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(t,r)}var a=e=="utf8"?ga(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,t);if(typeof Blob<"u"){var i=new Blob([p1(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var n=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),chrome.downloads.download({url:n,filename:t,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=t,s.href=n,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),n}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(r)&&(r=mi(r)),o.write(r),o.close(),r}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function _1(t){if(typeof Tn<"u")return Tn.readFileSync(t);if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(t);r.open("r"),r.encoding="binary";var e=r.read();return r.close(),e}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+t)}function mt(t){for(var r=Object.keys(t),e=[],a=0;a<r.length;++a)Object.prototype.hasOwnProperty.call(t,r[a])&&e.push(r[a]);return e}function Ou(t,r){for(var e=[],a=mt(t),i=0;i!==a.length;++i)e[t[a[i]][r]]==null&&(e[t[a[i]][r]]=a[i]);return e}function Al(t){for(var r=[],e=mt(t),a=0;a!==e.length;++a)r[t[e[a]]]=e[a];return r}function Fl(t){for(var r=[],e=mt(t),a=0;a!==e.length;++a)r[t[e[a]]]=parseInt(e[a],10);return r}function g1(t){for(var r=[],e=mt(t),a=0;a!==e.length;++a)r[t[e[a]]]==null&&(r[t[e[a]]]=[]),r[t[e[a]]].push(e[a]);return r}var gl=new Date(1899,11,30,0,0,0);function Lt(t,r){var e=t.getTime();r&&(e-=1462*24*60*60*1e3);var a=gl.getTime()+(t.getTimezoneOffset()-gl.getTimezoneOffset())*6e4;return(e-a)/(24*60*60*1e3)}var Wh=new Date,x1=gl.getTime()+(Wh.getTimezoneOffset()-gl.getTimezoneOffset())*6e4,Mu=Wh.getTimezoneOffset();function Ol(t){var r=new Date;return r.setTime(t*24*60*60*1e3+x1),r.getTimezoneOffset()!==Mu&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Mu)*6e4),r}function v1(t){var r=0,e=0,a=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var n=1;n!=i.length;++n)if(i[n]){switch(e=1,n>3&&(a=!0),i[n].slice(i[n].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[n].slice(i[n].length-1));case"D":e*=24;case"H":e*=60;case"M":if(a)e*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}r+=e*parseInt(i[n],10)}return r}var Iu=new Date("2017-02-19T19:06:09.000Z"),Gh=isNaN(Iu.getFullYear())?new Date("2/19/17"):Iu,w1=Gh.getFullYear()==2017;function nt(t,r){var e=new Date(t);if(w1)return r>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):r<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(t instanceof Date)return t;if(Gh.getFullYear()==1917&&!isNaN(e.getFullYear())){var a=e.getFullYear();return t.indexOf(""+a)>-1||e.setFullYear(e.getFullYear()+100),e}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(n=new Date(n.getTime()-n.getTimezoneOffset()*60*1e3)),n}function Ri(t,r){if(Ue&&Buffer.isBuffer(t)){if(r){if(t[0]==255&&t[1]==254)return ga(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ga(Fh(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(t[0]==255&&t[1]==254)return ga(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ga(new TextDecoder("utf-16be").decode(t.slice(2)))}var e={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(n){return e[n]||n})}catch{}for(var a=[],i=0;i!=t.length;++i)a.push(String.fromCharCode(t[i]));return a.join("")}function st(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=st(t[e]));return r}function ft(t,r){for(var e="";e.length<r;)e+=t;return e}function ta(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var e=1,a=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(r=Number(a))||(a=a.replace(/[(](.*)[)]/,function(i,n){return e=-e,n}),!isNaN(r=Number(a)))?r/e:r}var y1=["january","february","march","april","may","june","july","august","september","october","november","december"];function Rn(t){var r=new Date(t),e=new Date(NaN),a=r.getYear(),i=r.getMonth(),n=r.getDate();if(isNaN(n))return e;var s=t.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&y1.indexOf(s)==-1)return e}else if(s.match(/[a-z]/))return e;return a<0||a>8099?e:(i>0||n>1)&&a!=101?r:t.match(/[^-0-9:,\/\\]/)?e:r}var b1=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(e,a,i){if(t||typeof a=="string")return e.split(a);for(var n=e.split(a),s=[n[0]],o=1;o<n.length;++o)s.push(i),s.push(n[o]);return s}}();function zh(t){return t?t.content&&t.type?Ri(t.content,!0):t.data?_s(t.data):t.asNodeBuffer&&Ue?_s(t.asNodeBuffer().toString("binary")):t.asBinary?_s(t.asBinary()):t._data&&t._data.getContent?_s(Ri(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function Yh(t){if(!t)return null;if(t.data)return Qc(t.data);if(t.asNodeBuffer&&Ue)return t.asNodeBuffer();if(t._data&&t._data.getContent){var r=t._data.getContent();return typeof r=="string"?Qc(r):Array.prototype.slice.call(r)}return t.content&&t.type?t.content:null}function C1(t){return t&&t.name.slice(-4)===".bin"?Yh(t):zh(t)}function Yr(t,r){for(var e=t.FullPaths||mt(t.files),a=r.toLowerCase().replace(/[\/]/g,"\\"),i=a.replace(/\\/g,"/"),n=0;n<e.length;++n){var s=e[n].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==s||i==s)return t.files?t.files[e[n]]:t.FileIndex[n]}return null}function _0(t,r){var e=Yr(t,r);if(e==null)throw new Error("Cannot find file "+r+" in zip");return e}function Ft(t,r,e){if(!e)return C1(_0(t,r));if(!r)return null;try{return Ft(t,r)}catch{return null}}function Mr(t,r,e){if(!e)return zh(_0(t,r));if(!r)return null;try{return Mr(t,r)}catch{return null}}function $h(t,r,e){if(!e)return Yh(_0(t,r));if(!r)return null;try{return $h(t,r)}catch{return null}}function Pu(t){for(var r=t.FullPaths||mt(t.files),e=[],a=0;a<r.length;++a)r[a].slice(-1)!="/"&&e.push(r[a].replace(/^Root Entry[\/]/,""));return e.sort()}function Le(t,r,e){if(t.FullPaths){if(typeof e=="string"){var a;return Ue?a=Ra(e):a=Wg(e),Se.utils.cfb_add(t,r,a)}Se.utils.cfb_add(t,r,e)}else t.file(r,e)}function g0(){return Se.utils.cfb_new()}function Xh(t,r){switch(r.type){case"base64":return Se.read(t,{type:"base64"});case"binary":return Se.read(t,{type:"binary"});case"buffer":case"array":return Se.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function xs(t,r){if(t.charAt(0)=="/")return t.slice(1);var e=r.split("/");r.slice(-1)!="/"&&e.pop();for(var a=t.split("/");a.length!==0;){var i=a.shift();i===".."?e.pop():i!=="."&&e.push(i)}return e.join("/")}var Et=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,k1=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ru=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,E1=/<[^>]*>/g,dr=Et.match(Ru)?Ru:E1,S1=/<\w*:/,D1=/<(\/?)\w+:/;function Me(t,r,e){for(var a={},i=0,n=0;i!==t.length&&!((n=t.charCodeAt(i))===32||n===10||n===13);++i);if(r||(a[0]=t.slice(0,i)),i===t.length)return a;var s=t.match(k1),o=0,l="",c=0,d="",f="",h=1;if(s)for(c=0;c!=s.length;++c){for(f=s[c],n=0;n!=f.length&&f.charCodeAt(n)!==61;++n);for(d=f.slice(0,n).trim();f.charCodeAt(n+1)==32;)++n;for(h=(i=f.charCodeAt(n+1))==34||i==39?1:0,l=f.slice(n+1+h,f.length-h),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=l,e||(a[d.toLowerCase()]=l);else{var m=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(a[m]&&d.slice(o-3,o)=="ext")continue;a[m]=l,e||(a[m.toLowerCase()]=l)}}return a}function va(t){return t.replace(D1,"<$1")}var jh={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},x0=Al(jh),$e=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function e(a){var i=a+"",n=i.indexOf("<![CDATA[");if(n==-1)return i.replace(t,function(o,l){return jh[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(r,function(o,l){return String.fromCharCode(parseInt(l,16))});var s=i.indexOf("]]>");return e(i.slice(0,n))+i.slice(n+9,s)+e(i.slice(s+3))}}(),v0=/[&<>'"]/g,T1=/[\u0000-\u0008\u000b-\u001f]/g;function et(t){var r=t+"";return r.replace(v0,function(e){return x0[e]}).replace(T1,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Nu(t){return et(t).replace(/ /g,"_x0020_")}var Kh=/[\u0000-\u001f]/g;function w0(t){var r=t+"";return r.replace(v0,function(e){return x0[e]}).replace(/\n/g,"<br/>").replace(Kh,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function A1(t){var r=t+"";return r.replace(v0,function(e){return x0[e]}).replace(Kh,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var Lu=function(){var t=/&#(\d+);/g;function r(e,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(t,r)}}();function F1(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function it(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Vc(t){for(var r="",e=0,a=0,i=0,n=0,s=0,o=0;e<t.length;){if(a=t.charCodeAt(e++),a<128){r+=String.fromCharCode(a);continue}if(i=t.charCodeAt(e++),a>191&&a<224){s=(a&31)<<6,s|=i&63,r+=String.fromCharCode(s);continue}if(n=t.charCodeAt(e++),a<240){r+=String.fromCharCode((a&15)<<12|(i&63)<<6|n&63);continue}s=t.charCodeAt(e++),o=((a&7)<<18|(i&63)<<12|(n&63)<<6|s&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function Bu(t){var r=di(2*t.length),e,a,i=1,n=0,s=0,o;for(a=0;a<t.length;a+=i)i=1,(o=t.charCodeAt(a))<128?e=o:o<224?(e=(o&31)*64+(t.charCodeAt(a+1)&63),i=2):o<240?(e=(o&15)*4096+(t.charCodeAt(a+1)&63)*64+(t.charCodeAt(a+2)&63),i=3):(i=4,e=(o&7)*262144+(t.charCodeAt(a+1)&63)*4096+(t.charCodeAt(a+2)&63)*64+(t.charCodeAt(a+3)&63),e-=65536,s=55296+(e>>>10&1023),e=56320+(e&1023)),s!==0&&(r[n++]=s&255,r[n++]=s>>>8,s=0),r[n++]=e%256,r[n++]=e>>>8;return r.slice(0,n).toString("ucs2")}function Vu(t){return Ra(t,"binary").toString("utf8")}var il="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",rt=Ue&&(Vu(il)==Vc(il)&&Vu||Bu(il)==Vc(il)&&Bu)||Vc,ga=Ue?function(t){return Ra(t,"utf8").toString("binary")}:function(t){for(var r=[],e=0,a=0,i=0;e<t.length;)switch(a=t.charCodeAt(e++),!0){case a<128:r.push(String.fromCharCode(a));break;case a<2048:r.push(String.fromCharCode(192+(a>>6))),r.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,i=t.charCodeAt(e++)-56320+(a<<10),r.push(String.fromCharCode(240+(i>>18&7))),r.push(String.fromCharCode(144+(i>>12&63))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(i&63)));break;default:r.push(String.fromCharCode(224+(a>>12))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)))}return r.join("")},Fs=function(){var t={};return function(e,a){var i=e+"|"+(a||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",a||"")}}(),qh=function(){var t=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(e){for(var a=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)a=a.replace(t[i][0],t[i][1]);return a}}(),O1=function(){var t={};return function(e){return t[e]!==void 0?t[e]:t[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}}(),M1=/<\/?(?:vt:)?variant>/g,I1=/<(?:vt:)([^>]*)>([\s\S]*)</;function Uu(t,r){var e=Me(t),a=t.match(O1(e.baseType))||[],i=[];if(a.length!=e.size){if(r.WTF)throw new Error("unexpected vector length "+a.length+" != "+e.size);return i}return a.forEach(function(n){var s=n.replace(M1,"").match(I1);s&&i.push({v:rt(s[2]),t:s[1]})}),i}var Zh=/(^\s|\s$|\n)/;function Xt(t,r){return"<"+t+(r.match(Zh)?' xml:space="preserve"':"")+">"+r+"</"+t+">"}function Os(t){return mt(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function le(t,r,e){return"<"+t+(e!=null?Os(e):"")+(r!=null?(r.match(Zh)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function Jc(t,r){try{return t.toISOString().replace(/\.\d*/,"")}catch(e){if(r)throw e}return""}function P1(t,r){switch(typeof t){case"string":var e=le("vt:lpwstr",et(t));return r&&(e=e.replace(/&quot;/g,"_x0022_")),e;case"number":return le((t|0)==t?"vt:i4":"vt:r8",et(String(t)));case"boolean":return le("vt:bool",t?"true":"false")}if(t instanceof Date)return le("vt:filetime",Jc(t));throw new Error("Unable to serialize "+t)}function y0(t){if(Ue&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return rt(mi(h0(t)));throw new Error("Bad input format: expected Buffer or string")}var Ms=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Nt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ui=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Fr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function R1(t,r){for(var e=1-2*(t[r+7]>>>7),a=((t[r+7]&127)<<4)+(t[r+6]>>>4&15),i=t[r+6]&15,n=5;n>=0;--n)i=i*256+t[r+n];return a==2047?i==0?e*(1/0):NaN:(a==0?a=-1022:(a-=1023,i+=Math.pow(2,52)),e*Math.pow(2,a-52)*i)}function N1(t,r,e){var a=(r<0||1/r==-1/0?1:0)<<7,i=0,n=0,s=a?-r:r;isFinite(s)?s==0?i=n=0:(i=Math.floor(Math.log(s)/Math.LN2),n=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?i=-1022:(n-=Math.pow(2,52),i+=1023)):(i=2047,n=isNaN(r)?26985:0);for(var o=0;o<=5;++o,n/=256)t[e+o]=n&255;t[e+6]=(i&15)<<4|n&15,t[e+7]=i>>4|a}var Hu=function(t){for(var r=[],e=10240,a=0;a<t[0].length;++a)if(t[0][a])for(var i=0,n=t[0][a].length;i<n;i+=e)r.push.apply(r,t[0][a].slice(i,i+e));return r},Wu=Ue?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:Ra(r)})):Hu(t)}:Hu,Gu=function(t,r,e){for(var a=[],i=r;i<e;i+=2)a.push(String.fromCharCode(Fa(t,i)));return a.join("").replace(or,"")},Ml=Ue?function(t,r,e){return Buffer.isBuffer(t)?t.toString("utf16le",r,e).replace(or,""):Gu(t,r,e)}:Gu,zu=function(t,r,e){for(var a=[],i=r;i<r+e;++i)a.push(("0"+t[i].toString(16)).slice(-2));return a.join("")},Qh=Ue?function(t,r,e){return Buffer.isBuffer(t)?t.toString("hex",r,r+e):zu(t,r,e)}:zu,Yu=function(t,r,e){for(var a=[],i=r;i<e;i++)a.push(String.fromCharCode(Dn(t,i)));return a.join("")},Un=Ue?function(r,e,a){return Buffer.isBuffer(r)?r.toString("utf8",e,a):Yu(r,e,a)}:Yu,Jh=function(t,r){var e=Ht(t,r);return e>0?Un(t,r+4,r+4+e-1):""},b0=Jh,em=function(t,r){var e=Ht(t,r);return e>0?Un(t,r+4,r+4+e-1):""},C0=em,tm=function(t,r){var e=2*Ht(t,r);return e>0?Un(t,r+4,r+4+e-1):""},k0=tm,rm=function(r,e){var a=Ht(r,e);return a>0?Ml(r,e+4,e+4+a):""},E0=rm,am=function(t,r){var e=Ht(t,r);return e>0?Un(t,r+4,r+4+e):""},S0=am,im=function(t,r){return R1(t,r)},xl=im,D0=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Ue&&(b0=function(r,e){if(!Buffer.isBuffer(r))return Jh(r,e);var a=r.readUInt32LE(e);return a>0?r.toString("utf8",e+4,e+4+a-1):""},C0=function(r,e){if(!Buffer.isBuffer(r))return em(r,e);var a=r.readUInt32LE(e);return a>0?r.toString("utf8",e+4,e+4+a-1):""},k0=function(r,e){if(!Buffer.isBuffer(r))return tm(r,e);var a=2*r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+a-1)},E0=function(r,e){if(!Buffer.isBuffer(r))return rm(r,e);var a=r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+a)},S0=function(r,e){if(!Buffer.isBuffer(r))return am(r,e);var a=r.readUInt32LE(e);return r.toString("utf8",e+4,e+4+a)},xl=function(r,e){return Buffer.isBuffer(r)?r.readDoubleLE(e):im(r,e)},D0=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});function L1(){Ml=function(t,r,e){return Ke.utils.decode(1200,t.slice(r,e)).replace(or,"")},Un=function(t,r,e){return Ke.utils.decode(65001,t.slice(r,e))},b0=function(t,r){var e=Ht(t,r);return e>0?Ke.utils.decode(Pn,t.slice(r+4,r+4+e-1)):""},C0=function(t,r){var e=Ht(t,r);return e>0?Ke.utils.decode(xa,t.slice(r+4,r+4+e-1)):""},k0=function(t,r){var e=2*Ht(t,r);return e>0?Ke.utils.decode(1200,t.slice(r+4,r+4+e-1)):""},E0=function(t,r){var e=Ht(t,r);return e>0?Ke.utils.decode(1200,t.slice(r+4,r+4+e)):""},S0=function(t,r){var e=Ht(t,r);return e>0?Ke.utils.decode(65001,t.slice(r+4,r+4+e)):""}}typeof Ke<"u"&&L1();var Dn=function(t,r){return t[r]},Fa=function(t,r){return t[r+1]*256+t[r]},B1=function(t,r){var e=t[r+1]*256+t[r];return e<32768?e:(65535-e+1)*-1},Ht=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},Ti=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},V1=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function vs(t,r){var e="",a,i,n=[],s,o,l,c;switch(r){case"dbcs":if(c=this.l,Ue&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)e+=String.fromCharCode(Fa(this,c)),c+=2;t*=2;break;case"utf8":e=Un(this,this.l,this.l+t);break;case"utf16le":t*=2,e=Ml(this,this.l,this.l+t);break;case"wstr":if(typeof Ke<"u")e=Ke.utils.decode(xa,this.slice(this.l,this.l+2*t));else return vs.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":e=b0(this,this.l),t=4+Ht(this,this.l);break;case"lpstr-cp":e=C0(this,this.l),t=4+Ht(this,this.l);break;case"lpwstr":e=k0(this,this.l),t=4+2*Ht(this,this.l);break;case"lpp4":t=4+Ht(this,this.l),e=E0(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Ht(this,this.l),e=S0(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(s=Dn(this,this.l+t++))!==0;)n.push(al(s));e=n.join("");break;case"_wstr":for(t=0,e="";(s=Fa(this,this.l+t))!==0;)n.push(al(s)),t+=2;t+=2,e=n.join("");break;case"dbcs-cont":for(e="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Dn(this,c),this.l=c+1,o=vs.call(this,t-l,s?"dbcs-cont":"sbcs-cont"),n.join("")+o;n.push(al(Fa(this,c))),c+=2}e=n.join(""),t*=2;break;case"cpstr":if(typeof Ke<"u"){e=Ke.utils.decode(xa,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(e="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Dn(this,c),this.l=c+1,o=vs.call(this,t-l,s?"dbcs-cont":"sbcs-cont"),n.join("")+o;n.push(al(Dn(this,c))),c+=1}e=n.join("");break;default:switch(t){case 1:return a=Dn(this,this.l),this.l++,a;case 2:return a=(r==="i"?B1:Fa)(this,this.l),this.l+=2,a;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(a=(t>0?Ti:V1)(this,this.l),this.l+=4,a):(i=Ht(this,this.l),this.l+=4,i);case 8:case-8:if(r==="f")return t==8?i=xl(this,this.l):i=xl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:e=Qh(this,this.l,t);break}}return this.l+=t,e}var U1=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24&255},H1=function(t,r,e){t[e]=r&255,t[e+1]=r>>8&255,t[e+2]=r>>16&255,t[e+3]=r>>24&255},W1=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255};function G1(t,r,e){var a=0,i=0;if(e==="dbcs"){for(i=0;i!=r.length;++i)W1(this,r.charCodeAt(i),this.l+2*i);a=2*r.length}else if(e==="sbcs"){if(typeof Ke<"u"&&Pn==874)for(i=0;i!=r.length;++i){var n=Ke.utils.encode(Pn,r.charAt(i));this[this.l+i]=n[0]}else for(r=r.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=r.length;++i)this[this.l+i]=r.charCodeAt(i)&255;a=r.length}else if(e==="hex"){for(;i<t;++i)this[this.l++]=parseInt(r.slice(2*i,2*i+2),16)||0;return this}else if(e==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(r.length,t);++i){var o=r.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:a=1,this[this.l]=r&255;break;case 2:a=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:a=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:a=4,U1(this,r,this.l);break;case 8:if(a=8,e==="f"){N1(this,r,this.l);break}case 16:break;case-4:a=4,H1(this,r,this.l);break}return this.l+=a,this}function nm(t,r){var e=Qh(this,this.l,t.length>>1);if(e!==t)throw new Error(r+"Expected "+t+" saw "+e);this.l+=t.length>>1}function $t(t,r){t.l=r,t.read_shift=vs,t.chk=nm,t.write_shift=G1}function cr(t,r){t.l+=r}function Z(t){var r=di(t);return $t(r,0),r}function Na(t,r,e){if(t){var a,i,n;$t(t,t.l||0);for(var s=t.length,o=0,l=0;t.l<s;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=Bs[o]||Bs[65535];for(a=t.read_shift(1),n=a&127,i=1;i<4&&a&128;++i)n+=((a=t.read_shift(1))&127)<<7*i;l=t.l+n;var d=c.f&&c.f(t,n,e);if(t.l=l,r(d,c,o))return}}}function yr(){var t=[],r=Ue?256:2048,e=function(c){var d=Z(c);return $t(d,0),d},a=e(r),i=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&t.push(a),a=null)},n=function(c){return a&&c<a.length-a.l?a:(i(),a=e(Math.max(c+1,r)))},s=function(){return i(),Wt(t)},o=function(c){i(),a=c,a.l==null&&(a.l=a.length),n(r)};return{next:n,push:o,end:s,_bufs:t}}function re(t,r,e,a){var i=+r,n;if(!isNaN(i)){a||(a=Bs[i].p||(e||[]).length||0),n=1+(i>=128?1:0)+1,a>=128&&++n,a>=16384&&++n,a>=2097152&&++n;var s=t.next(n);i<=127?s.write_shift(1,i):(s.write_shift(1,(i&127)+128),s.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(a>=128)s.write_shift(1,(a&127)+128),a>>=7;else{s.write_shift(1,a);break}a>0&&D0(e)&&t.push(e)}}function ws(t,r,e){var a=st(t);if(r.s?(a.cRel&&(a.c+=r.s.c),a.rRel&&(a.r+=r.s.r)):(a.cRel&&(a.c+=r.c),a.rRel&&(a.r+=r.r)),!e||e.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function $u(t,r,e){var a=st(t);return a.s=ws(a.s,r.s,e),a.e=ws(a.e,r.s,e),a}function ys(t,r){if(t.cRel&&t.c<0)for(t=st(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=st(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var e=Oe(t);return!t.cRel&&t.cRel!=null&&(e=$1(e)),!t.rRel&&t.rRel!=null&&(e=z1(e)),e}function Uc(t,r){return t.s.r==0&&!t.s.rRel&&t.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+lt(t.s.c)+":"+(t.e.cRel?"":"$")+lt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(r.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+kt(t.s.r)+":"+(t.e.rRel?"":"$")+kt(t.e.r):ys(t.s,r.biff)+":"+ys(t.e,r.biff)}function T0(t){return parseInt(Y1(t),10)-1}function kt(t){return""+(t+1)}function z1(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Y1(t){return t.replace(/\$(\d+)$/,"$1")}function A0(t){for(var r=X1(t),e=0,a=0;a!==r.length;++a)e=26*e+r.charCodeAt(a)-64;return e-1}function lt(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function $1(t){return t.replace(/^([A-Z])/,"$$$1")}function X1(t){return t.replace(/^\$([A-Z])/,"$1")}function j1(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ct(t){for(var r=0,e=0,a=0;a<t.length;++a){var i=t.charCodeAt(a);i>=48&&i<=57?r=10*r+(i-48):i>=65&&i<=90&&(e=26*e+(i-64))}return{c:e-1,r:r-1}}function Oe(t){for(var r=t.c+1,e="";r;r=(r-1)/26|0)e=String.fromCharCode((r-1)%26+65)+e;return e+(t.r+1)}function br(t){var r=t.indexOf(":");return r==-1?{s:ct(t),e:ct(t)}:{s:ct(t.slice(0,r)),e:ct(t.slice(r+1))}}function Ne(t,r){return typeof r>"u"||typeof r=="number"?Ne(t.s,t.e):(typeof t!="string"&&(t=Oe(t)),typeof r!="string"&&(r=Oe(r)),t==r?t:t+":"+r)}function Xe(t){var r={s:{c:0,r:0},e:{c:0,r:0}},e=0,a=0,i=0,n=t.length;for(e=0;a<n&&!((i=t.charCodeAt(a)-64)<1||i>26);++a)e=26*e+i;for(r.s.c=--e,e=0;a<n&&!((i=t.charCodeAt(a)-48)<0||i>9);++a)e=10*e+i;if(r.s.r=--e,a===n||i!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++a,e=0;a!=n&&!((i=t.charCodeAt(a)-64)<1||i>26);++a)e=26*e+i;for(r.e.c=--e,e=0;a!=n&&!((i=t.charCodeAt(a)-48)<0||i>9);++a)e=10*e+i;return r.e.r=--e,r}function Xu(t,r){var e=t.t=="d"&&r instanceof Date;if(t.z!=null)try{return t.w=jr(t.z,e?Lt(r):r)}catch{}try{return t.w=jr((t.XF||{}).numFmtId||(e?14:0),e?Lt(r):r)}catch{return""+r}}function Pa(t,r,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?La[t.v]||t.v:r==null?Xu(t,t.v):Xu(t,r))}function pi(t,r){var e=r&&r.sheet?r.sheet:"Sheet1",a={};return a[e]=t,{SheetNames:[e],Sheets:a}}function sm(t,r,e){var a=e||{},i=t?Array.isArray(t):a.dense;ht!=null&&i==null&&(i=ht);var n=t||(i?[]:{}),s=0,o=0;if(n&&a.origin!=null){if(typeof a.origin=="number")s=a.origin;else{var l=typeof a.origin=="string"?ct(a.origin):a.origin;s=l.r,o=l.c}n["!ref"]||(n["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var d=Xe(n["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),s==-1&&(c.e.r=s=d.e.r+1)}for(var f=0;f!=r.length;++f)if(r[f]){if(!Array.isArray(r[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=r[f].length;++h)if(!(typeof r[f][h]>"u")){var m={v:r[f][h]},p=s+f,u=o+h;if(c.s.r>p&&(c.s.r=p),c.s.c>u&&(c.s.c=u),c.e.r<p&&(c.e.r=p),c.e.c<u&&(c.e.c=u),r[f][h]&&typeof r[f][h]=="object"&&!Array.isArray(r[f][h])&&!(r[f][h]instanceof Date))m=r[f][h];else if(Array.isArray(m.v)&&(m.f=r[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(a.nullError)m.t="e",m.v=0;else if(a.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=a.dateNF||Fe[14],a.cellDates?(m.t="d",m.w=jr(m.z,Lt(m.v))):(m.t="n",m.v=Lt(m.v),m.w=jr(m.z,m.v))):m.t="s";if(i)n[p]||(n[p]=[]),n[p][u]&&n[p][u].z&&(m.z=n[p][u].z),n[p][u]=m;else{var _=Oe({c:u,r:p});n[_]&&n[_].z&&(m.z=n[_].z),n[_]=m}}}return c.s.c<1e7&&(n["!ref"]=Ne(c)),n}function Hn(t,r){return sm(null,t,r)}function K1(t){return t.read_shift(4,"i")}function ra(t,r){return r||(r=Z(4)),r.write_shift(4,t),r}function lr(t){var r=t.read_shift(4);return r===0?"":t.read_shift(r,"dbcs")}function Gt(t,r){var e=!1;return r==null&&(e=!0,r=Z(4+2*t.length)),r.write_shift(4,t.length),t.length>0&&r.write_shift(0,t,"dbcs"),e?r.slice(0,r.l):r}function q1(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Z1(t,r){return r||(r=Z(4)),r.write_shift(2,t.ich||0),r.write_shift(2,t.ifnt||0),r}function F0(t,r){var e=t.l,a=t.read_shift(1),i=lr(t),n=[],s={t:i,h:i};if((a&1)!==0){for(var o=t.read_shift(4),l=0;l!=o;++l)n.push(q1(t));s.r=n}else s.r=[{ich:0,ifnt:0}];return t.l=e+r,s}function Q1(t,r){var e=!1;return r==null&&(e=!0,r=Z(15+4*t.t.length)),r.write_shift(1,0),Gt(t.t,r),e?r.slice(0,r.l):r}var J1=F0;function ex(t,r){var e=!1;return r==null&&(e=!0,r=Z(23+4*t.t.length)),r.write_shift(1,1),Gt(t.t,r),r.write_shift(4,1),Z1({ich:0,ifnt:0},r),e?r.slice(0,r.l):r}function Kr(t){var r=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:e}}function Hi(t,r){return r==null&&(r=Z(8)),r.write_shift(-4,t.c),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}function Wi(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}function Gi(t,r){return r==null&&(r=Z(4)),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}var tx=lr,om=Gt;function O0(t){var r=t.read_shift(4);return r===0||r===4294967295?"":t.read_shift(r,"dbcs")}function vl(t,r){var e=!1;return r==null&&(e=!0,r=Z(127)),r.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&r.write_shift(0,t,"dbcs"),e?r.slice(0,r.l):r}var rx=lr,e0=O0,M0=vl;function I0(t){var r=t.slice(t.l,t.l+4),e=r[0]&1,a=r[0]&2;t.l+=4;var i=a===0?xl([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Ti(r,0)>>2;return e?i/100:i}function lm(t,r){r==null&&(r=Z(4));var e=0,a=0,i=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?a=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(a=1,e=1),a)r.write_shift(-4,((e?i:t)<<2)+(e+2));else throw new Error("unsupported RkNumber "+t)}function cm(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}function ax(t,r){return r||(r=Z(16)),r.write_shift(4,t.s.r),r.write_shift(4,t.e.r),r.write_shift(4,t.s.c),r.write_shift(4,t.e.c),r}var zi=cm,Wn=ax;function sr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Ni(t,r){return(r||Z(8)).write_shift(8,t,"f")}function ix(t){var r={},e=t.read_shift(1),a=e>>>1,i=t.read_shift(1),n=t.read_shift(2,"i"),s=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,a){case 0:r.auto=1;break;case 1:r.index=i;var c=Fi[i];c&&(r.rgb=Ps(c));break;case 2:r.rgb=Ps([s,o,l]);break;case 3:r.theme=i;break}return n!=0&&(r.tint=n>0?n/32767:n/32768),r}function wl(t,r){if(r||(r=Z(8)),!t||t.auto)return r.write_shift(4,0),r.write_shift(4,0),r;t.index!=null?(r.write_shift(1,2),r.write_shift(1,t.index)):t.theme!=null?(r.write_shift(1,6),r.write_shift(1,t.theme)):(r.write_shift(1,5),r.write_shift(1,0));var e=t.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),r.write_shift(2,e),!t.rgb||t.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var a=t.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),r.write_shift(1,parseInt(a.slice(0,2),16)),r.write_shift(1,parseInt(a.slice(2,4),16)),r.write_shift(1,parseInt(a.slice(4,6),16)),r.write_shift(1,255)}return r}function nx(t){var r=t.read_shift(1);t.l++;var e={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return e}function sx(t,r){r||(r=Z(2));var e=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return r.write_shift(1,e),r.write_shift(1,0),r}function dm(t,r){var e={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=t.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return e[t.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return t.l-=4,t.read_shift(0,r==1?"lpstr":"lpwstr")}function ox(t){return dm(t,1)}function lx(t){return dm(t,2)}var P0=2,wr=3,nl=11,ju=12,yl=19;var sl=64,cx=65,dx=71;var fx=4108,ux=4126,Ut=80,fm=81,hx=[Ut,fm],t0={1:{n:"CodePage",t:P0},2:{n:"Category",t:Ut},3:{n:"PresentationFormat",t:Ut},4:{n:"ByteCount",t:wr},5:{n:"LineCount",t:wr},6:{n:"ParagraphCount",t:wr},7:{n:"SlideCount",t:wr},8:{n:"NoteCount",t:wr},9:{n:"HiddenCount",t:wr},10:{n:"MultimediaClipCount",t:wr},11:{n:"ScaleCrop",t:nl},12:{n:"HeadingPairs",t:fx},13:{n:"TitlesOfParts",t:ux},14:{n:"Manager",t:Ut},15:{n:"Company",t:Ut},16:{n:"LinksUpToDate",t:nl},17:{n:"CharacterCount",t:wr},19:{n:"SharedDoc",t:nl},22:{n:"HyperlinksChanged",t:nl},23:{n:"AppVersion",t:wr,p:"version"},24:{n:"DigSig",t:cx},26:{n:"ContentType",t:Ut},27:{n:"ContentStatus",t:Ut},28:{n:"Language",t:Ut},29:{n:"Version",t:Ut},255:{},2147483648:{n:"Locale",t:yl},2147483651:{n:"Behavior",t:yl},1919054434:{}},r0={1:{n:"CodePage",t:P0},2:{n:"Title",t:Ut},3:{n:"Subject",t:Ut},4:{n:"Author",t:Ut},5:{n:"Keywords",t:Ut},6:{n:"Comments",t:Ut},7:{n:"Template",t:Ut},8:{n:"LastAuthor",t:Ut},9:{n:"RevNumber",t:Ut},10:{n:"EditTime",t:sl},11:{n:"LastPrinted",t:sl},12:{n:"CreatedDate",t:sl},13:{n:"ModifiedDate",t:sl},14:{n:"PageCount",t:wr},15:{n:"WordCount",t:wr},16:{n:"CharCount",t:wr},17:{n:"Thumbnail",t:dx},18:{n:"Application",t:Ut},19:{n:"DocSecurity",t:wr},255:{},2147483648:{n:"Locale",t:yl},2147483651:{n:"Behavior",t:yl},1919054434:{}},Ku={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},mx=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function px(t){return t.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var _x=px([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Fi=st(_x),La={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},um={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},a0={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ol={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function R0(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function gx(t){var r=R0();if(!t||!t.match)return r;var e={};if((t.match(dr)||[]).forEach(function(a){var i=Me(a);switch(i[0].replace(S1,"<")){case"<?xml":break;case"<Types":r.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[i.Extension]=i.ContentType;break;case"<Override":r[a0[i.ContentType]]!==void 0&&r[a0[i.ContentType]].push(i.PartName);break}}),r.xmlns!==Nt.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=e,delete r.calcchains,r}function hm(t,r){var e=g1(a0),a=[],i;a[a.length]=Et,a[a.length]=le("Types",null,{xmlns:Nt.CT,"xmlns:xsd":Nt.xsd,"xmlns:xsi":Nt.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return le("Default",null,{Extension:l[0],ContentType:l[1]})}));var n=function(l){t[l]&&t[l].length>0&&(i=t[l][0],a[a.length]=le("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:ol[l][r.bookType]||ol[l].xlsx}))},s=function(l){(t[l]||[]).forEach(function(c){a[a.length]=le("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:ol[l][r.bookType]||ol[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(c){a[a.length]=le("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:e[l][0]})})};return n("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(n),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Be={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Is(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function bs(t,r){var e={"!id":{}};if(!t)return e;r.charAt(0)!=="/"&&(r="/"+r);var a={};return(t.match(dr)||[]).forEach(function(i){var n=Me(i);if(n[0]==="<Relationship"){var s={};s.Type=n.Type,s.Target=n.Target,s.Id=n.Id,n.TargetMode&&(s.TargetMode=n.TargetMode);var o=n.TargetMode==="External"?n.Target:xs(n.Target,r);e[o]=s,a[n.Id]=s}}),e["!id"]=a,e}function On(t){var r=[Et,le("Relationships",null,{xmlns:Nt.RELS})];return mt(t["!id"]).forEach(function(e){r[r.length]=le("Relationship",null,t["!id"][e])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function Je(t,r,e,a,i,n){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),r<0)for(r=t["!idx"];t["!id"]["rId"+r];++r);if(t["!idx"]=r+1,i.Id="rId"+r,i.Type=a,i.Target=e,n?i.TargetMode=n:[Be.HLINK,Be.XPATH,Be.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+r);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,r}var xx="application/vnd.oasis.opendocument.spreadsheet";function vx(t,r){for(var e=y0(t),a,i;a=Ms.exec(e);)switch(a[3]){case"manifest":break;case"file-entry":if(i=Me(a[0],!1),i.path=="/"&&i.type!==xx)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw a}}function wx(t){var r=[Et];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<t.length;++e)r.push('  <manifest:file-entry manifest:full-path="'+t[e][0]+'" manifest:media-type="'+t[e][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function qu(t,r,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function yx(t,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function bx(t){var r=[Et];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=t.length;++e)r.push(qu(t[e][0],t[e][1])),r.push(yx("",t[e][0]));return r.push(qu("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function mm(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ds.version+"</meta:generator></office:meta></office:document-meta>"}var Xr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Cx=function(){for(var t=new Array(Xr.length),r=0;r<Xr.length;++r){var e=Xr[r],a="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);t[r]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return t}();function pm(t){var r={};t=rt(t);for(var e=0;e<Xr.length;++e){var a=Xr[e],i=t.match(Cx[e]);i!=null&&i.length>0&&(r[a[1]]=$e(i[1])),a[2]==="date"&&r[a[1]]&&(r[a[1]]=nt(r[a[1]]))}return r}function Hc(t,r,e,a,i){i[t]!=null||r==null||r===""||(i[t]=r,r=et(r),a[a.length]=e?le(t,r,e):Xt(t,r))}function _m(t,r){var e=r||{},a=[Et,le("cp:coreProperties",null,{"xmlns:cp":Nt.CORE_PROPS,"xmlns:dc":Nt.dc,"xmlns:dcterms":Nt.dcterms,"xmlns:dcmitype":Nt.dcmitype,"xmlns:xsi":Nt.xsi})],i={};if(!t&&!e.Props)return a.join("");t&&(t.CreatedDate!=null&&Hc("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Jc(t.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},a,i),t.ModifiedDate!=null&&Hc("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Jc(t.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},a,i));for(var n=0;n!=Xr.length;++n){var s=Xr[n],o=e.Props&&e.Props[s[1]]!=null?e.Props[s[1]]:t?t[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Hc(s[0],o,null,a,i)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Oi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],gm=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function xm(t,r,e,a){var i=[];if(typeof t=="string")i=Uu(t,a);else for(var n=0;n<t.length;++n)i=i.concat(t[n].map(function(d){return{v:d}}));var s=typeof r=="string"?Uu(r,a).map(function(d){return d.v}):r,o=0,l=0;if(s.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":e.Worksheets=l,e.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":e.NamedRanges=l,e.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":e.Chartsheets=l,e.ChartNames=s.slice(o,o+l);break}o+=l}}function kx(t,r,e){var a={};return r||(r={}),t=rt(t),Oi.forEach(function(i){var n=(t.match(Fs(i[0]))||[])[1];switch(i[2]){case"string":n&&(r[i[1]]=$e(n));break;case"bool":r[i[1]]=n==="true";break;case"raw":var s=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));s&&s.length>0&&(a[i[1]]=s[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&xm(a.HeadingPairs,a.TitlesOfParts,r,e),r}function vm(t){var r=[],e=le;return t||(t={}),t.Application="SheetJS",r[r.length]=Et,r[r.length]=le("Properties",null,{xmlns:Nt.EXT_PROPS,"xmlns:vt":Nt.vt}),Oi.forEach(function(a){if(t[a[1]]!==void 0){var i;switch(a[2]){case"string":i=et(String(t[a[1]]));break;case"bool":i=t[a[1]]?"true":"false";break}i!==void 0&&(r[r.length]=e(a[0],i))}}),r[r.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=e("TitlesOfParts",e("vt:vector",t.SheetNames.map(function(a){return"<vt:lpstr>"+et(a)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Ex=/<[^>]+>[^<]*/g;function Sx(t,r){var e={},a="",i=t.match(Ex);if(i)for(var n=0;n!=i.length;++n){var s=i[n],o=Me(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":a=$e(o.name);break;case"</property>":a=null;break;default:if(s.indexOf("<vt:")===0){var l=s.split(">"),c=l[0].slice(4),d=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":e[a]=$e(d);break;case"bool":e[a]=it(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[a]=parseInt(d,10);break;case"r4":case"r8":case"decimal":e[a]=parseFloat(d);break;case"filetime":case"date":e[a]=nt(d);break;case"cy":case"error":e[a]=$e(d);break;default:if(c.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",s,c,l)}}else if(s.slice(0,2)!=="</"){if(r.WTF)throw new Error(s)}}}return e}function wm(t){var r=[Et,le("Properties",null,{xmlns:Nt.CUST_PROPS,"xmlns:vt":Nt.vt})];if(!t)return r.join("");var e=1;return mt(t).forEach(function(i){++e,r[r.length]=le("property",P1(t[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:et(i)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var i0={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Wc;function Dx(t,r,e){Wc||(Wc=Al(i0)),r=Wc[r]||r,t[r]=e}function Tx(t,r){var e=[];return mt(i0).map(function(a){for(var i=0;i<Xr.length;++i)if(Xr[i][1]==a)return Xr[i];for(i=0;i<Oi.length;++i)if(Oi[i][1]==a)return Oi[i];throw a}).forEach(function(a){if(t[a[1]]!=null){var i=r&&r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t[a[1]];switch(a[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),e.push(Xt(i0[a[1]]||a[1],i))}}),le("DocumentProperties",e.join(""),{xmlns:Fr.o})}function Ax(t,r){var e=["Worksheets","SheetNames"],a="CustomDocumentProperties",i=[];return t&&mt(t).forEach(function(n){if(Object.prototype.hasOwnProperty.call(t,n)){for(var s=0;s<Xr.length;++s)if(n==Xr[s][1])return;for(s=0;s<Oi.length;++s)if(n==Oi[s][1])return;for(s=0;s<e.length;++s)if(n==e[s])return;var o=t[n],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(le(Nu(n),o,{"dt:dt":l}))}}),r&&mt(r).forEach(function(n){if(Object.prototype.hasOwnProperty.call(r,n)&&!(t&&Object.prototype.hasOwnProperty.call(t,n))){var s=r[n],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),i.push(le(Nu(n),s,{"dt:dt":o}))}}),"<"+a+' xmlns="'+Fr.o+'">'+i.join("")+"</"+a+">"}function N0(t){var r=t.read_shift(4),e=t.read_shift(4);return new Date((e/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Fx(t){var r=typeof t=="string"?new Date(Date.parse(t)):t,e=r.getTime()/1e3+11644473600,a=e%Math.pow(2,32),i=(e-a)/Math.pow(2,32);a*=1e7,i*=1e7;var n=a/Math.pow(2,32)|0;n>0&&(a=a%Math.pow(2,32),i+=n);var s=Z(8);return s.write_shift(4,a),s.write_shift(4,i),s}function ym(t,r,e){var a=t.l,i=t.read_shift(0,"lpstr-cp");if(e)for(;t.l-a&3;)++t.l;return i}function bm(t,r,e){var a=t.read_shift(0,"lpwstr");return e&&(t.l+=4-(a.length+1&3)&3),a}function Cm(t,r,e){return r===31?bm(t):ym(t,r,e)}function n0(t,r,e){return Cm(t,r,e===!1?0:4)}function Ox(t,r){if(!r)throw new Error("VtUnalignedString must have positive length");return Cm(t,r,0)}function Mx(t){for(var r=t.read_shift(4),e=[],a=0;a!=r;++a){var i=t.l;e[a]=t.read_shift(0,"lpwstr").replace(or,""),t.l-i&2&&(t.l+=2)}return e}function Ix(t){for(var r=t.read_shift(4),e=[],a=0;a!=r;++a)e[a]=t.read_shift(0,"lpstr-cp").replace(or,"");return e}function Px(t){var r=t.l,e=bl(t,fm);t[t.l]==0&&t[t.l+1]==0&&t.l-r&2&&(t.l+=2);var a=bl(t,wr);return[e,a]}function Rx(t){for(var r=t.read_shift(4),e=[],a=0;a<r/2;++a)e.push(Px(t));return e}function Zu(t,r){for(var e=t.read_shift(4),a={},i=0;i!=e;++i){var n=t.read_shift(4),s=t.read_shift(4);a[n]=t.read_shift(s,r===1200?"utf16le":"utf8").replace(or,"").replace(gs,"!"),r===1200&&s%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),a}function km(t){var r=t.read_shift(4),e=t.slice(t.l,t.l+r);return t.l+=r,(r&3)>0&&(t.l+=4-(r&3)&3),e}function Nx(t){var r={};return r.Size=t.read_shift(4),t.l+=r.Size+3-(r.Size-1)%4,r}function bl(t,r,e){var a=t.read_shift(2),i,n=e||{};if(t.l+=2,r!==ju&&a!==r&&hx.indexOf(r)===-1&&!((r&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+r+" saw "+a);switch(r===ju?a:r){case 2:return i=t.read_shift(2,"i"),n.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return ym(t,a,4).replace(or,"");case 31:return bm(t);case 64:return N0(t);case 65:return km(t);case 71:return Nx(t);case 80:return n0(t,a,!n.raw).replace(or,"");case 81:return Ox(t,a).replace(or,"");case 4108:return Rx(t);case 4126:case 4127:return a==4127?Mx(t):Ix(t);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+a)}}function Qu(t,r){var e=Z(4),a=Z(4);switch(e.write_shift(4,t==80?31:t),t){case 3:a.write_shift(-4,r);break;case 5:a=Z(8),a.write_shift(8,r,"f");break;case 11:a.write_shift(4,r?1:0);break;case 64:a=Fx(r);break;case 31:case 80:for(a=Z(4+2*(r.length+1)+(r.length%2?0:2)),a.write_shift(4,r.length+1),a.write_shift(0,r,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}return Wt([e,a])}function Ju(t,r){var e=t.l,a=t.read_shift(4),i=t.read_shift(4),n=[],s=0,o=0,l=-1,c={};for(s=0;s!=i;++s){var d=t.read_shift(4),f=t.read_shift(4);n[s]=[d,f+e]}n.sort(function(k,w){return k[1]-w[1]});var h={};for(s=0;s!=i;++s){if(t.l!==n[s][1]){var m=!0;if(s>0&&r)switch(r[n[s-1][0]].t){case 2:t.l+2===n[s][1]&&(t.l+=2,m=!1);break;case 80:t.l<=n[s][1]&&(t.l=n[s][1],m=!1);break;case 4108:t.l<=n[s][1]&&(t.l=n[s][1],m=!1);break}if((!r||s==0)&&t.l<=n[s][1]&&(m=!1,t.l=n[s][1]),m)throw new Error("Read Error: Expected address "+n[s][1]+" at "+t.l+" :"+s)}if(r){var p=r[n[s][0]];if(h[p.n]=bl(t,p.t,{raw:!0}),p.p==="version"&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(h[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Jr(o=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(n[s][0]===1){if(o=h.CodePage=bl(t,P0),Jr(o),l!==-1){var u=t.l;t.l=n[l][1],c=Zu(t,o),t.l=u}}else if(n[s][0]===0){if(o===0){l=s,t.l=n[s+1][1];continue}c=Zu(t,o)}else{var _=c[n[s][0]],E;switch(t[t.l]){case 65:t.l+=4,E=km(t);break;case 30:t.l+=4,E=n0(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,E=n0(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,E=t.read_shift(4,"i");break;case 19:t.l+=4,E=t.read_shift(4);break;case 5:t.l+=4,E=t.read_shift(8,"f");break;case 11:t.l+=4,E=Ct(t,4);break;case 64:t.l+=4,E=nt(N0(t));break;default:throw new Error("unparsed value: "+t[t.l])}h[_]=E}}return t.l=e+a,h}var Em=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Lx(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function eh(t,r,e){var a=Z(8),i=[],n=[],s=8,o=0,l=Z(8),c=Z(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),n.push(l),i.push(c),s+=8+l.length,!r){c=Z(8),c.write_shift(4,0),i.unshift(c);var d=[Z(4)];for(d[0].write_shift(4,t.length),o=0;o<t.length;++o){var f=t[o][0];for(l=Z(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=Wt(d),n.unshift(l),s+=8+l.length}for(o=0;o<t.length;++o)if(!(r&&!r[t[o][0]])&&!(Em.indexOf(t[o][0])>-1||gm.indexOf(t[o][0])>-1)&&t[o][1]!=null){var h=t[o][1],m=0;if(r){m=+r[t[o][0]];var p=e[m];if(p.p=="version"&&typeof h=="string"){var u=h.split(".");h=(+u[0]<<16)+(+u[1]||0)}l=Qu(p.t,h)}else{var _=Lx(h);_==-1&&(_=31,h=String(h)),l=Qu(_,h)}n.push(l),c=Z(8),c.write_shift(4,r?m:2+o),i.push(c),s+=8+l.length}var E=8*(n.length+1);for(o=0;o<n.length;++o)i[o].write_shift(4,E),E+=n[o].length;return a.write_shift(4,s),a.write_shift(4,n.length),Wt([a].concat(i).concat(n))}function th(t,r,e){var a=t.content;if(!a)return{};$t(a,0);var i,n,s,o,l=0;a.chk("feff","Byte Order: "),a.read_shift(2);var c=a.read_shift(4),d=a.read_shift(16);if(d!==Se.utils.consts.HEADER_CLSID&&d!==e)throw new Error("Bad PropertySet CLSID "+d);if(i=a.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(n=a.read_shift(16),o=a.read_shift(4),i===1&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);i===2&&(s=a.read_shift(16),l=a.read_shift(4));var f=Ju(a,r),h={SystemIdentifier:c};for(var m in f)h[m]=f[m];if(h.FMTID=n,i===1)return h;if(l-a.l==2&&(a.l+=2),a.l!==l)throw new Error("Length mismatch 2: "+a.l+" !== "+l);var p;try{p=Ju(a,null)}catch{}for(m in p)h[m]=p[m];return h.FMTID=[n,s],h}function rh(t,r,e,a,i,n){var s=Z(i?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Se.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,i?2:1),s.write_shift(16,r,"hex"),s.write_shift(4,i?68:48);var l=eh(t,e,a);if(o.push(l),i){var c=eh(i,null,null);s.write_shift(16,n,"hex"),s.write_shift(4,68+l.length),o.push(c)}return Wt(o)}function oi(t,r){return t.read_shift(r),null}function Bx(t,r){r||(r=Z(t));for(var e=0;e<t;++e)r.write_shift(1,0);return r}function Vx(t,r,e){for(var a=[],i=t.l+r;t.l<i;)a.push(e(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return a}function Ct(t,r){return t.read_shift(r)===1}function pr(t,r){return r||(r=Z(2)),r.write_shift(2,+!!t),r}function Ot(t){return t.read_shift(2,"u")}function $r(t,r){return r||(r=Z(2)),r.write_shift(2,t),r}function Sm(t,r){return Vx(t,r,Ot)}function Ux(t){var r=t.read_shift(1),e=t.read_shift(1);return e===1?r:r===1}function Dm(t,r,e){return e||(e=Z(2)),e.write_shift(1,r=="e"?+t:+!!t),e.write_shift(1,r=="e"?1:0),e}function Ws(t,r,e){var a=t.read_shift(e&&e.biff>=12?2:1),i="sbcs-cont",n=xa;if(e&&e.biff>=8&&(xa=1200),!e||e.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else e.biff==12&&(i="wstr");e.biff>=2&&e.biff<=5&&(i="cpstr");var o=a?t.read_shift(a,i):"";return xa=n,o}function Hx(t){var r=xa;xa=1200;var e=t.read_shift(2),a=t.read_shift(1),i=a&4,n=a&8,s=1+(a&1),o=0,l,c={};n&&(o=t.read_shift(2)),i&&(l=t.read_shift(4));var d=s==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,d);return n&&(t.l+=4*o),i&&(t.l+=l),c.t=f,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),xa=r,c}function Wx(t){var r=t.t||"",e=1,a=Z(3+(e>1?2:0));a.write_shift(2,r.length),a.write_shift(1,(e>1?8:0)|1),e>1&&a.write_shift(2,e);var i=Z(2*r.length);i.write_shift(2*r.length,r,"utf16le");var n=[a,i];return Wt(n)}function Li(t,r,e){var a;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(r,"cpstr");if(e.biff>=12)return t.read_shift(r,"dbcs-cont")}var i=t.read_shift(1);return i===0?a=t.read_shift(r,"sbcs-cont"):a=t.read_shift(r,"dbcs-cont"),a}function Gs(t,r,e){var a=t.read_shift(e&&e.biff==2?1:2);return a===0?(t.l++,""):Li(t,a,e)}function Yi(t,r,e){if(e.biff>5)return Gs(t,r,e);var a=t.read_shift(1);return a===0?(t.l++,""):t.read_shift(a,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function Tm(t,r,e){return e||(e=Z(3+2*t.length)),e.write_shift(2,t.length),e.write_shift(1,1),e.write_shift(31,t,"utf16le"),e}function Gx(t){var r=t.read_shift(1);t.l++;var e=t.read_shift(2);return t.l+=2,[r,e]}function zx(t){var r=t.read_shift(4),e=t.l,a=!1;r>24&&(t.l+=r-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),t.l=e);var i=t.read_shift((a?r-24:r)>>1,"utf16le").replace(or,"");return a&&(t.l+=24),i}function Yx(t){for(var r=t.read_shift(2),e="";r-- >0;)e+="../";var a=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return e+a.replace(/\\/g,"/");var n=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=t.read_shift(n>>1,"utf16le").replace(or,"");return e+s}function $x(t,r){var e=t.read_shift(16);switch(r-=16,e){case"e0c9ea79f9bace118c8200aa004ba90b":return zx(t,r);case"0303000000000000c000000000000046":return Yx(t,r);default:throw new Error("Unsupported Moniker "+e)}}function ll(t){var r=t.read_shift(4),e=r>0?t.read_shift(r,"utf16le").replace(or,""):"";return e}function ah(t,r){r||(r=Z(6+t.length*2)),r.write_shift(4,1+t.length);for(var e=0;e<t.length;++e)r.write_shift(2,t.charCodeAt(e));return r.write_shift(2,0),r}function Xx(t,r){var e=t.l+r,a=t.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var i=t.read_shift(2);t.l+=2;var n,s,o,l,c="",d,f;i&16&&(n=ll(t,e-t.l)),i&128&&(s=ll(t,e-t.l)),(i&257)===257&&(o=ll(t,e-t.l)),(i&257)===1&&(l=$x(t,e-t.l)),i&8&&(c=ll(t,e-t.l)),i&32&&(d=t.read_shift(16)),i&64&&(f=N0(t)),t.l=e;var h=s||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return d&&(m.guid=d),f&&(m.time=f),n&&(m.Tooltip=n),m}function jx(t){var r=Z(512),e=0,a=t.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var i=a.indexOf("#"),n=i>-1?31:23;switch(a.charAt(0)){case"#":n=28;break;case".":n&=-3;break}r.write_shift(4,2),r.write_shift(4,n);var s=[8,6815827,6619237,4849780,83];for(e=0;e<s.length;++e)r.write_shift(4,s[e]);if(n==28)a=a.slice(1),ah(a,r);else if(n&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<s.length;++e)r.write_shift(1,parseInt(s[e],16));var o=i>-1?a.slice(0,i):a;for(r.write_shift(4,2*(o.length+1)),e=0;e<o.length;++e)r.write_shift(2,o.charCodeAt(e));r.write_shift(2,0),n&8&&ah(i>-1?a.slice(i+1):"",r)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<s.length;++e)r.write_shift(1,parseInt(s[e],16));for(var l=0;a.slice(l*3,l*3+3)=="../"||a.slice(l*3,l*3+3)=="..\\";)++l;for(r.write_shift(2,l),r.write_shift(4,a.length-3*l+1),e=0;e<a.length-3*l;++e)r.write_shift(1,a.charCodeAt(e+3*l)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),e=0;e<6;++e)r.write_shift(4,0)}return r.slice(0,r.l)}function Am(t){var r=t.read_shift(1),e=t.read_shift(1),a=t.read_shift(1),i=t.read_shift(1);return[r,e,a,i]}function Fm(t,r){var e=Am(t,r);return e[3]=0,e}function wa(t){var r=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(2);return{r,c:e,ixfe:a}}function Bi(t,r,e,a){return a||(a=Z(6)),a.write_shift(2,t),a.write_shift(2,r),a.write_shift(2,e||0),a}function Kx(t){var r=t.read_shift(2),e=t.read_shift(2);return t.l+=8,{type:r,flags:e}}function qx(t,r,e){return r===0?"":Yi(t,r,e)}function Zx(t,r,e){var a=e.biff>8?4:2,i=t.read_shift(a),n=t.read_shift(a,"i"),s=t.read_shift(a,"i");return[i,n,s]}function Om(t){var r=t.read_shift(2),e=I0(t);return[r,e]}function Qx(t,r,e){t.l+=4,r-=4;var a=t.l+r,i=Ws(t,r,e),n=t.read_shift(2);if(a-=t.l,n!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+n);return t.l+=n,i}function Il(t){var r=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2);return{s:{c:a,r},e:{c:i,r:e}}}function Mm(t,r){return r||(r=Z(8)),r.write_shift(2,t.s.r),r.write_shift(2,t.e.r),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c),r}function Im(t){var r=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(1),i=t.read_shift(1);return{s:{c:a,r},e:{c:i,r:e}}}var Jx=Im;function Pm(t){t.l+=4;var r=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(2);return t.l+=12,[e,r,a]}function ev(t){var r={};return t.l+=4,t.l+=16,r.fSharedNote=t.read_shift(2),t.l+=4,r}function tv(t){var r={};return t.l+=4,t.cf=t.read_shift(2),r}function rr(t){t.l+=2,t.l+=t.read_shift(2)}var rv={0:rr,4:rr,5:rr,6:rr,7:tv,8:rr,9:rr,10:rr,11:rr,12:rr,13:ev,14:rr,15:rr,16:rr,17:rr,18:rr,19:rr,20:rr,21:Pm};function av(t,r){for(var e=t.l+r,a=[];t.l<e;){var i=t.read_shift(2);t.l-=2;try{a.push(rv[i](t,e-t.l))}catch{return t.l=e,a}}return t.l!=e&&(t.l=e),a}function cl(t,r){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=t.read_shift(2),r-=2,r>=2&&(e.dt=t.read_shift(2),t.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return t.read_shift(r),e}function L0(t,r,e){var a=1536,i=16;switch(e.bookType){case"biff8":break;case"biff5":a=1280,i=8;break;case"biff4":a=4,i=6;break;case"biff3":a=3,i=6;break;case"biff2":a=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var n=Z(i);return n.write_shift(2,a),n.write_shift(2,r),i>4&&n.write_shift(2,29282),i>6&&n.write_shift(2,1997),i>8&&(n.write_shift(2,49161),n.write_shift(2,1),n.write_shift(2,1798),n.write_shift(2,0)),n}function iv(t,r){return r===0||t.read_shift(2),1200}function nv(t,r,e){if(e.enc)return t.l+=r,"";var a=t.l,i=Yi(t,0,e);return t.read_shift(r+a-t.l),i}function sv(t,r){var e=!r||r.biff==8,a=Z(e?112:54);for(a.write_shift(r.biff==8?2:1,7),e&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(e?0:536870912));a.l<a.length;)a.write_shift(1,e?0:32);return a}function ov(t,r,e){var a=e&&e.biff==8||r==2?t.read_shift(2):(t.l+=r,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function lv(t,r,e){var a=t.read_shift(4),i=t.read_shift(1)&3,n=t.read_shift(1);switch(n){case 0:n="Worksheet";break;case 1:n="Macrosheet";break;case 2:n="Chartsheet";break;case 6:n="VBAModule";break}var s=Ws(t,0,e);return s.length===0&&(s="Sheet1"),{pos:a,hs:i,dt:n,name:s}}function cv(t,r){var e=!r||r.biff>=8?2:1,a=Z(8+e*t.name.length);a.write_shift(4,t.pos),a.write_shift(1,t.hs||0),a.write_shift(1,t.dt),a.write_shift(1,t.name.length),r.biff>=8&&a.write_shift(1,1),a.write_shift(e*t.name.length,t.name,r.biff<8?"sbcs":"utf16le");var i=a.slice(0,a.l);return i.l=a.l,i}function dv(t,r){for(var e=t.l+r,a=t.read_shift(4),i=t.read_shift(4),n=[],s=0;s!=i&&t.l<e;++s)n.push(Hx(t));return n.Count=a,n.Unique=i,n}function fv(t,r){var e=Z(8);e.write_shift(4,t.Count),e.write_shift(4,t.Unique);for(var a=[],i=0;i<t.length;++i)a[i]=Wx(t[i],r);var n=Wt([e].concat(a));return n.parts=[e.length].concat(a.map(function(s){return s.length})),n}function uv(t,r){var e={};return e.dsst=t.read_shift(2),t.l+=r-2,e}function hv(t){var r={};r.r=t.read_shift(2),r.c=t.read_shift(2),r.cnt=t.read_shift(2)-r.c;var e=t.read_shift(2);t.l+=4;var a=t.read_shift(1);return t.l+=3,a&7&&(r.level=a&7),a&32&&(r.hidden=!0),a&64&&(r.hpt=e/20),r}function mv(t){var r=Kx(t);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var e=t.read_shift(4);return e!==0}function pv(t){return t.read_shift(2),t.read_shift(4)}function ih(t,r,e){var a=0;e&&e.biff==2||(a=t.read_shift(2));var i=t.read_shift(2);e&&e.biff==2&&(a=1-(i>>15),i&=32767);var n={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[n,i]}function _v(t){var r=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[r,e],Dim:[a,i],Flags:n,CurTab:s,FirstTab:o,Selected:l,TabRatio:c}}function gv(){var t=Z(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function xv(t,r,e){if(e&&e.biff>=2&&e.biff<5)return{};var a=t.read_shift(2);return{RTL:a&64}}function vv(t){var r=Z(18),e=1718;return t&&t.RTL&&(e|=64),r.write_shift(2,e),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function wv(){}function yv(t,r,e){var a={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return a.name=Ws(t,0,e),a}function bv(t,r){var e=t.name||"Arial",a=r&&r.biff==5,i=a?15+e.length:16+2*e.length,n=Z(i);return n.write_shift(2,(t.sz||12)*20),n.write_shift(4,0),n.write_shift(2,400),n.write_shift(4,0),n.write_shift(2,0),n.write_shift(1,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le"),n}function Cv(t){var r=wa(t);return r.isst=t.read_shift(4),r}function kv(t,r,e,a){var i=Z(10);return Bi(t,r,a,i),i.write_shift(4,e),i}function Ev(t,r,e){e.biffguess&&e.biff==2&&(e.biff=5);var a=t.l+r,i=wa(t,6);e.biff==2&&t.l++;var n=Gs(t,a-t.l,e);return i.val=n,i}function Sv(t,r,e,a,i){var n=!i||i.biff==8,s=Z(8+ +n+(1+n)*e.length);return Bi(t,r,a,s),s.write_shift(2,e.length),n&&s.write_shift(1,1),s.write_shift((1+n)*e.length,e,n?"utf16le":"sbcs"),s}function Dv(t,r,e){var a=t.read_shift(2),i=Yi(t,0,e);return[a,i]}function Tv(t,r,e,a){var i=e&&e.biff==5;a||(a=Z(i?3+r.length:5+2*r.length)),a.write_shift(2,t),a.write_shift(i?1:2,r.length),i||a.write_shift(1,1),a.write_shift((i?1:2)*r.length,r,i?"sbcs":"utf16le");var n=a.length>a.l?a.slice(0,a.l):a;return n.l==null&&(n.l=n.length),n}var Av=Yi;function nh(t,r,e){var a=t.l+r,i=e.biff==8||!e.biff?4:2,n=t.read_shift(i),s=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=a,{s:{r:n,c:o},e:{r:s,c:l}}}function Fv(t,r){var e=r.biff==8||!r.biff?4:2,a=Z(2*e+6);return a.write_shift(e,t.s.r),a.write_shift(e,t.e.r+1),a.write_shift(2,t.s.c),a.write_shift(2,t.e.c+1),a.write_shift(2,0),a}function Ov(t){var r=t.read_shift(2),e=t.read_shift(2),a=Om(t);return{r,c:e,ixfe:a[0],rknum:a[1]}}function Mv(t,r){for(var e=t.l+r-2,a=t.read_shift(2),i=t.read_shift(2),n=[];t.l<e;)n.push(Om(t));if(t.l!==e)throw new Error("MulRK read error");var s=t.read_shift(2);if(n.length!=s-i+1)throw new Error("MulRK length mismatch");return{r:a,c:i,C:s,rkrec:n}}function Iv(t,r){for(var e=t.l+r-2,a=t.read_shift(2),i=t.read_shift(2),n=[];t.l<e;)n.push(t.read_shift(2));if(t.l!==e)throw new Error("MulBlank read error");var s=t.read_shift(2);if(n.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r:a,c:i,C:s,ixfe:n}}function Pv(t,r,e,a){var i={},n=t.read_shift(4),s=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=mx[o>>26],a.cellStyles&&(i.alc=n&7,i.fWrap=n>>3&1,i.alcV=n>>4&7,i.fJustLast=n>>7&1,i.trot=n>>8&255,i.cIndent=n>>16&15,i.fShrinkToFit=n>>20&1,i.iReadOrder=n>>22&2,i.fAtrNum=n>>26&1,i.fAtrFnt=n>>27&1,i.fAtrAlc=n>>28&1,i.fAtrBdr=n>>29&1,i.fAtrPat=n>>30&1,i.fAtrProt=n>>31&1,i.dgLeft=s&15,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function Rv(t,r,e){var a={};return a.ifnt=t.read_shift(2),a.numFmtId=t.read_shift(2),a.flags=t.read_shift(2),a.fStyle=a.flags>>2&1,r-=6,a.data=Pv(t,r,a.fStyle,e),a}function sh(t,r,e,a){var i=e&&e.biff==5;a||(a=Z(i?16:20)),a.write_shift(2,0),t.style?(a.write_shift(2,t.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,t.numFmtId||0),a.write_shift(2,r<<4));var n=0;return t.numFmtId>0&&i&&(n|=1024),a.write_shift(4,n),a.write_shift(4,0),i||a.write_shift(4,0),a.write_shift(2,0),a}function Nv(t){t.l+=4;var r=[t.read_shift(2),t.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function Lv(t){var r=Z(8);return r.write_shift(4,0),r.write_shift(2,t[0]?t[0]+1:0),r.write_shift(2,t[1]?t[1]+1:0),r}function oh(t,r,e){var a=wa(t,6);(e.biff==2||r==9)&&++t.l;var i=Ux(t,2);return a.val=i,a.t=i===!0||i===!1?"b":"e",a}function Bv(t,r,e,a,i,n){var s=Z(8);return Bi(t,r,a,s),Dm(e,n,s),s}function Vv(t,r,e){e.biffguess&&e.biff==2&&(e.biff=5);var a=wa(t,6),i=sr(t,8);return a.val=i,a}function Uv(t,r,e,a){var i=Z(14);return Bi(t,r,a,i),Ni(e,i),i}var lh=qx;function Hv(t,r,e){var a=t.l+r,i=t.read_shift(2),n=t.read_shift(2);if(e.sbcch=n,n==1025||n==14849)return[n,i];if(n<1||n>255)throw new Error("Unexpected SupBook type: "+n);for(var s=Li(t,n),o=[];a>t.l;)o.push(Gs(t));return[n,i,s,o]}function ch(t,r,e){var a=t.read_shift(2),i,n={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return e.sbcch===14849&&(i=Qx(t,r-2,e)),n.body=i||t.read_shift(r-2),typeof i=="string"&&(n.Name=i),n}var Wv=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function dh(t,r,e){var a=t.l+r,i=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1),o=t.read_shift(e&&e.biff==2?1:2),l=0;(!e||e.biff>=5)&&(e.biff!=5&&(t.l+=2),l=t.read_shift(2),e.biff==5&&(t.l+=2),t.l+=4);var c=Li(t,s,e);i&32&&(c=Wv[c.charCodeAt(0)]);var d=a-t.l;e&&e.biff==2&&--d;var f=a==t.l||o===0||!(d>0)?[]:aC(t,d,e,o);return{chKey:n,Name:c,itab:l,rgce:f}}function Rm(t,r,e){if(e.biff<8)return Gv(t,r,e);for(var a=[],i=t.l+r,n=t.read_shift(e.biff>8?4:2);n--!==0;)a.push(Zx(t,e.biff>8?12:6,e));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return a}function Gv(t,r,e){t[t.l+1]==3&&t[t.l]++;var a=Ws(t,r,e);return a.charCodeAt(0)==3?a.slice(1):a}function zv(t,r,e){if(e.biff<8){t.l+=r;return}var a=t.read_shift(2),i=t.read_shift(2),n=Li(t,a,e),s=Li(t,i,e);return[n,s]}function Yv(t,r,e){var a=Im(t,6);t.l++;var i=t.read_shift(1);return r-=8,[iC(t,r,e),i,a]}function fh(t,r,e){var a=Jx(t,6);switch(e.biff){case 2:t.l++,r-=7;break;case 3:case 4:t.l+=2,r-=8;break;default:t.l+=6,r-=12}return[a,tC(t,r,e,a)]}function $v(t){var r=t.read_shift(4)!==0,e=t.read_shift(4)!==0,a=t.read_shift(4);return[r,e,a]}function Xv(t,r,e){if(!(e.biff<8)){var a=t.read_shift(2),i=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),o=Yi(t,0,e);return e.biff<8&&t.read_shift(1),[{r:a,c:i},o,s,n]}}function jv(t,r,e){return Xv(t,r,e)}function Kv(t,r){for(var e=[],a=t.read_shift(2);a--;)e.push(Il(t,r));return e}function qv(t){var r=Z(2+t.length*8);r.write_shift(2,t.length);for(var e=0;e<t.length;++e)Mm(t[e],r);return r}function Zv(t,r,e){if(e&&e.biff<8)return Jv(t,r,e);var a=Pm(t,22),i=av(t,r-22,a[1]);return{cmo:a,ft:i}}var Qv={8:function(t,r){var e=t.l+r;t.l+=10;var a=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=e,{fmt:a}}};function Jv(t,r,e){t.l+=4;var a=t.read_shift(2),i=t.read_shift(2),n=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,r-=36;var s=[];return s.push((Qv[a]||cr)(t,r,e)),{cmo:[i,a,n],ft:s}}function e2(t,r,e){var a=t.l,i="";try{t.l+=4;var n=(e.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(n)==-1?t.l+=6:s=Gx(t,6,e);var o=t.read_shift(2);t.read_shift(2),Ot(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-a!=t.lens[c])throw new Error("TxO: bad continue record");var d=t[t.l],f=Li(t,t.lens[c+1]-t.lens[c]-1);if(i+=f,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=a+r,{t:i}}catch{return t.l=a+r,{t:i}}}function t2(t,r){var e=Il(t,8);t.l+=16;var a=Xx(t,r-24);return[e,a]}function r2(t){var r=Z(24),e=ct(t[0]);r.write_shift(2,e.r),r.write_shift(2,e.r),r.write_shift(2,e.c),r.write_shift(2,e.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)r.write_shift(1,parseInt(a[i],16));return Wt([r,jx(t[1])])}function a2(t,r){t.read_shift(2);var e=Il(t,8),a=t.read_shift((r-10)/2,"dbcs-cont");return a=a.replace(or,""),[e,a]}function i2(t){var r=t[1].Tooltip,e=Z(10+2*(r.length+1));e.write_shift(2,2048);var a=ct(t[0]);e.write_shift(2,a.r),e.write_shift(2,a.r),e.write_shift(2,a.c),e.write_shift(2,a.c);for(var i=0;i<r.length;++i)e.write_shift(2,r.charCodeAt(i));return e.write_shift(2,0),e}function n2(t){var r=[0,0],e;return e=t.read_shift(2),r[0]=Ku[e]||e,e=t.read_shift(2),r[1]=Ku[e]||e,r}function s2(t){return t||(t=Z(4)),t.write_shift(2,1),t.write_shift(2,1),t}function o2(t){for(var r=t.read_shift(2),e=[];r-- >0;)e.push(Fm(t,8));return e}function l2(t){for(var r=t.read_shift(2),e=[];r-- >0;)e.push(Fm(t,8));return e}function c2(t){t.l+=2;var r={cxfs:0,crc:0};return r.cxfs=t.read_shift(2),r.crc=t.read_shift(4),r}function Nm(t,r,e){if(!e.cellStyles)return cr(t,r);var a=e&&e.biff>=12?4:2,i=t.read_shift(a),n=t.read_shift(a),s=t.read_shift(a),o=t.read_shift(a),l=t.read_shift(2);a==2&&(t.l+=2);var c={s:i,e:n,w:s,ixfe:o,flags:l};return(e.biff>=5||!e.biff)&&(c.level=l>>8&7),c}function d2(t,r){var e=Z(12);e.write_shift(2,r),e.write_shift(2,r),e.write_shift(2,t.width*256),e.write_shift(2,0);var a=0;return t.hidden&&(a|=1),e.write_shift(1,a),a=t.level||0,e.write_shift(1,a),e.write_shift(2,0),e}function f2(t,r){var e={};return r<32||(t.l+=16,e.header=sr(t,8),e.footer=sr(t,8),t.l+=2),e}function u2(t,r,e){var a={area:!1};if(e.biff!=5)return t.l+=r,a;var i=t.read_shift(1);return t.l+=3,i&16&&(a.area=!0),a}function h2(t){for(var r=Z(2*t),e=0;e<t;++e)r.write_shift(2,e+1);return r}var m2=wa,p2=Sm,_2=Gs;function g2(t){var r=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(4),i={fmt:r,env:e,len:a,data:t.slice(t.l,t.l+a)};return t.l+=a,i}function x2(t,r,e){e.biffguess&&e.biff==5&&(e.biff=2);var a=wa(t,6);++t.l;var i=Yi(t,r-7,e);return a.t="str",a.val=i,a}function v2(t){var r=wa(t,6);++t.l;var e=sr(t,8);return r.t="n",r.val=e,r}function w2(t,r,e){var a=Z(15);return Xs(a,t,r),a.write_shift(8,e,"f"),a}function y2(t){var r=wa(t,6);++t.l;var e=t.read_shift(2);return r.t="n",r.val=e,r}function b2(t,r,e){var a=Z(9);return Xs(a,t,r),a.write_shift(2,e),a}function C2(t){var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,"sbcs-cont")}function k2(t,r){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=r-13}function E2(t,r,e){var a=t.l+r,i=wa(t,6),n=t.read_shift(2),s=Li(t,n,e);return t.l=a,i.t="str",i.val=s,i}var S2=[2,3,48,49,131,139,140,245],s0=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Al({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(o,l){var c=[],d=di(1);switch(l.type){case"base64":d=Or(Ir(o));break;case"binary":d=Or(o);break;case"buffer":case"array":d=o;break}$t(d,0);var f=d.read_shift(1),h=!!(f&136),m=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var u=0,_=521;f==2&&(u=d.read_shift(2)),d.l+=3,f!=2&&(u=d.read_shift(4)),u>1048576&&(u=1e6),f!=2&&(_=d.read_shift(2));var E=d.read_shift(2),k=l.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(k=t[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var w=[],L={},U=Math.min(d.length,f==2?521:_-10-(m?264:0)),R=p?32:11;d.l<U&&d[d.l]!=13;)switch(L={},L.name=Ke.utils.decode(k,d.slice(d.l,d.l+R)).replace(/[\u0000\r\n].*$/g,""),d.l+=R,L.type=String.fromCharCode(d.read_shift(1)),f!=2&&!p&&(L.offset=d.read_shift(4)),L.len=d.read_shift(1),f==2&&(L.offset=d.read_shift(2)),L.dec=d.read_shift(1),L.name.length&&w.push(L),f!=2&&(d.l+=p?13:14),L.type){case"B":(!m||L.len!=8)&&l.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+L.type)}if(d[d.l]!==13&&(d.l=_-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=_;var T=0,B=0;for(c[0]=[],B=0;B!=w.length;++B)c[0][B]=w[B].name;for(;u-- >0;){if(d[d.l]===42){d.l+=E;continue}for(++d.l,c[++T]=[],B=0,B=0;B!=w.length;++B){var N=d.slice(d.l,d.l+w[B].len);d.l+=w[B].len,$t(N,0);var K=Ke.utils.decode(k,N);switch(w[B].type){case"C":K.trim().length&&(c[T][B]=K.replace(/\s+$/,""));break;case"D":K.length===8?c[T][B]=new Date(+K.slice(0,4),+K.slice(4,6)-1,+K.slice(6,8)):c[T][B]=K;break;case"F":c[T][B]=parseFloat(K.trim());break;case"+":case"I":c[T][B]=p?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(K.trim().toUpperCase()){case"Y":case"T":c[T][B]=!0;break;case"N":case"F":c[T][B]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+K+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[T][B]="##MEMO##"+(p?parseInt(K.trim(),10):N.read_shift(4));break;case"N":K=K.replace(/\u0000/g,"").trim(),K&&K!="."&&(c[T][B]=+K||0);break;case"@":c[T][B]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":c[T][B]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":c[T][B]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[T][B]=-N.read_shift(-8,"f");break;case"B":if(m&&w[B].len==8){c[T][B]=N.read_shift(8,"f");break}case"G":case"P":N.l+=w[B].len;break;case"0":if(w[B].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[B].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=w,c}function a(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var d=Hn(e(o,c),c);return d["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,d}function i(o,l){try{return pi(a(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var n={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var c=l||{};if(+c.codepage>=0&&Jr(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var d=yr(),f=Sl(o,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),p=o["!cols"]||[],u=0,_=0,E=0,k=1;for(u=0;u<h.length;++u){if(((p[u]||{}).DBF||{}).name){h[u]=p[u].DBF.name,++E;continue}if(h[u]!=null){if(++E,typeof h[u]=="number"&&(h[u]=h[u].toString(10)),typeof h[u]!="string")throw new Error("DBF Invalid column name "+h[u]+" |"+typeof h[u]+"|");if(h.indexOf(h[u])!==u){for(_=0;_<1024;++_)if(h.indexOf(h[u]+"_"+_)==-1){h[u]+="_"+_;break}}}}var w=Xe(o["!ref"]),L=[],U=[],R=[];for(u=0;u<=w.e.c-w.s.c;++u){var T="",B="",N=0,K=[];for(_=0;_<m.length;++_)m[_][u]!=null&&K.push(m[_][u]);if(K.length==0||h[u]==null){L[u]="?";continue}for(_=0;_<K.length;++_){switch(typeof K[_]){case"number":B="B";break;case"string":B="C";break;case"boolean":B="L";break;case"object":B=K[_]instanceof Date?"D":"C";break;default:B="C"}N=Math.max(N,String(K[_]).length),T=T&&T!=B?"C":B}N>250&&(N=250),B=((p[u]||{}).DBF||{}).type,B=="C"&&p[u].DBF.len>N&&(N=p[u].DBF.len),T=="B"&&B=="N"&&(T="N",R[u]=p[u].DBF.dec,N=p[u].DBF.len),U[u]=T=="C"||B=="N"?N:n[T]||0,k+=U[u],L[u]=T}var q=d.next(32);for(q.write_shift(4,318902576),q.write_shift(4,m.length),q.write_shift(2,296+32*E),q.write_shift(2,k),u=0;u<4;++u)q.write_shift(4,0);for(q.write_shift(4,0|(+r[Pn]||3)<<8),u=0,_=0;u<h.length;++u)if(h[u]!=null){var V=d.next(32),se=(h[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);V.write_shift(1,se,"sbcs"),V.write_shift(1,L[u]=="?"?"C":L[u],"sbcs"),V.write_shift(4,_),V.write_shift(1,U[u]||n[L[u]]||0),V.write_shift(1,R[u]||0),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(1,0),V.write_shift(4,0),V.write_shift(4,0),_+=U[u]||n[L[u]]||0}var ge=d.next(264);for(ge.write_shift(4,13),u=0;u<65;++u)ge.write_shift(4,0);for(u=0;u<m.length;++u){var oe=d.next(k);for(oe.write_shift(1,0),_=0;_<h.length;++_)if(h[_]!=null)switch(L[_]){case"L":oe.write_shift(1,m[u][_]==null?63:m[u][_]?84:70);break;case"B":oe.write_shift(8,m[u][_]||0,"f");break;case"N":var Ee="0";for(typeof m[u][_]=="number"&&(Ee=m[u][_].toFixed(R[_]||0)),E=0;E<U[_]-Ee.length;++E)oe.write_shift(1,32);oe.write_shift(1,Ee,"sbcs");break;case"D":m[u][_]?(oe.write_shift(4,("0000"+m[u][_].getFullYear()).slice(-4),"sbcs"),oe.write_shift(2,("00"+(m[u][_].getMonth()+1)).slice(-2),"sbcs"),oe.write_shift(2,("00"+m[u][_].getDate()).slice(-2),"sbcs")):oe.write_shift(8,"00000000","sbcs");break;case"C":var xe=String(m[u][_]!=null?m[u][_]:"").slice(0,U[_]);for(oe.write_shift(1,xe,"sbcs"),E=0;E<U[_]-xe.length;++E)oe.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:a,from_sheet:s}}(),Lm=function(){var t={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+mt(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(h,m){var p=t[m];return typeof p=="number"?bu(p):p},a=function(h,m,p){var u=m.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return u==59?h:bu(u)};t["|"]=254;function i(h,m){switch(m.type){case"base64":return n(Ir(h),m);case"binary":return n(h,m);case"buffer":return n(Ue&&Buffer.isBuffer(h)?h.toString("binary"):mi(h),m);case"array":return n(Ri(h),m)}throw new Error("Unrecognized type "+m.type)}function n(h,m){var p=h.split(/[\n\r]+/),u=-1,_=-1,E=0,k=0,w=[],L=[],U=null,R={},T=[],B=[],N=[],K=0,q;for(+m.codepage>=0&&Jr(+m.codepage);E!==p.length;++E){K=0;var V=p[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(r,e),se=V.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),ge=se[0],oe;if(V.length>0)switch(ge){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":se[1].charAt(0)=="P"&&L.push(V.slice(3).replace(/;;/g,";"));break;case"C":var Ee=!1,xe=!1,He=!1,pe=!1,we=-1,ee=-1;for(k=1;k<se.length;++k)switch(se[k].charAt(0)){case"A":break;case"X":_=parseInt(se[k].slice(1))-1,xe=!0;break;case"Y":for(u=parseInt(se[k].slice(1))-1,xe||(_=0),q=w.length;q<=u;++q)w[q]=[];break;case"K":oe=se[k].slice(1),oe.charAt(0)==='"'?oe=oe.slice(1,oe.length-1):oe==="TRUE"?oe=!0:oe==="FALSE"?oe=!1:isNaN(ta(oe))?isNaN(Rn(oe).getDate())||(oe=nt(oe)):(oe=ta(oe),U!==null&&Bn(U)&&(oe=Ol(oe))),typeof Ke<"u"&&typeof oe=="string"&&(m||{}).type!="string"&&(m||{}).codepage&&(oe=Ke.utils.decode(m.codepage,oe)),Ee=!0;break;case"E":pe=!0;var O=Mn(se[k].slice(1),{r:u,c:_});w[u][_]=[w[u][_],O];break;case"S":He=!0,w[u][_]=[w[u][_],"S5S"];break;case"G":break;case"R":we=parseInt(se[k].slice(1))-1;break;case"C":ee=parseInt(se[k].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+V)}if(Ee&&(w[u][_]&&w[u][_].length==2?w[u][_][0]=oe:w[u][_]=oe,U=null),He){if(pe)throw new Error("SYLK shared formula cannot have own formula");var G=we>-1&&w[we][ee];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");w[u][_][1]=tp(G[1],{r:u-we,c:_-ee})}break;case"F":var I=0;for(k=1;k<se.length;++k)switch(se[k].charAt(0)){case"X":_=parseInt(se[k].slice(1))-1,++I;break;case"Y":for(u=parseInt(se[k].slice(1))-1,q=w.length;q<=u;++q)w[q]=[];break;case"M":K=parseInt(se[k].slice(1))/20;break;case"F":break;case"G":break;case"P":U=L[parseInt(se[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=se[k].slice(1).split(" "),q=parseInt(N[0],10);q<=parseInt(N[1],10);++q)K=parseInt(N[2],10),B[q-1]=K===0?{hidden:!0}:{wch:K},fi(B[q-1]);break;case"C":_=parseInt(se[k].slice(1))-1,B[_]||(B[_]={});break;case"R":u=parseInt(se[k].slice(1))-1,T[u]||(T[u]={}),K>0?(T[u].hpt=K,T[u].hpx=Ln(K)):K===0&&(T[u].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+V)}I<1&&(U=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+V)}}return T.length>0&&(R["!rows"]=T),B.length>0&&(R["!cols"]=B),m&&m.sheetRows&&(w=w.slice(0,m.sheetRows)),[w,R]}function s(h,m){var p=i(h,m),u=p[0],_=p[1],E=Hn(u,m);return mt(_).forEach(function(k){E[k]=_[k]}),E}function o(h,m){return pi(s(h,m),m)}function l(h,m,p,u){var _="C;Y"+(p+1)+";X"+(u+1)+";K";switch(h.t){case"n":_+=h.v||0,h.f&&!h.F&&(_+=";E"+G0(h.f,{r:p,c:u}));break;case"b":_+=h.v?"TRUE":"FALSE";break;case"e":_+=h.w||h.v;break;case"d":_+='"'+(h.w||h.v)+'"';break;case"s":_+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(h,m){m.forEach(function(p,u){var _="F;W"+(u+1)+" "+(u+1)+" ";p.hidden?_+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Rs(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Ns(p.wpx)),typeof p.wch=="number"&&(_+=Math.round(p.wch))),_.charAt(_.length-1)!=" "&&h.push(_)})}function d(h,m){m.forEach(function(p,u){var _="F;";p.hidden?_+="M0;":p.hpt?_+="M"+20*p.hpt+";":p.hpx&&(_+="M"+20*Ls(p.hpx)+";"),_.length>2&&h.push(_+"R"+(u+1))})}function f(h,m){var p=["ID;PWXL;N;E"],u=[],_=Xe(h["!ref"]),E,k=Array.isArray(h),w=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&c(p,h["!cols"]),h["!rows"]&&d(p,h["!rows"]),p.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var L=_.s.r;L<=_.e.r;++L)for(var U=_.s.c;U<=_.e.c;++U){var R=Oe({r:L,c:U});E=k?(h[L]||[])[U]:h[R],!(!E||E.v==null&&(!E.f||E.F))&&u.push(l(E,h,L,U,m))}return p.join(w)+w+u.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:s,from_sheet:f}}(),Bm=function(){function t(n,s){switch(s.type){case"base64":return r(Ir(n),s);case"binary":return r(n,s);case"buffer":return r(Ue&&Buffer.isBuffer(n)?n.toString("binary"):mi(n),s);case"array":return r(Ri(n),s)}throw new Error("Unrecognized type "+s.type)}function r(n,s){for(var o=n.split(`
`),l=-1,c=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var h=o[d].trim().split(","),m=h[0],p=h[1];++d;for(var u=o[d]||"";(u.match(/["]/g)||[]).length&1&&d<o.length-1;)u+=`
`+o[++d];switch(u=u.trim(),+m){case-1:if(u==="BOT"){f[++l]=[],c=0;continue}else if(u!=="EOD")throw new Error("Unrecognized DIF special command "+u);break;case 0:u==="TRUE"?f[l][c]=!0:u==="FALSE"?f[l][c]=!1:isNaN(ta(p))?isNaN(Rn(p).getDate())?f[l][c]=p:f[l][c]=nt(p):f[l][c]=ta(p),++c;break;case 1:u=u.slice(1,u.length-1),u=u.replace(/""/g,'"'),ms&&u&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),f[l][c++]=u!==""?u:null;break}if(u==="EOD")break}}return s&&s.sheetRows&&(f=f.slice(0,s.sheetRows)),f}function e(n,s){return Hn(t(n,s),s)}function a(n,s){return pi(e(n,s),s)}var i=function(){var n=function(l,c,d,f,h){l.push(c),l.push(d+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},s=function(l,c,d,f){l.push(c+","+d),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],d=Xe(l["!ref"]),f,h=Array.isArray(l);n(c,"TABLE",0,1,"sheetjs"),n(c,"VECTORS",0,d.e.r-d.s.r+1,""),n(c,"TUPLES",0,d.e.c-d.s.c+1,""),n(c,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){s(c,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var u=Oe({r:m,c:p});if(f=h?(l[m]||[])[p]:l[u],!f){s(c,1,0,"");continue}switch(f.t){case"n":var _=ms?f.w:f.v;!_&&f.v!=null&&(_=f.v),_==null?ms&&f.f&&!f.F?s(c,1,0,"="+f.f):s(c,1,0,""):s(c,0,_,"V");break;case"b":s(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":s(c,1,0,!ms||isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=jr(f.z||Fe[14],Lt(nt(f.v)))),ms?s(c,0,f.w,"V"):s(c,1,0,f.w);break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var E=`\r
`,k=c.join(E);return k}}();return{to_workbook:a,to_sheet:e,from_sheet:i}}(),Vm=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(f,h){for(var m=f.split(`
`),p=-1,u=-1,_=0,E=[];_!==m.length;++_){var k=m[_].trim().split(":");if(k[0]==="cell"){var w=ct(k[1]);if(E.length<=w.r)for(p=E.length;p<=w.r;++p)E[p]||(E[p]=[]);switch(p=w.r,u=w.c,k[2]){case"t":E[p][u]=t(k[3]);break;case"v":E[p][u]=+k[3];break;case"vtf":var L=k[k.length-1];case"vtc":switch(k[3]){case"nl":E[p][u]=!!+k[4];break;default:E[p][u]=+k[4];break}k[2]=="vtf"&&(E[p][u]=[E[p][u],L])}}}return h&&h.sheetRows&&(E=E.slice(0,h.sheetRows)),E}function a(f,h){return Hn(e(f,h),h)}function i(f,h){return pi(a(f,h),h)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],p,u="",_=br(f["!ref"]),E=Array.isArray(f),k=_.s.r;k<=_.e.r;++k)for(var w=_.s.c;w<=_.e.c;++w)if(u=Oe({r:k,c:w}),p=E?(f[k]||[])[w]:f[u],!(!p||p.v==null||p.t==="z")){switch(m=["cell",u,"t"],p.t){case"s":case"str":m.push(r(p.v));break;case"n":p.f?(m[2]="vtf",m[3]="n",m[4]=p.v,m[5]=r(p.f)):(m[2]="v",m[3]=p.v);break;case"b":m[2]="vt"+(p.f?"f":"c"),m[3]="nl",m[4]=p.v?"1":"0",m[5]=r(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var L=Lt(nt(p.v));m[2]="vtc",m[3]="nd",m[4]=""+L,m[5]=p.w||jr(p.z||Fe[14],L);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[n,s,o,s,c(f),l].join(`
`)}return{to_workbook:i,to_sheet:a,from_sheet:d}}(),Nn=function(){function t(d,f,h,m,p){p.raw?f[h][m]=d:d===""||(d==="TRUE"?f[h][m]=!0:d==="FALSE"?f[h][m]=!1:isNaN(ta(d))?isNaN(Rn(d).getDate())?f[h][m]=d:f[h][m]=nt(d):f[h][m]=ta(d))}function r(d,f){var h=f||{},m=[];if(!d||d.length===0)return m;for(var p=d.split(/[\r\n]/),u=p.length-1;u>=0&&p[u].length===0;)--u;for(var _=10,E=0,k=0;k<=u;++k)E=p[k].indexOf(" "),E==-1?E=p[k].length:E++,_=Math.max(_,E);for(k=0;k<=u;++k){m[k]=[];var w=0;for(t(p[k].slice(0,_).trim(),m,k,w,h),w=1;w<=(p[k].length-_)/10+1;++w)t(p[k].slice(_+(w-1)*10,_+w*10).trim(),m,k,w,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var e={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function i(d){for(var f={},h=!1,m=0,p=0;m<d.length;++m)(p=d.charCodeAt(m))==34?h=!h:!h&&p in e&&(f[p]=(f[p]||0)+1);p=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&p.push([f[m],m]);if(!p.length){f=a;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&p.push([f[m],m])}return p.sort(function(u,_){return u[0]-_[0]||a[u[1]]-a[_[1]]}),e[p.pop()[1]]||44}function n(d,f){var h=f||{},m="";ht!=null&&h.dense==null&&(h.dense=ht);var p=h.dense?[]:{},u={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=i(d.slice(0,1024)):h&&h.FS?m=h.FS:m=i(d.slice(0,1024));var _=0,E=0,k=0,w=0,L=0,U=m.charCodeAt(0),R=!1,T=0,B=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var N=h.dateNF!=null?u1(h.dateNF):null;function K(){var q=d.slice(w,L),V={};if(q.charAt(0)=='"'&&q.charAt(q.length-1)=='"'&&(q=q.slice(1,-1).replace(/""/g,'"')),q.length===0)V.t="z";else if(h.raw)V.t="s",V.v=q;else if(q.trim().length===0)V.t="s",V.v=q;else if(q.charCodeAt(0)==61)q.charCodeAt(1)==34&&q.charCodeAt(q.length-1)==34?(V.t="s",V.v=q.slice(2,-1).replace(/""/g,'"')):Hy(q)?(V.t="n",V.f=q.slice(1)):(V.t="s",V.v=q);else if(q=="TRUE")V.t="b",V.v=!0;else if(q=="FALSE")V.t="b",V.v=!1;else if(!isNaN(k=ta(q)))V.t="n",h.cellText!==!1&&(V.w=q),V.v=k;else if(!isNaN(Rn(q).getDate())||N&&q.match(N)){V.z=h.dateNF||Fe[14];var se=0;N&&q.match(N)&&(q=h1(q,h.dateNF,q.match(N)||[]),se=1),h.cellDates?(V.t="d",V.v=nt(q,se)):(V.t="n",V.v=Lt(nt(q,se))),h.cellText!==!1&&(V.w=jr(V.z,V.v instanceof Date?Lt(V.v):V.v)),h.cellNF||delete V.z}else V.t="s",V.v=q;if(V.t=="z"||(h.dense?(p[_]||(p[_]=[]),p[_][E]=V):p[Oe({c:E,r:_})]=V),w=L+1,B=d.charCodeAt(w),u.e.c<E&&(u.e.c=E),u.e.r<_&&(u.e.r=_),T==U)++E;else if(E=0,++_,h.sheetRows&&h.sheetRows<=_)return!0}e:for(;L<d.length;++L)switch(T=d.charCodeAt(L)){case 34:B===34&&(R=!R);break;case U:case 10:case 13:if(!R&&K())break e;break;default:break}return L-w>0&&K(),p["!ref"]=Ne(u),p}function s(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?n(d,f):Hn(r(d,f),f)}function o(d,f){var h="",m=f.type=="string"?[0,0,0,0]:Z0(d,f);switch(f.type){case"base64":h=Ir(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof Ke<"u"?h=Ke.utils.decode(f.codepage,d):h=Ue&&Buffer.isBuffer(d)?d.toString("binary"):mi(d);break;case"array":h=Ri(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=rt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=rt(h):f.type=="binary"&&typeof Ke<"u"&&f.codepage&&(h=Ke.utils.decode(f.codepage,Ke.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?Vm.to_sheet(f.type=="string"?h:rt(h),f):s(h,f)}function l(d,f){return pi(o(d,f),f)}function c(d){for(var f=[],h=Xe(d["!ref"]),m,p=Array.isArray(d),u=h.s.r;u<=h.e.r;++u){for(var _=[],E=h.s.c;E<=h.e.c;++E){var k=Oe({r:u,c:E});if(m=p?(d[u]||[])[E]:d[k],!m||m.v==null){_.push("          ");continue}for(var w=(m.w||(Pa(m),m.w)||"").slice(0,10);w.length<10;)w+=" ";_.push(w+(E===0?" ":""))}f.push(_.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function D2(t,r){var e=r||{},a=!!e.WTF;e.WTF=!0;try{var i=Lm.to_workbook(t,e);return e.WTF=a,i}catch(n){if(e.WTF=a,!n.message.match(/SYLK bad record ID/)&&a)throw n;return Nn.to_workbook(t,r)}}var Mi=function(){function t(O,G,I){if(O){$t(O,O.l||0);for(var M=I.Enum||we;O.l<O.length;){var J=O.read_shift(2),ue=M[J]||M[65535],ie=O.read_shift(2),ne=O.l+ie,te=ue.f&&ue.f(O,ie,I);if(O.l=ne,G(te,ue,J))return}}}function r(O,G){switch(G.type){case"base64":return e(Or(Ir(O)),G);case"binary":return e(Or(O),G);case"buffer":case"array":return e(O,G)}throw"Unsupported type "+G.type}function e(O,G){if(!O)return O;var I=G||{};ht!=null&&I.dense==null&&(I.dense=ht);var M=I.dense?[]:{},J="Sheet1",ue="",ie=0,ne={},te=[],Re=[],F={s:{r:0,c:0},e:{r:0,c:0}},qe=I.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)I.Enum=we,t(O,function(_e,pt,Pr){switch(Pr){case 0:I.vers=_e,_e>=4096&&(I.qpro=!0);break;case 6:F=_e;break;case 204:_e&&(ue=_e);break;case 222:ue=_e;break;case 15:case 51:I.qpro||(_e[1].v=_e[1].v.slice(1));case 13:case 14:case 16:Pr==14&&(_e[2]&112)==112&&(_e[2]&15)>1&&(_e[2]&15)<15&&(_e[1].z=I.dateNF||Fe[14],I.cellDates&&(_e[1].t="d",_e[1].v=Ol(_e[1].v))),I.qpro&&_e[3]>ie&&(M["!ref"]=Ne(F),ne[J]=M,te.push(J),M=I.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},ie=_e[3],J=ue||"Sheet"+(ie+1),ue="");var aa=I.dense?(M[_e[0].r]||[])[_e[0].c]:M[Oe(_e[0])];if(aa){aa.t=_e[1].t,aa.v=_e[1].v,_e[1].z!=null&&(aa.z=_e[1].z),_e[1].f!=null&&(aa.f=_e[1].f);break}I.dense?(M[_e[0].r]||(M[_e[0].r]=[]),M[_e[0].r][_e[0].c]=_e[1]):M[Oe(_e[0])]=_e[1];break;default:}},I);else if(O[2]==26||O[2]==14)I.Enum=ee,O[2]==14&&(I.qpro=!0,O.l=0),t(O,function(_e,pt,Pr){switch(Pr){case 204:J=_e;break;case 22:_e[1].v=_e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(_e[3]>ie&&(M["!ref"]=Ne(F),ne[J]=M,te.push(J),M=I.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},ie=_e[3],J="Sheet"+(ie+1)),qe>0&&_e[0].r>=qe)break;I.dense?(M[_e[0].r]||(M[_e[0].r]=[]),M[_e[0].r][_e[0].c]=_e[1]):M[Oe(_e[0])]=_e[1],F.e.c<_e[0].c&&(F.e.c=_e[0].c),F.e.r<_e[0].r&&(F.e.r=_e[0].r);break;case 27:_e[14e3]&&(Re[_e[14e3][0]]=_e[14e3][1]);break;case 1537:Re[_e[0]]=_e[1],_e[0]==ie&&(J=_e[1]);break;default:break}},I);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(M["!ref"]=Ne(F),ne[ue||J]=M,te.push(ue||J),!Re.length)return{SheetNames:te,Sheets:ne};for(var Ge={},Ze=[],ze=0;ze<Re.length;++ze)ne[te[ze]]?(Ze.push(Re[ze]||te[ze]),Ge[Re[ze]]=ne[Re[ze]]||ne[te[ze]]):(Ze.push(Re[ze]),Ge[Re[ze]]={"!ref":"A1"});return{SheetNames:Ze,Sheets:Ge}}function a(O,G){var I=G||{};if(+I.codepage>=0&&Jr(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var M=yr(),J=Xe(O["!ref"]),ue=Array.isArray(O),ie=[];ce(M,0,n(1030)),ce(M,6,l(J));for(var ne=Math.min(J.e.r,8191),te=J.s.r;te<=ne;++te)for(var Re=kt(te),F=J.s.c;F<=J.e.c;++F){te===J.s.r&&(ie[F]=lt(F));var qe=ie[F]+Re,Ge=ue?(O[te]||[])[F]:O[qe];if(!(!Ge||Ge.t=="z"))if(Ge.t=="n")(Ge.v|0)==Ge.v&&Ge.v>=-32768&&Ge.v<=32767?ce(M,13,m(te,F,Ge.v)):ce(M,14,u(te,F,Ge.v));else{var Ze=Pa(Ge);ce(M,15,f(te,F,Ze.slice(0,239)))}}return ce(M,1),M.end()}function i(O,G){var I=G||{};if(+I.codepage>=0&&Jr(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var M=yr();ce(M,0,s(O));for(var J=0,ue=0;J<O.SheetNames.length;++J)(O.Sheets[O.SheetNames[J]]||{})["!ref"]&&ce(M,27,pe(O.SheetNames[J],ue++));var ie=0;for(J=0;J<O.SheetNames.length;++J){var ne=O.Sheets[O.SheetNames[J]];if(!(!ne||!ne["!ref"])){for(var te=Xe(ne["!ref"]),Re=Array.isArray(ne),F=[],qe=Math.min(te.e.r,8191),Ge=te.s.r;Ge<=qe;++Ge)for(var Ze=kt(Ge),ze=te.s.c;ze<=te.e.c;++ze){Ge===te.s.r&&(F[ze]=lt(ze));var _e=F[ze]+Ze,pt=Re?(ne[Ge]||[])[ze]:ne[_e];if(!(!pt||pt.t=="z"))if(pt.t=="n")ce(M,23,K(Ge,ze,ie,pt.v));else{var Pr=Pa(pt);ce(M,22,T(Ge,ze,ie,Pr.slice(0,239)))}}++ie}}return ce(M,1),M.end()}function n(O){var G=Z(2);return G.write_shift(2,O),G}function s(O){var G=Z(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var I=0,M=0,J=0,ue=0;ue<O.SheetNames.length;++ue){var ie=O.SheetNames[ue],ne=O.Sheets[ie];if(!(!ne||!ne["!ref"])){++J;var te=br(ne["!ref"]);I<te.e.r&&(I=te.e.r),M<te.e.c&&(M=te.e.c)}}return I>8191&&(I=8191),G.write_shift(2,I),G.write_shift(1,J),G.write_shift(1,M),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function o(O,G,I){var M={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&I.qpro?(M.s.c=O.read_shift(1),O.l++,M.s.r=O.read_shift(2),M.e.c=O.read_shift(1),O.l++,M.e.r=O.read_shift(2),M):(M.s.c=O.read_shift(2),M.s.r=O.read_shift(2),G==12&&I.qpro&&(O.l+=2),M.e.c=O.read_shift(2),M.e.r=O.read_shift(2),G==12&&I.qpro&&(O.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function l(O){var G=Z(8);return G.write_shift(2,O.s.c),G.write_shift(2,O.s.r),G.write_shift(2,O.e.c),G.write_shift(2,O.e.r),G}function c(O,G,I){var M=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(M[0].c=O.read_shift(1),M[3]=O.read_shift(1),M[0].r=O.read_shift(2),O.l+=2):(M[2]=O.read_shift(1),M[0].c=O.read_shift(2),M[0].r=O.read_shift(2)),M}function d(O,G,I){var M=O.l+G,J=c(O,G,I);if(J[1].t="s",I.vers==20768){O.l++;var ue=O.read_shift(1);return J[1].v=O.read_shift(ue,"utf8"),J}return I.qpro&&O.l++,J[1].v=O.read_shift(M-O.l,"cstr"),J}function f(O,G,I){var M=Z(7+I.length);M.write_shift(1,255),M.write_shift(2,G),M.write_shift(2,O),M.write_shift(1,39);for(var J=0;J<M.length;++J){var ue=I.charCodeAt(J);M.write_shift(1,ue>=128?95:ue)}return M.write_shift(1,0),M}function h(O,G,I){var M=c(O,G,I);return M[1].v=O.read_shift(2,"i"),M}function m(O,G,I){var M=Z(7);return M.write_shift(1,255),M.write_shift(2,G),M.write_shift(2,O),M.write_shift(2,I,"i"),M}function p(O,G,I){var M=c(O,G,I);return M[1].v=O.read_shift(8,"f"),M}function u(O,G,I){var M=Z(13);return M.write_shift(1,255),M.write_shift(2,G),M.write_shift(2,O),M.write_shift(8,I,"f"),M}function _(O,G,I){var M=O.l+G,J=c(O,G,I);if(J[1].v=O.read_shift(8,"f"),I.qpro)O.l=M;else{var ue=O.read_shift(2);L(O.slice(O.l,O.l+ue),J),O.l+=ue}return J}function E(O,G,I){var M=G&32768;return G&=-32769,G=(M?O:0)+(G>=8192?G-16384:G),(M?"":"$")+(I?lt(G):kt(G))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function L(O,G){$t(O,0);for(var I=[],M=0,J="",ue="",ie="",ne="";O.l<O.length;){var te=O[O.l++];switch(te){case 0:I.push(O.read_shift(8,"f"));break;case 1:ue=E(G[0].c,O.read_shift(2),!0),J=E(G[0].r,O.read_shift(2),!1),I.push(ue+J);break;case 2:{var Re=E(G[0].c,O.read_shift(2),!0),F=E(G[0].r,O.read_shift(2),!1);ue=E(G[0].c,O.read_shift(2),!0),J=E(G[0].r,O.read_shift(2),!1),I.push(Re+F+":"+ue+J)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(O.read_shift(2));break;case 6:{for(var qe="";te=O[O.l++];)qe+=String.fromCharCode(te);I.push('"'+qe.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:ne=I.pop(),ie=I.pop(),I.push(["AND","OR"][te-20]+"("+ie+","+ne+")");break;default:if(te<32&&w[te])ne=I.pop(),ie=I.pop(),I.push(ie+w[te]+ne);else if(k[te]){if(M=k[te][1],M==69&&(M=O[O.l++]),M>I.length){console.error("WK1 bad formula parse 0x"+te.toString(16)+":|"+I.join("|")+"|");return}var Ge=I.slice(-M);I.length-=M,I.push(k[te][0]+"("+Ge.join(",")+")")}else return te<=7?console.error("WK1 invalid opcode "+te.toString(16)):te<=24?console.error("WK1 unsupported op "+te.toString(16)):te<=30?console.error("WK1 invalid opcode "+te.toString(16)):te<=115?console.error("WK1 unsupported function opcode "+te.toString(16)):console.error("WK1 unrecognized opcode "+te.toString(16))}}I.length==1?G[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function U(O){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=O.read_shift(2),G[3]=O[O.l++],G[0].c=O[O.l++],G}function R(O,G){var I=U(O,G);return I[1].t="s",I[1].v=O.read_shift(G-4,"cstr"),I}function T(O,G,I,M){var J=Z(6+M.length);J.write_shift(2,O),J.write_shift(1,I),J.write_shift(1,G),J.write_shift(1,39);for(var ue=0;ue<M.length;++ue){var ie=M.charCodeAt(ue);J.write_shift(1,ie>=128?95:ie)}return J.write_shift(1,0),J}function B(O,G){var I=U(O,G);I[1].v=O.read_shift(2);var M=I[1].v>>1;if(I[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return I[1].v=M,I}function N(O,G){var I=U(O,G),M=O.read_shift(4),J=O.read_shift(4),ue=O.read_shift(2);if(ue==65535)return M===0&&J===3221225472?(I[1].t="e",I[1].v=15):M===0&&J===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var ie=ue&32768;return ue=(ue&32767)-16446,I[1].v=(1-ie*2)*(J*Math.pow(2,ue+32)+M*Math.pow(2,ue)),I}function K(O,G,I,M){var J=Z(14);if(J.write_shift(2,O),J.write_shift(1,I),J.write_shift(1,G),M==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var ue=0,ie=0,ne=0,te=0;return M<0&&(ue=1,M=-M),ie=Math.log2(M)|0,M/=Math.pow(2,ie-31),te=M>>>0,(te&2147483648)==0&&(M/=2,++ie,te=M>>>0),M-=te,te|=2147483648,te>>>=0,M*=Math.pow(2,32),ne=M>>>0,J.write_shift(4,ne),J.write_shift(4,te),ie+=16383+(ue?32768:0),J.write_shift(2,ie),J}function q(O,G){var I=N(O,14);return O.l+=G-14,I}function V(O,G){var I=U(O,G),M=O.read_shift(4);return I[1].v=M>>6,I}function se(O,G){var I=U(O,G),M=O.read_shift(8,"f");return I[1].v=M,I}function ge(O,G){var I=se(O,14);return O.l+=G-10,I}function oe(O,G){return O[O.l+G-1]==0?O.read_shift(G,"cstr"):""}function Ee(O,G){var I=O[O.l++];I>G-1&&(I=G-1);for(var M="";M.length<I;)M+=String.fromCharCode(O[O.l++]);return M}function xe(O,G,I){if(!(!I.qpro||G<21)){var M=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var J=O.read_shift(G-21,"cstr");return[M,J]}}function He(O,G){for(var I={},M=O.l+G;O.l<M;){var J=O.read_shift(2);if(J==14e3){for(I[J]=[0,""],I[J][0]=O.read_shift(2);O[O.l];)I[J][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return I}function pe(O,G){var I=Z(5+O.length);I.write_shift(2,14e3),I.write_shift(2,G);for(var M=0;M<O.length;++M){var J=O.charCodeAt(M);I[I.l++]=J>127?95:J}return I[I.l++]=0,I}var we={0:{n:"BOF",f:Ot},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:oe},222:{n:"SHEETNAMELP",f:Ee},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:B},25:{n:"FORMULA19",f:q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:He},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:se},40:{n:"FORMULA28",f:ge},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:oe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:xe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:i,to_workbook:r}}();function T2(t){var r={},e=t.match(dr),a=0,i=!1;if(e)for(;a!=e.length;++a){var n=Me(e[a]);switch(n[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!n.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(n.val=="1")break;r.cp=d0[parseInt(n.val,10)];break;case"<outline":if(!n.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=n.val;break;case"<sz":r.sz=n.val;break;case"<strike":if(!n.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!n.val)break;switch(n.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(n.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(n.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":n.rgb&&(r.color=n.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=n.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=n.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+n[0])}}return r}var A2=function(){var t=Fs("t"),r=Fs("rPr");function e(n){var s=n.match(t);if(!s)return{t:"s",v:""};var o={t:"s",v:$e(s[1])},l=n.match(r);return l&&(o.s=T2(l[1])),o}var a=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(s){return s.replace(a,"").split(i).map(e).filter(function(o){return o.v})}}(),F2=function(){var r=/(\r\n|\n)/g;function e(i,n,s){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),n.push('<span style="'+o.join("")+'">'),i.b&&(n.push("<b>"),s.push("</b>")),i.i&&(n.push("<i>"),s.push("</i>")),i.strike&&(n.push("<s>"),s.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(n.push("<"+l+">"),s.push("</"+l+">")),s.push("</span>"),i}function a(i){var n=[[],i.v,[]];return i.v?(i.s&&e(i.s,n[0],n[2]),n[0].join("")+n[1].replace(r,"<br/>")+n[2].join("")):""}return function(n){return n.map(a).join("")}}(),O2=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,M2=/<(?:\w+:)?r>/,I2=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function B0(t,r){var e=r?r.cellHTML:!0,a={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=$e(rt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=rt(t),e&&(a.h=w0(a.t))):t.match(M2)&&(a.r=rt(t),a.t=$e(rt((t.replace(I2,"").match(O2)||[]).join("").replace(dr,""))),e&&(a.h=F2(A2(a.r)))),a):{t:""}}var P2=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,R2=/<(?:\w+:)?(?:si|sstItem)>/g,N2=/<\/(?:\w+:)?(?:si|sstItem)>/;function L2(t,r){var e=[],a="";if(!t)return e;var i=t.match(P2);if(i){a=i[2].replace(R2,"").split(N2);for(var n=0;n!=a.length;++n){var s=B0(a[n].trim(),r);s!=null&&(e[e.length]=s)}i=Me(i[1]),e.Count=i.count,e.Unique=i.uniqueCount}return e}var B2=/^\s|\s$|[\t\n\r]/;function Um(t,r){if(!r.bookSST)return"";var e=[Et];e[e.length]=le("sst",null,{xmlns:Ui[0],count:t.Count,uniqueCount:t.Unique});for(var a=0;a!=t.length;++a)if(t[a]!=null){var i=t[a],n="<si>";i.r?n+=i.r:(n+="<t",i.t||(i.t=""),i.t.match(B2)&&(n+=' xml:space="preserve"'),n+=">"+et(i.t)+"</t>"),n+="</si>",e[e.length]=n}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function V2(t){return[t.read_shift(4),t.read_shift(4)]}function U2(t,r){var e=[],a=!1;return Na(t,function(n,s,o){switch(o){case 159:e.Count=n[0],e.Unique=n[1];break;case 19:e.push(n);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(s.T,!a||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),e}function H2(t,r){return r||(r=Z(8)),r.write_shift(4,t.Count),r.write_shift(4,t.Unique),r}var W2=Q1;function G2(t){var r=yr();re(r,159,H2(t));for(var e=0;e<t.length;++e)re(r,19,W2(t[e]));return re(r,160),r.end()}function Hm(t){if(typeof Ke<"u")return Ke.utils.encode(Pn,t);for(var r=[],e=t.split(""),a=0;a<e.length;++a)r[a]=e[a].charCodeAt(0);return r}function Ia(t,r){var e={};return e.Major=t.read_shift(2),e.Minor=t.read_shift(2),r>=4&&(t.l+=r-4),e}function z2(t){var r={};return r.id=t.read_shift(0,"lpp4"),r.R=Ia(t,4),r.U=Ia(t,4),r.W=Ia(t,4),r}function Y2(t){for(var r=t.read_shift(4),e=t.l+r-4,a={},i=t.read_shift(4),n=[];i-- >0;)n.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(a.name=t.read_shift(0,"lpp4"),a.comps=n,t.l!=e)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+e);return a}function $2(t){var r=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)r.push(Y2(t));return r}function X2(t){var r=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)r.push(t.read_shift(0,"lpp4"));return r}function j2(t){var r={};return t.read_shift(4),t.l+=4,r.id=t.read_shift(0,"lpp4"),r.name=t.read_shift(0,"lpp4"),r.R=Ia(t,4),r.U=Ia(t,4),r.W=Ia(t,4),r}function K2(t){var r=j2(t);if(r.ename=t.read_shift(0,"8lpp4"),r.blksz=t.read_shift(4),r.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function Wm(t,r){var e=t.l+r,a={};a.Flags=t.read_shift(4)&63,t.l+=4,a.AlgID=t.read_shift(4);var i=!1;switch(a.AlgID){case 26126:case 26127:case 26128:i=a.Flags==36;break;case 26625:i=a.Flags==4;break;case 0:i=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=t.read_shift(4),a.KeySize=t.read_shift(4),a.ProviderType=t.read_shift(4),t.l+=8,a.CSPName=t.read_shift(e-t.l>>1,"utf16le"),t.l=e,a}function Gm(t,r){var e={},a=t.l+r;return t.l+=4,e.Salt=t.slice(t.l,t.l+16),t.l+=16,e.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),e.VerifierHash=t.slice(t.l,a),t.l=a,e}function q2(t){var r=Ia(t);switch(r.Minor){case 2:return[r.Minor,Z2(t,r)];case 3:return[r.Minor,Q2(t,r)];case 4:return[r.Minor,J2(t,r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function Z2(t){var r=t.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var e=t.read_shift(4),a=Wm(t,e),i=Gm(t,t.length-t.l);return{t:"Std",h:a,v:i}}function Q2(){throw new Error("File is password-protected: ECMA-376 Extensible")}function J2(t){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var e=t.read_shift(t.length-t.l,"utf8"),a={};return e.replace(dr,function(n){var s=Me(n);switch(va(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(o){a[o]=s[o]});break;case"<dataIntegrity":a.encryptedHmacKey=s.encryptedHmacKey,a.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(s);break;default:throw s[0]}}),a}function ew(t,r){var e={},a=e.EncryptionVersionInfo=Ia(t,4);if(r-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);e.Flags=t.read_shift(4),r-=4;var i=t.read_shift(4);return r-=4,e.EncryptionHeader=Wm(t,i),r-=i,e.EncryptionVerifier=Gm(t,r),e}function tw(t){var r={},e=r.EncryptionVersionInfo=Ia(t,4);if(e.Major!=1||e.Minor!=1)throw"unrecognized version code "+e.Major+" : "+e.Minor;return r.Salt=t.read_shift(16),r.EncryptedVerifier=t.read_shift(16),r.EncryptedVerifierHash=t.read_shift(16),r}function V0(t){var r=0,e,a=Hm(t),i=a.length+1,n,s,o,l,c;for(e=di(i),e[0]=a.length,n=1;n!=i;++n)e[n]=a[n-1];for(n=i-1;n>=0;--n)s=e[n],o=(r&16384)===0?0:1,l=r<<1&32767,c=o|l,r=c^s;return r^52811}var zm=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(s){return(s/2|s*128)&255},i=function(s,o){return a(s^o)},n=function(s){for(var o=r[s.length-1],l=104,c=s.length-1;c>=0;--c)for(var d=s[c],f=0;f!=7;++f)d&64&&(o^=e[l]),d*=2,--l;return o};return function(s){for(var o=Hm(s),l=n(o),c=o.length,d=di(16),f=0;f!=16;++f)d[f]=0;var h,m,p;for((c&1)===1&&(h=l>>8,d[c]=i(t[0],h),--c,h=l&255,m=o[o.length-1],d[c]=i(m,h));c>0;)--c,h=l>>8,d[c]=i(o[c],h),--c,h=l&255,d[c]=i(o[c],h);for(c=15,p=15-o.length;p>0;)h=l>>8,d[c]=i(t[p],h),--c,--p,h=l&255,d[c]=i(o[c],h),--c,--p;return d}}(),rw=function(t,r,e,a,i){i||(i=r),a||(a=zm(t));var n,s;for(n=0;n!=r.length;++n)s=r[n],s^=a[e],s=(s>>5|s<<3)&255,i[n]=s,++e;return[i,e,a]},aw=function(t){var r=0,e=zm(t);return function(a){var i=rw("",a,r,e);return r=i[1],i[0]}};function iw(t,r,e,a){var i={key:Ot(t),verificationBytes:Ot(t)};return e.password&&(i.verifier=V0(e.password)),a.valid=i.verificationBytes===i.verifier,a.valid&&(a.insitu=aw(e.password)),i}function nw(t,r,e){var a=e||{};return a.Info=t.read_shift(2),t.l-=2,a.Info===1?a.Data=tw(t,r):a.Data=ew(t,r),a}function sw(t,r,e){var a={Type:e.biff>=8?t.read_shift(2):0};return a.Type?nw(t,r-2,a):iw(t,e.biff>=8?r:r-2,e,a),a}var Ym=function(){function t(i,n){switch(n.type){case"base64":return r(Ir(i),n);case"binary":return r(i,n);case"buffer":return r(Ue&&Buffer.isBuffer(i)?i.toString("binary"):mi(i),n);case"array":return r(Ri(i),n)}throw new Error("Unrecognized type "+n.type)}function r(i,n){var s=n||{},o=s.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,m=0,p,u=-1;p=h.exec(d);){switch(p[0]){case"\\cell":var _=d.slice(m,h.lastIndex-p[0].length);if(_[0]==" "&&(_=_.slice(1)),++u,_.length){var E={v:_,t:"s"};Array.isArray(o)?o[f][u]=E:o[Oe({r:f,c:u})]=E}break}m=h.lastIndex}u>c.e.c&&(c.e.c=u)}),o["!ref"]=Ne(c),o}function e(i,n){return pi(t(i,n),n)}function a(i){for(var n=["{\\rtf1\\ansi"],s=Xe(i["!ref"]),o,l=Array.isArray(i),c=s.s.r;c<=s.e.r;++c){n.push("\\trowd\\trautofit1");for(var d=s.s.c;d<=s.e.c;++d)n.push("\\cellx"+(d+1));for(n.push("\\pard\\intbl"),d=s.s.c;d<=s.e.c;++d){var f=Oe({r:c,c:d});o=l?(i[c]||[])[d]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(n.push(" "+(o.w||(Pa(o),o.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}return{to_workbook:e,to_sheet:t,from_sheet:a}}();function ow(t){var r=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Ps(t){for(var r=0,e=1;r!=3;++r)e=e*256+(t[r]>255?255:t[r]<0?0:t[r]);return e.toString(16).toUpperCase().slice(1)}function lw(t){var r=t[0]/255,e=t[1]/255,a=t[2]/255,i=Math.max(r,e,a),n=Math.min(r,e,a),s=i-n;if(s===0)return[0,0,r];var o=0,l=0,c=i+n;switch(l=s/(c>1?2-c:c),i){case r:o=((e-a)/s+6)%6;break;case e:o=(a-r)/s+2;break;case a:o=(r-e)/s+4;break}return[o/6,l,c/2]}function cw(t){var r=t[0],e=t[1],a=t[2],i=e*2*(a<.5?a:1-a),n=a-i/2,s=[n,n,n],o=6*r,l;if(e!==0)switch(o|0){case 0:case 6:l=i*o,s[0]+=i,s[1]+=l;break;case 1:l=i*(2-o),s[0]+=l,s[1]+=i;break;case 2:l=i*(o-2),s[1]+=i,s[2]+=l;break;case 3:l=i*(4-o),s[1]+=l,s[2]+=i;break;case 4:l=i*(o-4),s[2]+=i,s[0]+=l;break;case 5:l=i*(6-o),s[2]+=l,s[0]+=i;break}for(var c=0;c!=3;++c)s[c]=Math.round(s[c]*255);return s}function Cl(t,r){if(r===0)return t;var e=lw(ow(t));return r<0?e[2]=e[2]*(1+r):e[2]=1-(1-e[2])*(1-r),Ps(cw(e))}var $m=6,dw=15,fw=1,nr=$m;function Rs(t){return Math.floor((t+Math.round(128/nr)/256)*nr)}function Ns(t){return Math.floor((t-5)/nr*100+.5)/100}function kl(t){return Math.round((t*nr+5)/nr*256)/256}function Gc(t){return kl(Ns(Rs(t)))}function U0(t){var r=Math.abs(t-Gc(t)),e=nr;if(r>.005)for(nr=fw;nr<dw;++nr)Math.abs(t-Gc(t))<=r&&(r=Math.abs(t-Gc(t)),e=nr);nr=e}function fi(t){t.width?(t.wpx=Rs(t.width),t.wch=Ns(t.wpx),t.MDW=nr):t.wpx?(t.wch=Ns(t.wpx),t.width=kl(t.wch),t.MDW=nr):typeof t.wch=="number"&&(t.width=kl(t.wch),t.wpx=Rs(t.width),t.MDW=nr),t.customWidth&&delete t.customWidth}var uw=96,Xm=uw;function Ls(t){return t*96/Xm}function Ln(t){return t*Xm/96}var hw={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function mw(t,r,e,a){r.Borders=[];var i={},n=!1;(t[0].match(dr)||[]).forEach(function(s){var o=Me(s);switch(va(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=it(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=it(o.diagonalDown)),r.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+o[0]+" in borders")}})}function pw(t,r,e,a){r.Fills=[];var i={},n=!1;(t[0].match(dr)||[]).forEach(function(s){var o=Me(s);switch(va(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},r.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+o[0]+" in fills")}})}function _w(t,r,e,a){r.Fonts=[];var i={},n=!1;(t[0].match(dr)||[]).forEach(function(s){var o=Me(s);switch(va(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=rt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?it(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?it(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?it(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?it(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?it(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?it(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?it(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=d0[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=it(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=Fi[i.color.index];i.color.index==81&&(l=Fi[1]),l||(l=Fi[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&e.themeElements&&e.themeElements.clrScheme&&(i.color.rgb=Cl(e.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+o[0]+" in fonts")}})}function gw(t,r,e){r.NumberFmt=[];for(var a=mt(Fe),i=0;i<a.length;++i)r.NumberFmt[a[i]]=Fe[a[i]];var n=t[0].match(dr);if(n)for(i=0;i<n.length;++i){var s=Me(n[i]);switch(va(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=$e(rt(s.formatCode)),l=parseInt(s.numFmtId,10);if(r.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&r.NumberFmt[l]!=null;--l);r.NumberFmt[l]=o}Ma(o,l)}}break;case"</numFmt>":break;default:if(e.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function xw(t){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var a=e[0];a<=e[1];++a)t[a]!=null&&(r[r.length]=le("numFmt",null,{numFmtId:a,formatCode:et(t[a])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=le("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var dl=["numFmtId","fillId","fontId","borderId","xfId"],fl=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function vw(t,r,e){r.CellXf=[];var a,i=!1;(t[0].match(dr)||[]).forEach(function(n){var s=Me(n),o=0;switch(va(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=s,delete a[0],o=0;o<dl.length;++o)a[dl[o]]&&(a[dl[o]]=parseInt(a[dl[o]],10));for(o=0;o<fl.length;++o)a[fl[o]]&&(a[fl[o]]=it(a[fl[o]]));if(r.NumberFmt&&a.numFmtId>392){for(o=392;o>60;--o)if(r.NumberFmt[a.numFmtId]==r.NumberFmt[o]){a.numFmtId=o;break}}r.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),s.textRotation!=null&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=it(s.wrapText)),a.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(e&&e.WTF&&!i)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function ww(t){var r=[];return r[r.length]=le("cellXfs",null),t.forEach(function(e){r[r.length]=le("xf",null,e)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=le("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var yw=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,n=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(r))&&gw(f,d,c),(f=o.match(i))&&_w(f,d,l,c),(f=o.match(a))&&pw(f,d,l,c),(f=o.match(n))&&mw(f,d,l,c),(f=o.match(e))&&vw(f,d,c),d}}();function jm(t,r){var e=[Et,le("styleSheet",null,{xmlns:Ui[0],"xmlns:vt":Nt.vt})],a;return t.SSF&&(a=xw(t.SSF))!=null&&(e[e.length]=a),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=ww(r.cellXfs))&&(e[e.length]=a),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function bw(t,r){var e=t.read_shift(2),a=lr(t,r-2);return[e,a]}function Cw(t,r,e){e||(e=Z(6+4*r.length)),e.write_shift(2,t),Gt(r,e);var a=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),a}function kw(t,r,e){var a={};a.sz=t.read_shift(2)/20;var i=nx(t,2,e);i.fItalic&&(a.italic=1),i.fCondense&&(a.condense=1),i.fExtend&&(a.extend=1),i.fShadow&&(a.shadow=1),i.fOutline&&(a.outline=1),i.fStrikeout&&(a.strike=1);var n=t.read_shift(2);switch(n===700&&(a.bold=1),t.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var s=t.read_shift(1);s!=0&&(a.underline=s);var o=t.read_shift(1);o>0&&(a.family=o);var l=t.read_shift(1);switch(l>0&&(a.charset=l),t.l++,a.color=ix(t,8),t.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=lr(t,r-21),a}function Ew(t,r){r||(r=Z(25+4*32)),r.write_shift(2,t.sz*20),sx(t,r),r.write_shift(2,t.bold?700:400);var e=0;t.vertAlign=="superscript"?e=1:t.vertAlign=="subscript"&&(e=2),r.write_shift(2,e),r.write_shift(1,t.underline||0),r.write_shift(1,t.family||0),r.write_shift(1,t.charset||0),r.write_shift(1,0),wl(t.color,r);var a=0;return t.scheme=="major"&&(a=1),t.scheme=="minor"&&(a=2),r.write_shift(1,a),Gt(t.name,r),r.length>r.l?r.slice(0,r.l):r}var Sw=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],zc,Dw=cr;function uh(t,r){r||(r=Z(4*3+8*7+16*1)),zc||(zc=Al(Sw));var e=zc[t.patternType];e==null&&(e=40),r.write_shift(4,e);var a=0;if(e!=40)for(wl({auto:1},r),wl({auto:1},r);a<12;++a)r.write_shift(4,0);else{for(;a<4;++a)r.write_shift(4,0);for(;a<12;++a)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function Tw(t,r){var e=t.l+r,a=t.read_shift(2),i=t.read_shift(2);return t.l=e,{ixfe:a,numFmtId:i}}function Km(t,r,e){e||(e=Z(16)),e.write_shift(2,r||0),e.write_shift(2,t.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var a=0;return e.write_shift(1,a),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function ps(t,r){return r||(r=Z(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var Aw=cr;function Fw(t,r){return r||(r=Z(51)),r.write_shift(1,0),ps(null,r),ps(null,r),ps(null,r),ps(null,r),ps(null,r),r.length>r.l?r.slice(0,r.l):r}function Ow(t,r){return r||(r=Z(12+4*10)),r.write_shift(4,t.xfId),r.write_shift(2,1),r.write_shift(1,+t.builtinId),r.write_shift(1,0),vl(t.name||"",r),r.length>r.l?r.slice(0,r.l):r}function Mw(t,r,e){var a=Z(2052);return a.write_shift(4,t),vl(r,a),vl(e,a),a.length>a.l?a.slice(0,a.l):a}function Iw(t,r,e){var a={};a.NumberFmt=[];for(var i in Fe)a.NumberFmt[i]=Fe[i];a.CellXf=[],a.Fonts=[];var n=[],s=!1;return Na(t,function(l,c,d){switch(d){case 44:a.NumberFmt[l[0]]=l[1],Ma(l[1],l[0]);break;case 43:a.Fonts.push(l),l.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(l.color.rgb=Cl(r.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:n[n.length-1]==617&&a.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;default:if(c.T>0)n.push(d);else if(c.T<0)n.pop();else if(!s||e.WTF&&n[n.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function Pw(t,r){if(r){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var i=a[0];i<=a[1];++i)r[i]!=null&&++e}),e!=0&&(re(t,615,ra(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var i=a[0];i<=a[1];++i)r[i]!=null&&re(t,44,Cw(i,r[i]))}),re(t,616))}}function Rw(t){var r=1;r!=0&&(re(t,611,ra(r)),re(t,43,Ew({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),re(t,612))}function Nw(t){var r=2;r!=0&&(re(t,603,ra(r)),re(t,45,uh({patternType:"none"})),re(t,45,uh({patternType:"gray125"})),re(t,604))}function Lw(t){var r=1;r!=0&&(re(t,613,ra(r)),re(t,46,Fw({})),re(t,614))}function Bw(t){var r=1;re(t,626,ra(r)),re(t,47,Km({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),re(t,627)}function Vw(t,r){re(t,617,ra(r.length)),r.forEach(function(e){re(t,47,Km(e,0))}),re(t,618)}function Uw(t){var r=1;re(t,619,ra(r)),re(t,48,Ow({xfId:0,builtinId:0,name:"Normal"})),re(t,620)}function Hw(t){var r=0;re(t,505,ra(r)),re(t,506)}function Ww(t){var r=0;re(t,508,Mw(r,"TableStyleMedium9","PivotStyleMedium4")),re(t,509)}function Gw(t,r){var e=yr();return re(e,278),Pw(e,t.SSF),Rw(e,t),Nw(e,t),Lw(e,t),Bw(e,t),Vw(e,r.cellXfs),Uw(e,t),Hw(e,t),Ww(e,t),re(e,279),e.end()}var zw=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Yw(t,r,e){r.themeElements.clrScheme=[];var a={};(t[0].match(dr)||[]).forEach(function(i){var n=Me(i);switch(n[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=n.val;break;case"<a:sysClr":a.rgb=n.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":n[0].charAt(1)==="/"?(r.themeElements.clrScheme[zw.indexOf(n[0])]=a,a={}):a.name=n[0].slice(3,n[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+n[0]+" in clrScheme")}})}function $w(){}function Xw(){}var jw=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Kw=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,qw=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Zw(t,r,e){r.themeElements={};var a;[["clrScheme",jw,Yw],["fontScheme",Kw,$w],["fmtScheme",qw,Xw]].forEach(function(i){if(!(a=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](a,r,e)})}var Qw=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function qm(t,r){(!t||t.length===0)&&(t=H0());var e,a={};if(!(e=t.match(Qw)))throw new Error("themeElements not found in theme");return Zw(e[0],a,r),a.raw=t,a}function H0(t,r){if(r&&r.themeXLSX)return r.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var e=[Et];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function Jw(t,r,e){var a=t.l+r,i=t.read_shift(4);if(i!==124226){if(!e.cellStyles){t.l=a;return}var n=t.slice(t.l);t.l=a;var s;try{s=Xh(n,{type:"array"})}catch{return}var o=Mr(s,"theme/theme/theme1.xml",!0);if(o)return qm(o,e)}}function ey(t){return t.read_shift(4)}function ty(t){var r={};switch(r.xclrType=t.read_shift(2),r.nTintShade=t.read_shift(2),r.xclrType){case 0:t.l+=4;break;case 1:r.xclrValue=ry(t,4);break;case 2:r.xclrValue=Am(t,4);break;case 3:r.xclrValue=ey(t,4);break;case 4:t.l+=4;break}return t.l+=8,r}function ry(t,r){return cr(t,r)}function ay(t,r){return cr(t,r)}function iy(t){var r=t.read_shift(2),e=t.read_shift(2)-4,a=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=ty(t,e);break;case 6:a[1]=ay(t,e);break;case 14:case 15:a[1]=t.read_shift(e===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+e)}return a}function ny(t,r){var e=t.l+r;t.l+=2;var a=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),n=[];i-- >0;)n.push(iy(t,e-t.l));return{ixfe:a,ext:n}}function sy(t,r){r.forEach(function(e){switch(e[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function oy(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:lr(t,r-8)}}function ly(t){var r=Z(12+2*t.name.length);return r.write_shift(4,t.flags),r.write_shift(4,t.version),Gt(t.name,r),r.slice(0,r.l)}function cy(t){for(var r=[],e=t.read_shift(4);e-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}function dy(t){var r=Z(4+8*t.length);r.write_shift(4,t.length);for(var e=0;e<t.length;++e)r.write_shift(4,t[e][0]),r.write_shift(4,t[e][1]);return r}function fy(t,r){var e=Z(8+2*r.length);return e.write_shift(4,t),Gt(r,e),e.slice(0,e.l)}function uy(t){return t.l+=4,t.read_shift(4)!=0}function hy(t,r){var e=Z(8);return e.write_shift(4,t),e.write_shift(4,r?1:0),e}function my(t,r,e){var a={Types:[],Cell:[],Value:[]},i=e||{},n=[],s=!1,o=2;return Na(t,function(l,c,d){switch(d){case 335:a.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?a.Cell.push({type:a.Types[f[0]-1].name,index:f[1]}):o==0&&a.Value.push({type:a.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;default:if(!c.T){if(!s||i.WTF&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),a}function py(){var t=yr();return re(t,332),re(t,334,ra(1)),re(t,335,ly({name:"XLDAPR",version:12e4,flags:3496657072})),re(t,336),re(t,339,fy(1,"XLDAPR")),re(t,52),re(t,35,ra(514)),re(t,4096,ra(0)),re(t,4097,$r(1)),re(t,36),re(t,53),re(t,340),re(t,337,hy(1,!0)),re(t,51,dy([[1,0]])),re(t,338),re(t,333),t.end()}function _y(t,r,e){var a={Types:[],Cell:[],Value:[]};if(!t)return a;var i=!1,n=2,s;return t.replace(dr,function(o){var l=Me(o);switch(va(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<a.Types.length;++c)a.Types[c].name==l.name&&(s=a.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":n==1?a.Cell.push({type:a.Types[l.t-1].name,index:+l.v}):n==0&&a.Value.push({type:a.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":n=1;break;case"</cellMetadata>":n=2;break;case"<valueMetadata":n=0;break;case"</valueMetadata>":n=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+l.i);break;default:if(!i&&e.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),a}function Zm(){var t=[Et];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function gy(t){var r=[];if(!t)return r;var e=1;return(t.match(dr)||[]).forEach(function(a){var i=Me(a);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?e=i.i:i.i=e,r.push(i);break}}),r}function xy(t){var r={};r.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),r.r=Oe(e);var a=t.read_shift(1);return a&2&&(r.l="1"),a&8&&(r.a="1"),r}function vy(t,r,e){var a=[],i=!1;return Na(t,function(s,o,l){switch(l){case 63:a.push(s);break;default:if(!o.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),a}function wy(t,r,e,a){if(!t)return t;var i=a||{},n=!1,s=!1;Na(t,function(l,c,d){if(!s)switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:n=!0;break;case 36:n=!1;break;default:if(!c.T){if(!n||i.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},i)}function yy(t,r){if(!t)return"??";var e=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][e].Target}var An=1024;function Qm(t,r){for(var e=[21600,21600],a=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),i=[le("xml",null,{"xmlns:v":Fr.v,"xmlns:o":Fr.o,"xmlns:x":Fr.x,"xmlns:mv":Fr.mv}).replace(/\/>/,">"),le("o:shapelayout",le("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),le("v:shapetype",[le("v:stroke",null,{joinstyle:"miter"}),le("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:a})];An<t*1e3;)An+=1e3;return r.forEach(function(n){var s=ct(n[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?le("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=le("v:fill",l,o),d={on:"t",obscured:"t"};++An,i=i.concat(["<v:shape"+Os({id:"_x0000_s"+An,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(n[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,le("v:shadow",null,d),le("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Xt("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Xt("x:AutoFill","False"),Xt("x:Row",String(s.r)),Xt("x:Column",String(s.c)),n[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function hh(t,r,e,a){var i=Array.isArray(t),n;r.forEach(function(s){var o=ct(s.ref);if(i?(t[o.r]||(t[o.r]=[]),n=t[o.r][o.c]):n=t[s.ref],!n){n={t:"z"},i?t[o.r][o.c]=n:t[s.ref]=n;var l=Xe(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Ne(l);c!==t["!ref"]&&(t["!ref"]=c)}n.c||(n.c=[]);var d={a:s.author,t:s.t,r:s.r,T:e};s.h&&(d.h=s.h);for(var f=n.c.length-1;f>=0;--f){if(!e&&n.c[f].T)return;e&&!n.c[f].T&&n.c.splice(f,1)}if(e&&a){for(f=0;f<a.length;++f)if(d.a==a[f].id){d.a=a[f].name||d.a;break}}n.c.push(d)})}function by(t,r){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],a=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&e.push(o[1])}});var n=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return n&&n[1]&&n[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Me(o[0]),c={author:l.authorId&&e[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=ct(l.ref);if(!(r.sheetRows&&r.sheetRows<=d.r)){var f=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&B0(f[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(c.h=h.h),a.push(c)}}}}),a}function Jm(t){var r=[Et,le("comments",null,{xmlns:Ui[0]})],e=[];return r.push("<authors>"),t.forEach(function(a){a[1].forEach(function(i){var n=et(i.a);e.indexOf(n)==-1&&(e.push(n),r.push("<author>"+n+"</author>")),i.T&&i.ID&&e.indexOf("tc="+i.ID)==-1&&(e.push("tc="+i.ID),r.push("<author>tc="+i.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),t.forEach(function(a){var i=0,n=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?i=e.indexOf("tc="+a[1][0].ID):a[1].forEach(function(l){l.a&&(i=e.indexOf(et(l.a))),n.push(l.t||"")}),r.push('<comment ref="'+a[0]+'" authorId="'+i+'"><text>'),n.length<=1)r.push(Xt("t",et(n[0]||"")));else{for(var s=`Comment:
    `+n[0]+`
`,o=1;o<n.length;++o)s+=`Reply:
    `+n[o]+`
`;r.push(Xt("t",et(s)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Cy(t,r){var e=[],a=!1,i={},n=0;return t.replace(dr,function(o,l){var c=Me(o);switch(va(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&e.push(i);break;case"<text>":case"<text":n=l+o.length;break;case"</text>":i.t=t.slice(n,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),e}function ky(t,r,e){var a=[Et,le("ThreadedComments",null,{xmlns:Nt.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var n="";(i[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&r.indexOf(s.a)==-1&&r.push(s.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};o==0?n=l.id:l.parentId=n,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(s.a)).slice(-12)+"}"),a.push(le("threadedComment",Xt("text",s.t||""),l))})}),a.push("</ThreadedComments>"),a.join("")}function Ey(t,r){var e=[],a=!1;return t.replace(dr,function(n){var s=Me(n);switch(va(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":e.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return n}),e}function Sy(t){var r=[Et,le("personList",null,{xmlns:Nt.TCMNT,"xmlns:x":Ui[0]}).replace(/[\/]>/,">")];return t.forEach(function(e,a){r.push(le("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:e,providerId:"None"}))}),r.push("</personList>"),r.join("")}function Dy(t){var r={};r.iauthor=t.read_shift(4);var e=zi(t,16);return r.rfx=e.s,r.ref=Oe(e.s),t.l+=16,r}function Ty(t,r){return r==null&&(r=Z(36)),r.write_shift(4,t[1].iauthor),Wn(t[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var Ay=lr;function Fy(t){return Gt(t.slice(0,54))}function Oy(t,r){var e=[],a=[],i={},n=!1;return Na(t,function(o,l,c){switch(c){case 632:a.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=a[i.iauthor],delete i.iauthor,r.sheetRows&&i.rfx&&r.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,e.push(i);break;case 3072:break;case 35:n=!0;break;case 36:n=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!n||r.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),e}function My(t){var r=yr(),e=[];return re(r,628),re(r,630),t.forEach(function(a){a[1].forEach(function(i){e.indexOf(i.a)>-1||(e.push(i.a.slice(0,54)),re(r,632,Fy(i.a)))})}),re(r,631),re(r,633),t.forEach(function(a){a[1].forEach(function(i){i.iauthor=e.indexOf(i.a);var n={s:ct(a[0]),e:ct(a[0])};re(r,635,Ty([n,i])),i.t&&i.t.length>0&&re(r,637,ex(i)),re(r,636),delete i.iauthor})}),re(r,634),re(r,629),r.end()}var Iy="application/vnd.ms-office.vbaProject";function Py(t){var r=Se.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(e,a){if(!(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))){var i=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Se.utils.cfb_add(r,i,t.FileIndex[a].content)}}),Se.write(r)}function Ry(t,r){r.FullPaths.forEach(function(e,a){if(a!=0){var i=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Se.utils.cfb_add(t,i,r.FileIndex[a].content)}})}var ep=["xlsb","xlsm","xlam","biff8","xla"];function Ny(){return{"!type":"dialog"}}function Ly(){return{"!type":"dialog"}}function By(){return{"!type":"macro"}}function Vy(){return{"!type":"macro"}}var Mn=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function e(a,i,n,s){var o=!1,l=!1;n.length==0?l=!0:n.charAt(0)=="["&&(l=!0,n=n.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=n.length>0?parseInt(n,10)|0:0,d=s.length>0?parseInt(s,10)|0:0;return o?d+=r.c:--d,l?c+=r.r:--c,i+(o?"":"$")+lt(d)+(l?"":"$")+kt(c)}return function(i,n){return r=n,i.replace(t,e)}}(),W0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,G0=function(){return function(r,e){return r.replace(W0,function(a,i,n,s,o,l){var c=A0(s)-(n?0:e.c),d=T0(l)-(o?0:e.r),f=d==0?"":o?d+1:"["+d+"]",h=c==0?"":n?c+1:"["+c+"]";return i+"R"+f+"C"+h})}}();function tp(t,r){return t.replace(W0,function(e,a,i,n,s,o){return a+(i=="$"?i+n:lt(A0(n)+r.c))+(s=="$"?s+o:kt(T0(o)+r.r))})}function Uy(t,r,e){var a=br(r),i=a.s,n=ct(e),s={r:n.r-i.r,c:n.c-i.c};return tp(t,s)}function Hy(t){return t.length!=1}function mh(t){return t.replace(/_xlfn\./g,"")}function At(t){t.l+=1}function ui(t,r){var e=t.read_shift(r==1?1:2);return[e&16383,e>>14&1,e>>15&1]}function rp(t,r,e){var a=2;if(e){if(e.biff>=2&&e.biff<=5)return ap(t,r,e);e.biff==12&&(a=4)}var i=t.read_shift(a),n=t.read_shift(a),s=ui(t,2),o=ui(t,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function ap(t){var r=ui(t,2),e=ui(t,2),a=t.read_shift(1),i=t.read_shift(1);return{s:{r:r[0],c:a,cRel:r[1],rRel:r[2]},e:{r:e[0],c:i,cRel:e[1],rRel:e[2]}}}function Wy(t,r,e){if(e.biff<8)return ap(t,r,e);var a=t.read_shift(e.biff==12?4:2),i=t.read_shift(e.biff==12?4:2),n=ui(t,2),s=ui(t,2);return{s:{r:a,c:n[0],cRel:n[1],rRel:n[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function ip(t,r,e){if(e&&e.biff>=2&&e.biff<=5)return Gy(t,r,e);var a=t.read_shift(e&&e.biff==12?4:2),i=ui(t,2);return{r:a,c:i[0],cRel:i[1],rRel:i[2]}}function Gy(t){var r=ui(t,2),e=t.read_shift(1);return{r:r[0],c:e,cRel:r[1],rRel:r[2]}}function zy(t){var r=t.read_shift(2),e=t.read_shift(2);return{r,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function Yy(t,r,e){var a=e&&e.biff?e.biff:8;if(a>=2&&a<=5)return $y(t,r,e);var i=t.read_shift(a>=12?4:2),n=t.read_shift(2),s=(n&16384)>>14,o=(n&32768)>>15;if(n&=16383,o==1)for(;i>524287;)i-=1048576;if(s==1)for(;n>8191;)n=n-16384;return{r:i,c:n,cRel:s,rRel:o}}function $y(t){var r=t.read_shift(2),e=t.read_shift(1),a=(r&32768)>>15,i=(r&16384)>>14;return r&=16383,a==1&&r>=8192&&(r=r-16384),i==1&&e>=128&&(e=e-256),{r,c:e,cRel:i,rRel:a}}function Xy(t,r,e){var a=(t[t.l++]&96)>>5,i=rp(t,e.biff>=2&&e.biff<=5?6:8,e);return[a,i]}function jy(t,r,e){var a=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),n=8;if(e)switch(e.biff){case 5:t.l+=12,n=6;break;case 12:n=12;break}var s=rp(t,n,e);return[a,i,s]}function Ky(t,r,e){var a=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[a]}function qy(t,r,e){var a=(t[t.l++]&96)>>5,i=t.read_shift(2),n=8;if(e)switch(e.biff){case 5:t.l+=12,n=6;break;case 12:n=12;break}return t.l+=n,[a,i]}function Zy(t,r,e){var a=(t[t.l++]&96)>>5,i=Wy(t,r-1,e);return[a,i]}function Qy(t,r,e){var a=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[a]}function ph(t){var r=t[t.l+1]&1,e=1;return t.l+=4,[r,e]}function Jy(t,r,e){t.l+=2;for(var a=t.read_shift(e&&e.biff==2?1:2),i=[],n=0;n<=a;++n)i.push(t.read_shift(e&&e.biff==2?1:2));return i}function eb(t,r,e){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(e&&e.biff==2?1:2)]}function tb(t,r,e){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(e&&e.biff==2?1:2)]}function rb(t){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(2)]}function ab(t,r,e){var a=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[a]}function np(t){var r=t.read_shift(1),e=t.read_shift(1);return[r,e]}function ib(t){return t.read_shift(2),np(t,2)}function nb(t){return t.read_shift(2),np(t,2)}function sb(t,r,e){var a=(t[t.l]&96)>>5;t.l+=1;var i=ip(t,0,e);return[a,i]}function ob(t,r,e){var a=(t[t.l]&96)>>5;t.l+=1;var i=Yy(t,0,e);return[a,i]}function lb(t,r,e){var a=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var n=ip(t,0,e);return[a,i,n]}function cb(t,r,e){var a=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(e&&e.biff<=3?1:2);return[uC[i],lp[i],a]}function db(t,r,e){var a=t[t.l++],i=t.read_shift(1),n=e&&e.biff<=3?[a==88?-1:0,t.read_shift(1)]:fb(t);return[i,(n[0]===0?lp:fC)[n[1]]]}function fb(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function ub(t,r,e){t.l+=e&&e.biff==2?3:4}function hb(t,r,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var a=t.read_shift(2),i=t.read_shift(e&&e.biff==2?1:2);return[a,i]}function mb(t){return t.l++,La[t.read_shift(1)]}function pb(t){return t.l++,t.read_shift(2)}function _b(t){return t.l++,t.read_shift(1)!==0}function gb(t){return t.l++,sr(t,8)}function xb(t,r,e){return t.l++,Ws(t,r-1,e)}function vb(t,r){var e=[t.read_shift(1)];if(r==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=Ct(t,1)?"TRUE":"FALSE",r!=12&&(t.l+=7);break;case 37:case 16:e[1]=La[t[t.l]],t.l+=r==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=sr(t,8);break;case 2:e[1]=Yi(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function wb(t,r,e){for(var a=t.read_shift(e.biff==12?4:2),i=[],n=0;n!=a;++n)i.push((e.biff==12?zi:Il)(t,8));return i}function yb(t,r,e){var a=0,i=0;e.biff==12?(a=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),a=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--a,--i==0&&(i=256));for(var n=0,s=[];n!=a&&(s[n]=[]);++n)for(var o=0;o!=i;++o)s[n][o]=vb(t,e.biff);return s}function bb(t,r,e){var a=t.read_shift(1)>>>5&3,i=!e||e.biff>=8?4:2,n=t.read_shift(i);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[a,0,n]}function Cb(t,r,e){if(e.biff==5)return kb(t,r,e);var a=t.read_shift(1)>>>5&3,i=t.read_shift(2),n=t.read_shift(4);return[a,i,n]}function kb(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var a=t.read_shift(2);return t.l+=12,[r,e,a]}function Eb(t,r,e){var a=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var i=t.read_shift(e&&e.biff==2?1:2);return[a,i]}function Sb(t,r,e){var a=t.read_shift(1)>>>5&3,i=t.read_shift(e&&e.biff==2?1:2);return[a,i]}function Db(t,r,e){var a=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[a]}function Tb(t,r,e){var a=(t[t.l++]&96)>>5,i=t.read_shift(2),n=4;if(e)switch(e.biff){case 5:n=15;break;case 12:n=6;break}return t.l+=n,[a,i]}var Ab=cr,Fb=cr,Ob=cr;function zs(t,r,e){return t.l+=2,[zy(t,4,e)]}function z0(t){return t.l+=6,[]}var Mb=zs,Ib=z0,Pb=z0,Rb=zs;function sp(t){return t.l+=2,[Ot(t),t.read_shift(2)&1]}var Nb=zs,Lb=sp,Bb=z0,Vb=zs,Ub=zs,Hb=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Wb(t){t.l+=2;var r=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(4),i=t.read_shift(2),n=t.read_shift(2),s=Hb[e>>2&31];return{ixti:r,coltype:e&3,rt:s,idx:a,c:i,C:n}}function Gb(t){return t.l+=2,[t.read_shift(4)]}function zb(t,r,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function Yb(t,r,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function $b(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function Xb(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function jb(t){return t.l+=4,[0,0]}var _h={1:{n:"PtgExp",f:hb},2:{n:"PtgTbl",f:Ob},3:{n:"PtgAdd",f:At},4:{n:"PtgSub",f:At},5:{n:"PtgMul",f:At},6:{n:"PtgDiv",f:At},7:{n:"PtgPower",f:At},8:{n:"PtgConcat",f:At},9:{n:"PtgLt",f:At},10:{n:"PtgLe",f:At},11:{n:"PtgEq",f:At},12:{n:"PtgGe",f:At},13:{n:"PtgGt",f:At},14:{n:"PtgNe",f:At},15:{n:"PtgIsect",f:At},16:{n:"PtgUnion",f:At},17:{n:"PtgRange",f:At},18:{n:"PtgUplus",f:At},19:{n:"PtgUminus",f:At},20:{n:"PtgPercent",f:At},21:{n:"PtgParen",f:At},22:{n:"PtgMissArg",f:At},23:{n:"PtgStr",f:xb},26:{n:"PtgSheet",f:zb},27:{n:"PtgEndSheet",f:Yb},28:{n:"PtgErr",f:mb},29:{n:"PtgBool",f:_b},30:{n:"PtgInt",f:pb},31:{n:"PtgNum",f:gb},32:{n:"PtgArray",f:Qy},33:{n:"PtgFunc",f:cb},34:{n:"PtgFuncVar",f:db},35:{n:"PtgName",f:bb},36:{n:"PtgRef",f:sb},37:{n:"PtgArea",f:Xy},38:{n:"PtgMemArea",f:Eb},39:{n:"PtgMemErr",f:Ab},40:{n:"PtgMemNoMem",f:Fb},41:{n:"PtgMemFunc",f:Sb},42:{n:"PtgRefErr",f:Db},43:{n:"PtgAreaErr",f:Ky},44:{n:"PtgRefN",f:ob},45:{n:"PtgAreaN",f:Zy},46:{n:"PtgMemAreaN",f:$b},47:{n:"PtgMemNoMemN",f:Xb},57:{n:"PtgNameX",f:Cb},58:{n:"PtgRef3d",f:lb},59:{n:"PtgArea3d",f:jy},60:{n:"PtgRefErr3d",f:Tb},61:{n:"PtgAreaErr3d",f:qy},255:{}},Kb={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},qb={1:{n:"PtgElfLel",f:sp},2:{n:"PtgElfRw",f:Vb},3:{n:"PtgElfCol",f:Mb},6:{n:"PtgElfRwV",f:Ub},7:{n:"PtgElfColV",f:Rb},10:{n:"PtgElfRadical",f:Nb},11:{n:"PtgElfRadicalS",f:Bb},13:{n:"PtgElfColS",f:Ib},15:{n:"PtgElfColSV",f:Pb},16:{n:"PtgElfRadicalLel",f:Lb},25:{n:"PtgList",f:Wb},29:{n:"PtgSxName",f:Gb},255:{}},Zb={0:{n:"PtgAttrNoop",f:jb},1:{n:"PtgAttrSemi",f:ab},2:{n:"PtgAttrIf",f:tb},4:{n:"PtgAttrChoose",f:Jy},8:{n:"PtgAttrGoto",f:eb},16:{n:"PtgAttrSum",f:ub},32:{n:"PtgAttrBaxcel",f:ph},33:{n:"PtgAttrBaxcel",f:ph},64:{n:"PtgAttrSpace",f:ib},65:{n:"PtgAttrSpaceSemi",f:nb},128:{n:"PtgAttrIfError",f:rb},255:{}};function Ys(t,r,e,a){if(a.biff<8)return cr(t,r);for(var i=t.l+r,n=[],s=0;s!==e.length;++s)switch(e[s][0]){case"PtgArray":e[s][1]=yb(t,0,a),n.push(e[s][1]);break;case"PtgMemArea":e[s][2]=wb(t,e[s][1],a),n.push(e[s][2]);break;case"PtgExp":a&&a.biff==12&&(e[s][1][1]=t.read_shift(4),n.push(e[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[s][0];default:break}return r=i-t.l,r!==0&&n.push(cr(t,r)),n}function $s(t,r,e){for(var a=t.l+r,i,n,s=[];a!=t.l;)r=a-t.l,n=t[t.l],i=_h[n]||_h[Kb[n]],(n===24||n===25)&&(i=(n===24?qb:Zb)[t[t.l+1]]),!i||!i.f?cr(t,r):s.push([i.n,i.f(t,r,e)]);return s}function Qb(t){for(var r=[],e=0;e<t.length;++e){for(var a=t[e],i=[],n=0;n<a.length;++n){var s=a[n];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}r.push(i.join(","))}return r.join(";")}var Jb={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function eC(t,r){if(!t&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function op(t,r,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var a=t.XTI[r];if(e.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":t.XTI[r-1];if(!a)return"SH33TJSERR1";var i="";if(e.biff>8)switch(t[a[0]][0]){case 357:return i=a[1]==-1?"#REF":t.SheetNames[a[1]],a[1]==a[2]?i:i+":"+t.SheetNames[a[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[a[0]][0];case 355:default:return"SH33TJSSRC"+t[a[0]][0]}switch(t[a[0]][0][0]){case 1025:return i=a[1]==-1?"#REF":t.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?i:i+":"+t.SheetNames[a[2]];case 14849:return t[a[0]].slice(1).map(function(n){return n.Name}).join(";;");default:return t[a[0]][0][3]?(i=a[1]==-1?"#REF":t[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?i:i+":"+t[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function gh(t,r,e){var a=op(t,r,e);return a=="#REF"?a:eC(a,e)}function ir(t,r,e,a,i){var n=i&&i.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,d,f=0,h=0,m,p="";if(!t[0]||!t[0][0])return"";for(var u=-1,_="",E=0,k=t[0].length;E<k;++E){var w=t[0][E];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),u>=0){switch(t[0][u][1][0]){case 0:_=ft(" ",t[0][u][1][1]);break;case 1:_=ft("\r",t[0][u][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][u][1][0])}c=c+_,u=-1}o.push(c+Jb[w[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=ws(w[1][1],s,i),o.push(ys(d,n));break;case"PtgRefN":d=e?ws(w[1][1],e,i):w[1][1],o.push(ys(d,n));break;case"PtgRef3d":f=w[1][1],d=ws(w[1][2],s,i),p=gh(a,f,i);var L=p;o.push(p+"!"+ys(d,n));break;case"PtgFunc":case"PtgFuncVar":var U=w[1][0],R=w[1][1];U||(U=0),U&=127;var T=U==0?[]:o.slice(-U);o.length-=U,R==="User"&&(R=T.shift()),o.push(R+"("+T.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":m=$u(w[1][1],e?{s:e}:s,i),o.push(Uc(m,i));break;case"PtgArea":m=$u(w[1][1],s,i),o.push(Uc(m,i));break;case"PtgArea3d":f=w[1][1],m=w[1][2],p=gh(a,f,i),o.push(p+"!"+Uc(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=w[1][2];var B=(a.names||[])[h-1]||(a[0]||[])[h],N=B?B.Name:"SH33TJSNAME"+String(h);N&&N.slice(0,6)=="_xlfn."&&!i.xlfn&&(N=N.slice(6)),o.push(N);break;case"PtgNameX":var K=w[1][1];h=w[1][2];var q;if(i.biff<=5)K<0&&(K=-K),a[K]&&(q=a[K][h]);else{var V="";if(((a[K]||[])[0]||[])[0]==14849||(((a[K]||[])[0]||[])[0]==1025?a[K][h]&&a[K][h].itab>0&&(V=a.SheetNames[a[K][h].itab-1]+"!"):V=a.SheetNames[h-1]+"!"),a[K]&&a[K][h])V+=a[K][h].Name;else if(a[0]&&a[0][h])V+=a[0][h].Name;else{var se=(op(a,K,i)||"").split(";;");se[h-1]?V=se[h-1]:V+="SH33TJSERRX"}o.push(V);break}q||(q={Name:"SH33TJSERRY"}),o.push(q.Name);break;case"PtgParen":var ge="(",oe=")";if(u>=0){switch(_="",t[0][u][1][0]){case 2:ge=ft(" ",t[0][u][1][1])+ge;break;case 3:ge=ft("\r",t[0][u][1][1])+ge;break;case 4:oe=ft(" ",t[0][u][1][1])+oe;break;case 5:oe=ft("\r",t[0][u][1][1])+oe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][u][1][0])}u=-1}o.push(ge+o.pop()+oe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var Ee={c:e.c,r:e.r};if(a.sharedf[Oe(d)]){var xe=a.sharedf[Oe(d)];o.push(ir(xe,s,Ee,a,i))}else{var He=!1;for(l=0;l!=a.arrayf.length;++l)if(c=a.arrayf[l],!(d.c<c[0].s.c||d.c>c[0].e.c)&&!(d.r<c[0].s.r||d.r>c[0].e.r)){o.push(ir(c[1],s,Ee,a,i)),He=!0;break}He||o.push(w[1])}break;case"PtgArray":o.push("{"+Qb(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":u=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&u>=0&&pe.indexOf(t[0][E][0])==-1){w=t[0][u];var we=!0;switch(w[1][0]){case 4:we=!1;case 0:_=ft(" ",w[1][1]);break;case 5:we=!1;case 1:_=ft("\r",w[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((we?_:"")+o.pop()+(we?"":_)),u=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function tC(t,r,e){var a=t.l+r,i=e.biff==2?1:2,n,s=t.read_shift(i);if(s==65535)return[[],cr(t,r-2)];var o=$s(t,s,e);return r!==s+i&&(n=Ys(t,r-s-i,o,e)),t.l=a,[o,n]}function rC(t,r,e){var a=t.l+r,i=e.biff==2?1:2,n,s=t.read_shift(i);if(s==65535)return[[],cr(t,r-2)];var o=$s(t,s,e);return r!==s+i&&(n=Ys(t,r-s-i,o,e)),t.l=a,[o,n]}function aC(t,r,e,a){var i=t.l+r,n=$s(t,a,e),s;return i!==t.l&&(s=Ys(t,i-t.l,n,e)),[n,s]}function iC(t,r,e){var a=t.l+r,i,n=t.read_shift(2),s=$s(t,n,e);return n==65535?[[],cr(t,r-2)]:(r!==n+2&&(i=Ys(t,a-n-2,s,e)),[s,i])}function nC(t){var r;if(Fa(t,t.l+6)!==65535)return[sr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return r=t[t.l+2]===1,t.l+=8,[r,"b"];case 2:return r=t[t.l+2],t.l+=8,[r,"e"];case 3:return t.l+=8,["","s"]}return[]}function sC(t){if(t==null){var r=Z(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof t=="number")return Ni(t);return Ni(0)}function Yc(t,r,e){var a=t.l+r,i=wa(t,6);e.biff==2&&++t.l;var n=nC(t,8),s=t.read_shift(1);e.biff!=2&&(t.read_shift(1),e.biff>=5&&t.read_shift(4));var o=rC(t,a-t.l,e);return{cell:i,val:n[0],formula:o,shared:s>>3&1,tt:n[1]}}function oC(t,r,e,a,i){var n=Bi(r,e,i),s=sC(t.v),o=Z(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=Z(t.bf.length),d=0;d<t.bf.length;++d)c[d]=t.bf[d];var f=Wt([n,s,o,c]);return f}function Pl(t,r,e){var a=t.read_shift(4),i=$s(t,a,e),n=t.read_shift(4),s=n>0?Ys(t,n,i,e):null;return[i,s]}var lC=Pl,Rl=Pl,cC=Pl,dC=Pl,fC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},lp={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},uC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function xh(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,e){return e.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function hC(t){var r="of:="+t.replace(W0,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function $c(t){var r=t.split(":"),e=r[0].split(".")[0];return[e,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function mC(t){return t.replace(/\./,"!")}var Cs={},In={},ks=typeof Map<"u";function Y0(t,r,e){var a=0,i=t.length;if(e){if(ks?e.has(r):Object.prototype.hasOwnProperty.call(e,r)){for(var n=ks?e.get(r):e[r];a<n.length;++a)if(t[n[a]].t===r)return t.Count++,n[a]}}else for(;a<i;++a)if(t[a].t===r)return t.Count++,a;return t[i]={t:r},t.Count++,t.Unique++,e&&(ks?(e.has(r)||e.set(r,[]),e.get(r).push(i)):(Object.prototype.hasOwnProperty.call(e,r)||(e[r]=[]),e[r].push(i))),i}function Nl(t,r){var e={min:t+1,max:t+1},a=-1;return r.MDW&&(nr=r.MDW),r.width!=null?e.customWidth=1:r.wpx!=null?a=Ns(r.wpx):r.wch!=null&&(a=r.wch),a>-1?(e.width=kl(a),e.customWidth=1):r.width!=null&&(e.width=r.width),r.hidden&&(e.hidden=!0),r.level!=null&&(e.outlineLevel=e.level=r.level),e}function Ii(t,r){if(t){var e=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(e=[1,1,1,1,.5,.5]),t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function _i(t,r,e){var a=e.revssf[r.z!=null?r.z:"General"],i=60,n=t.length;if(a==null&&e.ssf){for(;i<392;++i)if(e.ssf[i]==null){Ma(r.z,i),e.ssf[i]=r.z,e.revssf[r.z]=a=i;break}}for(i=0;i!=n;++i)if(t[i].numFmtId===a)return i;return t[n]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},n}function cp(t,r,e,a,i,n){try{a.cellNF&&(t.z=Fe[r])}catch(o){if(a.WTF)throw o}if(!(t.t==="z"&&!a.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=nt(t.v)),(!a||a.cellText!==!1)&&t.t!=="z")try{if(Fe[r]==null&&Ma(f1[r]||"General",r),t.t==="e")t.w=t.w||La[t.v];else if(r===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=As(t.v);else if(t.t==="d"){var s=Lt(t.v);(s|0)===s?t.w=s.toString(10):t.w=As(s)}else{if(t.v===void 0)return"";t.w=Pi(t.v,In)}else t.t==="d"?t.w=jr(r,Lt(t.v),In):t.w=jr(r,t.v,In)}catch(o){if(a.WTF)throw o}if(a.cellStyles&&e!=null)try{t.s=n.Fills[e],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Cl(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),a.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Cl(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),a.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(a.WTF&&n.Fills)throw o}}}function pC(t,r,e){if(t&&t["!ref"]){var a=Xe(t["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+e+"): "+t["!ref"])}}function _C(t,r){var e=Xe(r);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(t["!ref"]=Ne(e))}var gC=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,xC=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,vC=/<(?:\w:)?hyperlink [^>]*>/mg,wC=/"(\w*:\w*)"/,yC=/<(?:\w:)?col\b[^>]*[\/]?>/g,bC=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,CC=/<(?:\w:)?pageMargins[^>]*\/>/g,dp=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,kC=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,EC=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function SC(t,r,e,a,i,n,s){if(!t)return t;a||(a={"!id":{}}),ht!=null&&r.dense==null&&(r.dense=ht);var o=r.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",f=t.match(xC);f?(c=t.slice(0,f.index),d=t.slice(f.index+f[0].length)):c=d=t;var h=c.match(dp);h?$0(h[0],o,i,e):(h=c.match(kC))&&TC(h[0],h[1]||"",o,i,e,s,n);var m=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var p=c.slice(m,m+50).match(wC);p&&_C(o,p[1])}var u=c.match(EC);u&&u[1]&&HC(u[1],i);var _=[];if(r.cellStyles){var E=c.match(yC);E&&NC(_,E)}f&&zC(f[1],o,r,l,n,s);var k=d.match(bC);k&&(o["!autofilter"]=BC(k[0]));var w=[],L=d.match(gC);if(L)for(m=0;m!=L.length;++m)w[m]=Xe(L[m].slice(L[m].indexOf('"')+1));var U=d.match(vC);U&&IC(o,U,a);var R=d.match(CC);if(R&&(o["!margins"]=PC(Me(R[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Ne(l)),r.sheetRows>0&&o["!ref"]){var T=Xe(o["!ref"]);r.sheetRows<=+T.e.r&&(T.e.r=r.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ne(T))}return _.length>0&&(o["!cols"]=_),w.length>0&&(o["!merges"]=w),o}function DC(t){if(t.length===0)return"";for(var r='<mergeCells count="'+t.length+'">',e=0;e!=t.length;++e)r+='<mergeCell ref="'+Ne(t[e])+'"/>';return r+"</mergeCells>"}function $0(t,r,e,a){var i=Me(t);e.Sheets[a]||(e.Sheets[a]={}),i.codeName&&(e.Sheets[a].CodeName=$e(rt(i.codeName)))}function TC(t,r,e,a,i){$0(t.slice(0,t.indexOf(">")),e,a,i)}function AC(t,r,e,a,i){var n=!1,s={},o=null;if(a.bookType!=="xlsx"&&r.vbaraw){var l=r.SheetNames[e];try{r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}n=!0,s.codeName=ga(et(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+le("outlinePr",null,c)}!n&&!o||(i[i.length]=le("sheetPr",o,s))}var FC=["objects","scenarios","selectLockedCells","selectUnlockedCells"],OC=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function MC(t){var r={sheet:1};return FC.forEach(function(e){t[e]!=null&&t[e]&&(r[e]="1")}),OC.forEach(function(e){t[e]!=null&&!t[e]&&(r[e]="0")}),t.password&&(r.password=V0(t.password).toString(16).toUpperCase()),le("sheetProtection",null,r)}function IC(t,r,e){for(var a=Array.isArray(t),i=0;i!=r.length;++i){var n=Me(rt(r[i]),!0);if(!n.ref)return;var s=((e||{})["!id"]||[])[n.id];s?(n.Target=s.Target,n.location&&(n.Target+="#"+$e(n.location))):(n.Target="#"+$e(n.location),s={Target:n.Target,TargetMode:"Internal"}),n.Rel=s,n.tooltip&&(n.Tooltip=n.tooltip,delete n.tooltip);for(var o=Xe(n.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var d=Oe({c,r:l});a?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=n):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=n)}}}function PC(t){var r={};return["left","right","top","bottom","header","footer"].forEach(function(e){t[e]&&(r[e]=parseFloat(t[e]))}),r}function RC(t){return Ii(t),le("pageMargins",null,t)}function NC(t,r){for(var e=!1,a=0;a!=r.length;++a){var i=Me(r[a],!0);i.hidden&&(i.hidden=it(i.hidden));var n=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!e&&i.width&&(e=!0,U0(i.width)),fi(i);n<=s;)t[n++]=st(i)}}function LC(t,r){for(var e=["<cols>"],a,i=0;i!=r.length;++i)(a=r[i])&&(e[e.length]=le("col",null,Nl(i,a)));return e[e.length]="</cols>",e.join("")}function BC(t){var r={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return r}function VC(t,r,e,a){var i=typeof t.ref=="string"?t.ref:Ne(t.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var n=e.Workbook.Names,s=br(i);s.s.r==s.e.r&&(s.e.r=br(r["!ref"]).e.r,i=Ne(s));for(var o=0;o<n.length;++o){var l=n[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==a){l.Ref="'"+e.SheetNames[a]+"'!"+i;break}}return o==n.length&&n.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+e.SheetNames[a]+"'!"+i}),le("autoFilter",null,{ref:i})}var UC=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function HC(t,r){r.Views||(r.Views=[{}]),(t.match(UC)||[]).forEach(function(e,a){var i=Me(e);r.Views[a]||(r.Views[a]={}),+i.zoomScale&&(r.Views[a].zoom=+i.zoomScale),it(i.rightToLeft)&&(r.Views[a].RTL=!0)})}function WC(t,r,e,a){var i={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),le("sheetViews",le("sheetView",null,i),{})}function GC(t,r,e,a){if(t.c&&e["!comments"].push([r,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",n=t.t,s=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=La[t.v];break;case"d":a&&a.cellDates?i=nt(t.v,-1).toISOString():(t=st(t),t.t="n",i=""+(t.v=Lt(nt(t.v)))),typeof t.z>"u"&&(t.z=Fe[14]);break;default:i=t.v;break}var o=Xt("v",et(i)),l={r},c=_i(a.cellXfs,t,a);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){o=Xt("v",""+Y0(a.Strings,t.v,a.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=n&&(t.t=n,t.v=s),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,r.length)==r?{t:"array",ref:t.F}:null;o=le("f",et(t.f),d)+(t.v!=null?o:"")}return t.l&&e["!links"].push([r,t.l]),t.D&&(l.cm=1),le("c",o,l)}var zC=function(){var t=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,n=Fs("v"),s=Fs("f");return function(l,c,d,f,h,m){for(var p=0,u="",_=[],E=[],k=0,w=0,L=0,U="",R,T,B=0,N=0,K,q,V=0,se=0,ge=Array.isArray(m.CellXf),oe,Ee=[],xe=[],He=Array.isArray(c),pe=[],we={},ee=!1,O=!!d.sheetStubs,G=l.split(r),I=0,M=G.length;I!=M;++I){u=G[I].trim();var J=u.length;if(J!==0){var ue=0;e:for(p=0;p<J;++p)switch(u[p]){case">":if(u[p-1]!="/"){++p;break e}if(d&&d.cellStyles){if(T=Me(u.slice(ue,p),!0),B=T.r!=null?parseInt(T.r,10):B+1,N=-1,d.sheetRows&&d.sheetRows<B)continue;we={},ee=!1,T.ht&&(ee=!0,we.hpt=parseFloat(T.ht),we.hpx=Ln(we.hpt)),T.hidden=="1"&&(ee=!0,we.hidden=!0),T.outlineLevel!=null&&(ee=!0,we.level=+T.outlineLevel),ee&&(pe[B-1]=we)}break;case"<":ue=p;break}if(ue>=p)break;if(T=Me(u.slice(ue,p),!0),B=T.r!=null?parseInt(T.r,10):B+1,N=-1,!(d.sheetRows&&d.sheetRows<B)){f.s.r>B-1&&(f.s.r=B-1),f.e.r<B-1&&(f.e.r=B-1),d&&d.cellStyles&&(we={},ee=!1,T.ht&&(ee=!0,we.hpt=parseFloat(T.ht),we.hpx=Ln(we.hpt)),T.hidden=="1"&&(ee=!0,we.hidden=!0),T.outlineLevel!=null&&(ee=!0,we.level=+T.outlineLevel),ee&&(pe[B-1]=we)),_=u.slice(p).split(t);for(var ie=0;ie!=_.length&&_[ie].trim().charAt(0)=="<";++ie);for(_=_.slice(ie),p=0;p!=_.length;++p)if(u=_[p].trim(),u.length!==0){if(E=u.match(e),k=p,w=0,L=0,u="<c "+(u.slice(0,1)=="<"?">":"")+u,E!=null&&E.length===2){for(k=0,U=E[1],w=0;w!=U.length&&!((L=U.charCodeAt(w)-64)<1||L>26);++w)k=26*k+L;--k,N=k}else++N;for(w=0;w!=u.length&&u.charCodeAt(w)!==62;++w);if(++w,T=Me(u.slice(0,w),!0),T.r||(T.r=Oe({r:B-1,c:N})),U=u.slice(w),R={t:""},(E=U.match(n))!=null&&E[1]!==""&&(R.v=$e(E[1])),d.cellFormula){if((E=U.match(s))!=null&&E[1]!==""){if(R.f=$e(rt(E[1])).replace(/\r\n/g,`
`),d.xlfn||(R.f=mh(R.f)),E[0].indexOf('t="array"')>-1)R.F=(U.match(i)||[])[1],R.F.indexOf(":")>-1&&Ee.push([Xe(R.F),R.F]);else if(E[0].indexOf('t="shared"')>-1){q=Me(E[0]);var ne=$e(rt(E[1]));d.xlfn||(ne=mh(ne)),xe[parseInt(q.si,10)]=[q,ne,T.r]}}else(E=U.match(/<f[^>]*\/>/))&&(q=Me(E[0]),xe[q.si]&&(R.f=Uy(xe[q.si][1],xe[q.si][2],T.r)));var te=ct(T.r);for(w=0;w<Ee.length;++w)te.r>=Ee[w][0].s.r&&te.r<=Ee[w][0].e.r&&te.c>=Ee[w][0].s.c&&te.c<=Ee[w][0].e.c&&(R.F=Ee[w][1])}if(T.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(O)R.t="z";else continue;else R.t=T.t||"n";switch(f.s.c>N&&(f.s.c=N),f.e.c<N&&(f.e.c=N),R.t){case"n":if(R.v==""||R.v==null){if(!O)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!O)continue;R.t="z"}else K=Cs[parseInt(R.v,10)],R.v=K.t,R.r=K.r,d.cellHTML&&(R.h=K.h);break;case"str":R.t="s",R.v=R.v!=null?rt(R.v):"",d.cellHTML&&(R.h=w0(R.v));break;case"inlineStr":E=U.match(a),R.t="s",E!=null&&(K=B0(E[1]))?(R.v=K.t,d.cellHTML&&(R.h=K.h)):R.v="";break;case"b":R.v=it(R.v);break;case"d":d.cellDates?R.v=nt(R.v,1):(R.v=Lt(nt(R.v,1)),R.t="n");break;case"e":(!d||d.cellText!==!1)&&(R.w=R.v),R.v=um[R.v];break}if(V=se=0,oe=null,ge&&T.s!==void 0&&(oe=m.CellXf[T.s],oe!=null&&(oe.numFmtId!=null&&(V=oe.numFmtId),d.cellStyles&&oe.fillId!=null&&(se=oe.fillId))),cp(R,V,se,d,h,m),d.cellDates&&ge&&R.t=="n"&&Bn(Fe[V])&&(R.t="d",R.v=Ol(R.v)),T.cm&&d.xlmeta){var Re=(d.xlmeta.Cell||[])[+T.cm-1];Re&&Re.type=="XLDAPR"&&(R.D=!0)}if(He){var F=ct(T.r);c[F.r]||(c[F.r]=[]),c[F.r][F.c]=R}else c[T.r]=R}}}}pe.length>0&&(c["!rows"]=pe)}}();function YC(t,r,e,a){var i=[],n=[],s=Xe(t["!ref"]),o="",l,c="",d=[],f=0,h=0,m=t["!rows"],p=Array.isArray(t),u={r:c},_,E=-1;for(h=s.s.c;h<=s.e.c;++h)d[h]=lt(h);for(f=s.s.r;f<=s.e.r;++f){for(n=[],c=kt(f),h=s.s.c;h<=s.e.c;++h){l=d[h]+c;var k=p?(t[f]||[])[h]:t[l];k!==void 0&&(o=GC(k,l,t,r,e,a))!=null&&n.push(o)}(n.length>0||m&&m[f])&&(u={r:c},m&&m[f]&&(_=m[f],_.hidden&&(u.hidden=1),E=-1,_.hpx?E=Ls(_.hpx):_.hpt&&(E=_.hpt),E>-1&&(u.ht=E,u.customHeight=1),_.level&&(u.outlineLevel=_.level)),i[i.length]=le("row",n.join(""),u))}if(m)for(;f<m.length;++f)m&&m[f]&&(u={r:f+1},_=m[f],_.hidden&&(u.hidden=1),E=-1,_.hpx?E=Ls(_.hpx):_.hpt&&(E=_.hpt),E>-1&&(u.ht=E,u.customHeight=1),_.level&&(u.outlineLevel=_.level),i[i.length]=le("row","",u));return i.join("")}function fp(t,r,e,a){var i=[Et,le("worksheet",null,{xmlns:Ui[0],"xmlns:r":Nt.r})],n=e.SheetNames[t],s=0,o="",l=e.Sheets[n];l==null&&(l={});var c=l["!ref"]||"A1",d=Xe(c);if(d.e.c>16383||d.e.r>1048575){if(r.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=Ne(d)}a||(a={}),l["!comments"]=[];var f=[];AC(l,e,t,r,i),i[i.length]=le("dimension",null,{ref:c}),i[i.length]=WC(l,r,t,e),r.sheetFormat&&(i[i.length]=le("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=LC(l,l["!cols"])),i[s=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=YC(l,r,t,e,a),o.length>0&&(i[i.length]=o)),i.length>s+1&&(i[i.length]="</sheetData>",i[s]=i[s].replace("/>",">")),l["!protect"]&&(i[i.length]=MC(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=VC(l["!autofilter"],l,e,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=DC(l["!merges"]));var h=-1,m,p=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(u){u[1].Target&&(m={ref:u[0]},u[1].Target.charAt(0)!="#"&&(p=Je(a,-1,et(u[1].Target).replace(/#.*$/,""),Be.HLINK),m["r:id"]="rId"+p),(h=u[1].Target.indexOf("#"))>-1&&(m.location=et(u[1].Target.slice(h+1))),u[1].Tooltip&&(m.tooltip=et(u[1].Tooltip)),i[i.length]=le("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=RC(l["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(i[i.length]=Xt("ignoredErrors",le("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(p=Je(a,-1,"../drawings/drawing"+(t+1)+".xml",Be.DRAW),i[i.length]=le("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=f),l["!comments"].length>0&&(p=Je(a,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Be.VML),i[i.length]=le("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function $C(t,r){var e={},a=t.l+r;e.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var n=t.read_shift(1);return t.l=a,n&7&&(e.level=n&7),n&16&&(e.hidden=!0),n&32&&(e.hpt=i/20),e}function XC(t,r,e){var a=Z(145),i=(e["!rows"]||[])[t]||{};a.write_shift(4,t),a.write_shift(4,0);var n=320;i.hpx?n=Ls(i.hpx)*20:i.hpt&&(n=i.hpt*20),a.write_shift(2,n),a.write_shift(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),a.write_shift(1,s),a.write_shift(1,0);var o=0,l=a.l;a.l+=4;for(var c={r:t,c:0},d=0;d<16;++d)if(!(r.s.c>d+1<<10||r.e.c<d<<10)){for(var f=-1,h=-1,m=d<<10;m<d+1<<10;++m){c.c=m;var p=Array.isArray(e)?(e[c.r]||[])[c.c]:e[Oe(c)];p&&(f<0&&(f=m),h=m)}f<0||(++o,a.write_shift(4,f),a.write_shift(4,h))}var u=a.l;return a.l=l,a.write_shift(4,o),a.l=u,a.length>a.l?a.slice(0,a.l):a}function jC(t,r,e,a){var i=XC(a,e,r);(i.length>17||(r["!rows"]||[])[a])&&re(t,0,i)}var KC=zi,qC=Wn;function ZC(){}function QC(t,r){var e={},a=t[t.l];return++t.l,e.above=!(a&64),e.left=!(a&128),t.l+=18,e.name=tx(t,r-19),e}function JC(t,r,e){e==null&&(e=Z(84+4*t.length));var a=192;r&&(r.above&&(a&=-65),r.left&&(a&=-129)),e.write_shift(1,a);for(var i=1;i<3;++i)e.write_shift(1,0);return wl({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),om(t,e),e.slice(0,e.l)}function ek(t){var r=Kr(t);return[r]}function tk(t,r,e){return e==null&&(e=Z(8)),Hi(r,e)}function rk(t){var r=Wi(t);return[r]}function ak(t,r,e){return e==null&&(e=Z(4)),Gi(r,e)}function ik(t){var r=Kr(t),e=t.read_shift(1);return[r,e,"b"]}function nk(t,r,e){return e==null&&(e=Z(9)),Hi(r,e),e.write_shift(1,t.v?1:0),e}function sk(t){var r=Wi(t),e=t.read_shift(1);return[r,e,"b"]}function ok(t,r,e){return e==null&&(e=Z(5)),Gi(r,e),e.write_shift(1,t.v?1:0),e}function lk(t){var r=Kr(t),e=t.read_shift(1);return[r,e,"e"]}function ck(t,r,e){return e==null&&(e=Z(9)),Hi(r,e),e.write_shift(1,t.v),e}function dk(t){var r=Wi(t),e=t.read_shift(1);return[r,e,"e"]}function fk(t,r,e){return e==null&&(e=Z(8)),Gi(r,e),e.write_shift(1,t.v),e.write_shift(2,0),e.write_shift(1,0),e}function uk(t){var r=Kr(t),e=t.read_shift(4);return[r,e,"s"]}function hk(t,r,e){return e==null&&(e=Z(12)),Hi(r,e),e.write_shift(4,r.v),e}function mk(t){var r=Wi(t),e=t.read_shift(4);return[r,e,"s"]}function pk(t,r,e){return e==null&&(e=Z(8)),Gi(r,e),e.write_shift(4,r.v),e}function _k(t){var r=Kr(t),e=sr(t);return[r,e,"n"]}function gk(t,r,e){return e==null&&(e=Z(16)),Hi(r,e),Ni(t.v,e),e}function up(t){var r=Wi(t),e=sr(t);return[r,e,"n"]}function xk(t,r,e){return e==null&&(e=Z(12)),Gi(r,e),Ni(t.v,e),e}function vk(t){var r=Kr(t),e=I0(t);return[r,e,"n"]}function wk(t,r,e){return e==null&&(e=Z(12)),Hi(r,e),lm(t.v,e),e}function yk(t){var r=Wi(t),e=I0(t);return[r,e,"n"]}function bk(t,r,e){return e==null&&(e=Z(8)),Gi(r,e),lm(t.v,e),e}function Ck(t){var r=Kr(t),e=F0(t);return[r,e,"is"]}function kk(t){var r=Kr(t),e=lr(t);return[r,e,"str"]}function Ek(t,r,e){return e==null&&(e=Z(12+4*t.v.length)),Hi(r,e),Gt(t.v,e),e.length>e.l?e.slice(0,e.l):e}function Sk(t){var r=Wi(t),e=lr(t);return[r,e,"str"]}function Dk(t,r,e){return e==null&&(e=Z(8+4*t.v.length)),Gi(r,e),Gt(t.v,e),e.length>e.l?e.slice(0,e.l):e}function Tk(t,r,e){var a=t.l+r,i=Kr(t);i.r=e["!row"];var n=t.read_shift(1),s=[i,n,"b"];if(e.cellFormula){t.l+=2;var o=Rl(t,a-t.l,e);s[3]=ir(o,null,i,e.supbooks,e)}else t.l=a;return s}function Ak(t,r,e){var a=t.l+r,i=Kr(t);i.r=e["!row"];var n=t.read_shift(1),s=[i,n,"e"];if(e.cellFormula){t.l+=2;var o=Rl(t,a-t.l,e);s[3]=ir(o,null,i,e.supbooks,e)}else t.l=a;return s}function Fk(t,r,e){var a=t.l+r,i=Kr(t);i.r=e["!row"];var n=sr(t),s=[i,n,"n"];if(e.cellFormula){t.l+=2;var o=Rl(t,a-t.l,e);s[3]=ir(o,null,i,e.supbooks,e)}else t.l=a;return s}function Ok(t,r,e){var a=t.l+r,i=Kr(t);i.r=e["!row"];var n=lr(t),s=[i,n,"str"];if(e.cellFormula){t.l+=2;var o=Rl(t,a-t.l,e);s[3]=ir(o,null,i,e.supbooks,e)}else t.l=a;return s}var Mk=zi,Ik=Wn;function Pk(t,r){return r==null&&(r=Z(4)),r.write_shift(4,t),r}function Rk(t,r){var e=t.l+r,a=zi(t,16),i=O0(t),n=lr(t),s=lr(t),o=lr(t);t.l=e;var l={rfx:a,relId:i,loc:n,display:o};return s&&(l.Tooltip=s),l}function Nk(t,r){var e=Z(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Wn({s:ct(t[0]),e:ct(t[0])},e),M0("rId"+r,e);var a=t[1].Target.indexOf("#"),i=a==-1?"":t[1].Target.slice(a+1);return Gt(i||"",e),Gt(t[1].Tooltip||"",e),Gt("",e),e.slice(0,e.l)}function Lk(){}function Bk(t,r,e){var a=t.l+r,i=cm(t,16),n=t.read_shift(1),s=[i];if(s[2]=n,e.cellFormula){var o=lC(t,a-t.l,e);s[1]=o}else t.l=a;return s}function Vk(t,r,e){var a=t.l+r,i=zi(t,16),n=[i];if(e.cellFormula){var s=dC(t,a-t.l,e);n[1]=s,t.l=a}else t.l=a;return n}function Uk(t,r,e){e==null&&(e=Z(18));var a=Nl(t,r);e.write_shift(-4,t),e.write_shift(-4,t),e.write_shift(4,(a.width||10)*256),e.write_shift(4,0);var i=0;return r.hidden&&(i|=1),typeof a.width=="number"&&(i|=2),r.level&&(i|=r.level<<8),e.write_shift(2,i),e}var hp=["left","right","top","bottom","header","footer"];function Hk(t){var r={};return hp.forEach(function(e){r[e]=sr(t,8)}),r}function Wk(t,r){return r==null&&(r=Z(6*8)),Ii(t),hp.forEach(function(e){Ni(t[e],r)}),r}function Gk(t){var r=t.read_shift(2);return t.l+=28,{RTL:r&32}}function zk(t,r,e){e==null&&(e=Z(30));var a=924;return(((r||{}).Views||[])[0]||{}).RTL&&(a|=32),e.write_shift(2,a),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function Yk(t){var r=Z(24);return r.write_shift(4,4),r.write_shift(4,1),Wn(t,r),r}function $k(t,r){return r==null&&(r=Z(16*4+2)),r.write_shift(2,t.password?V0(t.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?r.write_shift(4,t[e[0]]!=null&&!t[e[0]]?1:0):r.write_shift(4,t[e[0]]!=null&&t[e[0]]?0:1)}),r}function Xk(){}function jk(){}function Kk(t,r,e,a,i,n,s){if(!t)return t;var o=r||{};a||(a={"!id":{}}),ht!=null&&o.dense==null&&(o.dense=ht);var l=o.dense?[]:{},c,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=[],h=!1,m=!1,p,u,_,E,k,w,L,U,R,T=[];o.biff=12,o["!row"]=0;var B=0,N=!1,K=[],q={},V=o.supbooks||i.supbooks||[[]];if(V.sharedf=q,V.arrayf=K,V.SheetNames=i.SheetNames||i.Sheets.map(function(we){return we.name}),!o.supbooks&&(o.supbooks=V,i.Names))for(var se=0;se<i.Names.length;++se)V[0][se+1]=i.Names[se];var ge=[],oe=[],Ee=!1;Bs[16]={n:"BrtShortReal",f:up};var xe,He;if(Na(t,function(ee,O,G){if(!m)switch(G){case 148:c=ee;break;case 0:p=ee,o.sheetRows&&o.sheetRows<=p.r&&(m=!0),U=kt(E=p.r),o["!row"]=p.r,(ee.hidden||ee.hpt||ee.level!=null)&&(ee.hpt&&(ee.hpx=Ln(ee.hpt)),oe[ee.r]=ee);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:ee[2]},ee[2]){case"n":u.v=ee[1];break;case"s":L=Cs[ee[1]],u.v=L.t,u.r=L.r;break;case"b":u.v=!!ee[1];break;case"e":u.v=ee[1],o.cellText!==!1&&(u.w=La[u.v]);break;case"str":u.t="s",u.v=ee[1];break;case"is":u.t="s",u.v=ee[1].t;break}if((_=s.CellXf[ee[0].iStyleRef])&&cp(u,_.numFmtId,null,o,n,s),k=ee[0].c==-1?k+1:ee[0].c,o.dense?(l[E]||(l[E]=[]),l[E][k]=u):l[lt(k)+U]=u,o.cellFormula){for(N=!1,B=0;B<K.length;++B){var I=K[B];p.r>=I[0].s.r&&p.r<=I[0].e.r&&k>=I[0].s.c&&k<=I[0].e.c&&(u.F=Ne(I[0]),N=!0)}!N&&ee.length>3&&(u.f=ee[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>k&&(d.s.c=k),d.e.r<p.r&&(d.e.r=p.r),d.e.c<k&&(d.e.c=k),o.cellDates&&_&&u.t=="n"&&Bn(Fe[_.numFmtId])){var M=Ai(u.v);M&&(u.t="d",u.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}xe&&(xe.type=="XLDAPR"&&(u.D=!0),xe=void 0),He&&(He=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;u={t:"z",v:void 0},k=ee[0].c==-1?k+1:ee[0].c,o.dense?(l[E]||(l[E]=[]),l[E][k]=u):l[lt(k)+U]=u,d.s.r>p.r&&(d.s.r=p.r),d.s.c>k&&(d.s.c=k),d.e.r<p.r&&(d.e.r=p.r),d.e.c<k&&(d.e.c=k),xe&&(xe.type=="XLDAPR"&&(u.D=!0),xe=void 0),He&&(He=void 0);break;case 176:T.push(ee);break;case 49:xe=((o.xlmeta||{}).Cell||[])[ee-1];break;case 494:var J=a["!id"][ee.relId];for(J?(ee.Target=J.Target,ee.loc&&(ee.Target+="#"+ee.loc),ee.Rel=J):ee.relId==""&&(ee.Target="#"+ee.loc),E=ee.rfx.s.r;E<=ee.rfx.e.r;++E)for(k=ee.rfx.s.c;k<=ee.rfx.e.c;++k)o.dense?(l[E]||(l[E]=[]),l[E][k]||(l[E][k]={t:"z",v:void 0}),l[E][k].l=ee):(w=Oe({c:k,r:E}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=ee);break;case 426:if(!o.cellFormula)break;K.push(ee),R=o.dense?l[E][k]:l[lt(k)+U],R.f=ir(ee[1],d,{r:p.r,c:k},V,o),R.F=Ne(ee[0]);break;case 427:if(!o.cellFormula)break;q[Oe(ee[0].s)]=ee[1],R=o.dense?l[E][k]:l[lt(k)+U],R.f=ir(ee[1],d,{r:p.r,c:k},V,o);break;case 60:if(!o.cellStyles)break;for(;ee.e>=ee.s;)ge[ee.e--]={width:ee.w/256,hidden:!!(ee.flags&1),level:ee.level},Ee||(Ee=!0,U0(ee.w/256)),fi(ge[ee.e+1]);break;case 161:l["!autofilter"]={ref:Ne(ee)};break;case 476:l["!margins"]=ee;break;case 147:i.Sheets[e]||(i.Sheets[e]={}),ee.name&&(i.Sheets[e].CodeName=ee.name),(ee.above||ee.left)&&(l["!outline"]={above:ee.above,left:ee.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ee.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:f.push(G),h=!0;break;case 38:f.pop(),h=!1;break;default:if(!O.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+G.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(d.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Ne(c||d)),o.sheetRows&&l["!ref"]){var pe=Xe(l["!ref"]);o.sheetRows<=+pe.e.r&&(pe.e.r=o.sheetRows-1,pe.e.r>d.e.r&&(pe.e.r=d.e.r),pe.e.r<pe.s.r&&(pe.s.r=pe.e.r),pe.e.c>d.e.c&&(pe.e.c=d.e.c),pe.e.c<pe.s.c&&(pe.s.c=pe.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ne(pe))}return T.length>0&&(l["!merges"]=T),ge.length>0&&(l["!cols"]=ge),oe.length>0&&(l["!rows"]=oe),l}function qk(t,r,e,a,i,n,s){if(r.v===void 0)return!1;var o="";switch(r.t){case"b":o=r.v?"1":"0";break;case"d":r=st(r),r.z=r.z||Fe[14],r.v=Lt(nt(r.v)),r.t="n";break;case"n":case"e":o=""+r.v;break;default:o=r.v;break}var l={r:e,c:a};switch(l.s=_i(i.cellXfs,r,i),r.l&&n["!links"].push([Oe(l),r.l]),r.c&&n["!comments"].push([Oe(l),r.c]),r.t){case"s":case"str":return i.bookSST?(o=Y0(i.Strings,r.v,i.revStrings),l.t="s",l.v=o,s?re(t,18,pk(r,l)):re(t,7,hk(r,l))):(l.t="str",s?re(t,17,Dk(r,l)):re(t,6,Ek(r,l))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?s?re(t,13,bk(r,l)):re(t,2,wk(r,l)):s?re(t,16,xk(r,l)):re(t,5,gk(r,l)),!0;case"b":return l.t="b",s?re(t,15,ok(r,l)):re(t,4,nk(r,l)),!0;case"e":return l.t="e",s?re(t,14,fk(r,l)):re(t,3,ck(r,l)),!0}return s?re(t,12,ak(r,l)):re(t,1,tk(r,l)),!0}function Zk(t,r,e,a){var i=Xe(r["!ref"]||"A1"),n,s="",o=[];re(t,145);var l=Array.isArray(r),c=i.e.r;r["!rows"]&&(c=Math.max(i.e.r,r["!rows"].length-1));for(var d=i.s.r;d<=c;++d){s=kt(d),jC(t,r,i,d);var f=!1;if(d<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){d===i.s.r&&(o[h]=lt(h)),n=o[h]+s;var m=l?(r[d]||[])[h]:r[n];if(!m){f=!1;continue}f=qk(t,m,d,h,a,r,f)}}re(t,146)}function Qk(t,r){!r||!r["!merges"]||(re(t,177,Pk(r["!merges"].length)),r["!merges"].forEach(function(e){re(t,176,Ik(e))}),re(t,178))}function Jk(t,r){!r||!r["!cols"]||(re(t,390),r["!cols"].forEach(function(e,a){e&&re(t,60,Uk(a,e))}),re(t,391))}function eE(t,r){!r||!r["!ref"]||(re(t,648),re(t,649,Yk(Xe(r["!ref"]))),re(t,650))}function tE(t,r,e){r["!links"].forEach(function(a){if(a[1].Target){var i=Je(e,-1,a[1].Target.replace(/#.*$/,""),Be.HLINK);re(t,494,Nk(a,i))}}),delete r["!links"]}function rE(t,r,e,a){if(r["!comments"].length>0){var i=Je(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Be.VML);re(t,551,M0("rId"+i)),r["!legacy"]=i}}function aE(t,r,e,a){if(r["!autofilter"]){var i=r["!autofilter"],n=typeof i.ref=="string"?i.ref:Ne(i.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var s=e.Workbook.Names,o=br(n);o.s.r==o.e.r&&(o.e.r=br(r["!ref"]).e.r,n=Ne(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+e.SheetNames[a]+"'!"+n;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+e.SheetNames[a]+"'!"+n}),re(t,161,Wn(Xe(n))),re(t,162)}}function iE(t,r,e){re(t,133),re(t,137,zk(r,e)),re(t,138),re(t,134)}function nE(t,r){r["!protect"]&&re(t,535,$k(r["!protect"]))}function sE(t,r,e,a){var i=yr(),n=e.SheetNames[t],s=e.Sheets[n]||{},o=n;try{e&&e.Workbook&&(o=e.Workbook.Sheets[t].CodeName||o)}catch{}var l=Xe(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(r.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],re(i,129),(e.vbaraw||s["!outline"])&&re(i,147,JC(o,s["!outline"])),re(i,148,qC(l)),iE(i,s,e.Workbook),Jk(i,s,t,r,e),Zk(i,s,t,r,e),nE(i,s),aE(i,s,e,t),Qk(i,s),tE(i,s,a),s["!margins"]&&re(i,476,Wk(s["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&eE(i,s),rE(i,s,t,a),re(i,130),i.end()}function oE(t){var r=[],e=t.match(/^<c:numCache>/),a;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(n){var s=n.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(r[+s[1]]=e?+s[2]:s[2])});var i=$e((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(n){a=n.replace(/<.*?>/g,"")}),[r,i,a]}function lE(t,r,e,a,i,n){var s=n||{"!type":"chart"};if(!t)return n;var o=0,l=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=oE(f);d.s.r=d.s.c=0,d.e.c=o,c=lt(o),h[0].forEach(function(m,p){s[c+kt(p)]={t:"n",v:m,z:h[1]},l=p}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(s["!ref"]=Ne(d)),s}function cE(t,r,e,a,i){if(!t)return t;a||(a={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},s,o=t.match(dp);return o&&$0(o[0],n,i,e),(s=t.match(/drawing r:id="(.*?)"/))&&(n["!rel"]=s[1]),a["!id"][n["!rel"]]&&(n["!drawel"]=a["!id"][n["!rel"]]),n}function dE(t,r){t.l+=10;var e=lr(t,r-10);return{name:e}}function fE(t,r,e,a,i){if(!t)return t;a||(a={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},s=[],o=!1;return Na(t,function(c,d,f){switch(f){case 550:n["!rel"]=c;break;case 651:i.Sheets[e]||(i.Sheets[e]={}),c.name&&(i.Sheets[e].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(f);break;case 38:s.pop();break;default:if(d.T>0)s.push(f);else if(d.T<0)s.pop();else if(!o||r.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}},r),a["!id"][n["!rel"]]&&(n["!drawel"]=a["!id"][n["!rel"]]),n}var X0=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],uE=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],hE=[],mE=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function vh(t,r){for(var e=0;e!=t.length;++e)for(var a=t[e],i=0;i!=r.length;++i){var n=r[i];if(a[n[0]]==null)a[n[0]]=n[1];else switch(n[2]){case"bool":typeof a[n[0]]=="string"&&(a[n[0]]=it(a[n[0]]));break;case"int":typeof a[n[0]]=="string"&&(a[n[0]]=parseInt(a[n[0]],10));break}}}function wh(t,r){for(var e=0;e!=r.length;++e){var a=r[e];if(t[a[0]]==null)t[a[0]]=a[1];else switch(a[2]){case"bool":typeof t[a[0]]=="string"&&(t[a[0]]=it(t[a[0]]));break;case"int":typeof t[a[0]]=="string"&&(t[a[0]]=parseInt(t[a[0]],10));break}}}function mp(t){wh(t.WBProps,X0),wh(t.CalcPr,mE),vh(t.WBView,uE),vh(t.Sheets,hE),In.date1904=it(t.WBProps.date1904)}function pE(t){return!t.Workbook||!t.Workbook.WBProps?"false":it(t.Workbook.WBProps.date1904)?"true":"false"}var _E="][*?/\\".split("");function pp(t,r){if(t.length>31){if(r)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var e=!0;return _E.forEach(function(a){if(t.indexOf(a)!=-1){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");e=!1}}),e}function gE(t,r,e){t.forEach(function(a,i){pp(a);for(var n=0;n<i;++n)if(a==t[n])throw new Error("Duplicate Sheet Name: "+a);if(e){var s=r&&r[i]&&r[i].CodeName||a;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function xE(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var r=t.Workbook&&t.Workbook.Sheets||[];gE(t.SheetNames,r,!!t.vbaraw);for(var e=0;e<t.SheetNames.length;++e)pC(t.Sheets[t.SheetNames[e]],t.SheetNames[e],e)}var vE=/<\w+:workbook/;function wE(t,r){if(!t)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,i="xmlns",n={},s=0;if(t.replace(dr,function(l,c){var d=Me(l);switch(va(d[0])){case"<?xml":break;case"<workbook":l.match(vE)&&(i="xmlns"+l.match(/<(\w+):/)[1]),e.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],e.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":X0.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":e.WBProps[f[0]]=it(d[f[0]]);break;case"int":e.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:e.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(e.WBProps.CodeName=rt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],e.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=$e(rt(d.name)),delete d[0],e.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":n={},n.Name=rt(d.name),d.comment&&(n.Comment=d.comment),d.localSheetId&&(n.Sheet=+d.localSheetId),it(d.hidden||"0")&&(n.Hidden=!0),s=c+l.length;break;case"</definedName>":n.Ref=$e(rt(t.slice(s,c))),e.Names.push(n);break;case"<definedName/>":break;case"<calcPr":delete d[0],e.CalcPr=d;break;case"<calcPr/>":delete d[0],e.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&r.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),Ui.indexOf(e.xmlns)===-1)throw new Error("Unknown Namespace: "+e.xmlns);return mp(e),e}function _p(t){var r=[Et];r[r.length]=le("workbook",null,{xmlns:Ui[0],"xmlns:r":Nt.r});var e=t.Workbook&&(t.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(X0.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(a[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(a.codeName=t.Workbook.WBProps.CodeName,delete a.CodeName)),r[r.length]=le("workbookPr",null,a);var i=t.Workbook&&t.Workbook.Sheets||[],n=0;if(i&&i[0]&&i[0].Hidden){for(r[r.length]="<bookViews>",n=0;n!=t.SheetNames.length&&!(!i[n]||!i[n].Hidden);++n);n==t.SheetNames.length&&(n=0),r[r.length]='<workbookView firstSheet="'+n+'" activeTab="'+n+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",n=0;n!=t.SheetNames.length;++n){var s={name:et(t.SheetNames[n].slice(0,31))};if(s.sheetId=""+(n+1),s["r:id"]="rId"+(n+1),i[n])switch(i[n].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}r[r.length]=le("sheet",null,s)}return r[r.length]="</sheets>",e&&(r[r.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(r[r.length]=le("definedName",et(o.Ref),l))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function yE(t,r){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=e0(t,r-8),e.name=lr(t),e}function bE(t,r){return r||(r=Z(127)),r.write_shift(4,t.Hidden),r.write_shift(4,t.iTabID),M0(t.strRelID,r),Gt(t.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function CE(t,r){var e={},a=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var i=r>8?lr(t):"";return i.length>0&&(e.CodeName=i),e.autoCompressPictures=!!(a&65536),e.backupFile=!!(a&64),e.checkCompatibility=!!(a&4096),e.date1904=!!(a&1),e.filterPrivacy=!!(a&8),e.hidePivotFieldList=!!(a&1024),e.promptedSolutions=!!(a&16),e.publishItems=!!(a&2048),e.refreshAllConnections=!!(a&262144),e.saveExternalLinkValues=!!(a&128),e.showBorderUnselectedTables=!!(a&4),e.showInkAnnotation=!!(a&32),e.showObjects=["all","placeholders","none"][a>>13&3],e.showPivotChartFilter=!!(a&32768),e.updateLinks=["userSet","never","always"][a>>8&3],e}function kE(t,r){r||(r=Z(72));var e=0;return t&&t.filterPrivacy&&(e|=8),r.write_shift(4,e),r.write_shift(4,0),om(t&&t.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function EE(t,r){var e={};return t.read_shift(4),e.ArchID=t.read_shift(4),t.l+=r-8,e}function SE(t,r,e){var a=t.l+r;t.l+=4,t.l+=1;var i=t.read_shift(4),n=rx(t),s=cC(t,0,e),o=O0(t);t.l=a;var l={Name:n,Ptg:s};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function DE(t,r){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],i=!1;r||(r={}),r.biff=12;var n=[],s=[[]];return s.SheetNames=[],s.XTI=[],Bs[16]={n:"BrtFRTArchID$",f:EE},Na(t,function(l,c,d){switch(d){case 156:s.SheetNames.push(l.name),e.Sheets.push(l);break;case 153:e.WBProps=l;break;case 39:l.Sheet!=null&&(r.SID=l.Sheet),l.Ref=ir(l.Ptg,null,null,s,r),delete r.SID,delete l.Ptg,n.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([d,l]):s[0]=[d,l],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(l),s.XTI=s.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||r.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},r),mp(e),e.Names=n,e.supbooks=s,e}function TE(t,r){re(t,143);for(var e=0;e!=r.SheetNames.length;++e){var a=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[e]&&r.Workbook.Sheets[e].Hidden||0,i={Hidden:a,iTabID:e+1,strRelID:"rId"+(e+1),name:r.SheetNames[e]};re(t,156,bE(i))}re(t,144)}function AE(t,r){r||(r=Z(127));for(var e=0;e!=4;++e)r.write_shift(4,0);return Gt("SheetJS",r),Gt(Ds.version,r),Gt(Ds.version,r),Gt("7262",r),r.length>r.l?r.slice(0,r.l):r}function FE(t,r){r||(r=Z(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,t),r.write_shift(4,t);var e=120;return r.write_shift(1,e),r.length>r.l?r.slice(0,r.l):r}function OE(t,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var e=r.Workbook.Sheets,a=0,i=-1,n=-1;a<e.length;++a)!e[a]||!e[a].Hidden&&i==-1?i=a:e[a].Hidden==1&&n==-1&&(n=a);n>i||(re(t,135),re(t,158,FE(i)),re(t,136))}}function ME(t,r){var e=yr();return re(e,131),re(e,128,AE()),re(e,153,kE(t.Workbook&&t.Workbook.WBProps||null)),OE(e,t,r),TE(e,t,r),re(e,132),e.end()}function IE(t,r,e){return r.slice(-4)===".bin"?DE(t,e):wE(t,e)}function PE(t,r,e,a,i,n,s,o){return r.slice(-4)===".bin"?Kk(t,a,e,i,n,s,o):SC(t,a,e,i,n,s,o)}function RE(t,r,e,a,i,n,s,o){return r.slice(-4)===".bin"?fE(t,a,e,i,n,s,o):cE(t,a,e,i,n,s,o)}function NE(t,r,e,a,i,n,s,o){return r.slice(-4)===".bin"?By(t,a,e,i,n,s,o):Vy(t,a,e,i,n,s,o)}function LE(t,r,e,a,i,n,s,o){return r.slice(-4)===".bin"?Ny(t,a,e,i,n,s,o):Ly(t,a,e,i,n,s,o)}function BE(t,r,e,a){return r.slice(-4)===".bin"?Iw(t,e,a):yw(t,e,a)}function VE(t,r,e){return qm(t,e)}function UE(t,r,e){return r.slice(-4)===".bin"?U2(t,e):L2(t,e)}function HE(t,r,e){return r.slice(-4)===".bin"?Oy(t,e):by(t,e)}function WE(t,r,e){return r.slice(-4)===".bin"?vy(t,r,e):gy(t,r,e)}function GE(t,r,e,a){return e.slice(-4)===".bin"?wy(t,r,e,a):void 0}function zE(t,r,e){return r.slice(-4)===".bin"?my(t,r,e):_y(t,r,e)}function YE(t,r,e){return(r.slice(-4)===".bin"?ME:_p)(t,e)}function $E(t,r,e,a,i){return(r.slice(-4)===".bin"?sE:fp)(t,e,a,i)}function XE(t,r,e){return(r.slice(-4)===".bin"?Gw:jm)(t,e)}function jE(t,r,e){return(r.slice(-4)===".bin"?G2:Um)(t,e)}function KE(t,r,e){return(r.slice(-4)===".bin"?My:Jm)(t,e)}function qE(t){return(t.slice(-4)===".bin"?py:Zm)()}var gp=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,xp=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Qr(t,r){var e=t.split(/\s+/),a=[];if(r||(a[0]=e[0]),e.length===1)return a;var i=t.match(gp),n,s,o,l;if(i)for(l=0;l!=i.length;++l)n=i[l].match(xp),(s=n[1].indexOf(":"))===-1?a[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(s+1),a[o]=n[2].slice(1,n[2].length-1));return a}function ZE(t){var r=t.split(/\s+/),e={};if(r.length===1)return e;var a=t.match(gp),i,n,s,o;if(a)for(o=0;o!=a.length;++o)i=a[o].match(xp),(n=i[1].indexOf(":"))===-1?e[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?s="xmlns"+i[1].slice(6):s=i[1].slice(n+1),e[s]=i[2].slice(1,i[2].length-1));return e}var Es;function QE(t,r){var e=Es[t]||$e(t);return e==="General"?Pi(r):jr(e,r)}function JE(t,r,e,a){var i=a;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=it(a);break;case"i2":case"int":i=parseInt(a,10);break;case"r4":case"float":i=parseFloat(a);break;case"date":case"dateTime.tz":i=nt(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}t[$e(r)]=i}function eS(t,r,e){if(t.t!=="z"){if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||La[t.v]:r==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=As(t.v):t.w=Pi(t.v):t.w=QE(r||"General",t.v)}catch(n){if(e.WTF)throw n}try{var a=Es[r]||r||"General";if(e.cellNF&&(t.z=a),e.cellDates&&t.t=="n"&&Bn(a)){var i=Ai(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(n){if(e.WTF)throw n}}}function tS(t,r,e){if(e.cellStyles&&r.Interior){var a=r.Interior;a.Pattern&&(a.patternType=hw[a.Pattern]||a.Pattern)}t[r.ID]=r}function rS(t,r,e,a,i,n,s,o,l,c){var d="General",f=a.StyleID,h={};c=c||{};var m=[],p=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&s&&(f=s.StyleID);n[f]!==void 0&&(n[f].nf&&(d=n[f].nf),n[f].Interior&&m.push(n[f].Interior),!!n[f].Parent);)f=n[f].Parent;switch(e.Type){case"Boolean":a.t="b",a.v=it(t);break;case"String":a.t="s",a.r=Lu($e(t)),a.v=t.indexOf("<")>-1?$e(r||t).replace(/<.*?>/g,""):a.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),a.v=(nt(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=$e(t):a.v<60&&(a.v=a.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+t),a.t||(a.t="n");break;case"Error":a.t="e",a.v=um[t],c.cellText!==!1&&(a.w=t);break;default:t==""&&r==""?a.t="z":(a.t="s",a.v=Lu(r||t));break}if(eS(a,d,c),c.cellFormula!==!1)if(a.Formula){var u=$e(a.Formula);u.charCodeAt(0)==61&&(u=u.slice(1)),a.f=Mn(u,i),delete a.Formula,a.ArrayRange=="RC"?a.F=Mn("RC:RC",i):a.ArrayRange&&(a.F=Mn(a.ArrayRange,i),l.push([Xe(a.F),a.F]))}else for(p=0;p<l.length;++p)i.r>=l[p][0].s.r&&i.r<=l[p][0].e.r&&i.c>=l[p][0].s.c&&i.c<=l[p][0].e.c&&(a.F=l[p][1]);c.cellStyles&&(m.forEach(function(_){!h.patternType&&_.patternType&&(h.patternType=_.patternType)}),a.s=h),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function aS(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Xc(t,r){var e=r||{};Vn();var a=_s(y0(t));(e.type=="binary"||e.type=="array"||e.type=="base64")&&(typeof Ke<"u"?a=Ke.utils.decode(65001,Qc(a)):a=rt(a));var i=a.slice(0,1024).toLowerCase(),n=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var s=st(e);return s.type="string",Nn.to_workbook(a,s)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(pt){i.indexOf("<"+pt)>=0&&(n=!0)}),n)return WS(a,e);Es={"General Number":"General","General Date":Fe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Fe[15],"Short Date":Fe[14],"Long Time":Fe[19],"Medium Time":Fe[18],"Short Time":Fe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Fe[2],Standard:Fe[4],Percent:Fe[10],Scientific:Fe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c;ht!=null&&e.dense==null&&(e.dense=ht);var d={},f=[],h=e.dense?[]:{},m="",p={},u={},_=Qr('<Data ss:Type="String">'),E=0,k=0,w=0,L={s:{r:2e6,c:2e6},e:{r:0,c:0}},U={},R={},T="",B=0,N=[],K={},q={},V=0,se=[],ge=[],oe={},Ee=[],xe,He=!1,pe=[],we=[],ee={},O=0,G=0,I={Sheets:[],WBProps:{date1904:!1}},M={};Ms.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";o=Ms.exec(a);)switch(o[3]=(J=o[3]).toLowerCase()){case"data":if(J=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?rS(a.slice(E,o.index),T,_,l[l.length-1][0]=="comment"?oe:p,{c:k,r:w},U,Ee[k],u,pe,e):(T="",_=Qr(o[0]),E=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ge.length>0&&(p.c=ge),(!e.sheetRows||e.sheetRows>w)&&p.v!==void 0&&(e.dense?(h[w]||(h[w]=[]),h[w][k]=p):h[lt(k)+kt(w)]=p),p.HRef&&(p.l={Target:$e(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(O=k+(parseInt(p.MergeAcross,10)|0),G=w+(parseInt(p.MergeDown,10)|0),N.push({s:{c:k,r:w},e:{c:O,r:G}})),!e.sheetStubs)p.MergeAcross?k=O+1:++k;else if(p.MergeAcross||p.MergeDown){for(var ue=k;ue<=O;++ue)for(var ie=w;ie<=G;++ie)(ue>k||ie>w)&&(e.dense?(h[ie]||(h[ie]=[]),h[ie][ue]={t:"z"}):h[lt(ue)+kt(ie)]={t:"z"});k=O+1}else++k;else p=ZE(o[0]),p.Index&&(k=+p.Index-1),k<L.s.c&&(L.s.c=k),k>L.e.c&&(L.e.c=k),o[0].slice(-2)==="/>"&&++k,ge=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<L.s.r&&(L.s.r=w),w>L.e.r&&(L.e.r=w),o[0].slice(-2)==="/>"&&(u=Qr(o[0]),u.Index&&(w=+u.Index-1)),k=0,++w):(u=Qr(o[0]),u.Index&&(w=+u.Index-1),ee={},(u.AutoFitHeight=="0"||u.Height)&&(ee.hpx=parseInt(u.Height,10),ee.hpt=Ls(ee.hpx),we[w]=ee),u.Hidden=="1"&&(ee.hidden=!0,we[w]=ee));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(m),L.s.r<=L.e.r&&L.s.c<=L.e.c&&(h["!ref"]=Ne(L),e.sheetRows&&e.sheetRows<=L.e.r&&(h["!fullref"]=h["!ref"],L.e.r=e.sheetRows-1,h["!ref"]=Ne(L))),N.length&&(h["!merges"]=N),Ee.length>0&&(h["!cols"]=Ee),we.length>0&&(h["!rows"]=we),d[m]=h}else L={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=k=0,l.push([o[3],!1]),c=Qr(o[0]),m=$e(c.Name),h=e.dense?[]:{},N=[],pe=[],we=[],M={name:m,Hidden:0},I.Sheets.push(M);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Ee=[],He=!1}break;case"style":o[1]==="/"?tS(U,R,e):R=Qr(o[0]);break;case"numberformat":R.nf=$e(Qr(o[0]).Format||"General"),Es[R.nf]&&(R.nf=Es[R.nf]);for(var ne=0;ne!=392&&Fe[ne]!=R.nf;++ne);if(ne==392){for(ne=57;ne!=392;++ne)if(Fe[ne]==null){Ma(R.nf,ne);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(xe=Qr(o[0]),xe.Hidden&&(xe.hidden=!0,delete xe.Hidden),xe.Width&&(xe.wpx=parseInt(xe.Width,10)),!He&&xe.wpx>10){He=!0,nr=$m;for(var te=0;te<Ee.length;++te)Ee[te]&&fi(Ee[te])}He&&fi(xe),Ee[xe.Index-1||Ee.length]=xe;for(var Re=0;Re<+xe.Span;++Re)Ee[Ee.length]=st(xe);break;case"namedrange":if(o[1]==="/")break;I.Names||(I.Names=[]);var F=Me(o[0]),qe={Name:F.Name,Ref:Mn(F.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(qe.Sheet=I.Sheets.length-1),I.Names.push(qe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?T+=a.slice(B,o.index):B=o.index+o[0].length;break;case"interior":if(!e.cellStyles)break;R.Interior=Qr(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?Dx(K,J,a.slice(V,o.index)):V=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));aS(oe),ge.push(oe)}else l.push([o[3],!1]),c=Qr(o[0]),oe={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ge=Qr(o[0]);h["!autofilter"]={ref:Mn(Ge.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Eh(a,e);var Ze=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ze=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ze=!1}break;case"excelworkbook":switch(o[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ze=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ze=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(a.slice(V,o.index)){case"SheetHidden":M.Hidden=1;break;case"SheetVeryHidden":M.Hidden=2;break}else V=o.index+o[0].length;break;case"header":h["!margins"]||Ii(h["!margins"]={},"xlml"),isNaN(+Me(o[0]).Margin)||(h["!margins"].header=+Me(o[0]).Margin);break;case"footer":h["!margins"]||Ii(h["!margins"]={},"xlml"),isNaN(+Me(o[0]).Margin)||(h["!margins"].footer=+Me(o[0]).Margin);break;case"pagemargins":var ze=Me(o[0]);h["!margins"]||Ii(h["!margins"]={},"xlml"),isNaN(+ze.Top)||(h["!margins"].top=+ze.Top),isNaN(+ze.Left)||(h["!margins"].left=+ze.Left),isNaN(+ze.Right)||(h["!margins"].right=+ze.Right),isNaN(+ze.Bottom)||(h["!margins"].bottom=+ze.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ze=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ze=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ze=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ze=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ze=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ze=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ze=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ze=!1}break;case"smarttags":break;default:Ze=!1;break}if(Ze||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?JE(q,J,se,a.slice(V,o.index)):(se=o,V=o.index+o[0].length);break}if(e.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var _e={};return!e.bookSheets&&!e.bookProps&&(_e.Sheets=d),_e.SheetNames=f,_e.Workbook=I,_e.SSF=st(Fe),_e.Props=K,_e.Custprops=q,_e}function o0(t,r){switch(K0(r=r||{}),r.type||"base64"){case"base64":return Xc(Ir(t),r);case"binary":case"buffer":case"file":return Xc(t,r);case"array":return Xc(mi(t),r)}}function iS(t,r){var e=[];return t.Props&&e.push(Tx(t.Props,r)),t.Custprops&&e.push(Ax(t.Props,t.Custprops,r)),e.join("")}function nS(){return""}function sS(t,r){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(a,i){var n=[];n.push(le("NumberFormat",null,{"ss:Format":et(Fe[a.numFmtId])}));var s={"ss:ID":"s"+(21+i)};e.push(le("Style",n.join(""),s))}),le("Styles",e.join(""))}function vp(t){return le("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+G0(t.Ref,{r:0,c:0})})}function oS(t){if(!((t||{}).Workbook||{}).Names)return"";for(var r=t.Workbook.Names,e=[],a=0;a<r.length;++a){var i=r[a];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||e.push(vp(i)))}return le("Names",e.join(""))}function lS(t,r,e,a){if(!t||!((a||{}).Workbook||{}).Names)return"";for(var i=a.Workbook.Names,n=[],s=0;s<i.length;++s){var o=i[s];o.Sheet==e&&(o.Name.match(/^_xlfn\./)||n.push(vp(o)))}return n.join("")}function cS(t,r,e,a){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(le("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(le("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(le("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[e])if(a.Workbook.Sheets[e].Hidden)i.push(le("Visible",a.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var n=0;n<e&&!(a.Workbook.Sheets[n]&&!a.Workbook.Sheets[n].Hidden);++n);n==e&&i.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Xt("ProtectContents","True")),t["!protect"].objects&&i.push(Xt("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Xt("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Xt("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Xt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){t["!protect"][s[0]]&&i.push("<"+s[1]+"/>")})),i.length==0?"":le("WorksheetOptions",i.join(""),{xmlns:Fr.x})}function dS(t){return t.map(function(r){var e=F1(r.t||""),a=le("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return le("Comment",a,{"ss:Author":r.a})}).join("")}function fS(t,r,e,a,i,n,s){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+et(G0(t.f,s))),t.F&&t.F.slice(0,r.length)==r){var l=ct(t.F.slice(r.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=et(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=et(t.l.Tooltip))),e["!merges"])for(var c=e["!merges"],d=0;d!=c.length;++d)c[d].s.c!=s.c||c[d].s.r!=s.r||(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var f="",h="";switch(t.t){case"z":if(!a.sheetStubs)return"";break;case"n":f="Number",h=String(t.v);break;case"b":f="Boolean",h=t.v?"1":"0";break;case"e":f="Error",h=La[t.v];break;case"d":f="DateTime",h=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Fe[14]);break;case"s":f="String",h=A1(t.v||"");break}var m=_i(a.cellXfs,t,a);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=s.c+1;var p=t.v!=null?h:"",u=t.t=="z"?"":'<Data ss:Type="'+f+'">'+p+"</Data>";return(t.c||[]).length>0&&(u+=dS(t.c)),le("Cell",u,o)}function uS(t,r){var e='<Row ss:Index="'+(t+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Ln(r.hpt)),r.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(e+=' ss:Hidden="1"')),e+">"}function hS(t,r,e,a){if(!t["!ref"])return"";var i=Xe(t["!ref"]),n=t["!merges"]||[],s=0,o=[];t["!cols"]&&t["!cols"].forEach(function(_,E){fi(_);var k=!!_.width,w=Nl(E,_),L={"ss:Index":E+1};k&&(L["ss:Width"]=Rs(w.width)),_.hidden&&(L["ss:Hidden"]="1"),o.push(le("Column",null,L))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var d=[uS(c,(t["!rows"]||[])[c])],f=i.s.c;f<=i.e.c;++f){var h=!1;for(s=0;s!=n.length;++s)if(!(n[s].s.c>f)&&!(n[s].s.r>c)&&!(n[s].e.c<f)&&!(n[s].e.r<c)){(n[s].s.c!=f||n[s].s.r!=c)&&(h=!0);break}if(!h){var m={r:c,c:f},p=Oe(m),u=l?(t[c]||[])[f]:t[p];d.push(fS(u,p,t,r,e,a,m))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function mS(t,r,e){var a=[],i=e.SheetNames[t],n=e.Sheets[i],s=n?lS(n,r,t,e):"";return s.length>0&&a.push("<Names>"+s+"</Names>"),s=n?hS(n,r,t,e):"",s.length>0&&a.push("<Table>"+s+"</Table>"),a.push(cS(n,r,t,e)),a.join("")}function pS(t,r){r||(r={}),t.SSF||(t.SSF=st(Fe)),t.SSF&&(Vn(),Tl(t.SSF),r.revssf=Fl(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF,r.cellXfs=[],_i(r.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(iS(t,r)),e.push(nS(t,r)),e.push(""),e.push("");for(var a=0;a<t.SheetNames.length;++a)e.push(le("Worksheet",mS(a,r,t),{"ss:Name":et(t.SheetNames[a])}));return e[2]=sS(t,r),e[3]=oS(t,r),Et+le("Workbook",e.join(""),{xmlns:Fr.ss,"xmlns:o":Fr.o,"xmlns:x":Fr.x,"xmlns:ss":Fr.ss,"xmlns:dt":Fr.dt,"xmlns:html":Fr.html})}function _S(t){var r={},e=t.content;if(e.l=28,r.AnsiUserType=e.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=ox(e),e.length-e.l<=4)return r;var a=e.read_shift(4);if(a==0||a>40||(e.l-=4,r.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||(a=e.read_shift(4),a!==1907505652)||(r.UnicodeClipboardFormat=lx(e),a=e.read_shift(4),a==0||a>40))return r;e.l-=4,r.Reserved2=e.read_shift(0,"lpwstr")}var gS=[60,1084,2066,2165,2175];function xS(t,r,e,a,i){var n=a,s=[],o=e.slice(e.l,e.l+n);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}s.push(o),e.l+=n;for(var l=Fa(e,e.l),c=l0[l],d=0;c!=null&&gS.indexOf(l)>-1;)n=Fa(e,e.l+2),d=e.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),o=e.slice(d,e.l+4+n),s.push(o),e.l+=4+n,c=l0[l=Fa(e,e.l)];var f=Wt(s);$t(f,0);var h=0;f.lens=[];for(var m=0;m<s.length;++m)f.lens.push(h),h+=s[m].length;if(f.length<a)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+a;return r.f(f,f.length,i)}function ma(t,r,e){if(t.t!=="z"&&t.XF){var a=0;try{a=t.z||t.XF.numFmtId||0,r.cellNF&&(t.z=Fe[a])}catch(n){if(r.WTF)throw n}if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||La[t.v]:a===0||a=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=As(t.v):t.w=Pi(t.v):t.w=jr(a,t.v,{date1904:!!e,dateNF:r&&r.dateNF})}catch(n){if(r.WTF)throw n}if(r.cellDates&&a&&t.t=="n"&&Bn(Fe[a]||String(a))){var i=Ai(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function ul(t,r,e){return{v:t,ixfe:r,t:e}}function vS(t,r){var e={opts:{}},a={};ht!=null&&r.dense==null&&(r.dense=ht);var i=r.dense?[]:{},n={},s={},o=null,l=[],c="",d={},f,h="",m,p,u,_,E={},k=[],w,L,U=[],R=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},B={},N=function(We){return We<8?Fi[We]:We<64&&R[We-8]||Fi[We]},K=function(We,_t,Rr){var Mt=_t.XF.data;if(!(!Mt||!Mt.patternType||!Rr||!Rr.cellStyles)){_t.s={},_t.s.patternType=Mt.patternType;var gi;(gi=Ps(N(Mt.icvFore)))&&(_t.s.fgColor={rgb:gi}),(gi=Ps(N(Mt.icvBack)))&&(_t.s.bgColor={rgb:gi})}},q=function(We,_t,Rr){if(!(ee>1)&&!(Rr.sheetRows&&We.r>=Rr.sheetRows)){if(Rr.cellStyles&&_t.XF&&_t.XF.data&&K(We,_t,Rr),delete _t.ixfe,delete _t.XF,f=We,h=Oe(We),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),We.r<s.s.r&&(s.s.r=We.r),We.c<s.s.c&&(s.s.c=We.c),We.r+1>s.e.r&&(s.e.r=We.r+1),We.c+1>s.e.c&&(s.e.c=We.c+1),Rr.cellFormula&&_t.f){for(var Mt=0;Mt<k.length;++Mt)if(!(k[Mt][0].s.c>We.c||k[Mt][0].s.r>We.r)&&!(k[Mt][0].e.c<We.c||k[Mt][0].e.r<We.r)){_t.F=Ne(k[Mt][0]),(k[Mt][0].s.c!=We.c||k[Mt][0].s.r!=We.r)&&delete _t.f,_t.f&&(_t.f=""+ir(k[Mt][1],s,We,pe,V));break}}Rr.dense?(i[We.r]||(i[We.r]=[]),i[We.r][We.c]=_t):i[h]=_t}},V={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(V.password=r.password);var se,ge=[],oe=[],Ee=[],xe=[],He=!1,pe=[];pe.SheetNames=V.snames,pe.sharedf=V.sharedf,pe.arrayf=V.arrayf,pe.names=[],pe.XTI=[];var we=0,ee=0,O=0,G=[],I=[],M;V.codepage=1200,Jr(1200);for(var J=!1;t.l<t.length-1;){var ue=t.l,ie=t.read_shift(2);if(ie===0&&we===10)break;var ne=t.l===t.length?0:t.read_shift(2),te=l0[ie];if(te&&te.f){if(r.bookSheets&&we===133&&ie!==133)break;if(we=ie,te.r===2||te.r==12){var Re=t.read_shift(2);if(ne-=2,!V.enc&&Re!==ie&&((Re&255)<<8|Re>>8)!==ie)throw new Error("rt mismatch: "+Re+"!="+ie);te.r==12&&(t.l+=10,ne-=10)}var F={};if(ie===10?F=te.f(t,ne,V):F=xS(ie,te,t,ne,V),ee==0&&[9,521,1033,2057].indexOf(we)===-1)continue;switch(ie){case 34:e.opts.Date1904=T.WBProps.date1904=F;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(V.enc||(t.l=0),V.enc=F,!r.password)throw new Error("File is password-protected");if(F.valid==null)throw new Error("Encryption scheme unsupported");if(!F.valid)throw new Error("Password is incorrect");break;case 92:V.lastuser=F;break;case 66:var qe=Number(F);switch(qe){case 21010:qe=1200;break;case 32768:qe=1e4;break;case 32769:qe=1252;break}Jr(V.codepage=qe),J=!0;break;case 317:V.rrtabid=F;break;case 25:V.winlocked=F;break;case 439:e.opts.RefreshAll=F;break;case 12:e.opts.CalcCount=F;break;case 16:e.opts.CalcDelta=F;break;case 17:e.opts.CalcIter=F;break;case 13:e.opts.CalcMode=F;break;case 14:e.opts.CalcPrecision=F;break;case 95:e.opts.CalcSaveRecalc=F;break;case 15:V.CalcRefMode=F;break;case 2211:e.opts.FullCalc=F;break;case 129:F.fDialog&&(i["!type"]="dialog"),F.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),F.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:U.push(F);break;case 430:pe.push([F]),pe[pe.length-1].XTI=[];break;case 35:case 547:pe[pe.length-1].push(F);break;case 24:case 536:M={Name:F.Name,Ref:ir(F.rgce,s,null,pe,V)},F.itab>0&&(M.Sheet=F.itab-1),pe.names.push(M),pe[0]||(pe[0]=[],pe[0].XTI=[]),pe[pe.length-1].push(F),F.Name=="_xlnm._FilterDatabase"&&F.itab>0&&F.rgce&&F.rgce[0]&&F.rgce[0][0]&&F.rgce[0][0][0]=="PtgArea3d"&&(I[F.itab-1]={ref:Ne(F.rgce[0][0][1][2])});break;case 22:V.ExternCount=F;break;case 23:pe.length==0&&(pe[0]=[],pe[0].XTI=[]),pe[pe.length-1].XTI=pe[pe.length-1].XTI.concat(F),pe.XTI=pe.XTI.concat(F);break;case 2196:if(V.biff<8)break;M!=null&&(M.Comment=F[1]);break;case 18:i["!protect"]=F;break;case 19:F!==0&&V.WTF&&console.error("Password verifier: "+F);break;case 133:n[F.pos]=F,V.snames.push(F.name);break;case 10:{if(--ee)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,i["!ref"]=Ne(s),r.sheetRows&&r.sheetRows<=s.e.r){var Ge=s.e.r;s.e.r=r.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Ne(s),s.e.r=Ge}s.e.r++,s.e.c++}ge.length>0&&(i["!merges"]=ge),oe.length>0&&(i["!objects"]=oe),Ee.length>0&&(i["!cols"]=Ee),xe.length>0&&(i["!rows"]=xe),T.Sheets.push(B)}c===""?d=i:a[c]=i,i=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(V.biff===8&&(V.biff={9:2,521:3,1033:4}[ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[F.BIFFVer]||8),V.biffguess=F.BIFFVer==0,F.BIFFVer==0&&F.dt==4096&&(V.biff=5,J=!0,Jr(V.codepage=28591)),V.biff==8&&F.BIFFVer==0&&F.dt==16&&(V.biff=2),ee++)break;if(i=r.dense?[]:{},V.biff<8&&!J&&(J=!0,Jr(V.codepage=r.codepage||1252)),V.biff<5||F.BIFFVer==0&&F.dt==4096){c===""&&(c="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Ze={pos:t.l-ne,name:c};n[Ze.pos]=Ze,V.snames.push(c)}else c=(n[ue]||{name:""}).name;F.dt==32&&(i["!type"]="chart"),F.dt==64&&(i["!type"]="macro"),ge=[],oe=[],V.arrayf=k=[],Ee=[],xe=[],He=!1,B={Hidden:(n[ue]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(r.dense?(i[F.r]||[])[F.c]:i[Oe({c:F.c,r:F.r})])&&++F.c,w={ixfe:F.ixfe,XF:U[F.ixfe]||{},v:F.val,t:"n"},O>0&&(w.z=G[w.ixfe>>8&63]),ma(w,r,e.opts.Date1904),q({c:F.c,r:F.r},w,r);break;case 5:case 517:w={ixfe:F.ixfe,XF:U[F.ixfe],v:F.val,t:F.t},O>0&&(w.z=G[w.ixfe>>8&63]),ma(w,r,e.opts.Date1904),q({c:F.c,r:F.r},w,r);break;case 638:w={ixfe:F.ixfe,XF:U[F.ixfe],v:F.rknum,t:"n"},O>0&&(w.z=G[w.ixfe>>8&63]),ma(w,r,e.opts.Date1904),q({c:F.c,r:F.r},w,r);break;case 189:for(var ze=F.c;ze<=F.C;++ze){var _e=F.rkrec[ze-F.c][0];w={ixfe:_e,XF:U[_e],v:F.rkrec[ze-F.c][1],t:"n"},O>0&&(w.z=G[w.ixfe>>8&63]),ma(w,r,e.opts.Date1904),q({c:ze,r:F.r},w,r)}break;case 6:case 518:case 1030:{if(F.val=="String"){o=F;break}if(w=ul(F.val,F.cell.ixfe,F.tt),w.XF=U[w.ixfe],r.cellFormula){var pt=F.formula;if(pt&&pt[0]&&pt[0][0]&&pt[0][0][0]=="PtgExp"){var Pr=pt[0][0][1][0],aa=pt[0][0][1][1],ya=Oe({r:Pr,c:aa});E[ya]?w.f=""+ir(F.formula,s,F.cell,pe,V):w.F=((r.dense?(i[Pr]||[])[aa]:i[ya])||{}).F}else w.f=""+ir(F.formula,s,F.cell,pe,V)}O>0&&(w.z=G[w.ixfe>>8&63]),ma(w,r,e.opts.Date1904),q(F.cell,w,r),o=F}break;case 7:case 519:if(o)o.val=F,w=ul(F,o.cell.ixfe,"s"),w.XF=U[w.ixfe],r.cellFormula&&(w.f=""+ir(o.formula,s,o.cell,pe,V)),O>0&&(w.z=G[w.ixfe>>8&63]),ma(w,r,e.opts.Date1904),q(o.cell,w,r),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(F);var Gn=Oe(F[0].s);if(m=r.dense?(i[F[0].s.r]||[])[F[0].s.c]:i[Gn],r.cellFormula&&m){if(!o||!Gn||!m)break;m.f=""+ir(F[1],s,F[0],pe,V),m.F=Ne(F[0])}}break;case 1212:{if(!r.cellFormula)break;if(h){if(!o)break;E[Oe(o.cell)]=F[0],m=r.dense?(i[o.cell.r]||[])[o.cell.c]:i[Oe(o.cell)],(m||{}).f=""+ir(F[0],s,f,pe,V)}}break;case 253:w=ul(l[F.isst].t,F.ixfe,"s"),l[F.isst].h&&(w.h=l[F.isst].h),w.XF=U[w.ixfe],O>0&&(w.z=G[w.ixfe>>8&63]),ma(w,r,e.opts.Date1904),q({c:F.c,r:F.r},w,r);break;case 513:r.sheetStubs&&(w={ixfe:F.ixfe,XF:U[F.ixfe],t:"z"},O>0&&(w.z=G[w.ixfe>>8&63]),ma(w,r,e.opts.Date1904),q({c:F.c,r:F.r},w,r));break;case 190:if(r.sheetStubs)for(var Ba=F.c;Ba<=F.C;++Ba){var Cr=F.ixfe[Ba-F.c];w={ixfe:Cr,XF:U[Cr],t:"z"},O>0&&(w.z=G[w.ixfe>>8&63]),ma(w,r,e.opts.Date1904),q({c:Ba,r:F.r},w,r)}break;case 214:case 516:case 4:w=ul(F.val,F.ixfe,"s"),w.XF=U[w.ixfe],O>0&&(w.z=G[w.ixfe>>8&63]),ma(w,r,e.opts.Date1904),q({c:F.c,r:F.r},w,r);break;case 0:case 512:ee===1&&(s=F);break;case 252:l=F;break;case 1054:if(V.biff==4){G[O++]=F[1];for(var ba=0;ba<O+163&&Fe[ba]!=F[1];++ba);ba>=163&&Ma(F[1],O+163)}else Ma(F[1],F[0]);break;case 30:{G[O++]=F;for(var Va=0;Va<O+163&&Fe[Va]!=F;++Va);Va>=163&&Ma(F,O+163)}break;case 229:ge=ge.concat(F);break;case 93:oe[F.cmo[0]]=V.lastobj=F;break;case 438:V.lastobj.TxO=F;break;case 127:V.lastobj.ImData=F;break;case 440:for(_=F[0].s.r;_<=F[0].e.r;++_)for(u=F[0].s.c;u<=F[0].e.c;++u)m=r.dense?(i[_]||[])[u]:i[Oe({c:u,r:_})],m&&(m.l=F[1]);break;case 2048:for(_=F[0].s.r;_<=F[0].e.r;++_)for(u=F[0].s.c;u<=F[0].e.c;++u)m=r.dense?(i[_]||[])[u]:i[Oe({c:u,r:_})],m&&m.l&&(m.l.Tooltip=F[1]);break;case 28:{if(V.biff<=5&&V.biff>=2)break;m=r.dense?(i[F[0].r]||[])[F[0].c]:i[Oe(F[0])];var zn=oe[F[2]];m||(r.dense?(i[F[0].r]||(i[F[0].r]=[]),m=i[F[0].r][F[0].c]={t:"z"}):m=i[Oe(F[0])]={t:"z"},s.e.r=Math.max(s.e.r,F[0].r),s.s.r=Math.min(s.s.r,F[0].r),s.e.c=Math.max(s.e.c,F[0].c),s.s.c=Math.min(s.s.c,F[0].c)),m.c||(m.c=[]),p={a:F[1],t:zn.TxO.t},m.c.push(p)}break;case 2173:sy(U[F.ixfe],F.ext);break;case 125:{if(!V.cellStyles)break;for(;F.e>=F.s;)Ee[F.e--]={width:F.w/256,level:F.level||0,hidden:!!(F.flags&1)},He||(He=!0,U0(F.w/256)),fi(Ee[F.e+1])}break;case 520:{var fr={};F.level!=null&&(xe[F.r]=fr,fr.level=F.level),F.hidden&&(xe[F.r]=fr,fr.hidden=!0),F.hpt&&(xe[F.r]=fr,fr.hpt=F.hpt,fr.hpx=Ln(F.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Ii(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ie]]=F;break;case 161:i["!margins"]||Ii(i["!margins"]={}),i["!margins"].header=F.header,i["!margins"].footer=F.footer;break;case 574:F.RTL&&(T.Views[0].RTL=!0);break;case 146:R=F;break;case 2198:se=F;break;case 140:L=F;break;case 442:c?B.CodeName=F||B.name:T.WBProps.CodeName=F||"ThisWorkbook";break}}else te||console.error("Missing Info for XLS Record 0x"+ie.toString(16)),t.l+=ne}return e.SheetNames=mt(n).sort(function(ia,We){return Number(ia)-Number(We)}).map(function(ia){return n[ia].name}),r.bookSheets||(e.Sheets=a),!e.SheetNames.length&&d["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=d)):e.Preamble=d,e.Sheets&&I.forEach(function(ia,We){e.Sheets[e.SheetNames[We]]["!autofilter"]=ia}),e.Strings=l,e.SSF=st(Fe),V.enc&&(e.Encryption=V.enc),se&&(e.Themes=se),e.Metadata={},L!==void 0&&(e.Metadata.Country=L),pe.names.length>0&&(T.Names=pe.names),e.Workbook=T,e}var Ss={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function wS(t,r,e){var a=Se.find(t,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var i=th(a,t0,Ss.DSI);for(var n in i)r[n]=i[n]}catch(c){if(e.WTF)throw c}var s=Se.find(t,"/!SummaryInformation");if(s&&s.size>0)try{var o=th(s,r0,Ss.SI);for(var l in o)r[l]==null&&(r[l]=o[l])}catch(c){if(e.WTF)throw c}r.HeadingPairs&&r.TitlesOfParts&&(xm(r.HeadingPairs,r.TitlesOfParts,r,e),delete r.HeadingPairs,delete r.TitlesOfParts)}function yS(t,r){var e=[],a=[],i=[],n=0,s,o=Ou(t0,"n"),l=Ou(r0,"n");if(t.Props)for(s=mt(t.Props),n=0;n<s.length;++n)(Object.prototype.hasOwnProperty.call(o,s[n])?e:Object.prototype.hasOwnProperty.call(l,s[n])?a:i).push([s[n],t.Props[s[n]]]);if(t.Custprops)for(s=mt(t.Custprops),n=0;n<s.length;++n)Object.prototype.hasOwnProperty.call(t.Props||{},s[n])||(Object.prototype.hasOwnProperty.call(o,s[n])?e:Object.prototype.hasOwnProperty.call(l,s[n])?a:i).push([s[n],t.Custprops[s[n]]]);var c=[];for(n=0;n<i.length;++n)Em.indexOf(i[n][0])>-1||gm.indexOf(i[n][0])>-1||i[n][1]!=null&&c.push(i[n]);a.length&&Se.utils.cfb_add(r,"/SummaryInformation",rh(a,Ss.SI,l,r0)),(e.length||c.length)&&Se.utils.cfb_add(r,"/DocumentSummaryInformation",rh(e,Ss.DSI,o,t0,c.length?c:null,Ss.UDI))}function wp(t,r){r||(r={}),K0(r),u0(),r.codepage&&f0(r.codepage);var e,a;if(t.FullPaths){if(Se.find(t,"/encryption"))throw new Error("File is password-protected");e=Se.find(t,"!CompObj"),a=Se.find(t,"/Workbook")||Se.find(t,"/Book")}else{switch(r.type){case"base64":t=Or(Ir(t));break;case"binary":t=Or(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}$t(t,0),a={content:t}}var i,n;if(e&&_S(e),r.bookProps&&!r.bookSheets)i={};else{var s=Ue?"buffer":"array";if(a&&a.content)i=vS(a.content,r);else if((n=Se.find(t,"PerfectOffice_MAIN"))&&n.content)i=Mi.to_workbook(n.content,(r.type=s,r));else if((n=Se.find(t,"NativeContent_MAIN"))&&n.content)i=Mi.to_workbook(n.content,(r.type=s,r));else throw(n=Se.find(t,"MN0"))&&n.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&t.FullPaths&&Se.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=Py(t))}var o={};return t.FullPaths&&wS(t,o,r),i.Props=i.Custprops=o,r.bookFiles&&(i.cfb=t),i}function bS(t,r){var e=r||{},a=Se.utils.cfb_new({root:"R"}),i="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":i="/Workbook",e.biff=8;break;case"biff5":i="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Se.utils.cfb_add(a,i,yp(t,e)),e.biff==8&&(t.Props||t.Custprops)&&yS(t,a),e.biff==8&&t.vbaraw&&Ry(a,Se.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),a}var Bs={0:{f:$C},1:{f:ek},2:{f:vk},3:{f:lk},4:{f:ik},5:{f:_k},6:{f:kk},7:{f:uk},8:{f:Ok},9:{f:Fk},10:{f:Tk},11:{f:Ak},12:{f:rk},13:{f:yk},14:{f:dk},15:{f:sk},16:{f:up},17:{f:Sk},18:{f:mk},19:{f:F0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:SE},40:{},42:{},43:{f:kw},44:{f:bw},45:{f:Dw},46:{f:Aw},47:{f:Tw},48:{},49:{f:K1},50:{},51:{f:cy},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Nm},62:{f:Ck},63:{f:xy},64:{f:Xk},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:cr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Gk},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:QC},148:{f:KC,p:16},151:{f:Lk},152:{},153:{f:CE},154:{},155:{},156:{f:yE},157:{},158:{},159:{T:1,f:V2},160:{T:-1},161:{T:1,f:zi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Mk},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:oy},336:{T:-1},337:{f:uy,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:e0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Rm},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Bk},427:{f:Vk},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Hk},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:ZC},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Rk},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:e0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Ay},633:{T:1},634:{T:-1},635:{T:1,f:Dy},636:{T:-1},637:{f:J1},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:dE},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:jk},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},l0={6:{f:Yc},10:{f:oi},12:{f:Ot},13:{f:Ot},14:{f:Ct},15:{f:Ct},16:{f:sr},17:{f:Ct},18:{f:Ct},19:{f:Ot},20:{f:lh},21:{f:lh},23:{f:Rm},24:{f:dh},25:{f:Ct},26:{},27:{},28:{f:jv},29:{},34:{f:Ct},35:{f:ch},38:{f:sr},39:{f:sr},40:{f:sr},41:{f:sr},42:{f:Ct},43:{f:Ct},47:{f:sw},49:{f:yv},51:{f:Ot},60:{},61:{f:_v},64:{f:Ct},65:{f:wv},66:{f:Ot},77:{},80:{},81:{},82:{},85:{f:Ot},89:{},90:{},91:{},92:{f:nv},93:{f:Zv},94:{},95:{f:Ct},96:{},97:{},99:{f:Ct},125:{f:Nm},128:{f:Nv},129:{f:ov},130:{f:Ot},131:{f:Ct},132:{f:Ct},133:{f:lv},134:{},140:{f:n2},141:{f:Ot},144:{},146:{f:l2},151:{},152:{},153:{},154:{},155:{},156:{f:Ot},157:{},158:{},160:{f:p2},161:{f:f2},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Mv},190:{f:Iv},193:{f:oi},197:{},198:{},199:{},200:{},201:{},202:{f:Ct},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ot},220:{},221:{f:Ct},222:{},224:{f:Rv},225:{f:iv},226:{f:oi},227:{},229:{f:Kv},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:dv},253:{f:Cv},255:{f:uv},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Sm},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ct},353:{f:oi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Hv},431:{f:Ct},432:{},433:{},434:{},437:{},438:{f:e2},439:{f:Ct},440:{f:t2},441:{},442:{f:Gs},443:{},444:{f:Ot},445:{},446:{},448:{f:oi},449:{f:pv,r:2},450:{f:oi},512:{f:nh},513:{f:m2},515:{f:Vv},516:{f:Ev},517:{f:oh},519:{f:_2},520:{f:hv},523:{},545:{f:fh},549:{f:ih},566:{},574:{f:xv},638:{f:Ov},659:{},1048:{},1054:{f:Dv},1084:{},1212:{f:Yv},2048:{f:a2},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:cl},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:oi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:c2,r:12},2173:{f:ny,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ct,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:zv,r:12},2197:{},2198:{f:Jw,r:12},2199:{},2200:{},2201:{},2202:{f:$v,r:12},2203:{f:oi},2204:{},2205:{},2206:{},2207:{},2211:{f:mv},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ot},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:u2},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:o2},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:nh},1:{},2:{f:y2},3:{f:v2},4:{f:x2},5:{f:oh},7:{f:C2},8:{},9:{f:cl},11:{},22:{f:Ot},30:{f:Av},31:{},32:{},33:{f:fh},36:{},37:{f:ih},50:{f:k2},62:{},52:{},67:{},68:{f:Ot},69:{},86:{},126:{},127:{f:g2},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:E2},223:{},234:{},354:{},421:{},518:{f:Yc},521:{f:cl},536:{f:dh},547:{f:ch},561:{},579:{},1030:{f:Yc},1033:{f:cl},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ce(t,r,e,a){var i=r;if(!isNaN(i)){var n=a||(e||[]).length||0,s=t.next(4);s.write_shift(2,i),s.write_shift(2,n),n>0&&D0(e)&&t.push(e)}}function CS(t,r,e,a){var i=a||(e||[]).length||0;if(i<=8224)return ce(t,r,e,i);var n=r;if(!isNaN(n)){for(var s=e.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var d=t.next(4);for(d.write_shift(2,n),d.write_shift(2,c),t.push(e.slice(l,l+c)),l+=c;l<i;){for(d=t.next(4),d.write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;d.write_shift(2,c),t.push(e.slice(l,l+c)),l+=c}}}function Xs(t,r,e){return t||(t=Z(7)),t.write_shift(2,r),t.write_shift(2,e),t.write_shift(2,0),t.write_shift(1,0),t}function kS(t,r,e,a){var i=Z(9);return Xs(i,t,r),Dm(e,a||"b",i),i}function ES(t,r,e){var a=Z(8+2*e.length);return Xs(a,t,r),a.write_shift(1,e.length),a.write_shift(e.length,e,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function SS(t,r,e,a){if(r.v!=null)switch(r.t){case"d":case"n":var i=r.t=="d"?Lt(nt(r.v)):r.v;i==(i|0)&&i>=0&&i<65536?ce(t,2,b2(e,a,i)):ce(t,3,w2(e,a,i));return;case"b":case"e":ce(t,5,kS(e,a,r.v,r.t));return;case"s":case"str":ce(t,4,ES(e,a,(r.v||"").slice(0,255)));return}ce(t,1,Xs(null,e,a))}function DS(t,r,e,a){var i=Array.isArray(r),n=Xe(r["!ref"]||"A1"),s,o="",l=[];if(n.e.c>255||n.e.r>16383){if(a.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");n.e.c=Math.min(n.e.c,255),n.e.r=Math.min(n.e.c,16383),s=Ne(n)}for(var c=n.s.r;c<=n.e.r;++c){o=kt(c);for(var d=n.s.c;d<=n.e.c;++d){c===n.s.r&&(l[d]=lt(d)),s=l[d]+o;var f=i?(r[c]||[])[d]:r[s];f&&SS(t,f,c,d,a)}}}function TS(t,r){var e=r||{};ht!=null&&e.dense==null&&(e.dense=ht);for(var a=yr(),i=0,n=0;n<t.SheetNames.length;++n)t.SheetNames[n]==e.sheet&&(i=n);if(i==0&&e.sheet&&t.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return ce(a,e.biff==4?1033:e.biff==3?521:9,L0(t,16,e)),DS(a,t.Sheets[t.SheetNames[i]],i,e,t),ce(a,10),a.end()}function AS(t,r,e){ce(t,49,bv({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},e))}function FS(t,r,e){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var i=a[0];i<=a[1];++i)r[i]!=null&&ce(t,1054,Tv(i,r[i],e))})}function OS(t,r){var e=Z(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),ce(t,2151,e),e=Z(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),Mm(Xe(r["!ref"]||"A1"),e),e.write_shift(4,4),ce(t,2152,e)}function MS(t,r){for(var e=0;e<16;++e)ce(t,224,sh({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(a){ce(t,224,sh(a,0,r))})}function IS(t,r){for(var e=0;e<r["!links"].length;++e){var a=r["!links"][e];ce(t,440,r2(a)),a[1].Tooltip&&ce(t,2048,i2(a))}delete r["!links"]}function PS(t,r){if(r){var e=0;r.forEach(function(a,i){++e<=256&&a&&ce(t,125,d2(Nl(i,a),i))})}}function RS(t,r,e,a,i){var n=16+_i(i.cellXfs,r,i);if(r.v==null&&!r.bf){ce(t,513,Bi(e,a,n));return}if(r.bf)ce(t,6,oC(r,e,a,i,n));else switch(r.t){case"d":case"n":var s=r.t=="d"?Lt(nt(r.v)):r.v;ce(t,515,Uv(e,a,s,n,i));break;case"b":case"e":ce(t,517,Bv(e,a,r.v,n,i,r.t));break;case"s":case"str":if(i.bookSST){var o=Y0(i.Strings,r.v,i.revStrings);ce(t,253,kv(e,a,o,n,i))}else ce(t,516,Sv(e,a,(r.v||"").slice(0,255),n,i));break;default:ce(t,513,Bi(e,a,n))}}function NS(t,r,e){var a=yr(),i=e.SheetNames[t],n=e.Sheets[i]||{},s=(e||{}).Workbook||{},o=(s.Sheets||[])[t]||{},l=Array.isArray(n),c=r.biff==8,d,f="",h=[],m=Xe(n["!ref"]||"A1"),p=c?65536:16384;if(m.e.c>255||m.e.r>=p){if(r.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,p-1)}ce(a,2057,L0(e,16,r)),ce(a,13,$r(1)),ce(a,12,$r(100)),ce(a,15,pr(!0)),ce(a,17,pr(!1)),ce(a,16,Ni(.001)),ce(a,95,pr(!0)),ce(a,42,pr(!1)),ce(a,43,pr(!1)),ce(a,130,$r(1)),ce(a,128,Lv([0,0])),ce(a,131,pr(!1)),ce(a,132,pr(!1)),c&&PS(a,n["!cols"]),ce(a,512,Fv(m,r)),c&&(n["!links"]=[]);for(var u=m.s.r;u<=m.e.r;++u){f=kt(u);for(var _=m.s.c;_<=m.e.c;++_){u===m.s.r&&(h[_]=lt(_)),d=h[_]+f;var E=l?(n[u]||[])[_]:n[d];E&&(RS(a,E,u,_,r),c&&E.l&&n["!links"].push([d,E.l]))}}var k=o.CodeName||o.name||i;return c&&ce(a,574,vv((s.Views||[])[0])),c&&(n["!merges"]||[]).length&&ce(a,229,qv(n["!merges"])),c&&IS(a,n),ce(a,442,Tm(k,r)),c&&OS(a,n),ce(a,10),a.end()}function LS(t,r,e){var a=yr(),i=(t||{}).Workbook||{},n=i.Sheets||[],s=i.WBProps||{},o=e.biff==8,l=e.biff==5;if(ce(a,2057,L0(t,5,e)),e.bookType=="xla"&&ce(a,135),ce(a,225,o?$r(1200):null),ce(a,193,Bx(2)),l&&ce(a,191),l&&ce(a,192),ce(a,226),ce(a,92,sv("SheetJS",e)),ce(a,66,$r(o?1200:1252)),o&&ce(a,353,$r(0)),o&&ce(a,448),ce(a,317,h2(t.SheetNames.length)),o&&t.vbaraw&&ce(a,211),o&&t.vbaraw){var c=s.CodeName||"ThisWorkbook";ce(a,442,Tm(c,e))}ce(a,156,$r(17)),ce(a,25,pr(!1)),ce(a,18,pr(!1)),ce(a,19,$r(0)),o&&ce(a,431,pr(!1)),o&&ce(a,444,$r(0)),ce(a,61,gv(e)),ce(a,64,pr(!1)),ce(a,141,$r(0)),ce(a,34,pr(pE(t)=="true")),ce(a,14,pr(!0)),o&&ce(a,439,pr(!1)),ce(a,218,$r(0)),AS(a,t,e),FS(a,t.SSF,e),MS(a,e),o&&ce(a,352,pr(!1));var d=a.end(),f=yr();o&&ce(f,140,s2()),o&&e.Strings&&CS(f,252,fv(e.Strings,e)),ce(f,10);var h=f.end(),m=yr(),p=0,u=0;for(u=0;u<t.SheetNames.length;++u)p+=(o?12:11)+(o?2:1)*t.SheetNames[u].length;var _=d.length+p+h.length;for(u=0;u<t.SheetNames.length;++u){var E=n[u]||{};ce(m,133,cv({pos:_,hs:E.Hidden||0,dt:0,name:t.SheetNames[u]},e)),_+=r[u].length}var k=m.end();if(p!=k.length)throw new Error("BS8 "+p+" != "+k.length);var w=[];return d.length&&w.push(d),k.length&&w.push(k),h.length&&w.push(h),Wt(w)}function BS(t,r){var e=r||{},a=[];t&&!t.SSF&&(t.SSF=st(Fe)),t&&t.SSF&&(Vn(),Tl(t.SSF),e.revssf=Fl(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,q0(e),e.cellXfs=[],_i(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)a[a.length]=NS(i,e,t);return a.unshift(LS(t,a,e)),Wt(a)}function yp(t,r){for(var e=0;e<=t.SheetNames.length;++e){var a=t.Sheets[t.SheetNames[e]];if(!(!a||!a["!ref"])){var i=br(a["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var n=r||{};switch(n.biff||2){case 8:case 5:return BS(t,r);case 4:case 3:case 2:return TS(t,r)}throw new Error("invalid type "+n.bookType+" for BIFF")}function yh(t,r){var e=r||{};ht!=null&&e.dense==null&&(e.dense=ht);var a=e.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var n=t.match(/<\/table/i),s=i.index,o=n&&n.index||t.length,l=b1(t.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,f=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(s=0;s<l.length;++s){var u=l[s].trim(),_=u.slice(0,3).toLowerCase();if(_=="<tr"){if(++c,e.sheetRows&&e.sheetRows<=c){--c;break}d=0;continue}if(!(_!="<td"&&_!="<th")){var E=u.split(/<\/t[dh]>/i);for(o=0;o<E.length;++o){var k=E[o].trim();if(k.match(/<t[dh]/i)){for(var w=k,L=0;w.charAt(0)=="<"&&(L=w.indexOf(">"))>-1;)w=w.slice(L+1);for(var U=0;U<p.length;++U){var R=p[U];R.s.c==d&&R.s.r<c&&c<=R.e.r&&(d=R.e.c+1,U=-1)}var T=Me(k.slice(0,k.indexOf(">")));h=T.colspan?+T.colspan:1,((f=+T.rowspan)>1||h>1)&&p.push({s:{r:c,c:d},e:{r:c+(f||1)-1,c:d+h-1}});var B=T.t||T["data-t"]||"";if(!w.length){d+=h;continue}if(w=qh(w),m.s.r>c&&(m.s.r=c),m.e.r<c&&(m.e.r=c),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),!w.length){d+=h;continue}var N={t:"s",v:w};e.raw||!w.trim().length||B=="s"||(w==="TRUE"?N={t:"b",v:!0}:w==="FALSE"?N={t:"b",v:!1}:isNaN(ta(w))?isNaN(Rn(w).getDate())||(N={t:"d",v:nt(w)},e.cellDates||(N={t:"n",v:Lt(N.v)}),N.z=e.dateNF||Fe[14]):N={t:"n",v:ta(w)}),e.dense?(a[c]||(a[c]=[]),a[c][d]=N):a[Oe({r:c,c:d})]=N,d+=h}}}}return a["!ref"]=Ne(m),p.length&&(a["!merges"]=p),a}function VS(t,r,e,a){for(var i=t["!merges"]||[],n=[],s=r.s.c;s<=r.e.c;++s){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>e||i[c].s.c>s)&&!(i[c].e.r<e||i[c].e.c<s)){if(i[c].s.r<e||i[c].s.c<s){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var d=Oe({r:e,c:s}),f=a.dense?(t[e]||[])[s]:t[d],h=f&&f.v!=null&&(f.h||w0(f.w||(Pa(f),f.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),a.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(a.id||"sjs")+"-"+d,n.push(le("td",h,m))}}var p="<tr>";return p+n.join("")+"</tr>"}var US='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HS="</body></html>";function WS(t,r){var e=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||e.length==0)throw new Error("Invalid HTML: could not find <table>");if(e.length==1)return pi(yh(e[0],r),r);var a=ed();return e.forEach(function(i,n){td(a,yh(i,r),"Sheet"+(n+1))}),a}function GS(t,r,e){var a=[];return a.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function bp(t,r){var e=r||{},a=e.header!=null?e.header:US,i=e.footer!=null?e.footer:HS,n=[a],s=br(t["!ref"]);e.dense=Array.isArray(t),n.push(GS(t,s,e));for(var o=s.s.r;o<=s.e.r;++o)n.push(VS(t,s,o,e));return n.push("</table>"+i),n.join("")}function Cp(t,r,e){var a=e||{};ht!=null&&(a.dense=ht);var i=0,n=0;if(a.origin!=null)if(typeof a.origin=="number")i=a.origin;else{var s=typeof a.origin=="string"?ct(a.origin):a.origin;i=s.r,n=s.c}var o=r.getElementsByTagName("tr"),l=Math.min(a.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:n}};if(t["!ref"]){var d=br(t["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),i==-1&&(c.e.r=i=d.e.r+1)}var f=[],h=0,m=t["!rows"]||(t["!rows"]=[]),p=0,u=0,_=0,E=0,k=0,w=0;for(t["!cols"]||(t["!cols"]=[]);p<o.length&&u<l;++p){var L=o[p];if(bh(L)){if(a.display)continue;m[u]={hidden:!0}}var U=L.children;for(_=E=0;_<U.length;++_){var R=U[_];if(!(a.display&&bh(R))){var T=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):qh(R.innerHTML),B=R.getAttribute("data-z")||R.getAttribute("z");for(h=0;h<f.length;++h){var N=f[h];N.s.c==E+n&&N.s.r<u+i&&u+i<=N.e.r&&(E=N.e.c+1-n,h=-1)}w=+R.getAttribute("colspan")||1,((k=+R.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:u+i,c:E+n},e:{r:u+i+(k||1)-1,c:E+n+(w||1)-1}});var K={t:"s",v:T},q=R.getAttribute("data-t")||R.getAttribute("t")||"";T!=null&&(T.length==0?K.t=q||"z":a.raw||T.trim().length==0||q=="s"||(T==="TRUE"?K={t:"b",v:!0}:T==="FALSE"?K={t:"b",v:!1}:isNaN(ta(T))?isNaN(Rn(T).getDate())||(K={t:"d",v:nt(T)},a.cellDates||(K={t:"n",v:Lt(K.v)}),K.z=a.dateNF||Fe[14]):K={t:"n",v:ta(T)})),K.z===void 0&&B!=null&&(K.z=B);var V="",se=R.getElementsByTagName("A");if(se&&se.length)for(var ge=0;ge<se.length&&!(se[ge].hasAttribute("href")&&(V=se[ge].getAttribute("href"),V.charAt(0)!="#"));++ge);V&&V.charAt(0)!="#"&&(K.l={Target:V}),a.dense?(t[u+i]||(t[u+i]=[]),t[u+i][E+n]=K):t[Oe({c:E+n,r:u+i})]=K,c.e.c<E+n&&(c.e.c=E+n),E+=w}}++u}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,u-1+i),t["!ref"]=Ne(c),u>=l&&(t["!fullref"]=Ne((c.e.r=o.length-p+u-1+i,c))),t}function kp(t,r){var e=r||{},a=e.dense?[]:{};return Cp(a,t,r)}function zS(t,r){return pi(kp(t,r),r)}function bh(t){var r="",e=YS(t);return e&&(r=e(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),r==="none"}function YS(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function $S(t){var r=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),e=$e(r.replace(/<[^>]*>/g,""));return[e]}var Ch={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Ep(t,r){var e=r||{};ht!=null&&e.dense==null&&(e.dense=ht);var a=y0(t),i=[],n,s,o={name:""},l="",c=0,d,f,h={},m=[],p=e.dense?[]:{},u,_,E={value:""},k="",w=0,L,U=[],R=-1,T=-1,B={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,K={},q=[],V={},se=0,ge=0,oe=[],Ee=1,xe=1,He=[],pe={Names:[]},we={},ee=["",""],O=[],G={},I="",M=0,J=!1,ue=!1,ie=0;for(Ms.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");u=Ms.exec(a);)switch(u[3]=u[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":u[1]==="/"?(B.e.c>=B.s.c&&B.e.r>=B.s.r?p["!ref"]=Ne(B):p["!ref"]="A1:A1",e.sheetRows>0&&e.sheetRows<=B.e.r&&(p["!fullref"]=p["!ref"],B.e.r=e.sheetRows-1,p["!ref"]=Ne(B)),q.length&&(p["!merges"]=q),oe.length&&(p["!rows"]=oe),d.name=d.\u540D\u79F0||d.name,typeof JSON<"u"&&JSON.stringify(d),m.push(d.name),h[d.name]=p,ue=!1):u[0].charAt(u[0].length-2)!=="/"&&(d=Me(u[0],!1),R=T=-1,B.s.r=B.s.c=1e7,B.e.r=B.e.c=0,p=e.dense?[]:{},q=[],oe=[],ue=!0);break;case"table-row-group":u[1]==="/"?--N:++N;break;case"table-row":case"\u884C":if(u[1]==="/"){R+=Ee,Ee=1;break}if(f=Me(u[0],!1),f.\u884C\u53F7?R=f.\u884C\u53F7-1:R==-1&&(R=0),Ee=+f["number-rows-repeated"]||1,Ee<10)for(ie=0;ie<Ee;++ie)N>0&&(oe[R+ie]={level:N});T=-1;break;case"covered-table-cell":u[1]!=="/"&&++T,e.sheetStubs&&(e.dense?(p[R]||(p[R]=[]),p[R][T]={t:"z"}):p[Oe({r:R,c:T})]={t:"z"}),k="",U=[];break;case"table-cell":case"\u6570\u636E":if(u[0].charAt(u[0].length-2)==="/")++T,E=Me(u[0],!1),xe=parseInt(E["number-columns-repeated"]||"1",10),_={t:"z",v:null},E.formula&&e.cellFormula!=!1&&(_.f=xh($e(E.formula))),(E.\u6570\u636E\u7C7B\u578B||E["value-type"])=="string"&&(_.t="s",_.v=$e(E["string-value"]||""),e.dense?(p[R]||(p[R]=[]),p[R][T]=_):p[Oe({r:R,c:T})]=_),T+=xe-1;else if(u[1]!=="/"){++T,k="",w=0,U=[],xe=1;var ne=Ee?R+Ee-1:R;if(T>B.e.c&&(B.e.c=T),T<B.s.c&&(B.s.c=T),R<B.s.r&&(B.s.r=R),ne>B.e.r&&(B.e.r=ne),E=Me(u[0],!1),O=[],G={},_={t:E.\u6570\u636E\u7C7B\u578B||E["value-type"],v:null},e.cellFormula)if(E.formula&&(E.formula=$e(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(se=parseInt(E["number-matrix-rows-spanned"],10)||0,ge=parseInt(E["number-matrix-columns-spanned"],10)||0,V={s:{r:R,c:T},e:{r:R+se-1,c:T+ge-1}},_.F=Ne(V),He.push([V,_.F])),E.formula)_.f=xh(E.formula);else for(ie=0;ie<He.length;++ie)R>=He[ie][0].s.r&&R<=He[ie][0].e.r&&T>=He[ie][0].s.c&&T<=He[ie][0].e.c&&(_.F=He[ie][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(se=parseInt(E["number-rows-spanned"],10)||0,ge=parseInt(E["number-columns-spanned"],10)||0,V={s:{r:R,c:T},e:{r:R+se-1,c:T+ge-1}},q.push(V)),E["number-columns-repeated"]&&(xe=parseInt(E["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=it(E["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(E.value);break;case"percentage":_.t="n",_.v=parseFloat(E.value);break;case"currency":_.t="n",_.v=parseFloat(E.value);break;case"date":_.t="d",_.v=nt(E["date-value"]),e.cellDates||(_.t="n",_.v=Lt(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=v1(E["time-value"])/86400,e.cellDates&&(_.t="d",_.v=Ol(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(E.\u6570\u636E\u6570\u503C);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",E["string-value"]!=null&&(k=$e(E["string-value"]),U=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(J=!1,_.t==="s"&&(_.v=k||"",U.length&&(_.R=U),J=w==0),we.Target&&(_.l=we),O.length>0&&(_.c=O,O=[]),k&&e.cellText!==!1&&(_.w=k),J&&(_.t="z",delete _.v),(!J||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=R))for(var te=0;te<Ee;++te){if(xe=parseInt(E["number-columns-repeated"]||"1",10),e.dense)for(p[R+te]||(p[R+te]=[]),p[R+te][T]=te==0?_:st(_);--xe>0;)p[R+te][T+xe]=st(_);else for(p[Oe({r:R+te,c:T})]=_;--xe>0;)p[Oe({r:R+te,c:T+xe})]=st(_);B.e.c<=T&&(B.e.c=T)}xe=parseInt(E["number-columns-repeated"]||"1",10),T+=xe-1,xe=0,_={},k="",U=[]}we={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(u[1]==="/"){if((n=i.pop())[0]!==u[3])throw"Bad state: "+n}else u[0].charAt(u[0].length-2)!=="/"&&i.push([u[3],!0]);break;case"annotation":if(u[1]==="/"){if((n=i.pop())[0]!==u[3])throw"Bad state: "+n;G.t=k,U.length&&(G.R=U),G.a=I,O.push(G)}else u[0].charAt(u[0].length-2)!=="/"&&i.push([u[3],!1]);I="",M=0,k="",w=0,U=[];break;case"creator":u[1]==="/"?I=a.slice(M,u.index):M=u.index+u[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(u[1]==="/"){if((n=i.pop())[0]!==u[3])throw"Bad state: "+n}else u[0].charAt(u[0].length-2)!=="/"&&i.push([u[3],!1]);k="",w=0,U=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(u[1]==="/"){if(K[o.name]=l,(n=i.pop())[0]!==u[3])throw"Bad state: "+n}else u[0].charAt(u[0].length-2)!=="/"&&(l="",o=Me(u[0],!1),i.push([u[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":s=Me(u[0],!1),l+=Ch[u[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":s=Me(u[0],!1),l+=Ch[u[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(u[0].slice(-2)==="/>")break;if(u[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=a.slice(c,u.index);break}else c=u.index+u[0].length;break;case"named-range":s=Me(u[0],!1),ee=$c(s["cell-range-address"]);var Re={Name:s.name,Ref:ee[0]+"!"+ee[1]};ue&&(Re.Sheet=m.length),pe.Names.push(Re);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(u[1]==="/"&&(!E||!E["string-value"])){var F=$S(a.slice(w,u.index),L);k=(k.length>0?k+`
`:"")+F[0]}else L=Me(u[0],!1),w=u.index+u[0].length;break;case"s":break;case"database-range":if(u[1]==="/")break;try{ee=$c(Me(u[0])["target-range-address"]),h[ee[0]]["!autofilter"]={ref:ee[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(u[1]!=="/"){if(we=Me(u[0],!1),!we.href)break;we.Target=$e(we.href),delete we.href,we.Target.charAt(0)=="#"&&we.Target.indexOf(".")>-1?(ee=$c(we.Target.slice(1)),we.Target="#"+ee[0]+"!"+ee[1]):we.Target.match(/^\.\.[\\\/]/)&&(we.Target=we.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(u[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(e.WTF)throw new Error(u)}}var qe={Sheets:h,SheetNames:m,Workbook:pe};return e.bookSheets&&delete qe.Sheets,qe}function kh(t,r){r=r||{},Yr(t,"META-INF/manifest.xml")&&vx(Ft(t,"META-INF/manifest.xml"),r);var e=Mr(t,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var a=Ep(rt(e),r);return Yr(t,"meta.xml")&&(a.Props=pm(Ft(t,"meta.xml"))),a}function Eh(t,r){return Ep(t,r)}var XS=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Os({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Et+r}}(),Sh=function(){var t=function(n){return et(n).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,e=`          <table:covered-table-cell/>
`,a=function(n,s,o){var l=[];l.push('      <table:table table:name="'+et(s.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,d=0,f=br(n["!ref"]||"A1"),h=n["!merges"]||[],m=0,p=Array.isArray(n);if(n["!cols"])for(d=0;d<=f.e.c;++d)l.push("        <table:table-column"+(n["!cols"][d]?' table:style-name="co'+n["!cols"][d].ods+'"':"")+`></table:table-column>
`);var u="",_=n["!rows"]||[];for(c=0;c<f.s.r;++c)u=_[c]?' table:style-name="ro'+_[c].ods+'"':"",l.push("        <table:table-row"+u+`></table:table-row>
`);for(;c<=f.e.r;++c){for(u=_[c]?' table:style-name="ro'+_[c].ods+'"':"",l.push("        <table:table-row"+u+`>
`),d=0;d<f.s.c;++d)l.push(r);for(;d<=f.e.c;++d){var E=!1,k={},w="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>d)&&!(h[m].s.r>c)&&!(h[m].e.c<d)&&!(h[m].e.r<c)){(h[m].s.c!=d||h[m].s.r!=c)&&(E=!0),k["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,k["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(E){l.push(e);continue}var L=Oe({r:c,c:d}),U=p?(n[c]||[])[d]:n[L];if(U&&U.f&&(k["table:formula"]=et(hC(U.f)),U.F&&U.F.slice(0,L.length)==L)){var R=br(U.F);k["table:number-matrix-columns-spanned"]=R.e.c-R.s.c+1,k["table:number-matrix-rows-spanned"]=R.e.r-R.s.r+1}if(!U){l.push(r);continue}switch(U.t){case"b":w=U.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=U.v?"true":"false";break;case"n":w=U.w||String(U.v||0),k["office:value-type"]="float",k["office:value"]=U.v||0;break;case"s":case"str":w=U.v==null?"":U.v,k["office:value-type"]="string";break;case"d":w=U.w||nt(U.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=nt(U.v).toISOString(),k["table:style-name"]="ce1";break;default:l.push(r);continue}var T=t(w);if(U.l&&U.l.Target){var B=U.l.Target;B=B.charAt(0)=="#"?"#"+mC(B.slice(1)):B,B.charAt(0)!="#"&&!B.match(/^\w+:/)&&(B="../"+B),T=le("text:a",T,{"xlink:href":B.replace(/&/g,"&amp;")})}l.push("          "+le("table:table-cell",le("text:p",T,{}),k)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(n,s){n.push(` <office:automatic-styles>
`),n.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),n.push(`   <number:month number:style="long"/>
`),n.push(`   <number:text>/</number:text>
`),n.push(`   <number:day number:style="long"/>
`),n.push(`   <number:text>/</number:text>
`),n.push(`   <number:year/>
`),n.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var d=0;d<c["!cols"].length;++d)if(c["!cols"][d]){var f=c["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;fi(f),f.ods=o;var h=c["!cols"][d].wpx+"px";n.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),n.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),n.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var d=0;d<c["!rows"].length;++d)if(c["!rows"][d]){c["!rows"][d].ods=l;var f=c["!rows"][d].hpx+"px";n.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),n.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),n.push(`  </style:style>
`),++l}}}),n.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),n.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),n.push(`  </style:style>
`),n.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),n.push(` </office:automatic-styles>
`)};return function(s,o){var l=[Et],c=Os({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Os({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+d+`>
`),l.push(mm().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=s.SheetNames.length;++f)l.push(a(s.Sheets[s.SheetNames[f]],s,f,o));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function Sp(t,r){if(r.bookType=="fods")return Sh(t,r);var e=g0(),a="",i=[],n=[];return a="mimetype",Le(e,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Le(e,a,Sh(t,r)),i.push([a,"text/xml"]),n.push([a,"ContentFile"]),a="styles.xml",Le(e,a,XS(t,r)),i.push([a,"text/xml"]),n.push([a,"StylesFile"]),a="meta.xml",Le(e,a,Et+mm()),i.push([a,"text/xml"]),n.push([a,"MetadataFile"]),a="manifest.rdf",Le(e,a,bx(n)),i.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Le(e,a,wx(i)),e}function Vi(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function c0(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):rt(mi(t))}function jS(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Or(ga(t))}function KS(t,r){e:for(var e=0;e<=t.length-r.length;++e){for(var a=0;a<r.length;++a)if(t[e+a]!=r[a])continue e;return!0}return!1}function hi(t){var r=t.reduce(function(i,n){return i+n.length},0),e=new Uint8Array(r),a=0;return t.forEach(function(i){e.set(i,a),a+=i.length}),e}function Dh(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function qS(t,r){for(var e=(t[r+15]&127)<<7|t[r+14]>>1,a=t[r+14]&1,i=r+13;i>=r;--i)a=a*256+t[i];return(t[r+15]&128?-a:a)*Math.pow(10,e-6176)}function ZS(t,r,e){var a=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,i=e/Math.pow(10,a-6176);t[r+15]|=a>>7,t[r+14]|=(a&127)<<1;for(var n=0;i>=1;++n,i/=256)t[r+n]=i&255;t[r+15]|=e>=0?0:128}function Vs(t,r){var e=r?r[0]:0,a=t[e]&127;e:if(t[e++]>=128&&(a|=(t[e]&127)<<7,t[e++]<128||(a|=(t[e]&127)<<14,t[e++]<128)||(a|=(t[e]&127)<<21,t[e++]<128)||(a+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(a+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(a+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return r&&(r[0]=e),a}function Qe(t){var r=new Uint8Array(7);r[0]=t&127;var e=1;e:if(t>127){if(r[e-1]|=128,r[e]=t>>7&127,++e,t<=16383||(r[e-1]|=128,r[e]=t>>14&127,++e,t<=2097151)||(r[e-1]|=128,r[e]=t>>21&127,++e,t<=268435455)||(r[e-1]|=128,r[e]=t/256>>>21&127,++e,t<=34359738367)||(r[e-1]|=128,r[e]=t/65536>>>21&127,++e,t<=4398046511103))break e;r[e-1]|=128,r[e]=t/16777216>>>21&127,++e}return r.slice(0,e)}function ut(t){var r=0,e=t[r]&127;e:if(t[r++]>=128){if(e|=(t[r]&127)<<7,t[r++]<128||(e|=(t[r]&127)<<14,t[r++]<128)||(e|=(t[r]&127)<<21,t[r++]<128))break e;e|=(t[r]&127)<<28}return e}function je(t){for(var r=[],e=[0];e[0]<t.length;){var a=e[0],i=Vs(t,e),n=i&7;i=Math.floor(i/8);var s=0,o;if(i==0)break;switch(n){case 0:{for(var l=e[0];t[e[0]++]>=128;);o=t.slice(l,e[0])}break;case 5:s=4,o=t.slice(e[0],e[0]+s),e[0]+=s;break;case 1:s=8,o=t.slice(e[0],e[0]+s),e[0]+=s;break;case 2:s=Vs(t,e),o=t.slice(e[0],e[0]+s),e[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(n," for Field ").concat(i," at offset ").concat(a))}var c={data:o,type:n};r[i]==null?r[i]=[c]:r[i].push(c)}return r}function Yt(t){var r=[];return t.forEach(function(e,a){e.forEach(function(i){i.data&&(r.push(Qe(a*8+i.type)),i.type==2&&r.push(Qe(i.data.length)),r.push(i.data))})}),hi(r)}function j0(t,r){return t?.map(function(e){return r(e.data)})||[]}function Gr(t){for(var r,e=[],a=[0];a[0]<t.length;){var i=Vs(t,a),n=je(t.slice(a[0],a[0]+i));a[0]+=i;var s={id:ut(n[1][0].data),messages:[]};n[2].forEach(function(o){var l=je(o.data),c=ut(l[3][0].data);s.messages.push({meta:l,data:t.slice(a[0],a[0]+c)}),a[0]+=c}),(r=n[3])!=null&&r[0]&&(s.merge=ut(n[3][0].data)>>>0>0),e.push(s)}return e}function En(t){var r=[];return t.forEach(function(e){var a=[];a[1]=[{data:Qe(e.id),type:0}],a[2]=[],e.merge!=null&&(a[3]=[{data:Qe(+!!e.merge),type:0}]);var i=[];e.messages.forEach(function(s){i.push(s.data),s.meta[3]=[{type:0,data:Qe(s.data.length)}],a[2].push({data:Yt(s.meta),type:2})});var n=Yt(a);r.push(Qe(n.length)),r.push(n),i.forEach(function(s){return r.push(s)})}),hi(r)}function QS(t,r){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],a=Vs(r,e),i=[];e[0]<r.length;){var n=r[e[0]]&3;if(n==0){var s=r[e[0]++]>>2;if(s<60)++s;else{var o=s-59;s=r[e[0]],o>1&&(s|=r[e[0]+1]<<8),o>2&&(s|=r[e[0]+2]<<16),o>3&&(s|=r[e[0]+3]<<24),s>>>=0,s++,e[0]+=o}i.push(r.slice(e[0],e[0]+s)),e[0]+=s;continue}else{var l=0,c=0;if(n==1?(c=(r[e[0]]>>2&7)+4,l=(r[e[0]++]&224)<<3,l|=r[e[0]++]):(c=(r[e[0]++]>>2)+1,n==2?(l=r[e[0]]|r[e[0]+1]<<8,e[0]+=2):(l=(r[e[0]]|r[e[0]+1]<<8|r[e[0]+2]<<16|r[e[0]+3]<<24)>>>0,e[0]+=4)),i=[hi(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var d=hi(i);if(d.length!=a)throw new Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}function zr(t){for(var r=[],e=0;e<t.length;){var a=t[e++],i=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,r.push(QS(a,t.slice(e,e+i))),e+=i}if(e!==t.length)throw new Error("data is not a valid framed stream!");return hi(r)}function Sn(t){for(var r=[],e=0;e<t.length;){var a=Math.min(t.length-e,268435455),i=new Uint8Array(4);r.push(i);var n=Qe(a),s=n.length;r.push(n),a<=60?(s++,r.push(new Uint8Array([a-1<<2]))):a<=256?(s+=2,r.push(new Uint8Array([240,a-1&255]))):a<=65536?(s+=3,r.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(s+=4,r.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(s+=5,r.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),r.push(t.slice(e,e+a)),s+=a,i[0]=0,i[1]=s&255,i[2]=s>>8&255,i[3]=s>>16&255,e+=a}return hi(r)}function JS(t,r,e,a){var i=Vi(t),n=i.getUint32(4,!0),s=(a>1?12:8)+Dh(n&(a>1?3470:398))*4,o=-1,l=-1,c=NaN,d=new Date(2001,0,1);n&512&&(o=i.getUint32(s,!0),s+=4),s+=Dh(n&(a>1?12288:4096))*4,n&16&&(l=i.getUint32(s,!0),s+=4),n&32&&(c=i.getFloat64(s,!0),s+=8),n&64&&(d.setTime(d.getTime()+i.getFloat64(s,!0)*1e3),s+=8);var f;switch(t[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:r[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:e[o]};else if(l>-1)f={t:"s",v:r[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}function eD(t,r,e){var a=Vi(t),i=a.getUint32(8,!0),n=12,s=-1,o=-1,l=NaN,c=NaN,d=new Date(2001,0,1);i&1&&(l=qS(t,n),n+=16),i&2&&(c=a.getFloat64(n,!0),n+=8),i&4&&(d.setTime(d.getTime()+a.getFloat64(n,!0)*1e3),n+=8),i&8&&(o=a.getUint32(n,!0),n+=4),i&16&&(s=a.getUint32(n,!0),n+=4);var f;switch(t[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:r[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(s>-1)f={t:"s",v:e[s]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return f}function jc(t,r){var e=new Uint8Array(32),a=Vi(e),i=12,n=0;switch(e[0]=5,t.t){case"n":e[1]=2,ZS(e,i,t.v),n|=1,i+=16;break;case"b":e[1]=6,a.setFloat64(i,t.v?1:0,!0),n|=2,i+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));e[1]=3,a.setUint32(i,r.indexOf(t.v),!0),n|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return a.setUint32(8,n,!0),e.slice(0,i)}function Kc(t,r){var e=new Uint8Array(32),a=Vi(e),i=12,n=0;switch(e[0]=3,t.t){case"n":e[2]=2,a.setFloat64(i,t.v,!0),n|=32,i+=8;break;case"b":e[2]=6,a.setFloat64(i,t.v?1:0,!0),n|=32,i+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));e[2]=3,a.setUint32(i,r.indexOf(t.v),!0),n|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return a.setUint32(4,n,!0),e.slice(0,i)}function tD(t,r,e){switch(t[0]){case 0:case 1:case 2:case 3:return JS(t,r,e,t[0]);case 5:return eD(t,r,e);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ar(t){var r=je(t);return Vs(r[1][0].data)}function Th(t,r){var e=je(r.data),a=ut(e[1][0].data),i=e[3],n=[];return(i||[]).forEach(function(s){var o=je(s.data),l=ut(o[1][0].data)>>>0;switch(a){case 1:n[l]=c0(o[3][0].data);break;case 8:{var c=t[ar(o[9][0].data)][0],d=je(c.data),f=t[ar(d[1][0].data)][0],h=ut(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=je(f.data);n[l]=m[3].map(function(p){return c0(p.data)}).join("")}break}}),n}function rD(t,r){var e,a,i,n,s,o,l,c,d,f,h,m,p,u,_=je(t),E=ut(_[1][0].data)>>>0,k=ut(_[2][0].data)>>>0,w=((a=(e=_[8])==null?void 0:e[0])==null?void 0:a.data)&&ut(_[8][0].data)>0||!1,L,U;if((n=(i=_[7])==null?void 0:i[0])!=null&&n.data&&r!=0)L=(o=(s=_[7])==null?void 0:s[0])==null?void 0:o.data,U=(c=(l=_[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(d=_[4])==null?void 0:d[0])!=null&&f.data&&r!=1)L=(m=(h=_[4])==null?void 0:h[0])==null?void 0:m.data,U=(u=(p=_[3])==null?void 0:p[0])==null?void 0:u.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var R=w?4:1,T=Vi(L),B=[],N=0;N<L.length/2;++N){var K=T.getUint16(N*2,!0);K<65535&&B.push([N,K])}if(B.length!=k)throw"Expected ".concat(k," cells, found ").concat(B.length);var q=[];for(N=0;N<B.length-1;++N)q[B[N][0]]=U.subarray(B[N][1]*R,B[N+1][1]*R);return B.length>=1&&(q[B[B.length-1][0]]=U.subarray(B[B.length-1][1]*R)),{R:E,cells:q}}function aD(t,r){var e,a=je(r.data),i=(e=a?.[7])!=null&&e[0]?ut(a[7][0].data)>>>0>0?1:0:-1,n=j0(a[5],function(s){return rD(s,i)});return{nrows:ut(a[4][0].data)>>>0,data:n.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(l,c){if(s[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));s[o.R][c]=l}),s},[])}}function iD(t,r,e){var a,i=je(r.data),n={s:{r:0,c:0},e:{r:0,c:0}};if(n.e.r=(ut(i[6][0].data)>>>0)-1,n.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(n.e.c=(ut(i[7][0].data)>>>0)-1,n.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));e["!ref"]=Ne(n);var s=je(i[4][0].data),o=Th(t,t[ar(s[4][0].data)][0]),l=(a=s[17])!=null&&a[0]?Th(t,t[ar(s[17][0].data)][0]):[],c=je(s[3][0].data),d=0;c[1].forEach(function(f){var h=je(f.data),m=t[ar(h[2][0].data)][0],p=ut(m.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var u=aD(t,m);u.data.forEach(function(_,E){_.forEach(function(k,w){var L=Oe({r:d+E,c:w}),U=tD(k,o,l);U&&(e[L]=U)})}),d+=u.nrows})}function nD(t,r){var e=je(r.data),a={"!ref":"A1"},i=t[ar(e[2][0].data)],n=ut(i[0].meta[1][0].data);if(n!=6001)throw new Error("6000 unexpected reference to ".concat(n));return iD(t,i[0],a),a}function sD(t,r){var e,a=je(r.data),i={name:(e=a[1])!=null&&e[0]?c0(a[1][0].data):"",sheets:[]},n=j0(a[2],ar);return n.forEach(function(s){t[s].forEach(function(o){var l=ut(o.meta[1][0].data);l==6e3&&i.sheets.push(nD(t,o))})}),i}function oD(t,r){var e=ed(),a=je(r.data),i=j0(a[1],ar);if(i.forEach(function(n){t[n].forEach(function(s){var o=ut(s.meta[1][0].data);if(o==2){var l=sD(t,s);l.sheets.forEach(function(c,d){td(e,c,d==0?l.name:l.name+"_"+d,!0)})}})}),e.SheetNames.length==0)throw new Error("Empty NUMBERS file");return e}function qc(t){var r,e,a,i,n={},s=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=zr(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var d;try{d=Gr(c)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){n[f.id]=f.messages,s.push(f.id)})}}),!s.length)throw new Error("File has no messages");var o=((i=(a=(e=(r=n?.[1])==null?void 0:r[0])==null?void 0:e.meta)==null?void 0:a[1])==null?void 0:i[0].data)&&ut(n[1][0].meta[1][0].data)==1&&n[1][0];if(o||s.forEach(function(l){n[l].forEach(function(c){var d=ut(c.meta[1][0].data)>>>0;if(d==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return oD(n,o)}function lD(t,r,e){var a,i,n,s;if(!((a=t[6])!=null&&a[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(n=t[8])==null?void 0:n[0])==null?void 0:s.data)&&ut(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Vi(t[7][0].data),d=0,f=[],h=Vi(t[4][0].data),m=0,p=[],u=0;u<r.length;++u){if(r[u]==null){c.setUint16(u*2,65535,!0),h.setUint16(u*2,65535);continue}c.setUint16(u*2,d,!0),h.setUint16(u*2,m,!0);var _,E;switch(typeof r[u]){case"string":_=jc({t:"s",v:r[u]},e),E=Kc({t:"s",v:r[u]},e);break;case"number":_=jc({t:"n",v:r[u]},e),E=Kc({t:"n",v:r[u]},e);break;case"boolean":_=jc({t:"b",v:r[u]},e),E=Kc({t:"b",v:r[u]},e);break;default:throw new Error("Unsupported value "+r[u])}f.push(_),d+=_.length,p.push(E),m+=E.length,++l}for(t[2][0].data=Qe(l);u<t[7][0].data.length/2;++u)c.setUint16(u*2,65535,!0),h.setUint16(u*2,65535,!0);return t[6][0].data=hi(f),t[3][0].data=hi(p),l}function cD(t,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=br(e["!ref"]);a.s.r=a.s.c=0;var i=!1;a.e.c>9&&(i=!0,a.e.c=9),a.e.r>49&&(i=!0,a.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Ne(a)));var n=Sl(e,{range:a,header:1}),s=["~Sh33tJ5~"];n.forEach(function(I){return I.forEach(function(M){typeof M=="string"&&s.push(M)})});var o={},l=[],c=Se.read(r.numbers,{type:"base64"});c.FileIndex.map(function(I,M){return[I,c.FullPaths[M]]}).forEach(function(I){var M=I[0],J=I[1];if(M.type==2&&M.name.match(/\.iwa/)){var ue=M.content,ie=zr(ue),ne=Gr(ie);ne.forEach(function(te){l.push(te.id),o[te.id]={deps:[],location:J,type:ut(te.messages[0].meta[1][0].data)}})}}),l.sort(function(I,M){return I-M});var d=l.filter(function(I){return I>1}).map(function(I){return[I,Qe(I)]});c.FileIndex.map(function(I,M){return[I,c.FullPaths[M]]}).forEach(function(I){var M=I[0],J=I[1];if(M.name.match(/\.iwa/)){var ue=Gr(zr(M.content));ue.forEach(function(ie){ie.messages.forEach(function(ne){d.forEach(function(te){ie.messages.some(function(Re){return ut(Re.meta[1][0].data)!=11006&&KS(Re.data,te[1])})&&o[te[0]].deps.push(ie.id)})})})}});function f(){for(var I=927262;I<2e6;++I)if(!o[I])return I;throw new Error("Too many messages")}for(var h=Se.find(c,o[1].location),m=Gr(zr(h.content)),p,u=0;u<m.length;++u){var _=m[u];_.id==1&&(p=_)}var E=ar(je(p.messages[0].data)[1][0].data);for(h=Se.find(c,o[E].location),m=Gr(zr(h.content)),u=0;u<m.length;++u)_=m[u],_.id==E&&(p=_);for(E=ar(je(p.messages[0].data)[2][0].data),h=Se.find(c,o[E].location),m=Gr(zr(h.content)),u=0;u<m.length;++u)_=m[u],_.id==E&&(p=_);for(E=ar(je(p.messages[0].data)[2][0].data),h=Se.find(c,o[E].location),m=Gr(zr(h.content)),u=0;u<m.length;++u)_=m[u],_.id==E&&(p=_);var k=je(p.messages[0].data);{k[6][0].data=Qe(a.e.r+1),k[7][0].data=Qe(a.e.c+1);var w=ar(k[46][0].data),L=Se.find(c,o[w].location),U=Gr(zr(L.content));{for(var R=0;R<U.length&&U[R].id!=w;++R);if(U[R].id!=w)throw"Bad ColumnRowUIDMapArchive";var T=je(U[R].messages[0].data);T[1]=[],T[2]=[],T[3]=[];for(var B=0;B<=a.e.c;++B){var N=[];N[1]=N[2]=[{type:0,data:Qe(B+420690)}],T[1].push({type:2,data:Yt(N)}),T[2].push({type:0,data:Qe(B)}),T[3].push({type:0,data:Qe(B)})}T[4]=[],T[5]=[],T[6]=[];for(var K=0;K<=a.e.r;++K)N=[],N[1]=N[2]=[{type:0,data:Qe(K+726270)}],T[4].push({type:2,data:Yt(N)}),T[5].push({type:0,data:Qe(K)}),T[6].push({type:0,data:Qe(K)});U[R].messages[0].data=Yt(T)}L.content=Sn(En(U)),L.size=L.content.length,delete k[46];var q=je(k[4][0].data);{q[7][0].data=Qe(a.e.r+1);var V=je(q[1][0].data),se=ar(V[2][0].data);L=Se.find(c,o[se].location),U=Gr(zr(L.content));{if(U[0].id!=se)throw"Bad HeaderStorageBucket";var ge=je(U[0].messages[0].data);for(K=0;K<n.length;++K){var oe=je(ge[2][0].data);oe[1][0].data=Qe(K),oe[4][0].data=Qe(n[K].length),ge[2][K]={type:ge[2][0].type,data:Yt(oe)}}U[0].messages[0].data=Yt(ge)}L.content=Sn(En(U)),L.size=L.content.length;var Ee=ar(q[2][0].data);L=Se.find(c,o[Ee].location),U=Gr(zr(L.content));{if(U[0].id!=Ee)throw"Bad HeaderStorageBucket";for(ge=je(U[0].messages[0].data),B=0;B<=a.e.c;++B)oe=je(ge[2][0].data),oe[1][0].data=Qe(B),oe[4][0].data=Qe(a.e.r+1),ge[2][B]={type:ge[2][0].type,data:Yt(oe)};U[0].messages[0].data=Yt(ge)}L.content=Sn(En(U)),L.size=L.content.length;var xe=ar(q[4][0].data);(function(){for(var I=Se.find(c,o[xe].location),M=Gr(zr(I.content)),J,ue=0;ue<M.length;++ue){var ie=M[ue];ie.id==xe&&(J=ie)}var ne=je(J.messages[0].data);{ne[3]=[];var te=[];s.forEach(function(qe,Ge){te[1]=[{type:0,data:Qe(Ge)}],te[2]=[{type:0,data:Qe(1)}],te[3]=[{type:2,data:jS(qe)}],ne[3].push({type:2,data:Yt(te)})})}J.messages[0].data=Yt(ne);var Re=En(M),F=Sn(Re);I.content=F,I.size=I.content.length})();var He=je(q[3][0].data);{var pe=He[1][0];delete He[2];var we=je(pe.data);{var ee=ar(we[2][0].data);(function(){for(var I=Se.find(c,o[ee].location),M=Gr(zr(I.content)),J,ue=0;ue<M.length;++ue){var ie=M[ue];ie.id==ee&&(J=ie)}var ne=je(J.messages[0].data);{delete ne[6],delete He[7];var te=new Uint8Array(ne[5][0].data);ne[5]=[];for(var Re=0,F=0;F<=a.e.r;++F){var qe=je(te);Re+=lD(qe,n[F],s),qe[1][0].data=Qe(F),ne[5].push({data:Yt(qe),type:2})}ne[1]=[{type:0,data:Qe(a.e.c+1)}],ne[2]=[{type:0,data:Qe(a.e.r+1)}],ne[3]=[{type:0,data:Qe(Re)}],ne[4]=[{type:0,data:Qe(a.e.r+1)}]}J.messages[0].data=Yt(ne);var Ge=En(M),Ze=Sn(Ge);I.content=Ze,I.size=I.content.length})()}pe.data=Yt(we)}q[3][0].data=Yt(He)}k[4][0].data=Yt(q)}p.messages[0].data=Yt(k);var O=En(m),G=Sn(O);return h.content=G,h.size=h.content.length,c}function Dp(t){return function(e){for(var a=0;a!=t.length;++a){var i=t[a];e[i[0]]===void 0&&(e[i[0]]=i[1]),i[2]==="n"&&(e[i[0]]=Number(e[i[0]]))}}}function K0(t){Dp([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function q0(t){Dp([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function dD(t){return Be.WS.indexOf(t)>-1?"sheet":Be.CS&&t==Be.CS?"chart":Be.DS&&t==Be.DS?"dialog":Be.MS&&t==Be.MS?"macro":t&&t.length?t:"sheet"}function fD(t,r){if(!t)return 0;try{t=r.map(function(a){return a.id||(a.id=a.strRelID),[a.name,t["!id"][a.id].Target,dD(t["!id"][a.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function uD(t,r,e,a,i,n,s,o,l,c,d,f){try{n[a]=bs(Mr(t,e,!0),r);var h=Ft(t,r),m;switch(o){case"sheet":m=PE(h,r,i,l,n[a],c,d,f);break;case"chart":if(m=RE(h,r,i,l,n[a],c,d,f),!m||!m["!drawel"])break;var p=xs(m["!drawel"].Target,r),u=Is(p),_=yy(Mr(t,p,!0),bs(Mr(t,u,!0),p)),E=xs(_,p),k=Is(E);m=lE(Mr(t,E,!0),E,l,bs(Mr(t,k,!0),E),c,m);break;case"macro":m=NE(h,r,i,l,n[a],c,d,f);break;case"dialog":m=LE(h,r,i,l,n[a],c,d,f);break;default:throw new Error("Unrecognized sheet type "+o)}s[a]=m;var w=[];n&&n[a]&&mt(n[a]).forEach(function(L){var U="";if(n[a][L].Type==Be.CMNT){U=xs(n[a][L].Target,r);var R=HE(Ft(t,U,!0),U,l);if(!R||!R.length)return;hh(m,R,!1)}n[a][L].Type==Be.TCMNT&&(U=xs(n[a][L].Target,r),w=w.concat(Cy(Ft(t,U,!0),l)))}),w&&w.length&&hh(m,w,!0,l.people||[])}catch(L){if(l.WTF)throw L}}function Hr(t){return t.charAt(0)=="/"?t.slice(1):t}function hD(t,r){if(Vn(),r=r||{},K0(r),Yr(t,"META-INF/manifest.xml")||Yr(t,"objectdata.xml"))return kh(t,r);if(Yr(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof qc<"u"){if(t.FileIndex)return qc(t);var e=Se.utils.cfb_new();return Pu(t).forEach(function(ge){Le(e,ge,$h(t,ge))}),qc(e)}throw new Error("Unsupported NUMBERS file")}if(!Yr(t,"[Content_Types].xml"))throw Yr(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Yr(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Pu(t),i=gx(Mr(t,"[Content_Types].xml")),n=!1,s,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Ft(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Ft(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),n=!0}i.workbooks[0].slice(-3)=="bin"&&(n=!0);var l={},c={};if(!r.bookSheets&&!r.bookProps){if(Cs=[],i.sst)try{Cs=UE(Ft(t,Hr(i.sst)),i.sst,r)}catch(ge){if(r.WTF)throw ge}r.cellStyles&&i.themes.length&&(l=VE(Mr(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],r)),i.style&&(c=BE(Ft(t,Hr(i.style)),i.style,l,r))}i.links.map(function(ge){try{var oe=bs(Mr(t,Is(Hr(ge))),ge);return GE(Ft(t,Hr(ge)),oe,ge,r)}catch{}});var d=IE(Ft(t,Hr(i.workbooks[0])),i.workbooks[0],r),f={},h="";i.coreprops.length&&(h=Ft(t,Hr(i.coreprops[0]),!0),h&&(f=pm(h)),i.extprops.length!==0&&(h=Ft(t,Hr(i.extprops[0]),!0),h&&kx(h,f,r)));var m={};(!r.bookSheets||r.bookProps)&&i.custprops.length!==0&&(h=Mr(t,Hr(i.custprops[0]),!0),h&&(m=Sx(h,r)));var p={};if((r.bookSheets||r.bookProps)&&(d.Sheets?s=d.Sheets.map(function(oe){return oe.name}):f.Worksheets&&f.SheetNames.length>0&&(s=f.SheetNames),r.bookProps&&(p.Props=f,p.Custprops=m),r.bookSheets&&typeof s<"u"&&(p.SheetNames=s),r.bookSheets?p.SheetNames:r.bookProps))return p;s={};var u={};r.bookDeps&&i.calcchain&&(u=WE(Ft(t,Hr(i.calcchain)),i.calcchain,r));var _=0,E={},k,w;{var L=d.Sheets;f.Worksheets=L.length,f.SheetNames=[];for(var U=0;U!=L.length;++U)f.SheetNames[U]=L[U].name}var R=n?"bin":"xml",T=i.workbooks[0].lastIndexOf("/"),B=(i.workbooks[0].slice(0,T+1)+"_rels/"+i.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");Yr(t,B)||(B="xl/_rels/workbook."+R+".rels");var N=bs(Mr(t,B,!0),B.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(r.xlmeta=zE(Ft(t,Hr(i.metadata[0])),i.metadata[0],r)),(i.people||[]).length>=1&&(r.people=Ey(Ft(t,Hr(i.people[0])),r)),N&&(N=fD(N,d.Sheets));var K=Ft(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=f.Worksheets;++_){var q="sheet";if(N&&N[_]?(k="xl/"+N[_][1].replace(/[\/]?xl\//,""),Yr(t,k)||(k=N[_][1]),Yr(t,k)||(k=B.replace(/_rels\/.*$/,"")+N[_][1]),q=N[_][2]):(k="xl/worksheets/sheet"+(_+1-K)+"."+R,k=k.replace(/sheet0\./,"sheet.")),w=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(_!=r.sheets)continue e;break;case"string":if(f.SheetNames[_].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var V=!1,se=0;se!=r.sheets.length;++se)typeof r.sheets[se]=="number"&&r.sheets[se]==_&&(V=1),typeof r.sheets[se]=="string"&&r.sheets[se].toLowerCase()==f.SheetNames[_].toLowerCase()&&(V=1);if(!V)continue e}}uD(t,k,w,f.SheetNames[_],_,E,s,q,r,d,l,c)}return p={Directory:i,Workbook:d,Props:f,Custprops:m,Deps:u,Sheets:s,SheetNames:f.SheetNames,Strings:Cs,Styles:c,Themes:l,SSF:st(Fe)},r&&r.bookFiles&&(t.files?(p.keys=a,p.files=t.files):(p.keys=[],p.files={},t.FullPaths.forEach(function(ge,oe){ge=ge.replace(/^Root Entry[\/]/,""),p.keys.push(ge),p.files[ge]=t.FileIndex[oe]}))),r&&r.bookVBA&&(i.vba.length>0?p.vbaraw=Ft(t,Hr(i.vba[0]),!0):i.defaults&&i.defaults.bin===Iy&&(p.vbaraw=Ft(t,"xl/vbaProject.bin",!0))),p}function mD(t,r){var e=r||{},a="Workbook",i=Se.find(t,a);try{if(a="/!DataSpaces/Version",i=Se.find(t,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(z2(i.content),a="/!DataSpaces/DataSpaceMap",i=Se.find(t,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);var n=$2(i.content);if(n.length!==1||n[0].comps.length!==1||n[0].comps[0].t!==0||n[0].name!=="StrongEncryptionDataSpace"||n[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Se.find(t,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=X2(i.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Se.find(t,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);K2(i.content)}catch{}if(a="/EncryptionInfo",i=Se.find(t,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=q2(i.content);if(a="/EncryptedPackage",i=Se.find(t,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,e.password||"",e);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,e.password||"",e);throw new Error("File is password-protected")}function pD(t,r){return r.bookType=="ods"?Sp(t,r):r.bookType=="numbers"?cD(t,r):r.bookType=="xlsb"?_D(t,r):gD(t,r)}function _D(t,r){An=1024,t&&!t.SSF&&(t.SSF=st(Fe)),t&&t.SSF&&(Vn(),Tl(t.SSF),r.revssf=Fl(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ks?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var e=r.bookType=="xlsb"?"bin":"xml",a=ep.indexOf(r.bookType)>-1,i=R0();q0(r=r||{});var n=g0(),s="",o=0;if(r.cellXfs=[],_i(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),s="docProps/core.xml",Le(n,s,_m(t.Props,r)),i.coreprops.push(s),Je(r.rels,2,s,Be.CORE_PROPS),s="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,Le(n,s,vm(t.Props,r)),i.extprops.push(s),Je(r.rels,3,s,Be.EXT_PROPS),t.Custprops!==t.Props&&mt(t.Custprops||{}).length>0&&(s="docProps/custom.xml",Le(n,s,wm(t.Custprops,r)),i.custprops.push(s),Je(r.rels,4,s,Be.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},f=t.Sheets[t.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+o+"."+e,Le(n,s,$E(o-1,s,r,t,d)),i.sheets.push(s),Je(r.wbrels,-1,"worksheets/sheet"+o+"."+e,Be.WS[0])}if(f){var m=f["!comments"],p=!1,u="";m&&m.length>0&&(u="xl/comments"+o+"."+e,Le(n,u,KE(m,u,r)),i.comments.push(u),Je(d,-1,"../comments"+o+"."+e,Be.CMNT),p=!0),f["!legacy"]&&p&&Le(n,"xl/drawings/vmlDrawing"+o+".vml",Qm(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Le(n,Is(s),On(d))}return r.Strings!=null&&r.Strings.length>0&&(s="xl/sharedStrings."+e,Le(n,s,jE(r.Strings,s,r)),i.strs.push(s),Je(r.wbrels,-1,"sharedStrings."+e,Be.SST)),s="xl/workbook."+e,Le(n,s,YE(t,s,r)),i.workbooks.push(s),Je(r.rels,1,s,Be.WB),s="xl/theme/theme1.xml",Le(n,s,H0(t.Themes,r)),i.themes.push(s),Je(r.wbrels,-1,"theme/theme1.xml",Be.THEME),s="xl/styles."+e,Le(n,s,XE(t,s,r)),i.styles.push(s),Je(r.wbrels,-1,"styles."+e,Be.STY),t.vbaraw&&a&&(s="xl/vbaProject.bin",Le(n,s,t.vbaraw),i.vba.push(s),Je(r.wbrels,-1,"vbaProject.bin",Be.VBA)),s="xl/metadata."+e,Le(n,s,qE(s)),i.metadata.push(s),Je(r.wbrels,-1,"metadata."+e,Be.XLMETA),Le(n,"[Content_Types].xml",hm(i,r)),Le(n,"_rels/.rels",On(r.rels)),Le(n,"xl/_rels/workbook."+e+".rels",On(r.wbrels)),delete r.revssf,delete r.ssf,n}function gD(t,r){An=1024,t&&!t.SSF&&(t.SSF=st(Fe)),t&&t.SSF&&(Vn(),Tl(t.SSF),r.revssf=Fl(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ks?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var e="xml",a=ep.indexOf(r.bookType)>-1,i=R0();q0(r=r||{});var n=g0(),s="",o=0;if(r.cellXfs=[],_i(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),s="docProps/core.xml",Le(n,s,_m(t.Props,r)),i.coreprops.push(s),Je(r.rels,2,s,Be.CORE_PROPS),s="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,Le(n,s,vm(t.Props,r)),i.extprops.push(s),Je(r.rels,3,s,Be.EXT_PROPS),t.Custprops!==t.Props&&mt(t.Custprops||{}).length>0&&(s="docProps/custom.xml",Le(n,s,wm(t.Custprops,r)),i.custprops.push(s),Je(r.rels,4,s,Be.CUST_PROPS));var d=["SheetJ5"];for(r.tcid=0,o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:s="xl/worksheets/sheet"+o+"."+e,Le(n,s,fp(o-1,r,t,f)),i.sheets.push(s),Je(r.wbrels,-1,"worksheets/sheet"+o+"."+e,Be.WS[0])}if(h){var p=h["!comments"],u=!1,_="";if(p&&p.length>0){var E=!1;p.forEach(function(k){k[1].forEach(function(w){w.T==!0&&(E=!0)})}),E&&(_="xl/threadedComments/threadedComment"+o+"."+e,Le(n,_,ky(p,d,r)),i.threadedcomments.push(_),Je(f,-1,"../threadedComments/threadedComment"+o+"."+e,Be.TCMNT)),_="xl/comments"+o+"."+e,Le(n,_,Jm(p,r)),i.comments.push(_),Je(f,-1,"../comments"+o+"."+e,Be.CMNT),u=!0}h["!legacy"]&&u&&Le(n,"xl/drawings/vmlDrawing"+o+".vml",Qm(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Le(n,Is(s),On(f))}return r.Strings!=null&&r.Strings.length>0&&(s="xl/sharedStrings."+e,Le(n,s,Um(r.Strings,r)),i.strs.push(s),Je(r.wbrels,-1,"sharedStrings."+e,Be.SST)),s="xl/workbook."+e,Le(n,s,_p(t,r)),i.workbooks.push(s),Je(r.rels,1,s,Be.WB),s="xl/theme/theme1.xml",Le(n,s,H0(t.Themes,r)),i.themes.push(s),Je(r.wbrels,-1,"theme/theme1.xml",Be.THEME),s="xl/styles."+e,Le(n,s,jm(t,r)),i.styles.push(s),Je(r.wbrels,-1,"styles."+e,Be.STY),t.vbaraw&&a&&(s="xl/vbaProject.bin",Le(n,s,t.vbaraw),i.vba.push(s),Je(r.wbrels,-1,"vbaProject.bin",Be.VBA)),s="xl/metadata."+e,Le(n,s,Zm()),i.metadata.push(s),Je(r.wbrels,-1,"metadata."+e,Be.XLMETA),d.length>1&&(s="xl/persons/person.xml",Le(n,s,Sy(d,r)),i.people.push(s),Je(r.wbrels,-1,"persons/person.xml",Be.PEOPLE)),Le(n,"[Content_Types].xml",hm(i,r)),Le(n,"_rels/.rels",On(r.rels)),Le(n,"xl/_rels/workbook."+e+".rels",On(r.wbrels)),delete r.revssf,delete r.ssf,n}function Z0(t,r){var e="";switch((r||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=Ir(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function xD(t,r){return Se.find(t,"EncryptedPackage")?mD(t,r):wp(t,r)}function vD(t,r){var e,a=t,i=r||{};return i.type||(i.type=Ue&&Buffer.isBuffer(t)?"buffer":"base64"),e=Xh(a,i),hD(e,i)}function Tp(t,r){var e=0;e:for(;e<t.length;)switch(t.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return o0(t.slice(e),r);default:break e}return Nn.to_workbook(t,r)}function wD(t,r){var e="",a=Z0(t,r);switch(r.type){case"base64":e=Ir(t);break;case"binary":e=t;break;case"buffer":e=t.toString("binary");break;case"array":e=Ri(t);break;default:throw new Error("Unrecognized type "+r.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(e=rt(e)),r.type="binary",Tp(e,r)}function yD(t,r){var e=t;return r.type=="base64"&&(e=Ir(e)),e=Ke.utils.decode(1200,e.slice(2),"str"),r.type="binary",Tp(e,r)}function bD(t){return t.match(/[^\x00-\x7F]/)?ga(t):t}function Zc(t,r,e,a){return a?(e.type="string",Nn.to_workbook(t,e)):Nn.to_workbook(r,e)}function El(t,r){u0();var e=r||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return El(new Uint8Array(t),(e=st(e),e.type="array",e));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var a=t,i=[0,0,0,0],n=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),In={},e.dateNF&&(In.dateNF=e.dateNF),e.type||(e.type=Ue&&Buffer.isBuffer(t)?"buffer":"base64"),e.type=="file"&&(e.type=Ue?"buffer":"binary",a=_1(t),typeof Uint8Array<"u"&&!Ue&&(e.type="array")),e.type=="string"&&(n=!0,e.type="binary",e.codepage=65001,a=bD(t)),e.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return e=st(e),e.type="array",El(h0(a),e)}switch((i=Z0(a,e))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return xD(Se.read(a,e),e);break;case 9:if(i[1]<=8)return wp(a,e);break;case 60:return o0(a,e);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return D2(a,e);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return Bm.to_workbook(a,e);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?vD(a,e):Zc(t,a,e,n);case 239:return i[3]===60?o0(a,e):Zc(t,a,e,n);case 255:if(i[1]===254)return yD(a,e);if(i[1]===0&&i[2]===2&&i[3]===0)return Mi.to_workbook(a,e);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Mi.to_workbook(a,e);break;case 3:case 131:case 139:case 140:return s0.to_workbook(a,e);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return Ym.to_workbook(a,e);break;case 10:case 13:case 32:return wD(a,e);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return S2.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?s0.to_workbook(a,e):Zc(t,a,e,n)}function Ap(t,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Hs(r.file,Se.write(t,{type:Ue?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Se.write(t,r)}function CD(t,r){var e=st(r||{}),a=pD(t,e);return kD(a,e)}function kD(t,r){var e={},a=Ue?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(e.compression="DEFLATE"),r.password)e.type=a;else switch(r.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":e.type=a;break;default:throw new Error("Unrecognized type "+r.type)}var i=t.FullPaths?Se.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!r.compression}):t.generate(e);if(typeof Deno<"u"&&typeof i=="string"){if(r.type=="binary"||r.type=="base64")return i;i=new Uint8Array(Dl(i))}return r.password&&typeof encrypt_agile<"u"?Ap(encrypt_agile(i,r.password),r):r.type==="file"?Hs(r.file,i):r.type=="string"?rt(i):i}function ED(t,r){var e=r||{},a=bS(t,e);return Ap(a,e)}function _a(t,r,e){e||(e="");var a=e+t;switch(r.type){case"base64":return Ts(ga(a));case"binary":return ga(a);case"string":return t;case"file":return Hs(r.file,a,"utf8");case"buffer":return Ue?Ra(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):_a(a,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function SD(t,r){switch(r.type){case"base64":return Ts(t);case"binary":return t;case"string":return t;case"file":return Hs(r.file,t,"binary");case"buffer":return Ue?Ra(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function hl(t,r){switch(r.type){case"string":case"base64":case"binary":for(var e="",a=0;a<t.length;++a)e+=String.fromCharCode(t[a]);return r.type=="base64"?Ts(e):r.type=="string"?rt(e):e;case"file":return Hs(r.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+r.type)}}function Q0(t,r){u0(),xE(t);var e=st(r||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var a=Q0(t,e);return e.type="array",Dl(a)}var i=0;if(e.sheet&&(typeof e.sheet=="number"?i=e.sheet:i=t.SheetNames.indexOf(e.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return _a(pS(t,e),e);case"slk":case"sylk":return _a(Lm.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"htm":case"html":return _a(bp(t.Sheets[t.SheetNames[i]],e),e);case"txt":return SD(Fp(t.Sheets[t.SheetNames[i]],e),e);case"csv":return _a(J0(t.Sheets[t.SheetNames[i]],e),e,"\uFEFF");case"dif":return _a(Bm.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"dbf":return hl(s0.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"prn":return _a(Nn.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"rtf":return _a(Ym.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"eth":return _a(Vm.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"fods":return _a(Sp(t,e),e);case"wk1":return hl(Mi.sheet_to_wk1(t.Sheets[t.SheetNames[i]],e),e);case"wk3":return hl(Mi.book_to_wk3(t,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),hl(yp(t,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),ED(t,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return CD(t,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function DD(t,r,e,a,i,n,s,o){var l=kt(e),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:e,enumerable:!1})}catch{h.__rowNum__=e}else h.__rowNum__=e;if(!s||t[e])for(var m=r.s.c;m<=r.e.c;++m){var p=s?t[e][m]:t[a[m]+l];if(p===void 0||p.t===void 0){if(c===void 0)continue;n[m]!=null&&(h[n[m]]=c);continue}var u=p.v;switch(p.t){case"z":if(u==null)break;continue;case"e":u=u==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(n[m]!=null){if(u==null)if(p.t=="e"&&u===null)h[n[m]]=null;else if(c!==void 0)h[n[m]]=c;else if(d&&u===null)h[n[m]]=null;else continue;else h[n[m]]=d&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?u:Pa(p,u,o);u!=null&&(f=!1)}}return{row:h,isempty:f}}function Sl(t,r){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},a=0,i=1,n=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=r||{},d=c.range!=null?c.range:t["!ref"];switch(c.header===1?a=1:c.header==="A"?a=2:Array.isArray(c.header)?a=3:c.header==null&&(a=0),typeof d){case"string":l=Xe(d);break;case"number":l=Xe(t["!ref"]),l.s.r=d;break;default:l=d}a>0&&(i=0);var f=kt(l.s.r),h=[],m=[],p=0,u=0,_=Array.isArray(t),E=l.s.r,k=0,w={};_&&!t[E]&&(t[E]=[]);var L=c.skipHidden&&t["!cols"]||[],U=c.skipHidden&&t["!rows"]||[];for(k=l.s.c;k<=l.e.c;++k)if(!(L[k]||{}).hidden)switch(h[k]=lt(k),e=_?t[E][k]:t[h[k]+f],a){case 1:n[k]=k-l.s.c;break;case 2:n[k]=h[k];break;case 3:n[k]=c.header[k-l.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),o=s=Pa(e,null,c),u=w[s]||0,!u)w[s]=1;else{do o=s+"_"+u++;while(w[o]);w[s]=u,w[o]=1}n[k]=o}for(E=l.s.r+i;E<=l.e.r;++E)if(!(U[E]||{}).hidden){var R=DD(t,l,E,h,a,n,_,c);(R.isempty===!1||(a===1?c.blankrows!==!1:c.blankrows))&&(m[p++]=R.row)}return m.length=p,m}var Ah=/"/g;function TD(t,r,e,a,i,n,s,o){for(var l=!0,c=[],d="",f=kt(e),h=r.s.c;h<=r.e.c;++h)if(a[h]){var m=o.dense?(t[e]||[])[h]:t[a[h]+f];if(m==null)d="";else if(m.v!=null){l=!1,d=""+(o.rawNumbers&&m.t=="n"?m.v:Pa(m,null,o));for(var p=0,u=0;p!==d.length;++p)if((u=d.charCodeAt(p))===i||u===n||u===34||o.forceQuotes){d='"'+d.replace(Ah,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(l=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(Ah,'""')+'"')):d="";c.push(d)}return o.blankrows===!1&&l?null:c.join(s)}function J0(t,r){var e=[],a=r??{};if(t==null||t["!ref"]==null)return"";var i=Xe(t["!ref"]),n=a.FS!==void 0?a.FS:",",s=n.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,l=o.charCodeAt(0),c=new RegExp((n=="|"?"\\|":n)+"+$"),d="",f=[];a.dense=Array.isArray(t);for(var h=a.skipHidden&&t["!cols"]||[],m=a.skipHidden&&t["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(h[p]||{}).hidden||(f[p]=lt(p));for(var u=0,_=i.s.r;_<=i.e.r;++_)(m[_]||{}).hidden||(d=TD(t,i,_,f,s,l,n,a),d!=null&&(a.strip&&(d=d.replace(c,"")),(d||a.blankrows!==!1)&&e.push((u++?o:"")+d)));return delete a.dense,e.join("")}function Fp(t,r){r||(r={}),r.FS="	",r.RS=`
`;var e=J0(t,r);if(typeof Ke>"u"||r.type=="string")return e;var a=Ke.utils.encode(1200,e,"str");return"\xFF\xFE"+a}function AD(t){var r="",e,a="";if(t==null||t["!ref"]==null)return[];var i=Xe(t["!ref"]),n="",s=[],o,l=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)s[o]=lt(o);for(var d=i.s.r;d<=i.e.r;++d)for(n=kt(d),o=i.s.c;o<=i.e.c;++o)if(r=s[o]+n,e=c?(t[d]||[])[o]:t[r],a="",e!==void 0){if(e.F!=null){if(r=e.F,!e.f)continue;a=e.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(e.f!=null)a=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)a=""+e.v;else if(e.t=="b")a=e.v?"TRUE":"FALSE";else if(e.w!==void 0)a="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?a="'"+e.v:a=""+e.v}}l[l.length]=r+"="+a}return l}function Op(t,r,e){var a=e||{},i=+!a.skipHeader,n=t||{},s=0,o=0;if(n&&a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var l=typeof a.origin=="string"?ct(a.origin):a.origin;s=l.r,o=l.c}var c,d={s:{c:0,r:0},e:{c:o,r:s+r.length-1+i}};if(n["!ref"]){var f=Xe(n["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),s==-1&&(s=f.e.r+1,d.e.r=s+r.length-1+i)}else s==-1&&(s=0,d.e.r=r.length-1+i);var h=a.header||[],m=0;r.forEach(function(u,_){mt(u).forEach(function(E){(m=h.indexOf(E))==-1&&(h[m=h.length]=E);var k=u[E],w="z",L="",U=Oe({c:o+m,r:s+_+i});c=Us(n,U),k&&typeof k=="object"&&!(k instanceof Date)?n[U]=k:(typeof k=="number"?w="n":typeof k=="boolean"?w="b":typeof k=="string"?w="s":k instanceof Date?(w="d",a.cellDates||(w="n",k=Lt(k)),L=a.dateNF||Fe[14]):k===null&&a.nullError&&(w="e",k=0),c?(c.t=w,c.v=k,delete c.w,delete c.R,L&&(c.z=L)):n[U]=c={t:w,v:k},L&&(c.z=L))})}),d.e.c=Math.max(d.e.c,o+h.length-1);var p=kt(s);if(i)for(m=0;m<h.length;++m)n[lt(m+o)+p]={t:"s",v:h[m]};return n["!ref"]=Ne(d),n}function FD(t,r){return Op(null,t,r)}function Us(t,r,e){if(typeof r=="string"){if(Array.isArray(t)){var a=ct(r);return t[a.r]||(t[a.r]=[]),t[a.r][a.c]||(t[a.r][a.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return typeof r!="number"?Us(t,Oe(r)):Us(t,Oe({r,c:e||0}))}function OD(t,r){if(typeof r=="number"){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var e=t.SheetNames.indexOf(r);if(e>-1)return e;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function ed(){return{SheetNames:[],Sheets:{}}}function td(t,r,e,a){var i=1;if(!e)for(;i<=65535&&t.SheetNames.indexOf(e="Sheet"+i)!=-1;++i,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&t.SheetNames.indexOf(e)>=0){var n=e.match(/(^.*?)(\d+)$/);i=n&&+n[2]||0;var s=n&&n[1]||e;for(++i;i<=65535&&t.SheetNames.indexOf(e=s+i)!=-1;++i);}if(pp(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=r,e}function MD(t,r,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var a=OD(t,r);switch(t.Workbook.Sheets[a]||(t.Workbook.Sheets[a]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[a].Hidden=e}function ID(t,r){return t.z=r,t}function Mp(t,r,e){return r?(t.l={Target:r},e&&(t.l.Tooltip=e)):delete t.l,t}function PD(t,r,e){return Mp(t,"#"+r,e)}function RD(t,r,e){t.c||(t.c=[]),t.c.push({t:r,a:e||"SheetJS"})}function ND(t,r,e,a){for(var i=typeof r!="string"?r:Xe(r),n=typeof r=="string"?r:Ne(r),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var l=Us(t,s,o);l.t="n",l.F=n,delete l.v,s==i.s.r&&o==i.s.c&&(l.f=e,a&&(l.D=!0))}return t}var Ll={encode_col:lt,encode_row:kt,encode_cell:Oe,encode_range:Ne,decode_col:A0,decode_row:T0,split_cell:j1,decode_cell:ct,decode_range:br,format_cell:Pa,sheet_add_aoa:sm,sheet_add_json:Op,sheet_add_dom:Cp,aoa_to_sheet:Hn,json_to_sheet:FD,table_to_sheet:kp,table_to_book:zS,sheet_to_csv:J0,sheet_to_txt:Fp,sheet_to_json:Sl,sheet_to_html:bp,sheet_to_formulae:AD,sheet_to_row_object_array:Sl,sheet_get_cell:Us,book_new:ed,book_append_sheet:td,book_set_sheet_visibility:MD,cell_set_number_format:ID,cell_set_hyperlink:Mp,cell_set_internal_link:PD,cell_add_comment:RD,sheet_set_array_formula:ND,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var C3=Ds.version;var LD=(t,r)=>({"success-message":t,"error-message":r});function BD(t,r){if(t&1&&(v(0,"span",17),b(1),x()),t&2){let e=be();P(),Dt(e.fileName)}}function VD(t,r){if(t&1&&(v(0,"div",18)(1,"p"),b(2),x(),Ae(3,"mat-progress-bar",19),x()),t&2){let e=be();P(2),Ce("Importando archivo... ",e.uploadProgress,"%"),P(),j("value",e.uploadProgress)}}function UD(t,r){if(t&1&&(v(0,"div",26)(1,"mat-icon",27),b(2,"error_outline"),x(),v(3,"div",28),b(4),x()()),t&2){let e=r.$implicit;P(4),Jn(" Fila ",e.row,": ",e.message," ")}}function HD(t,r){if(t&1&&(v(0,"div",23)(1,"h4"),b(2,"Detalles de Errores:"),x(),v(3,"mat-list",24),me(4,UD,5,2,"div",25),x()()),t&2){let e=be(2);P(4),j("ngForOf",e.importResult.errors)}}function WD(t,r){if(t&1&&(v(0,"div",20)(1,"h3",21),b(2),x(),me(3,HD,5,1,"div",22),x()),t&2){let e=be();P(),j("ngClass",kd(3,LD,e.importResult.success,!e.importResult.success)),P(),Ce(" ",e.importResult.message," "),P(),j("ngIf",e.importResult.errors&&e.importResult.errors.length>0)}}var GD={"TIPO DE ENVIO":"type_order_transfer_to_warehouse","NOMBRE DEL DESTINATARIO":"recipient_name","TELEFONO DESTINATARIO 9 DIGITOS":"recipient_phone",DISTRITO:"delivery_district_name","DIRECCION DE ENTREGA":"delivery_address","FECHA DE ENTREGA (DIA/MES/A\xD1O)":"delivery_date","DETALLE DEL PRODUCTO":"item_description","MONTO A COBRAR":"amount_to_collect_at_delivery","FORMA DE PAGO":"payment_method_for_collection",OBSERVACION:"observations"},U3=Object.keys(GD),Bl=class t{importCompleted=new ke;selectedFile=null;fileName=null;isUploading=!1;uploadProgress=0;importResult=null;orderService=Y(vr);snackBar=Y(Qa);dialogRef=Y(fn);settingsService=Y(vf);destroy$=new Pe;enlace=null;constructor(){}ngOnInit(){this.settingsService.loadSettings().pipe(gt(this.destroy$)).subscribe({next:r=>{r.length&&(this.enlace=r[0].excel_import_template_url)},error:r=>{console.log("err",r)}})}onFileSelected(r){let a=r.currentTarget.files;a&&a.length>0?(this.selectedFile=a[0],this.fileName=this.selectedFile.name,this.importResult=null,console.log("File selected:",this.selectedFile)):(this.selectedFile=null,this.fileName=null)}downloadTemplate(){return this.snackBar.open("Plantilla con validaci\xF3n descargada.","OK",{duration:2e3}),this.enlace||""}processImport(){return Xn(this,null,function*(){if(!this.selectedFile){this.snackBar.open("Por favor, selecciona un archivo Excel.","OK",{duration:3e3,panelClass:["warn-snackbar"]});return}this.isUploading=!0,this.uploadProgress=0,this.importResult=null;let r=setInterval(()=>{this.uploadProgress<90&&(this.uploadProgress+=10)},200);try{let e=yield this.readFileAndParseToJson(this.selectedFile);if(e=e.filter(a=>a.CARGA==="CARGAR"),console.log("Parsed Excel to JSON:",e),e.length===0)throw new Error("El archivo Excel no contiene datos (despu\xE9s de las cabeceras) o el formato es incorrecto.");this.orderService.importOrdersFromParsedJson(e).subscribe({next:a=>{clearInterval(r),this.uploadProgress=100,this.importResult=a,a.success&&a.importedCount&&a.importedCount>0?(this.snackBar.open(a.message,"OK",{duration:4e3,panelClass:["success-snackbar"]}),this.importCompleted.emit(!0)):(this.snackBar.open(a.message||"Algunos pedidos no pudieron ser importados o hubo errores.","OK",{duration:6e3,panelClass:["warn-snackbar"]}),a.errors&&a.errors.length>0&&console.warn("Import errors from backend:",a.errors)),this.isUploading=!1},error:a=>{clearInterval(r),this.isUploading=!1,this.uploadProgress=0,this.importResult={success:!1,message:a.message||"Error en el servidor durante la importaci\xF3n."},this.snackBar.open(this.importResult.message,"OK",{duration:3e3,panelClass:["error-snackbar"]}),console.error("Error importing orders:",a)}})}catch(e){clearInterval(r),this.isUploading=!1,this.uploadProgress=0,this.importResult={success:!1,message:e.message||"Error al procesar el archivo Excel."},this.snackBar.open(this.importResult.message,"OK",{duration:3e3,panelClass:["error-snackbar"]}),console.error("Error processing file:",e)}})}readFileAndParseToJson(r){return new Promise((e,a)=>{if(!r){a(new Error("No se proporcion\xF3 ning\xFAn archivo."));return}let i=new FileReader;i.onload=n=>{try{let s=n.target.result,o=El(s,{type:"binary",cellDates:!0}),l=o.SheetNames[0];if(!l){a(new Error("El archivo Excel no contiene hojas."));return}let c=o.Sheets[l],d=Ll.sheet_to_json(c,{raw:!1,defval:null});e(d.filter(f=>Object.values(f).some(h=>h!==null&&h!=="")))}catch(s){console.error("Error al leer el contenido de la hoja de Excel:",s),a(new Error("No se pudo leer el contenido de la hoja de Excel. Formato incorrecto."))}},i.onerror=n=>{console.error("Error en FileReader:",n),a(new Error("Ocurri\xF3 un error al intentar leer el archivo."))},i.readAsBinaryString(r)})}closeDialog(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=Ye({type:t,selectors:[["app-order-import-modal"]],outputs:{importCompleted:"importCompleted"},decls:107,vars:8,consts:[["fileInput",""],[1,"import-modal-container"],["mat-dialog-title",""],[1,"mat-typography"],[1,"instructions"],[2,"margin-bottom","10px"],["mat-stroked-button","","color","accent","target","_blank","matTooltip","Descargar la plantilla en formato .xlsx (.xls tambi\xE9n soportado)",1,"template-button",3,"href"],[1,"column-descriptions"],[1,"file-input-container"],["mat-raised-button","","color","primary",3,"click","disabled"],["hidden","","type","file","accept",".xlsx, .xls",3,"change"],["class","file-name-display",4,"ngIf"],["class","upload-progress-container",4,"ngIf"],["class","import-results",4,"ngIf"],["align","end"],["mat-stroked-button","",3,"click","disabled"],["mat-flat-button","","color","primary",3,"click","disabled"],[1,"file-name-display"],[1,"upload-progress-container"],["mode","determinate",3,"value"],[1,"import-results"],[3,"ngClass"],["class","error-details",4,"ngIf"],[1,"error-details"],["dense",""],["class","error-item",4,"ngFor","ngForOf"],[1,"error-item"],["matListItemIcon","","color","warn"],[2,"overflow-wrap","break-word !important"]],template:function(e,a){if(e&1){let i=tt();v(0,"div",1)(1,"h2",2),b(2,"Importar Pedidos desde Excel"),x(),v(3,"mat-dialog-content",3)(4,"p",4),b(5," Sigue estos pasos para importar tus pedidos de forma masiva: "),x(),v(6,"ol")(7,"li")(8,"div",5),b(9," Descarga la plantilla de Excel para asegurar el formato correcto de los datos. "),x(),v(10,"a",6)(11,"mat-icon"),b(12,"cloud_download"),x(),b(13," Descargar Plantilla "),x()(),v(14,"li"),b(15," Completa la plantilla con la informaci\xF3n de tus pedidos. Aseg\xFArate de que el orden y nombre de las columnas coincidan con la plantilla. "),x(),v(16,"li")(17,"strong"),b(18,"Descripci\xF3n de las Columnas Esperadas en la Plantilla:"),x(),v(19,"ul",7)(20,"li")(21,"strong"),b(22,"TIPO DE ENVIO:"),x(),b(23," Indica la modalidad del env\xEDo. Valores comunes: "),v(24,"code"),b(25,"CONTRAENTREGA"),x(),b(26,", "),v(27,"code"),b(28,"SOLO-ENTREGA-NO-COBRAR"),x(),b(29,". *(Esta columna podr\xEDa tener una lista desplegable en la plantilla).* "),x(),v(30,"li")(31,"strong"),b(32,"NOMBRE DEL DESTINATARIO:"),x(),b(33," Nombre completo de la persona que recibir\xE1 el pedido. "),x(),v(34,"li")(35,"strong"),b(36,"TELEFONO DESTINATARIO 9 DIGITOS:"),x(),b(37," N\xFAmero de celular del destinatario, debe contener exactamente 9 d\xEDgitos. "),x(),v(38,"li")(39,"strong"),b(40,"DISTRITO (SELECCIONE SOLO DEL LISTADO):"),x(),b(41," El distrito de entrega. Es crucial seleccionar uno de los distritos v\xE1lidos que se mostrar\xE1n en la lista desplegable de esta columna en la plantilla. "),x(),v(42,"li")(43,"strong"),b(44,"DIRECCION DE ENTREGA:"),x(),b(45," Direcci\xF3n completa y detallada donde se entregar\xE1 el pedido (calle, n\xFAmero, urbanizaci\xF3n, referencia, etc.). "),x(),v(46,"li")(47,"strong"),b(48,"FECHA DE ENTREGA (DIA/MES/A\xD1O):"),x(),b(49," Fecha programada para la entrega del pedido. Utiliza el formato DD/MM/AAAA (ej. 25/12/2023). "),x(),v(50,"li")(51,"strong"),b(52,"DETALLE DEL PRODUCTO:"),x(),b(53,' Descripci\xF3n breve pero clara de lo que se est\xE1 enviando (ej. "Ropa y Zapatillas", "Documentos Urgentes", "Regalo Sorpresa"). '),x(),v(54,"li")(55,"strong"),b(56,"MONTO A COBRAR:"),x(),b(57," Si el env\xEDo es "),v(58,"code"),b(59,"CONTRAENTREGA"),x(),b(60,", indica aqu\xED el monto exacto que el courier debe cobrar al destinatario. Si es "),v(61,"code"),b(62,"SOLO-ENTREGA-NO-COBRAR"),x(),b(63,", este campo puede dejarse vac\xEDo o con 0. "),x(),v(64,"li")(65,"strong"),b(66,"FORMA DE PAGO:"),x(),b(67,' Indica c\xF3mo se realizar\xE1 el pago del "MONTO A COBRAR" si aplica. Ejemplos: '),v(68,"code"),b(69,"EFECTIVO"),x(),b(70,", "),v(71,"code"),b(72,"YAPE"),x(),b(73,", "),v(74,"code"),b(75,"PLIN"),x(),b(76,", "),v(77,"code"),b(78,"TRANSFERENCIA"),x(),b(79,". Si es no se realizar\xE1 cobro, puedes indicarlo con la opcion "),v(80,"code"),b(81,"NO COBRAR"),x()(),v(82,"li")(83,"strong"),b(84,"OBSERVACION:"),x(),b(85,' Cualquier nota o indicaci\xF3n adicional importante para el courier o para la gesti\xF3n del pedido (ej. "Entregar solo al titular", "Llamar antes de llegar", "Paquete fr\xE1gil"). '),x()()(),v(86,"li"),b(87,"Guarda el archivo en formato .xlsx o .xls."),x(),v(88,"li"),b(89,'Selecciona el archivo completo y haz clic en "Importar Pedidos".'),x()(),v(90,"div",8)(91,"button",9),ye("click",function(){De(i);let s=Tr(96);return Te(s.click())}),v(92,"mat-icon"),b(93,"attach_file"),x(),b(94," Seleccionar Archivo Excel "),x(),v(95,"input",10,0),ye("change",function(s){return De(i),Te(a.onFileSelected(s))}),x(),me(97,BD,2,1,"span",11),x(),me(98,VD,4,2,"div",12)(99,WD,4,6,"div",13),x(),v(100,"mat-dialog-actions",14)(101,"button",15),ye("click",function(){return De(i),Te(a.closeDialog())}),b(102," Cancelar "),x(),v(103,"button",16),ye("click",function(){return De(i),Te(a.processImport())}),v(104,"mat-icon"),b(105,"upload"),x(),b(106),x()()()}e&2&&(P(10),j("href",a.enlace,vd),P(81),j("disabled",a.isUploading),P(6),j("ngIf",a.fileName),P(),j("ngIf",a.isUploading),P(),j("ngIf",a.importResult),P(2),j("disabled",a.isUploading),P(2),j("disabled",!a.selectedFile||a.isUploading),P(3),Ce(" ",a.isUploading?"Importando...":"Importar Pedidos"," "))},dependencies:[Tt,la,ca,Qt,ti,un,mn,hn,dt,sf,Rt,er,xr,yf,wf,xf,gf,_f,ei,Ja],styles:[".import-modal-container[_ngcontent-%COMP%]{width:100%;max-width:650px}mat-dialog-content[_ngcontent-%COMP%]{padding-top:0;line-height:1.6;font-size:.95em;max-height:70vh;overflow-y:auto}.instructions[_ngcontent-%COMP%]{margin-bottom:16px;font-weight:500}ol[_ngcontent-%COMP%]{padding-left:20px;margin-bottom:24px}ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:12px}.template-button[_ngcontent-%COMP%]{margin-left:8px;vertical-align:middle;transform:translateY(-2px)}.file-input-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;margin-bottom:24px;padding:16px;border:1px dashed #ccc;border-radius:4px;background-color:#f9f9f9}@media (max-width: 500px){.file-input-container[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.file-input-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;margin-bottom:8px}}.file-name-display[_ngcontent-%COMP%]{font-style:italic;color:#555;word-break:break-all}.upload-progress-container[_ngcontent-%COMP%]{margin:20px 0}.upload-progress-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:8px;font-weight:500}.import-results[_ngcontent-%COMP%]{margin-top:24px;padding:16px;border-radius:4px;border:1px solid #ddd}.import-results[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;margin-bottom:12px;font-weight:600}.success-message[_ngcontent-%COMP%]{color:#2e7d32;border-left:4px solid #2e7d32;padding-left:12px}.error-message[_ngcontent-%COMP%]{color:#c62828;border-left:4px solid #c62828;padding-left:12px}.error-details[_ngcontent-%COMP%]{margin-top:16px}.error-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:8px;font-size:1em;font-weight:500}.error-item[_ngcontent-%COMP%]{padding-bottom:8px!important;border-bottom:1px dotted #eee}.error-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.error-item[_ngcontent-%COMP%]   .mat-mdc-list-item-line[_ngcontent-%COMP%]{white-space:normal!important}.error-data-preview[_ngcontent-%COMP%]{font-size:.8em;color:#757575;display:block;margin-top:4px}mat-dialog-actions[_ngcontent-%COMP%]{padding:8px 24px 16px!important}@media (max-height: 600px){mat-dialog-content[_ngcontent-%COMP%]{max-height:55vh}}ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px}.column-descriptions[_ngcontent-%COMP%]{list-style-type:disc;margin-top:8px;margin-bottom:16px;font-size:.9em;background-color:#f9f9f9;padding:10px 15px 10px 30px;border-radius:4px}.column-descriptions[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:8px;line-height:1.5}.column-descriptions[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#3f51b5}.column-descriptions[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background-color:#e0e0e0;padding:1px 4px;border-radius:3px;font-family:monospace}"]})};var zD="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-TFG-8",YD=".xlsx",Vl=class t{constructor(){}exportAsExcelFile(r,e,a="Sheet1"){if(!r||r.length===0){console.warn("No data provided for Excel export.");return}let i=Ll.json_to_sheet(r),n={Sheets:{[a]:i},SheetNames:[a]},s=Q0(n,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(s,e)}saveAsExcelFile(r,e){let a=new Blob([r],{type:zD}),i=window.URL.createObjectURL(a),n=document.createElement("a");n.href=i,n.download=`${e}${YD}`,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(i)}static \u0275fac=function(e){return new(e||t)};static \u0275prov=Er({token:t,factory:t.\u0275fac,providedIn:"root"})};var Ul=class t{orderService=Y(vr);router=Y(no);snackBar=Y(Qa);dialog=Y(ko);excelExportService=Y(Vl);datePipe=Y(gr);orders=[];isLoading=!1;totalOrderCount=0;currentPageIndex=0;currentPageSize=10;currentSortField="registration_date";currentSortDirection="desc";filterCriteriaSubject=new qs({});destroy$=new Pe;constructor(){}ngOnInit(){this.filterCriteriaSubject.pipe(gt(this.destroy$),Wa(()=>this.currentPageIndex=0)).subscribe(r=>{this.fetchOrders()})}getAllFilteredOrdersForExport(){return Xn(this,null,function*(){try{let r=this.filterCriteriaSubject.value;return(yield cd(this.orderService.getOrders2(r,this.currentSortField,this.currentSortDirection).pipe(gt(this.destroy$))))||[]}catch(r){return console.error("Error fetching all filtered orders for export:",r),this.snackBar.open("Failed to fetch data for export.","Close",{duration:3e3,panelClass:["error-snackbar"]}),[]}})}exportDataToExcel(){return Xn(this,null,function*(){this.isLoading=!0,this.snackBar.open("Preparing Excel export, this may take a moment...","",{duration:0});try{let r=yield this.getAllFilteredOrdersForExport();if(r&&r.length>0){let e=r.map(a=>({"TIPO DE ENVIO":a.shipment_type,"NOMBRE DEL DESTINATARIO":a.recipient_name,"TELEFONO DESTINATARIO 9 DIGITOS":a.recipient_phone,DISTRITO:a.delivery_district_name,"DIRECCION DE ENTREGA":a.delivery_address,"FECHA DE REGISTRO":a.createdAt?this.datePipe.transform(a.createdAt,"dd/MM/yyyy"):"N/A","FECHA DE ENTREGA":a.delivery_date,"DETALLE DEL PRODUCTO":a.item_description,"COSTO DE ENVIO":a.shipping_cost,"MONTO A COBRAR":a.amount_to_collect_at_delivery,"FORMA DE PAGO":a.payment_method_for_collection,OBSERVACION:a.observations||""}));this.excelExportService.exportAsExcelFile(e,"Listado_Pedidos_Filtrados","Pedidos"),this.snackBar.dismiss(),this.snackBar.open("Excel file exported successfully!","OK",{duration:3500,panelClass:["success-snackbar"]})}else this.snackBar.dismiss(),this.snackBar.open("No data available to export with current filters.","OK",{duration:3e3})}catch(r){console.error("Error during Excel export process:",r),this.snackBar.dismiss(),this.snackBar.open("An error occurred during Excel export.","Close",{duration:3e3,panelClass:["error-snackbar"]})}finally{this.isLoading=!1}})}fetchOrders(){this.isLoading=!0;let r=this.filterCriteriaSubject.value;this.orderService.getOrders(r,this.currentPageIndex+1,this.currentPageSize,this.currentSortField,this.currentSortDirection).pipe(gt(this.destroy$),oa(e=>(this.snackBar.open(e.message||"Failed to load orders.","Close",{duration:5e3,panelClass:["error-snackbar"]}),this.isLoading=!1,[]))).subscribe(e=>{this.orders=e.items,this.totalOrderCount=e.total_count||0,this.isLoading=!1,console.log("Orders fetched:",e)})}openImportModal(){let r=this.dialog.open(Bl,{width:"90%",maxWidth:"700px",autoFocus:!1});r.componentInstance.importCompleted.subscribe(e=>{e&&(console.log("Import completed, reloading orders..."),this.fetchOrders())}),r.afterClosed().subscribe(e=>{console.log("The import dialog was closed",e)})}handleStatusChanged(r){this.isLoading=!0,console.log("OrderListPage: Status change requested",r),this.orderService.updateOrderStatus(r.orderId,r.newStatus,r.details?.reason).subscribe({next:e=>{this.snackBar.open(`Estado del pedido ${e.code} actualizado a ${r.newStatus}.`,"OK",{duration:3e3,panelClass:["success-snackbar"]}),this.fetchOrders()},error:e=>{this.snackBar.open(`Error al actualizar estado: ${e.message||"Intente de nuevo"}`,"Cerrar",{duration:5e3,panelClass:["error-snackbar"]}),this.isLoading=!1},complete:()=>{this.isLoading=!1}})}onFiltersChanged(r){console.log("OrderListPage: Filters changed",r),this.filterCriteriaSubject.next(r)}onPageChanged(r){console.log("OrderListPage: Page changed",r),this.currentPageIndex=r.pageIndex,this.currentPageSize=r.pageSize,this.fetchOrders()}onSortChanged(r){console.log("OrderListPage: Sort changed",r),this.currentSortField=r.active,this.currentSortDirection=r.direction,this.currentPageIndex=0,this.fetchOrders()}handleMassiveActions(r){console.log("Massive action selected:",r),this.snackBar.open(`Action: ${r} not implemented yet.`,"OK",{duration:3e3})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=Ye({type:t,selectors:[["app-order-list-page"]],decls:25,vars:6,consts:[["massiveActionsMenu","matMenu"],[1,"page-content-wrapper"],[1,"page-title-bar"],[1,"page-title"],[1,"breadcrumbs"],["routerLink","/"],[3,"filtersChanged"],[1,"table-controls-bar"],[1,"records-info"],[1,"actions-group"],["mat-stroked-button","","color","primary",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[3,"pageChanged","sortChanged","statusChanged","orders","isLoading","totalCount","pageSize","pageIndex"]],template:function(e,a){if(e&1){let i=tt();v(0,"div",1)(1,"div",2)(2,"h1",3),b(3,"Listado de pedidos Lima"),x(),v(4,"div",4)(5,"a",5),b(6,"Inicio"),x(),b(7," / "),v(8,"span"),b(9,"Listado de pedidos Lima"),x()()(),v(10,"app-order-filters",6),ye("filtersChanged",function(s){return De(i),Te(a.onFiltersChanged(s))}),x(),v(11,"div",7),Ae(12,"div",8),v(13,"div",9)(14,"button",10),b(15," Acciones Masivas "),v(16,"mat-icon"),b(17,"arrow_drop_down"),x()(),v(18,"mat-menu",null,0)(20,"button",11),ye("click",function(){return De(i),Te(a.exportDataToExcel())}),b(21," Exportar a Excel "),x(),v(22,"button",11),ye("click",function(){return De(i),Te(a.openImportModal())}),b(23," Importar desde Excel "),x()()()(),v(24,"app-order-table",12),ye("pageChanged",function(s){return De(i),Te(a.onPageChanged(s))})("sortChanged",function(s){return De(i),Te(a.onSortChanged(s))})("statusChanged",function(s){return De(i),Te(a.handleStatusChanged(s))}),x()()}if(e&2){let i=Tr(19);P(14),j("matMenuTriggerFor",i),P(10),j("orders",a.orders)("isLoading",a.isLoading)("totalCount",a.totalOrderCount)("pageSize",a.currentPageSize)("pageIndex",a.currentPageIndex)}},dependencies:[Tt,so,Ad,Yo,rl,cn,dt,Rt,er,xr,yo,vo,xo,wo],styles:[".page-content-wrapper[_ngcontent-%COMP%]{padding:20px 24px;background-color:#f4f6f8;min-height:calc(100vh - 64px)}.page-title-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.page-title[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#333;margin:0}.breadcrumbs[_ngcontent-%COMP%]{font-size:14px;color:#666}.breadcrumbs[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#007bff;text-decoration:none}.breadcrumbs[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.breadcrumbs[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:5px}.table-controls-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding:0 8px}.records-info[_ngcontent-%COMP%]{font-size:.9em;color:#555}"]})};var $D=["input"],XD=["formField"],jD=["*"],Hl=class{source;value;constructor(r,e){this.source=r,this.value=e}},KD={provide:co,useExisting:Kn(()=>rd),multi:!0},Pp=new Kt("MatRadioGroup"),qD=new Kt("mat-radio-default-options",{providedIn:"root",factory:ZD});function ZD(){return{color:"accent",disabledInteractive:!1}}var rd=(()=>{class t{_changeDetector=Y(Zt);_value=null;_name=Y(Ci).getId("mat-radio-group-");_selected=null;_isInitialized=!1;_labelPosition="after";_disabled=!1;_required=!1;_buttonChanges;_controlValueAccessorChangeFn=()=>{};onTouched=()=>{};change=new ke;_radios;color;get name(){return this._name}set name(e){this._name=e,this._updateRadioButtonNames()}get labelPosition(){return this._labelPosition}set labelPosition(e){this._labelPosition=e==="before"?"before":"after",this._markRadiosForCheck()}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this._updateSelectedRadioFromValue(),this._checkSelectedRadioButton())}_checkSelectedRadioButton(){this._selected&&!this._selected.checked&&(this._selected.checked=!0)}get selected(){return this._selected}set selected(e){this._selected=e,this.value=e?e.value:null,this._checkSelectedRadioButton()}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._markRadiosForCheck()}get required(){return this._required}set required(e){this._required=e,this._markRadiosForCheck()}get disabledInteractive(){return this._disabledInteractive}set disabledInteractive(e){this._disabledInteractive=e,this._markRadiosForCheck()}_disabledInteractive=!1;constructor(){}ngAfterContentInit(){this._isInitialized=!0,this._buttonChanges=this._radios.changes.subscribe(()=>{this.selected&&!this._radios.find(e=>e===this.selected)&&(this._selected=null)})}ngOnDestroy(){this._buttonChanges?.unsubscribe()}_touch(){this.onTouched&&this.onTouched()}_updateRadioButtonNames(){this._radios&&this._radios.forEach(e=>{e.name=this.name,e._markForCheck()})}_updateSelectedRadioFromValue(){let e=this._selected!==null&&this._selected.value===this._value;this._radios&&!e&&(this._selected=null,this._radios.forEach(a=>{a.checked=this.value===a.value,a.checked&&(this._selected=a)}))}_emitChangeEvent(){this._isInitialized&&this.change.emit(new Hl(this._selected,this._value))}_markRadiosForCheck(){this._radios&&this._radios.forEach(e=>e._markForCheck())}writeValue(e){this.value=e,this._changeDetector.markForCheck()}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetector.markForCheck()}static \u0275fac=function(a){return new(a||t)};static \u0275dir=Br({type:t,selectors:[["mat-radio-group"]],contentQueries:function(a,i,n){if(a&1&&Ki(n,Wl,5),a&2){let s;yt(s=bt())&&(i._radios=s)}},hostAttrs:["role","radiogroup",1,"mat-mdc-radio-group"],inputs:{color:"color",name:"name",labelPosition:"labelPosition",value:"value",selected:"selected",disabled:[2,"disabled","disabled",Pt],required:[2,"required","required",Pt],disabledInteractive:[2,"disabledInteractive","disabledInteractive",Pt]},outputs:{change:"change"},exportAs:["matRadioGroup"],features:[ur([KD,{provide:Pp,useExisting:t}])]})}return t})(),Wl=(()=>{class t{_elementRef=Y(Sr);_changeDetector=Y(Zt);_focusMonitor=Y(Rd);_radioDispatcher=Y(pf);_defaultOptions=Y(qD,{optional:!0});_ngZone=Y(ka);_renderer=Y(Zn);_uniqueId=Y(Ci).getId("mat-radio-");_cleanupClick;id=this._uniqueId;name;ariaLabel;ariaLabelledby;ariaDescribedby;disableRipple=!1;tabIndex=0;get checked(){return this._checked}set checked(e){this._checked!==e&&(this._checked=e,e&&this.radioGroup&&this.radioGroup.value!==this.value?this.radioGroup.selected=this:!e&&this.radioGroup&&this.radioGroup.value===this.value&&(this.radioGroup.selected=null),e&&this._radioDispatcher.notify(this.id,this.name),this._changeDetector.markForCheck())}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this.radioGroup!==null&&(this.checked||(this.checked=this.radioGroup.value===e),this.checked&&(this.radioGroup.selected=this)))}get labelPosition(){return this._labelPosition||this.radioGroup&&this.radioGroup.labelPosition||"after"}set labelPosition(e){this._labelPosition=e}_labelPosition;get disabled(){return this._disabled||this.radioGroup!==null&&this.radioGroup.disabled}set disabled(e){this._setDisabled(e)}get required(){return this._required||this.radioGroup&&this.radioGroup.required}set required(e){this._required=e}get color(){return this._color||this.radioGroup&&this.radioGroup.color||this._defaultOptions&&this._defaultOptions.color||"accent"}set color(e){this._color=e}_color;get disabledInteractive(){return this._disabledInteractive||this.radioGroup!==null&&this.radioGroup.disabledInteractive}set disabledInteractive(e){this._disabledInteractive=e}_disabledInteractive;change=new ke;radioGroup;get inputId(){return`${this.id||this._uniqueId}-input`}_checked=!1;_disabled;_required;_value=null;_removeUniqueSelectionListener=()=>{};_previousTabIndex;_inputElement;_rippleTrigger;_noopAnimations;_injector=Y(yi);constructor(){Y(Ea).load(po);let e=Y(Pp,{optional:!0}),a=Y(Js,{optional:!0}),i=Y(new Qs("tabindex"),{optional:!0});this.radioGroup=e,this._noopAnimations=a==="NoopAnimations",this._disabledInteractive=this._defaultOptions?.disabledInteractive??!1,i&&(this.tabIndex=es(i,0))}focus(e,a){a?this._focusMonitor.focusVia(this._inputElement,a,e):this._inputElement.nativeElement.focus(e)}_markForCheck(){this._changeDetector.markForCheck()}ngOnInit(){this.radioGroup&&(this.checked=this.radioGroup.value===this._value,this.checked&&(this.radioGroup.selected=this),this.name=this.radioGroup.name),this._removeUniqueSelectionListener=this._radioDispatcher.listen((e,a)=>{e!==this.id&&a===this.name&&(this.checked=!1)})}ngDoCheck(){this._updateTabIndex()}ngAfterViewInit(){this._updateTabIndex(),this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{!e&&this.radioGroup&&this.radioGroup._touch()}),this._ngZone.runOutsideAngular(()=>{this._cleanupClick=this._renderer.listen(this._inputElement.nativeElement,"click",this._onInputClick)})}ngOnDestroy(){this._cleanupClick?.(),this._focusMonitor.stopMonitoring(this._elementRef),this._removeUniqueSelectionListener()}_emitChangeEvent(){this.change.emit(new Hl(this,this._value))}_isRippleDisabled(){return this.disableRipple||this.disabled}_onInputInteraction(e){if(e.stopPropagation(),!this.checked&&!this.disabled){let a=this.radioGroup&&this.value!==this.radioGroup.value;this.checked=!0,this._emitChangeEvent(),this.radioGroup&&(this.radioGroup._controlValueAccessorChangeFn(this.value),a&&this.radioGroup._emitChangeEvent())}}_onTouchTargetClick(e){this._onInputInteraction(e),(!this.disabled||this.disabledInteractive)&&this._inputElement?.nativeElement.focus()}_setDisabled(e){this._disabled!==e&&(this._disabled=e,this._changeDetector.markForCheck())}_onInputClick=e=>{this.disabled&&this.disabledInteractive&&e.preventDefault()};_updateTabIndex(){let e=this.radioGroup,a;if(!e||!e.selected||this.disabled?a=this.tabIndex:a=e.selected===this?this.tabIndex:-1,a!==this._previousTabIndex){let i=this._inputElement?.nativeElement;i&&(i.setAttribute("tabindex",a+""),this._previousTabIndex=a,bi(()=>{queueMicrotask(()=>{e&&e.selected&&e.selected!==this&&document.activeElement===i&&(e.selected?._inputElement.nativeElement.focus(),document.activeElement===i&&this._inputElement.nativeElement.blur())})},{injector:this._injector}))}}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=Ye({type:t,selectors:[["mat-radio-button"]],viewQuery:function(a,i){if(a&1&&(zt($D,5),zt(XD,7,Sr)),a&2){let n;yt(n=bt())&&(i._inputElement=n.first),yt(n=bt())&&(i._rippleTrigger=n.first)}},hostAttrs:[1,"mat-mdc-radio-button"],hostVars:19,hostBindings:function(a,i){a&1&&ye("focus",function(){return i._inputElement.nativeElement.focus()}),a&2&&(xt("id",i.id)("tabindex",null)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),Dr("mat-primary",i.color==="primary")("mat-accent",i.color==="accent")("mat-warn",i.color==="warn")("mat-mdc-radio-checked",i.checked)("mat-mdc-radio-disabled",i.disabled)("mat-mdc-radio-disabled-interactive",i.disabledInteractive)("_mat-animation-noopable",i._noopAnimations))},inputs:{id:"id",name:"name",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],disableRipple:[2,"disableRipple","disableRipple",Pt],tabIndex:[2,"tabIndex","tabIndex",e=>e==null?0:es(e)],checked:[2,"checked","checked",Pt],value:"value",labelPosition:"labelPosition",disabled:[2,"disabled","disabled",Pt],required:[2,"required","required",Pt],color:"color",disabledInteractive:[2,"disabledInteractive","disabledInteractive",Pt]},outputs:{change:"change"},exportAs:["matRadioButton"],ngContentSelectors:jD,decls:13,vars:17,consts:[["formField",""],["input",""],["mat-internal-form-field","",3,"labelPosition"],[1,"mdc-radio"],[1,"mat-mdc-radio-touch-target",3,"click"],["type","radio",1,"mdc-radio__native-control",3,"change","id","checked","disabled","required"],[1,"mdc-radio__background"],[1,"mdc-radio__outer-circle"],[1,"mdc-radio__inner-circle"],["mat-ripple","",1,"mat-radio-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[1,"mdc-label",3,"for"]],template:function(a,i){if(a&1){let n=tt();Ga(),v(0,"div",2,0)(2,"div",3)(3,"div",4),ye("click",function(o){return De(n),Te(i._onTouchTargetClick(o))}),x(),v(4,"input",5,1),ye("change",function(o){return De(n),Te(i._onInputInteraction(o))}),x(),v(6,"div",6),Ae(7,"div",7)(8,"div",8),x(),v(9,"div",9),Ae(10,"div",10),x()(),v(11,"label",11),za(12),x()()}a&2&&(j("labelPosition",i.labelPosition),P(2),Dr("mdc-radio--disabled",i.disabled),P(2),j("id",i.inputId)("checked",i.checked)("disabled",i.disabled&&!i.disabledInteractive)("required",i.required),xt("name",i.name)("value",i.value)("aria-label",i.ariaLabel)("aria-labelledby",i.ariaLabelledby)("aria-describedby",i.ariaDescribedby)("aria-disabled",i.disabled&&i.disabledInteractive?"true":null),P(5),j("matRippleTrigger",i._rippleTrigger.nativeElement)("matRippleDisabled",i._isRippleDisabled())("matRippleCentered",!0),P(2),j("for",i.inputId))},dependencies:[af,of],styles:[`.mat-mdc-radio-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-radio-button .mdc-radio{display:inline-block;position:relative;flex:0 0 auto;box-sizing:content-box;width:20px;height:20px;cursor:pointer;will-change:opacity,transform,border-color,color;padding:calc((var(--mdc-radio-state-layer-size, 40px) - 20px)/2)}.mat-mdc-radio-button .mdc-radio:hover>.mdc-radio__native-control:not([disabled]):not(:focus)~.mdc-radio__background::before{opacity:.04;transform:scale(1)}.mat-mdc-radio-button .mdc-radio:hover>.mdc-radio__native-control:not([disabled])~.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-hover-icon-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button .mdc-radio:hover>.mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:hover>.mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-hover-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio:active>.mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-pressed-icon-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button .mdc-radio:active>.mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:active>.mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-pressed-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio__background{display:inline-block;position:relative;box-sizing:border-box;width:20px;height:20px}.mat-mdc-radio-button .mdc-radio__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:"";transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1);width:var(--mdc-radio-state-layer-size, 40px);height:var(--mdc-radio-state-layer-size, 40px);top:calc(-1*(var(--mdc-radio-state-layer-size, 40px) - 20px)/2);left:calc(-1*(var(--mdc-radio-state-layer-size, 40px) - 20px)/2)}.mat-mdc-radio-button .mdc-radio__outer-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;border-width:2px;border-style:solid;border-radius:50%;transition:border-color 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-radio-button .mdc-radio__inner-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;transform:scale(0, 0);border-width:10px;border-style:solid;border-radius:50%;transition:transform 90ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-radio-button .mdc-radio__native-control{position:absolute;margin:0;padding:0;opacity:0;top:0;right:0;left:0;cursor:inherit;z-index:1;width:var(--mdc-radio-state-layer-size, 40px);height:var(--mdc-radio-state-layer-size, 40px)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background{transition:opacity 90ms cubic-bezier(0, 0, 0.2, 1),transform 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background>.mdc-radio__outer-circle{transition:border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background>.mdc-radio__inner-circle{transition:transform 90ms cubic-bezier(0, 0, 0.2, 1),border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:focus+.mdc-radio__background::before{transform:scale(1);opacity:.12;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 1),transform 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-unselected-icon-color, var(--mat-sys-on-surface));opacity:var(--mdc-radio-disabled-unselected-icon-opacity, 0.38)}.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background{cursor:default}.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-selected-icon-color, var(--mat-sys-on-surface));opacity:var(--mdc-radio-disabled-selected-icon-opacity, 0.38)}.mat-mdc-radio-button .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-radio-button .mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio__native-control:enabled:focus:checked+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:enabled:focus:checked+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-focus-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__inner-circle{transform:scale(0.5);transition:transform 90ms cubic-bezier(0, 0, 0.2, 1),border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled{pointer-events:auto}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:not(:checked)+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-unselected-icon-color, var(--mat-sys-on-surface));opacity:var(--mdc-radio-disabled-unselected-icon-opacity, 0.38)}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled:hover .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled:hover .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:checked:focus+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:checked:focus+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-selected-icon-color, var(--mat-sys-on-surface));opacity:var(--mdc-radio-disabled-selected-icon-opacity, 0.38)}.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__background::before,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__outer-circle,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__inner-circle{transition:none !important}.mat-mdc-radio-button .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button.mat-mdc-radio-checked .mat-ripple-element,.mat-mdc-radio-button.mat-mdc-radio-checked .mdc-radio__background::before{background-color:var(--mat-radio-checked-ripple-color, var(--mat-sys-primary))}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mat-ripple-element,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button .mat-internal-form-field{color:var(--mat-radio-label-text-color, var(--mat-sys-on-surface));font-family:var(--mat-radio-label-text-font, var(--mat-sys-body-medium-font));line-height:var(--mat-radio-label-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mat-radio-label-text-size, var(--mat-sys-body-medium-size));letter-spacing:var(--mat-radio-label-text-tracking, var(--mat-sys-body-medium-tracking));font-weight:var(--mat-radio-label-text-weight, var(--mat-sys-body-medium-weight))}.mat-mdc-radio-button .mdc-radio--disabled+label{color:var(--mat-radio-disabled-label-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-radio-button .mat-radio-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:50%}.mat-mdc-radio-button .mat-radio-ripple>.mat-ripple-element{opacity:.14}.mat-mdc-radio-button .mat-radio-ripple::before{border-radius:50%}.mat-mdc-radio-button .mdc-radio>.mdc-radio__native-control:focus:enabled:not(:checked)~.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-focus-icon-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button.cdk-focused .mat-focus-indicator::before{content:""}.mat-mdc-radio-disabled{cursor:default;pointer-events:none}.mat-mdc-radio-disabled.mat-mdc-radio-disabled-interactive{pointer-events:auto}.mat-mdc-radio-touch-target{position:absolute;top:50%;left:50%;height:48px;width:48px;transform:translate(-50%, -50%);display:var(--mat-radio-touch-target-display, block)}[dir=rtl] .mat-mdc-radio-touch-target{left:auto;right:50%;transform:translate(50%, -50%)}
`],encapsulation:2,changeDetection:0})}return t})(),Rp=(()=>{class t{static \u0275fac=function(a){return new(a||t)};static \u0275mod=Lr({type:t});static \u0275inj=Nr({imports:[Zr,nf,Wl,Zr]})}return t})();function JD(t,r){t&1&&(v(0,"mat-error"),b(1,"Largo es requerido"),x())}function eT(t,r){t&1&&(v(0,"mat-error"),b(1,"Valor debe ser positivo"),x())}function tT(t,r){t&1&&(v(0,"mat-error"),b(1,"Ancho es requerido"),x())}function rT(t,r){t&1&&(v(0,"mat-error"),b(1,"Valor debe ser positivo"),x())}function aT(t,r){t&1&&(v(0,"mat-error"),b(1,"Alto es requerido"),x())}function iT(t,r){t&1&&(v(0,"mat-error"),b(1,"Valor debe ser positivo"),x())}function nT(t,r){t&1&&(v(0,"mat-error"),b(1,"Peso es requerido"),x())}function sT(t,r){t&1&&(v(0,"mat-error"),b(1,"Valor debe ser positivo"),x())}function oT(t,r){t&1&&Ae(0,"mat-progress-spinner",18)}function lT(t,r){if(t&1){let e=tt();v(0,"div",8)(1,"mat-form-field",9)(2,"mat-label"),b(3,"Largo (cm)"),x(),Ae(4,"input",10),me(5,JD,2,0,"mat-error",11)(6,eT,2,0,"mat-error",11),x(),v(7,"mat-form-field",9)(8,"mat-label"),b(9,"Ancho (cm)"),x(),Ae(10,"input",12),me(11,tT,2,0,"mat-error",11)(12,rT,2,0,"mat-error",11),x(),v(13,"mat-form-field",9)(14,"mat-label"),b(15,"Alto (cm)"),x(),Ae(16,"input",13),me(17,aT,2,0,"mat-error",11)(18,iT,2,0,"mat-error",11),x(),v(19,"mat-form-field",9)(20,"mat-label"),b(21,"Peso (kg)"),x(),Ae(22,"input",14),me(23,nT,2,0,"mat-error",11)(24,sT,2,0,"mat-error",11),x(),v(25,"div",15)(26,"button",16),ye("click",function(){De(e);let i=be();return Te(i.onCalculateCustomCost())}),me(27,oT,1,0,"mat-progress-spinner",17),b(28),x()()()}if(t&2){let e,a,i,n,s,o,l,c,d=be();P(5),j("ngIf",(e=d.packageFormGroup.get("package_length_cm"))==null?null:e.hasError("required")),P(),j("ngIf",(a=d.packageFormGroup.get("package_length_cm"))==null?null:a.hasError("min")),P(5),j("ngIf",(i=d.packageFormGroup.get("package_width_cm"))==null?null:i.hasError("required")),P(),j("ngIf",(n=d.packageFormGroup.get("package_width_cm"))==null?null:n.hasError("min")),P(5),j("ngIf",(s=d.packageFormGroup.get("package_height_cm"))==null?null:s.hasError("required")),P(),j("ngIf",(o=d.packageFormGroup.get("package_height_cm"))==null?null:o.hasError("min")),P(5),j("ngIf",(l=d.packageFormGroup.get("package_weight_kg"))==null?null:l.hasError("required")),P(),j("ngIf",(c=d.packageFormGroup.get("package_weight_kg"))==null?null:c.hasError("min")),P(2),j("disabled",d.isCalculating()),P(),j("ngIf",d.isCalculating()),P(),Ce(" ",d.isCalculating()?"Calculando...":"CALCULAR"," ")}}function cT(t,r){t&1&&(v(0,"div",19)(1,"p"),b(2," Si su paquete excede las medidas y pesos est\xE1ndar y no utiliza la calculadora de env\xEDo, se le cobrar\xE1 en funci\xF3n de esas medidas sin previo aviso. "),x()())}function dT(t,r){if(t&1&&(v(0,"div",20)(1,"p"),b(2),x()()),t&2){let e=r.ngIf;P(2),Dt(e.info_text)}}var Gl=class t{packageFormGroup;deliveryDistrictId=null;listaDeDistritos=[];shippingCostCalculated=new ke;calculationLoading=new ke;maxDimensions$;standardPackageLabel=qt("Est\xE1ndar");volumetric_factor=qt(0);isCalculating=qt(!1);orderService=Y(vr);destroy$=new Pe;constructor(){this.maxDimensions$=this.orderService.getMaxPackageDimensions().pipe(Wa(r=>{r.standard_package_info&&r.volumetric_factor&&(this.standardPackageLabel.set(r.standard_package_info),this.volumetric_factor.set(r.volumetric_factor))}))}ngOnInit(){if(!this.packageFormGroup){console.error("PackageCalculatorComponent: packageFormGroup input is required.");return}this.packageFormGroup.get("package_size_type")?.valueChanges.pipe(gt(this.destroy$),Ha(this.packageFormGroup.get("package_size_type")?.value)).subscribe(r=>{this.toggleCustomDimensionControls(r==="custom")})}toggleCustomDimensionControls(r){["package_width_cm","package_length_cm","package_height_cm","package_weight_kg"].forEach(a=>{let i=this.packageFormGroup.get(a);i&&(r?(i.enable(),i.setValidators([ot.required,ot.min(.1),ot.max(999)])):(i.disable(),i.clearValidators(),i.updateValueAndValidity({emitEvent:!1})),i.updateValueAndValidity())})}calculateStandardShippingCost(){if(!this.deliveryDistrictId){console.warn("Cannot calculate standard shipping cost: deliveryDistrictId is missing."),this.shippingCostCalculated.emit(0);return}this.isCalculating.set(!0),this.calculationLoading.emit(!0),this.orderService.calculateShippingCost({delivery_district_id:this.deliveryDistrictId,package_size_type:"standard"}).pipe(gt(this.destroy$)).subscribe({next:r=>{this.shippingCostCalculated.emit(r.shipping_cost),this.isCalculating.set(!1),this.calculationLoading.emit(!1)},error:r=>{console.error("Error calculating standard shipping cost:",r),this.shippingCostCalculated.emit(0),this.isCalculating.set(!1),this.calculationLoading.emit(!1)}})}onCalculateCustomCost(){if(this.packageFormGroup.get("package_size_type")?.value!=="custom")return;if(!this.deliveryDistrictId){alert("Por favor, seleccione un distrito de entrega primero.");return}let r=!0;if(["package_width_cm","package_length_cm","package_height_cm","package_weight_kg"].forEach(n=>{let s=this.packageFormGroup.get(n);s?.markAsTouched(),s?.invalid&&(r=!1)}),!r){console.log("Custom dimensions form is invalid");return}this.isCalculating.set(!0),this.calculationLoading.emit(!0);let a={delivery_district_id:this.deliveryDistrictId,package_size_type:"custom",package_width_cm:this.packageFormGroup.get("package_width_cm")?.value,package_length_cm:this.packageFormGroup.get("package_length_cm")?.value,package_height_cm:this.packageFormGroup.get("package_height_cm")?.value,package_weight_kg:this.packageFormGroup.get("package_weight_kg")?.value};if(this.maxDimensions$,a.package_width_cm&&a.package_length_cm&&a.package_height_cm&&a.package_weight_kg&&this.volumetric_factor()){let n=a.package_length_cm*a.package_width_cm*a.package_height_cm/this.volumetric_factor(),s=0,o=a.package_weight_kg;if(n>a.package_weight_kg&&(o=n),a.delivery_district_id){let l=this.listaDeDistritos?.find(c=>c.id===a.delivery_district_id);if(l){let d=function(f,h=[]){for(let m of h)if(f>=m.weight_from&&f<=m.weight_to)return console.log("tarifa",m),m;return 0};var i=d;let c=this.listaDeDistritos?.filter(f=>f.name===l?.name);c&&(s=d(o,c).price||0)}}console.log("peso_cobrado",o),console.log("precio",s),this.shippingCostCalculated.emit(s),this.isCalculating.set(!1),this.calculationLoading.emit(!1)}else alert("las entradas no son validas")}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=Ye({type:t,selectors:[["app-package-calculator"]],inputs:{packageFormGroup:"packageFormGroup",deliveryDistrictId:"deliveryDistrictId",listaDeDistritos:"listaDeDistritos"},outputs:{shippingCostCalculated:"shippingCostCalculated",calculationLoading:"calculationLoading"},decls:12,vars:7,consts:[[1,"package-calculator-container",3,"formGroup"],[1,"section-subtitle"],["formControlName","package_size_type","aria-label","Seleccione el tipo de tama\xF1o del paquete"],["value","standard",1,"package-option"],["value","custom",1,"package-option"],["class","custom-dimensions-grid",4,"ngIf"],["class","warning-paquete-size",4,"ngIf"],["class","max-dimensions-info",4,"ngIf"],[1,"custom-dimensions-grid"],["appearance","outline"],["matInput","","type","number","formControlName","package_length_cm","placeholder","Ingrese el largo"],[4,"ngIf"],["matInput","","type","number","formControlName","package_width_cm","placeholder","Ingrese el ancho"],["matInput","","type","number","formControlName","package_height_cm","placeholder","Ingrese el alto"],["matInput","","type","number","formControlName","package_weight_kg","placeholder","Ingrese el peso"],[1,"calculate-button-container"],["mat-flat-button","","color","accent","type","button",3,"click","disabled"],["mode","indeterminate","diameter","20","class","button-spinner",4,"ngIf"],["mode","indeterminate","diameter","20",1,"button-spinner"],[1,"warning-paquete-size"],[1,"max-dimensions-info"]],template:function(e,a){if(e&1&&(v(0,"div",0)(1,"h3",1),b(2,"Tama\xF1o del paquete"),x(),v(3,"mat-radio-group",2)(4,"mat-radio-button",3),b(5),x(),v(6,"mat-radio-button",4),b(7,"Otros tama\xF1os : Calcular"),x()(),me(8,lT,29,11,"div",5)(9,cT,3,0,"div",6)(10,dT,3,1,"div",7),Ve(11,"async"),x()),e&2){let i,n;j("formGroup",a.packageFormGroup),P(5),Dt(a.standardPackageLabel()),P(3),j("ngIf",((i=a.packageFormGroup.get("package_size_type"))==null?null:i.value)==="custom"),P(),j("ngIf",((n=a.packageFormGroup.get("package_size_type"))==null?null:n.value)==="standard"),P(),j("ngIf",Bt(11,5,a.maxDimensions$))}},dependencies:[Tt,Qt,Ji,Ka,nn,uo,da,sn,Ei,on,ha,ua,fa,qa,Za,ln,Rp,rd,Wl,dt,Rt,ja,Xa],styles:[".package-calculator-container[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px;padding:16px;border:1px solid #e0e0e0;border-radius:4px;background-color:#f9f9f9}.section-subtitle[_ngcontent-%COMP%]{font-size:1.1em;font-weight:500;margin-top:0;margin-bottom:16px}mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;margin-bottom:20px}.package-option[_ngcontent-%COMP%]{font-weight:400}.custom-dimensions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:16px;margin-top:16px;align-items:start}.calculate-button-container[_ngcontent-%COMP%]{grid-column:1/-1;display:flex;justify-content:flex-start;margin-top:10px}.calculate-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:120px}.button-spinner[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;margin-right:8px}.max-dimensions-info[_ngcontent-%COMP%]{margin-top:16px;font-size:.85em;color:#757575;text-align:center;padding:8px;background-color:#efefef;border-radius:4px}.warning-paquete-size[_ngcontent-%COMP%]{font-size:14px;font-weight:700;margin:16px 0;text-align:left;color:#d32f2f;display:flex;align-items:center;justify-content:flex-end}"]})};function fT(t,r){if(t&1&&(v(0,"mat-option",31),b(1),x()),t&2){let e=r.$implicit;j("value",e),P(),Dt(e)}}function uT(t,r){t&1&&(v(0,"mat-error"),b(1,"Requerido"),x())}function hT(t,r){t&1&&(v(0,"mat-error"),b(1,"Requerido"),x())}function mT(t,r){t&1&&(v(0,"mat-error"),b(1,"Tel\xE9fono inv\xE1lido"),x())}function pT(t,r){if(t&1&&(v(0,"mat-option",32)(1,"div",33)(2,"span"),b(3),x(),b(4," \xA0 "),v(5,"span",34),b(6),Ve(7,"number"),x()()()),t&2){let e=r.$implicit;j("value",e.id),P(3),Ce("",e.name," "),P(3),Ce(" - S/ ",It(7,3,e.price,"1.2-2"),"")}}function _T(t,r){t&1&&(v(0,"mat-error"),b(1,"Requerido"),x())}function gT(t,r){t&1&&(v(0,"mat-error"),b(1,"Requerido"),x())}function xT(t,r){t&1&&(v(0,"mat-error"),b(1,"M\xEDnimo 6 caracteres"),x())}function vT(t,r){t&1&&(v(0,"mat-error"),b(1,"Requerido"),x())}function wT(t,r){t&1&&Ae(0,"mat-progress-spinner",35)}function yT(t,r){t&1&&(v(0,"mat-error"),b(1,"Requerido"),x())}function bT(t,r){t&1&&(v(0,"mat-error"),b(1,"Requerido"),x())}function CT(t,r){t&1&&(v(0,"mat-error"),b(1,"Monto no puede ser negativo"),x())}function kT(t,r){if(t&1&&(v(0,"mat-option",31),b(1),x()),t&2){let e=r.$implicit;j("value",e),P(),Dt(e)}}var js=class t{orderSubmit=new ke;formValidityChanged=new ke;orderForm;deliveryDistricts$;minDeliveryDate;shipmentTypes=["SOLO ENTREGA NO COBRAR"];paymentMethodsForCollection=["NO COBRAR","EFECTIVO","YAPE","PLIN","TRANSFERENCIA"];calculatedShippingCost=qt(0);isCalculatingShipping=qt(!1);selectedDistrictName=Dd(()=>{let r=this.orderForm?.get("delivery_district_id")?.value;return!r||!this._districtsCache?"":this._districtsCache.find(e=>e.id===r)?.name||""});orderService=Y(vr);fb=Y(ho);datePipe=Y(gr);destroy$=new Pe;_districtsCache=[];constructor(){this.minDeliveryDate=new Date,this.deliveryDistricts$=this.orderService.getDeliveryDistricts().pipe(Ua(r=>(this._districtsCache=r,r.filter(e=>e.isStandard)))),this.buildForm()}ngOnInit(){this.orderForm.statusChanges.pipe(gt(this.destroy$),Xi()).subscribe(r=>{this.formValidityChanged.emit(r==="VALID")}),this.orderForm.get("delivery_district_id")?.valueChanges.pipe(gt(this.destroy$),Xi()).subscribe(r=>{if(console.log("District changed to:",r),r)if(this.packageDetailsFormGroup.get("package_size_type")?.value==="standard"){let e=this._districtsCache.find(a=>a.id===r);e&&this.calculatedShippingCost.set(parseFloat(e.price))}else this.calculatedShippingCost.set(0)}),this.packageDetailsFormGroup.get("package_size_type")?.valueChanges.pipe(gt(this.destroy$),Xi()).subscribe(r=>{console.log("type",r);let e=this.orderForm.get("delivery_district_id")?.value;if(e&&r==="standard"){let a=this._districtsCache.find(i=>i.id===e);a&&this.calculatedShippingCost.set(parseFloat(a.price))}else this.calculatedShippingCost.set(0)})}resetPackageTypeSelection(){let r=this.packageDetailsFormGroup.get("package_size_type");this.calculatedShippingCost.set(0),this.isCalculatingShipping.set(!1)}get packageDetailsFormGroup(){return this.orderForm.get("package_details")}buildForm(){let r=this.datePipe.transform(new Date,"yyyy-MM-dd");this.orderForm=this.fb.group({shipment_type:[this.shipmentTypes[0],ot.required],recipient_name:["",ot.required],recipient_phone:["",[ot.required,ot.pattern("^[0-9]{9}$")]],delivery_district_id:[null,ot.required],delivery_address:["",[ot.required,ot.minLength(6)]],delivery_coordinates:[""],delivery_date:[r,ot.required],package_details:this.fb.group({package_size_type:["standard",ot.required],package_width_cm:[{value:0,disabled:!0}],package_length_cm:[{value:0,disabled:!0}],package_height_cm:[{value:0,disabled:!0}],package_weight_kg:[{value:0,disabled:!0}]}),item_description:["",ot.required],amount_to_collect_at_delivery:[0,[ot.required,ot.min(0)]],payment_method_for_collection:[this.paymentMethodsForCollection[0],ot.required],observations:[""]})}onShippingCostCalculated(r){this.calculatedShippingCost.set(r),console.log("Shipping cost updated in OrderCreationForm:",r)}onPackageCalculationLoading(r){this.isCalculatingShipping.set(r)}onSubmit(){if(this.orderForm.invalid){this.orderForm.markAllAsTouched(),console.log("Order form is invalid:",this.getFormErrors(this.orderForm)),alert("Por favor complete todos los campos requeridos.");return}let r=this.orderForm.getRawValue(),e=$i(na(na({},r),r.package_details),{shipping_cost:this.calculatedShippingCost(),delivery_district_name:this.selectedDistrictName(),temp_id:`temp-${Date.now()}-${Math.random().toString(36).substring(2,7)}`});console.log("newOrderData",e),console.log("Submitting New Order Data:",e),this.orderSubmit.emit(e)}resetFormForNextOrder(){let r=this.orderForm.get("shipment_type")?.value||this.shipmentTypes[0],e=this.orderForm.get("payment_method_for_collection")?.value||this.paymentMethodsForCollection[0],a=this.datePipe.transform(new Date,"yyyy-MM-dd");this.orderForm.reset({shipment_type:r,delivery_date:a,package_details:{package_size_type:"standard"},amount_to_collect_at_delivery:0,payment_method_for_collection:e}),this.calculatedShippingCost.set(0),this.packageDetailsFormGroup.get("package_size_type")?.setValue("standard",{emitEvent:!0}),this.formValidityChanged.emit(this.orderForm.valid)}getDistrictCoverageInfo(r){return!r||!this._districtsCache||this._districtsCache.length===0?"":this._districtsCache.find(a=>a.id===r)?.name||""}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}getFormErrors(r){let e={};return Object.keys(r.controls).forEach(a=>{let i=r.get(a)?.errors;if(i&&(e[a]=i),r.get(a)instanceof Yd){let n=this.getFormErrors(r.get(a));Object.keys(n).length>0&&(e[a]=n)}}),e}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=Ye({type:t,selectors:[["app-order-creation-form"]],outputs:{orderSubmit:"orderSubmit",formValidityChanged:"formValidityChanged"},features:[ur([cs(),gr])],decls:98,vars:28,consts:[["deliveryDatePicker",""],[1,"order-creation-form",3,"ngSubmit","formGroup"],[1,"form-section-title"],[1,"form-grid"],["appearance","outline"],["formControlName","shipment_type"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","recipient_name","placeholder","Nombre completo"],["matSuffix",""],[4,"ngIf"],["matInput","","formControlName","recipient_phone","type","tel","placeholder",""],["align","end"],["formControlName","delivery_district_id"],["class","district-option-content",3,"value",4,"ngFor","ngForOf"],["appearance","outline",1,"full-span-column"],["matInput","","formControlName","delivery_address","placeholder","Ingresar lugar de entrega (M\xEDnimo 6 caracteres)"],["matInput","","formControlName","delivery_coordinates","placeholder","-12.070,-77.012"],["matInput","","formControlName","delivery_date",3,"matDatepicker","min"],["matSuffix","",3,"for"],[1,"section-divider"],[3,"shippingCostCalculated","calculationLoading","packageFormGroup","listaDeDistritos","deliveryDistrictId"],[1,"shipping-cost-display"],[1,"cost-value"],["mode","indeterminate","diameter","20","class","cost-spinner",4,"ngIf"],["matInput","","formControlName","item_description","placeholder","Detalle del pedido"],["matInput","","formControlName","amount_to_collect_at_delivery","type","number","min","0","placeholder","S/"],["matPrefix",""],["formControlName","payment_method_for_collection"],["matInput","","formControlName","observations","placeholder","\xBFQu\xE9 env\xEDas?...","rows","3"],[1,"add-order-button-container"],["mat-flat-button","","color","accent","type","submit",3,"disabled"],[3,"value"],[1,"district-option-content",3,"value"],[2,"display","flex","justify-content","space-between","width","100%","align-items","center"],[2,"font-weight","500","color","#555"],["mode","indeterminate","diameter","20",1,"cost-spinner"]],template:function(e,a){if(e&1){let i=tt();v(0,"form",1),ye("ngSubmit",function(){return De(i),Te(a.onSubmit())}),v(1,"h2",2),b(2,"Registrar pedido"),x(),v(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),b(6,"Tipo de env\xEDo"),x(),v(7,"mat-select",5),me(8,fT,2,2,"mat-option",6),x()(),v(9,"mat-form-field",4)(10,"mat-label"),b(11,"Nombre del destinatario"),x(),Ae(12,"input",7),v(13,"mat-icon",8),b(14,"person_outline"),x(),me(15,uT,2,0,"mat-error",9),x(),v(16,"mat-form-field",4)(17,"mat-label"),b(18,"Tel\xE9fono del destinatario"),x(),Ae(19,"input",10),v(20,"mat-icon",8),b(21,"phone_outline"),x(),v(22,"mat-hint",11),b(23,"No se debe agregar el +51"),x(),me(24,hT,2,0,"mat-error",9)(25,mT,2,0,"mat-error",9),x(),v(26,"mat-form-field",4)(27,"mat-label"),b(28,"Distrito de entrega"),x(),v(29,"mat-select",12),me(30,pT,8,6,"mat-option",13),Ve(31,"async"),x(),me(32,_T,2,0,"mat-error",9),x(),v(33,"mat-form-field",14)(34,"mat-label"),b(35,"Direcci\xF3n de entrega"),x(),Ae(36,"input",15),v(37,"mat-hint",11),b(38,"No acepta caracteres especiales se borran autom\xE1ticos"),x(),me(39,gT,2,0,"mat-error",9)(40,xT,2,0,"mat-error",9),x(),v(41,"mat-form-field",4)(42,"mat-label"),b(43,"Coordenadas (Opcional)"),x(),Ae(44,"input",16),v(45,"mat-icon",8),b(46,"location_on_outline"),x()(),v(47,"mat-form-field",4)(48,"mat-label"),b(49,"Fecha Entrega"),x(),Ae(50,"input",17)(51,"mat-datepicker-toggle",18)(52,"mat-datepicker",null,0),me(54,vT,2,0,"mat-error",9),x()(),Ae(55,"mat-divider",19),v(56,"app-package-calculator",20),ye("shippingCostCalculated",function(s){return De(i),Te(a.onShippingCostCalculated(s))})("calculationLoading",function(s){return De(i),Te(a.onPackageCalculationLoading(s))}),x(),v(57,"div",21),b(58," Costo de env\xEDo = "),v(59,"span",22),b(60),Ve(61,"number"),x(),me(62,wT,1,0,"mat-progress-spinner",23),x(),Ae(63,"mat-divider",19),v(64,"div",3)(65,"mat-form-field",14)(66,"mat-label"),b(67,"\xBFQu\xE9 env\xEDa?"),x(),Ae(68,"input",24),v(69,"mat-icon",8),b(70,"inventory_2_outline"),x(),me(71,yT,2,0,"mat-error",9),x(),v(72,"mat-form-field",4)(73,"mat-label"),b(74,"Monto total a cobrar"),x(),Ae(75,"input",25),v(76,"span",26),b(77,"S/\xA0"),x(),v(78,"mat-hint"),b(79,"Si solo hay que entregar colocar 0"),x(),me(80,bT,2,0,"mat-error",9)(81,CT,2,0,"mat-error",9),x(),v(82,"mat-form-field",4)(83,"mat-label"),b(84,"M\xE9todo de Pago (para cobro en entrega)"),x(),v(85,"mat-select",27),me(86,kT,2,2,"mat-option",6),x()(),v(87,"mat-form-field",14)(88,"mat-label"),b(89,"Observaciones (Opcional)"),x(),Ae(90,"textarea",28),x()(),v(91,"div",29)(92,"button",30)(93,"mat-icon"),b(94,"add_shopping_cart"),x(),b(95," AGREGAR PEDIDO AL LISTADO "),v(96,"mat-icon"),b(97,"arrow_downward"),x()()()()}if(e&2){let i,n,s,o,l,c,d,f,h,m,p,u=Tr(53);j("formGroup",a.orderForm),P(8),j("ngForOf",a.shipmentTypes),P(7),j("ngIf",(i=a.orderForm.get("recipient_name"))==null?null:i.hasError("required")),P(9),j("ngIf",(n=a.orderForm.get("recipient_phone"))==null?null:n.hasError("required")),P(),j("ngIf",(s=a.orderForm.get("recipient_phone"))==null?null:s.hasError("pattern")),P(5),j("ngForOf",Bt(31,23,a.deliveryDistricts$)),P(2),j("ngIf",(o=a.orderForm.get("delivery_district_id"))==null?null:o.hasError("required")),P(7),j("ngIf",(l=a.orderForm.get("delivery_address"))==null?null:l.hasError("required")),P(),j("ngIf",(c=a.orderForm.get("delivery_address"))==null?null:c.hasError("minlength")),P(10),j("matDatepicker",u)("min",a.minDeliveryDate),P(),j("for",u),P(3),j("ngIf",(d=a.orderForm.get("delivery_date"))==null?null:d.hasError("required")),P(2),j("packageFormGroup",a.packageDetailsFormGroup)("listaDeDistritos",a._districtsCache)("deliveryDistrictId",(f=a.orderForm.get("delivery_district_id"))==null?null:f.value),P(4),Ce("S/ ",It(61,25,a.calculatedShippingCost(),"1.2-2"),""),P(2),j("ngIf",a.isCalculatingShipping()),P(9),j("ngIf",(h=a.orderForm.get("item_description"))==null?null:h.hasError("required")),P(9),j("ngIf",(m=a.orderForm.get("amount_to_collect_at_delivery"))==null?null:m.hasError("required")),P(),j("ngIf",(p=a.orderForm.get("amount_to_collect_at_delivery"))==null?null:p.hasError("min")),P(5),j("ngForOf",a.paymentMethodsForCollection),P(6),j("disabled",a.orderForm.invalid||a.isCalculatingShipping())}},dependencies:[Tt,ca,Qt,Ji,io,Ka,fo,nn,uo,da,sn,jd,Ei,on,ha,ua,fa,Qd,qa,Jd,mo,Za,ln,ii,ai,ri,zo,Go,yn,ls,dt,Rt,er,xr,dn,bo,Gl,ja,Xa],styles:[".order-creation-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.form-section-title[_ngcontent-%COMP%]{font-size:1.5em;font-weight:500;color:#333;margin-bottom:10px;padding-bottom:10px;border-bottom:1px solid #eee}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px 24px}.full-span-column[_ngcontent-%COMP%]{grid-column:1/-1}mat-form-field[_ngcontent-%COMP%]{width:100%}.section-divider[_ngcontent-%COMP%]{margin:24px 0}.shipping-cost-display[_ngcontent-%COMP%]{font-size:1.3em;font-weight:700;margin:16px 0;text-align:right;color:#d32f2f;display:flex;align-items:center;justify-content:flex-end;gap:8px}.add-order-button-container[_ngcontent-%COMP%]{margin-top:24px;text-align:center}.add-order-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:12px 24px;font-size:1.1em;letter-spacing:.5px}mat-hint[align=end][_ngcontent-%COMP%]{font-size:.75em;opacity:.7}"]})};function ET(t,r){t&1&&(v(0,"div",4),b(1," A\xFAn no has agregado pedidos. "),x())}function ST(t,r){t&1&&(v(0,"th",23),b(1,"Nombre"),x())}function DT(t,r){if(t&1&&(v(0,"td",24)(1,"span",25),b(2),x()()),t&2){let e=r.$implicit;P(),j("matTooltip",e.recipient_name)("matTooltipDisabled",e.recipient_name.length<=20),P(),Ce(" ",e.recipient_name," ")}}function TT(t,r){t&1&&(v(0,"th",23),b(1,"Tel\xE9fono"),x())}function AT(t,r){if(t&1&&(v(0,"td",24),b(1),x()),t&2){let e=r.$implicit;P(),Dt(e.recipient_phone)}}function FT(t,r){t&1&&(v(0,"th",23),b(1,"F. Entrega"),x())}function OT(t,r){if(t&1&&(v(0,"td",24),b(1),Ve(2,"date"),x()),t&2){let e=r.$implicit;P(),Ce(" ",It(2,1,e.delivery_date,"dd/MM/yy")," ")}}function MT(t,r){t&1&&(v(0,"th",23),b(1,"Distrito"),x())}function IT(t,r){if(t&1&&(v(0,"td",24),b(1),x()),t&2){let e=r.$implicit;P(),Ce(" ",e.delivery_district_name," ")}}function PT(t,r){t&1&&(v(0,"th",23),b(1,"Direcci\xF3n"),x())}function RT(t,r){if(t&1&&(v(0,"td",24)(1,"span",25),b(2),x()()),t&2){let e=r.$implicit;P(),j("matTooltip",e.delivery_address)("matTooltipDisabled",e.delivery_address.length<=25),P(),Ce(" ",e.delivery_address," ")}}function NT(t,r){t&1&&(v(0,"th",23),b(1,"Producto"),x())}function LT(t,r){if(t&1&&(v(0,"td",24)(1,"span",25),b(2),x()()),t&2){let e=r.$implicit;P(),j("matTooltip",e.item_description)("matTooltipDisabled",e.item_description.length<=20),P(),Ce(" ",e.item_description," ")}}function BT(t,r){t&1&&(v(0,"th",23),b(1,"Cobrar"),x())}function VT(t,r){if(t&1&&(v(0,"td",26),b(1),Ve(2,"currency"),x()),t&2){let e=r.$implicit;P(),Ce(" ",Ya(2,1,e.amount_to_collect_at_delivery,"PEN","S/ ","1.2-2")," ")}}function UT(t,r){t&1&&(v(0,"th",23),b(1,"Costo env\xEDo"),x())}function HT(t,r){if(t&1&&(v(0,"td",26),b(1),Ve(2,"currency"),x()),t&2){let e=r.$implicit;P(),Ce(" ",Ya(2,1,e.shipping_cost,"PEN","S/ ","1.2-2")," ")}}function WT(t,r){t&1&&(v(0,"th",23),b(1,"M\xE9todo de Pago"),x())}function GT(t,r){if(t&1&&(v(0,"td",24),b(1),x()),t&2){let e=r.$implicit;P(),Ce(" ",e.payment_method_for_collection," ")}}function zT(t,r){t&1&&(v(0,"th",23),b(1,"Observaci\xF3n"),x())}function YT(t,r){if(t&1&&(v(0,"td",24)(1,"span",25),b(2),x()()),t&2){let e=r.$implicit;P(),j("matTooltip",e.observations)("matTooltipDisabled",!e.observations||e.observations.length<=20),P(),Ce(" ",e.observations||"-"," ")}}function $T(t,r){t&1&&(v(0,"th",23),b(1,"Quitar"),x())}function XT(t,r){if(t&1){let e=tt();v(0,"td",24)(1,"button",27),ye("click",function(){let i=De(e).$implicit,n=be(2);return Te(n.onRemoveOrder(i.temp_id))}),v(2,"mat-icon"),b(3,"remove_circle_outline"),x()()()}}function jT(t,r){t&1&&Ae(0,"tr",28)}function KT(t,r){t&1&&Ae(0,"tr",29)}function qT(t,r){if(t&1&&(v(0,"div",5)(1,"table",6),vt(2,7),me(3,ST,2,0,"th",8)(4,DT,3,3,"td",9),wt(),vt(5,10),me(6,TT,2,0,"th",8)(7,AT,2,1,"td",9),wt(),vt(8,11),me(9,FT,2,0,"th",8)(10,OT,3,4,"td",9),wt(),vt(11,12),me(12,MT,2,0,"th",8)(13,IT,2,1,"td",9),wt(),vt(14,13),me(15,PT,2,0,"th",8)(16,RT,3,3,"td",9),wt(),vt(17,14),me(18,NT,2,0,"th",8)(19,LT,3,3,"td",9),wt(),vt(20,15),me(21,BT,2,0,"th",8)(22,VT,3,6,"td",16),wt(),vt(23,17),me(24,UT,2,0,"th",8)(25,HT,3,6,"td",16),wt(),vt(26,18),me(27,WT,2,0,"th",8)(28,GT,2,1,"td",9),wt(),vt(29,19),me(30,zT,2,0,"th",8)(31,YT,3,3,"td",9),wt(),vt(32,20),me(33,$T,2,0,"th",8)(34,XT,4,0,"td",9),wt(),me(35,jT,1,0,"tr",21)(36,KT,1,0,"tr",22),x()()),t&2){let e=be();P(),j("dataSource",e.pendingOrders),P(34),j("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),P(),j("matRowDefColumns",e.displayedColumns)}}var zl=class t{pendingOrders=[];removeOrder=new ke;displayedColumns=["recipient_name","recipient_phone","delivery_date","delivery_district_name","delivery_address","item_description","amount_to_collect_at_delivery","shipping_cost","payment_method_for_collection","observations","actions"];constructor(){}onRemoveOrder(r){r&&this.removeOrder.emit(r)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=Ye({type:t,selectors:[["app-temporary-orders-table"]],inputs:{pendingOrders:"pendingOrders"},outputs:{removeOrder:"removeOrder"},decls:6,vars:2,consts:[["ordersTable",""],[1,"temporary-orders-container","mat-elevation-z1"],[1,"list-title"],["class","no-orders-message",4,"ngIf","ngIfElse"],[1,"no-orders-message"],[1,"table-responsive-wrapper"],["mat-table","",1,"temporary-orders-table",3,"dataSource"],["matColumnDef","recipient_name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","recipient_phone"],["matColumnDef","delivery_date"],["matColumnDef","delivery_district_name"],["matColumnDef","delivery_address"],["matColumnDef","item_description"],["matColumnDef","amount_to_collect_at_delivery"],["mat-cell","","class","align-right",4,"matCellDef"],["matColumnDef","shipping_cost"],["matColumnDef","payment_method_for_collection"],["matColumnDef","observations"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"truncate-text",3,"matTooltip","matTooltipDisabled"],["mat-cell","",1,"align-right"],["mat-icon-button","","color","warn","matTooltip","Quitar pedido",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,a){if(e&1&&(v(0,"div",1)(1,"h3",2),b(2,"Listado de pedidos del Negocio: Nikeli Fashion"),x(),me(3,ET,2,0,"div",3)(4,qT,37,4,"ng-template",null,0,Ed),x()),e&2){let i=Tr(5);P(3),j("ngIf",a.pendingOrders.length===0)("ngIfElse",i)}},dependencies:[Tt,Qt,tn,gr,Ro,Eo,Do,Oo,To,So,Mo,Ao,Fo,Io,Po,dt,Da,er,xr,ei,Ja],styles:[".table-responsive-wrapper[_ngcontent-%COMP%]{background-color:#6c757d!important;overflow:auto}.temporary-orders-container[_ngcontent-%COMP%]{margin-top:30px;padding:0;background-color:#fff;border-radius:8px;overflow:hidden;box-shadow:0 1px 3px #0000001f,0 1px 2px #0000003d}.list-title[_ngcontent-%COMP%]{font-size:1.2em;font-weight:500;color:#fff;background-color:#d32f2f;padding:12px 16px;margin:0;border-top-left-radius:8px;border-top-right-radius:8px}.temporary-orders-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th.mat-header-cell[_ngcontent-%COMP%], td.mat-cell[_ngcontent-%COMP%]{padding:10px 12px;border-bottom:1px solid #e0e0e0;vertical-align:middle;text-align:left}th.mat-header-cell[_ngcontent-%COMP%]{font-weight:500;color:#000000bf;background-color:#f5f5f5;white-space:nowrap}td.mat-cell[_ngcontent-%COMP%]{color:#000000de;font-size:.9em}[matColumnDef=amount_to_collect_at_delivery].mat-header-cell[_ngcontent-%COMP%], [matColumnDef=amount_to_collect_at_delivery].mat-cell[_ngcontent-%COMP%], [matColumnDef=shipping_cost].mat-header-cell[_ngcontent-%COMP%], [matColumnDef=shipping_cost].mat-cell[_ngcontent-%COMP%]{text-align:right;justify-content:flex-end}[matColumnDef=actions][_ngcontent-%COMP%]{width:80px}[matColumnDef=actions].mat-header-cell[_ngcontent-%COMP%], [matColumnDef=actions].mat-cell[_ngcontent-%COMP%]{text-align:center;justify-content:center}.truncate-text[_ngcontent-%COMP%]{display:block;max-width:120px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.no-orders-message[_ngcontent-%COMP%]{text-align:center;padding:30px;font-style:italic;color:#6c757d;background-color:#f8f9fa;border-bottom-left-radius:8px;border-bottom-right-radius:8px}"]})};function ZT(t,r){if(t&1&&(v(0,"mat-option",17),b(1),Ve(2,"titlecase"),x()),t&2){let e=r.$implicit;j("value",e),P(),Ce(" ",Bt(2,2,e.replace("_"," "))," ")}}function QT(t,r){t&1&&(v(0,"mat-error"),b(1," Debe seleccionar una opci\xF3n de traslado. "),x())}function JT(t,r){t&1&&(v(0,"mat-error",18),b(1," Debe aceptar los t\xE9rminos y condiciones. "),x())}function e4(t,r){t&1&&Ae(0,"mat-progress-spinner",19)}function t4(t,r){if(t&1){let e=tt();v(0,"div",4)(1,"div",5)(2,"mat-form-field",6)(3,"mat-label"),b(4,"\xBFC\xF3mo se har\xE1 el traslado de los pedidos al almac\xE9n?"),x(),v(5,"mat-select",7),me(6,ZT,3,4,"mat-option",8),x(),me(7,QT,2,0,"mat-error",9),x()(),v(8,"div",10)(9,"mat-checkbox",11),b(10," acepto los "),v(11,"a",12),b(12,"t\xE9rminos y condiciones"),x(),b(13," de Dinsides Courier "),x(),me(14,JT,2,0,"mat-error",13),x(),v(15,"div",14)(16,"button",15),ye("click",function(){De(e);let i=be();return Te(i.submitAllOrders())}),me(17,e4,1,0,"mat-progress-spinner",16),b(18),x()()()}if(t&2){let e=be();P(5),j("formControl",e.pickupOptionControl),P(),j("ngForOf",e.pickupOptions),P(),j("ngIf",e.pickupOptionControl.hasError("required")&&e.pickupOptionControl.touched),P(2),j("formControl",e.termsAcceptedControl),P(5),j("ngIf",e.termsAcceptedControl.hasError("required")&&e.termsAcceptedControl.touched),P(2),j("disabled",e.pendingOrders().length===0||!e.termsAcceptedControl.value||!e.pickupOptionControl.valid||e.isSubmittingBatch()),P(),j("ngIf",e.isSubmittingBatch()),P(),Ce(" ",e.isSubmittingBatch()?"Generando Pedidos...":"Haz click aqu\xED para guardar los pedidos"," ")}}var Yl=class t{orderCreationFormComponent;pendingOrders=qt([]);isSubmittingBatch=qt(!1);isOrderFormValid=qt(!1);pickupOptionControl=new rc("RECOGER_DOMICILIO",ot.required);termsAcceptedControl=new rc(!1,ot.requiredTrue);pickupOptions=["RECOGER_DOMICILIO","ENTREGAR_EN_ALMACEN"];orderService=Y(vr);router=Y(no);snackBar=Y(Qa);cdr=Y(Zt);destroy$=new Pe;constructor(){}ngOnInit(){}handleOrderAdded(r){this.pendingOrders.update(e=>[...e,r]),this.snackBar.open("Pedido agregado al listado.","OK",{duration:2e3,verticalPosition:"top"}),this.orderCreationFormComponent&&this.orderCreationFormComponent.resetFormForNextOrder(),this.cdr.detectChanges()}handleRemoveOrder(r){this.pendingOrders.update(e=>e.filter(a=>a.temp_id!==r)),this.snackBar.open("Pedido quitado del listado.","OK",{duration:2e3,verticalPosition:"top"})}onOrderFormValidityChanged(r){this.isOrderFormValid.set(r)}submitAllOrders(){if(this.pendingOrders().length===0){this.snackBar.open("No hay pedidos en el listado para enviar.","Cerrar",{duration:3e3,verticalPosition:"top"});return}if(!this.pickupOptionControl.valid){this.snackBar.open("Por favor, seleccione c\xF3mo se har\xE1 el traslado.","Cerrar",{duration:3e3,verticalPosition:"top"}),this.pickupOptionControl.markAsTouched();return}if(!this.termsAcceptedControl.value){this.snackBar.open("Debe aceptar los t\xE9rminos y condiciones.","Cerrar",{duration:3e3,verticalPosition:"top"}),this.termsAcceptedControl.markAsTouched();return}this.isSubmittingBatch.set(!0);let e={orders:this.pendingOrders().map(a=>{let s=a,{temp_id:i}=s;return od(s,["temp_id"])}).map(a=>$i(na({},a),{type_order_transfer_to_warehouse:this.pickupOptionControl.value})),pickup_option:this.pickupOptionControl.value||"RECOGER_DOMICILIO",terms_accepted:!0};this.orderService.createBatchOrders(e).pipe(gt(this.destroy$),hd(()=>this.isSubmittingBatch.set(!1))).subscribe({next:a=>{this.snackBar.open(a.message||"Pedidos generados exitosamente!","OK",{duration:4e3,verticalPosition:"top",panelClass:["success-snackbar"]}),this.pendingOrders.set([]),this.pickupOptionControl.reset("RECOGER_DOMICILIO"),this.termsAcceptedControl.reset(!1),this.router.navigate(["/features/orders"])},error:a=>{this.snackBar.open(a.message||"Error al generar los pedidos. Intente nuevamente.","Cerrar",{duration:5e3,verticalPosition:"top",panelClass:["error-snackbar"]}),console.error("Error submitting batch orders:",a)}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=Ye({type:t,selectors:[["app-order-create-page"]],viewQuery:function(e,a){if(e&1&&zt(js,5),e&2){let i;yt(i=bt())&&(a.orderCreationFormComponent=i.first)}},decls:4,vars:2,consts:[[1,"page-content-wrapper","order-create-page"],[3,"orderSubmit","formValidityChanged"],[3,"removeOrder","pendingOrders"],["class","final-submission-section mat-elevation-z1",4,"ngIf"],[1,"final-submission-section","mat-elevation-z1"],[1,"pickup-option-section"],["appearance","outline",1,"full-width"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"terms-section"],["color","primary",3,"formControl"],["href","/terminos-y-condiciones","target","_blank"],["class","terms-error",4,"ngIf"],[1,"submit-batch-button-container"],["mat-flat-button","","color","primary",1,"submit-all-button",3,"click","disabled"],["mode","indeterminate","diameter","24","class","button-spinner",4,"ngIf"],[3,"value"],[1,"terms-error"],["mode","indeterminate","diameter","24",1,"button-spinner"]],template:function(e,a){e&1&&(v(0,"div",0)(1,"app-order-creation-form",1),ye("orderSubmit",function(n){return a.handleOrderAdded(n)})("formValidityChanged",function(n){return a.onOrderFormValidityChanged(n)}),x(),v(2,"app-temporary-orders-table",2),ye("removeOrder",function(n){return a.handleRemoveOrder(n)}),x(),me(3,t4,19,8,"div",3),x()),e&2&&(P(2),j("pendingOrders",a.pendingOrders()),P(),j("ngIf",a.pendingOrders().length>0))},dependencies:[Tt,ca,Qt,en,so,Ka,da,Xd,js,zl,cn,dt,Rt,er,cf,lf,ii,ua,fa,qa,ai,ri,ha,ja,Xa],styles:[".order-create-page[_ngcontent-%COMP%]{padding:0;background-color:#f4f6f8}.final-submission-section[_ngcontent-%COMP%]{margin-top:30px;padding:24px;background-color:#fff;border-radius:8px;display:flex;flex-direction:column;gap:20px}.pickup-option-section[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%}.terms-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.terms-section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-weight:500}.terms-section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.terms-section[_ngcontent-%COMP%]   .terms-error[_ngcontent-%COMP%]{font-size:.75em;margin-top:4px}.submit-batch-button-container[_ngcontent-%COMP%]{margin-top:16px;text-align:center}.submit-batch-button-container[_ngcontent-%COMP%]   .submit-all-button[_ngcontent-%COMP%]{padding:12px 28px;font-size:1.1em;font-weight:500;letter-spacing:.5px;min-width:250px}.button-spinner[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;margin-right:10px}"]})};var gI=[{path:"",component:Ul,title:"Listado de Pedidos"},{path:"create",component:Yl,title:"Registrar Nuevo Pedido"}];export{gI as ORDERS_ROUTES};
