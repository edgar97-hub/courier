import{b as m,c as l}from"./chunk-INNR5TUR.js";import{ia as p}from"./chunk-DQQKDGFN.js";var E="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-TFG-8",y=".xlsx",S=class v{constructor(){}exportAsExcelFile(c,s,i="Sheet1"){if(!c||c.length===0){console.warn("No data provided for Excel export.");return}let a=l.json_to_sheet(c),r=this.calculateColumnWidths(a);a["!cols"]=r;let d={Sheets:{[i]:a},SheetNames:[i]},h=m(d,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(h,s)}exportCashMovementSummaryAndDetailsToExcel(c,s,i,a="Movimientos de Caja",r,d){let h=l.book_new(),t=l.aoa_to_sheet([]),e=1;t["!merges"]||(t["!merges"]=[]),t["!merges"].push({s:{r:e-1,c:0},e:{r:e-1,c:3}}),t["A"+e]={v:"Movimientos de Caja",t:"s",s:{font:{bold:!0,sz:14}}},e++,e++,t["A"+e]={v:"Resumen de saldos",t:"s",s:{font:{bold:!0,sz:14}}},e++,e++,c.slice(0,2).forEach(o=>{t["A"+e]={v:o.label,t:"s"},t["C"+e]={v:o.value,t:"s"},e++}),e++;let X=c.slice(2,-3),b=X.map(o=>o.Tipo),n=1;t["A"+e]={v:"",t:"s"},b.forEach(o=>{let u=l.encode_cell({r:e-1,c:n});t[u]={v:o,t:"s",s:{font:{bold:!0}}},n++}),e++,n=0,t["A"+e]={v:"Ingreso",t:"s",s:{font:{bold:!0}}},n++,X.forEach(o=>{let u=l.encode_cell({r:e-1,c:n});t[u]={v:parseFloat(o.Ingreso),t:"n"},n++}),e++,n=0,t["A"+e]={v:"Egreso",t:"s",s:{font:{bold:!0}}},n++,X.forEach(o=>{let u=l.encode_cell({r:e-1,c:n});t[u]={v:parseFloat(o.Egreso),t:"n"},n++}),e++,n=0,t["A"+e]={v:"Saldo",t:"s",s:{font:{bold:!0}}},n++,X.forEach(o=>{let u=l.encode_cell({r:e-1,c:n});t[u]={v:parseFloat(o.Saldo),t:"n"},n++}),e++,e++,c.slice(-3).forEach(o=>{t["!merges"]||(t["!merges"]=[]),t["!merges"].push({s:{r:e-1,c:0},e:{r:e-1,c:2}}),t["A"+e]={v:o.label,t:"s",s:{font:{bold:!0}}},t["C"+e]={v:"S/",t:"s",s:{font:{bold:!0}}},t["D"+e]={v:o.value,t:"n",s:{font:{bold:!0}}},e++}),e++,e++,t["A"+e]={v:"Detalle de Movimientos",t:"s",s:{font:{bold:!0,sz:12}}},t["!merges"].push({s:{r:e-1,c:0},e:{r:e-1,c:3}}),e++,e++,t["A"+e]={v:"Fecha Inicio:",t:"s"},t["B"+e]={v:r,t:"s"},e++,t["A"+e]={v:"Fecha Fin:",t:"s"},t["B"+e]={v:d,t:"s"},e++,e++;let g=Object.keys(s[0]||{});l.sheet_add_aoa(t,[g],{origin:`A${e}`}),t["A"+e]&&(t["A"+e].s={font:{bold:!0}},e++),l.sheet_add_json(t,s.length?s:["-----"],{origin:`A${e}`,skipHeader:!0});let f=this.calculateColumnWidths(t);f[0]?f[0].wch=5:f.unshift({wch:5}),console.log("columnWidths",f),t["!cols"]=f,l.book_append_sheet(h,t,a);let L=m(h,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(L,i)}saveAsExcelFile(c,s){let i=new Blob([c],{type:E}),a=window.URL.createObjectURL(i),r=document.createElement("a");r.href=a,r.download=`${s}${y}`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(a)}calculateColumnWidths(c){let s=[];return l.sheet_to_json(c,{header:1,raw:!1}).forEach(a=>{a.forEach((r,d)=>{let h=String(r||""),t=s[d]?s[d].wch:0;h.length>t&&(s[d]={wch:h.length+2})})}),s}static \u0275fac=function(s){return new(s||v)};static \u0275prov=p({token:v,factory:v.\u0275fac,providedIn:"root"})};export{S as a};
