import{a as d}from"./chunk-QOYZNJPJ.js";import{Gc as a,I as s,Ic as c,Vc as u,ca as h,ha as p,ma as o,u as t,x as n}from"./chunk-NTZTTLCP.js";var l=class i{apiUrl=u.apiUrl+"/users";http=o(c);authService=o(d);constructor(){console.log("UserService (NgRx integrated) initialized")}getAuthHeaders(){let e=this.authService.getAccessToken();return e?new a({"Content-Type":"application/json",codrr_token:e}):new a({"Content-Type":"application/json"})}getUsers(){let e=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.get(`${this.apiUrl}/all`,{headers:e}).pipe(n(r=>r||[]),s(this.handleError)):t(()=>new Error("Not authenticated to fetch users."))}getUserById(e){let r=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.get(`${this.apiUrl}/${e}`,{headers:r}).pipe(s(this.handleError)):t(()=>new Error("Not authenticated to fetch user by ID."))}createUser(e){let r=this.getAuthHeaders();return this.http.post(this.apiUrl+"/register",e,{headers:r}).pipe(h(U=>console.log("UserService: User created via API",U)),s(this.handleError))}updateUser(e){let r=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.put(`${this.apiUrl}/edit/${e.id}`,e,{headers:r}).pipe(s(this.handleError)):t(()=>new Error("Not authenticated to update user."))}updateUserCompany(e){let r=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.put(`${this.apiUrl}/edit-user-company/${e.id}`,e,{headers:r}).pipe(s(this.handleError)):t(()=>new Error("Not authenticated to update user."))}updateProfile(e){let r=this.getAuthHeaders();return this.authService.getAccessToken()?this.http.put(`${this.apiUrl}/update-profile/${e.id}`,e,{headers:r}).pipe(s(this.handleError)):t(()=>new Error("Not authenticated to update user."))}deleteUser(e){let r=this.getAuthHeaders();return this.authService.getAccessToken()?(console.log(`UserService: Deleting user via API, ID: ${e}`),this.http.delete(`${this.apiUrl}/delete/${e}`,{headers:r}).pipe(s(this.handleError))):t(()=>new Error("Not authenticated to delete user."))}handleError(e){let r="An unknown error occurred in UserService!";return e.error instanceof ErrorEvent?r=`Client-side error: ${e.error.message}`:(r=`Server-side error Code: ${e.status}
Message: ${e.message}`,e.status===401?r="Unauthorized. Your session may have expired or you lack permissions.":e.status===403&&(r="Forbidden. You do not have permission for this action.")),console.error("UserService API Error:",r,e),t(()=>new Error(r))}static \u0275fac=function(r){return new(r||i)};static \u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"})};export{l as a};
