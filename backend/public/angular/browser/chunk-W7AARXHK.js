import{b as m}from"./chunk-4UMFQSK3.js";import{h as c,ia as g,na as p,w as d}from"./chunk-YUSEJVZ2.js";var f=class t{directionsService;settingsService=p(m);readyPromise;constructor(){this.readyPromise=this.loadApiAndInitialize()}ngOnInit(){}loadApiAndInitialize(){return c(this,null,function*(){let e=yield d(this.settingsService.loadSettings());return window.googleMapsApiPromise||(window.googleMapsApiPromise=new Promise((o,s)=>{if(window.google&&window.google.maps){o();return}if(e=e&&e.length>0?e[0]:null,console.log(e),!e)return;let i=document.createElement("script"),a=e.googleMapsApiKey;i.src=`https://maps.googleapis.com/maps/api/js?key=${a}&libraries=places`,i.async=!0,i.defer=!0,i.onload=()=>{console.log("Google Maps script loaded successfully by DirectionsService."),o()},i.onerror=r=>{console.error("Error loading Google Maps script:",r),s(r)},document.head.appendChild(i)})),window.googleMapsApiPromise.then(()=>{this.directionsService||(this.directionsService=new google.maps.DirectionsService)}).catch(o=>(console.error("Google Maps API could not be loaded.",o),Promise.reject(o)))})}getDirections(e,o,s){return c(this,null,function*(){if(yield this.readyPromise,!this.directionsService)throw new Error("DirectionsService is not initialized. The Google Maps API may have failed to load.");let i={origin:e,destination:o,waypoints:s,travelMode:google.maps.TravelMode.DRIVING,optimizeWaypoints:!1,drivingOptions:{departureTime:new Date,trafficModel:google.maps.TrafficModel.BEST_GUESS}};return new Promise((a,r)=>{this.directionsService.route(i,(l,n)=>{n===google.maps.DirectionsStatus.OK&&l?a(l):(console.error(`Directions request failed due to status: ${n}`),r(new Error(`Directions request failed with status: ${n}`)))})})})}static \u0275fac=function(o){return new(o||t)};static \u0275prov=g({token:t,factory:t.\u0275fac,providedIn:"root"})};export{f as a};
