import"./chunk-F5X5MWHG.js";import{a as $t,b as jt,c as Vt,d as zt,e as Ht,f as qt,g as Gt,h as Qt,i as Kt,j as Yt,k as Wt,l as Zt,m as Jt,n as Be,o as ni,p as oi}from"./chunk-GVTQD7MK.js";import"./chunk-MS4AQ6UA.js";import{a as P,b as A,c as xe,d as me,e as ft,f as gt,h as T,i as _t,j as de,k as bt,l as pe,m as Ct}from"./chunk-WAFLSE7V.js";import{a as ti,b as ii,d as Re,e as ri}from"./chunk-V2UYO6B7.js";import{a as Xt,b as ei}from"./chunk-76D75VZ6.js";import{a as Pt,b as Tt}from"./chunk-ROMPM4OS.js";import{a as ie}from"./chunk-UZXXKA4A.js";import{a as Ae,b as Le}from"./chunk-FMCWYXBX.js";import{a as Ot,b as Nt,c as kt,e as At,f as Lt,g as Rt,h as ke}from"./chunk-TY3YGHIS.js";import{d as Bt}from"./chunk-D6JRQKJR.js";import"./chunk-BIOBBD76.js";import"./chunk-YWJ7YDH4.js";import{a as Ft}from"./chunk-QD6P4UPR.js";import"./chunk-QW3LQFON.js";import{d as Oe,e as Ne}from"./chunk-PIM5JW6K.js";import{b as ee,c as te}from"./chunk-5B4NE2BL.js";import"./chunk-SGYCFQGT.js";import{C as Te,D as Fe,b as vt,d as De,f as xt,g as Ut,l as St,o as Et,p as Mt,r as It,s as yt,u as Dt,v as we,w as wt,z as Pe}from"./chunk-5E3ALB3J.js";import"./chunk-4HLPQ3MO.js";import"./chunk-SH5IQZAH.js";import{a as he,c as N,d as ve,h as V}from"./chunk-LONJ5JQN.js";import{a as Ue,b as Se,d as Ee,e as Me,f as ht,g as Ie,i as z}from"./chunk-4UISFGQU.js";import{a as ye,b as X}from"./chunk-6QWK72ZE.js";import{a as y,b as x}from"./chunk-V3XFB2MU.js";import{a as H,b as q,e as S}from"./chunk-EHVJKBXY.js";import"./chunk-ZDC23HDZ.js";import{$b as nt,$c as v,Db as ct,Eb as d,Fa as dt,Ga as B,Ha as $,J as Q,L as R,Nb as r,Ob as e,Pb as m,Qa as K,Qb as M,Rb as I,Tb as J,Tc as O,Vb as _,Vc as j,W as rt,Wa as pt,Wb as C,a as g,ac as ot,b,bc as at,c as lt,ec as st,fc as n,gb as s,gc as p,ha as Z,hc as U,ia as k,ka as E,kb as le,l as L,m as _e,pa as mt,pc as Ce,rb as h,sc as D,t as F,tc as w,wa as c,xb as u,xc as ut,y as be}from"./chunk-XL3VFI5A.js";var re=P("[User Page/API] Load Users"),$e=P("[User API] Load Users Success",A()),je=P("[User API] Load Users Failure",A()),ne=P("[User Create Page] Create User",A()),ce=P("[User API] Create User Success",A()),Ve=P("[User API] Create User Failure",A()),oe=P("[User Page] Delete User",A()),ze=P("[User API] Delete User Success",A()),He=P("[User API] Delete User Failure",A()),qe=P("[User Store] Clear User Error");var Qe=ft("users"),ai=me(Qe,o=>o.users),si=me(Qe,o=>o.isLoading),Ke=me(Qe,o=>o.error),li=me(Qe,o=>o.isSubmitting);var _i=()=>[5,10,25,100];function bi(o,t){o&1&&(r(0,"div",10),m(1,"mat-progress-spinner",11),e())}function Ci(o,t){o&1&&(r(0,"th",24),n(1,"N\xB0"),e())}function hi(o,t){if(o&1&&(r(0,"td",25),n(1),e()),o&2){let i=t.$implicit;s(),p(i.code)}}function vi(o,t){o&1&&(r(0,"th",24),n(1,"Nombre"),e())}function xi(o,t){if(o&1&&(r(0,"td",25),n(1),e()),o&2){let i=t.$implicit;s(),p(i.username)}}function Ui(o,t){o&1&&(r(0,"th",24),n(1,"Correo"),e())}function Si(o,t){if(o&1&&(r(0,"td",25),n(1),e()),o&2){let i=t.$implicit;s(),p(i.email)}}function Ei(o,t){o&1&&(r(0,"th",24),n(1,"Rol"),e())}function Mi(o,t){if(o&1&&(r(0,"td",25),n(1),e()),o&2){let i=t.$implicit;s(),p(i.role||"N/A")}}function Ii(o,t){o&1&&(r(0,"th",26),n(1,"Acciones"),e())}function yi(o,t){if(o&1){let i=J();r(0,"td",25)(1,"button",27),_("click",function(){let l=B(i).$implicit,f=C(2);return $(f.onEdit(l))}),r(2,"mat-icon"),n(3,"edit"),e()(),r(4,"button",28),_("click",function(){let l=B(i).$implicit,f=C(2);return $(f.onDelete(l))}),r(5,"mat-icon"),n(6,"delete"),e()()()}}function Di(o,t){o&1&&m(0,"tr",29)}function wi(o,t){o&1&&m(0,"tr",30)}function Pi(o,t){if(o&1&&(r(0,"tr",31)(1,"td",32),n(2),e()()),o&2){let i=C(2),a=st(6);s(),ct("colspan",i.displayedColumns.length),s(),U(' No data matching the filter "',a.value,'" ')}}function Ti(o,t){if(o&1&&(r(0,"table",12),M(1,13),u(2,Ci,2,0,"th",14)(3,hi,2,1,"td",15),I(),M(4,16),u(5,vi,2,0,"th",14)(6,xi,2,1,"td",15),I(),M(7,17),u(8,Ui,2,0,"th",14)(9,Si,2,1,"td",15),I(),M(10,18),u(11,Ei,2,0,"th",14)(12,Mi,2,1,"td",15),I(),M(13,19),u(14,Ii,2,0,"th",20)(15,yi,7,0,"td",15),I(),u(16,Di,1,0,"tr",21)(17,wi,1,0,"tr",22)(18,Pi,3,2,"tr",23),e()),o&2){let i=C();d("dataSource",i.dataSource),s(16),d("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky",!0),s(),d("matRowDefColumns",i.displayedColumns)}}function Fi(o,t){o&1&&(r(0,"div",33),n(1," No users found. Try dispatching the load action or check your API. "),e())}var Ye=class o{users=[];isLoading=!1;displayedColumns=["code","username","email","rol","actions"];dataSource=new Jt;paginator;sort;ngOnChanges(t){t.users&&this.users?(console.log("UserTableComponent: Users received via @Input()",this.users),this.dataSource.data=this.users):t.users&&!this.users&&(this.dataSource.data=[])}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.dataSource.sortingDataAccessor=(t,i)=>t[i]}applyFilter(t){let i=t.target.value;this.dataSource.filter=i.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}viewUser=new K;editUser=new K;deleteUser=new K;onView(t){this.viewUser.emit(t)}onEdit(t){this.editUser.emit(t)}onDelete(t){this.deleteUser.emit(t)}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=h({type:o,selectors:[["app-user-table"]],viewQuery:function(i,a){if(i&1&&(nt(Re,5),nt(Be,5)),i&2){let l;ot(l=at())&&(a.paginator=l.first),ot(l=at())&&(a.sort=l.first)}},inputs:{users:"users",isLoading:"isLoading"},outputs:{viewUser:"viewUser",editUser:"editUser",deleteUser:"deleteUser"},features:[dt],decls:13,vars:5,consts:[["input",""],[1,"table-container","mat-elevation-z4"],[1,"table-header"],["appearance","outline",1,"filter-field"],["matInput","","placeholder","Search...",3,"keyup"],["matSuffix",""],["class","spinner-container",4,"ngIf"],["mat-table","","matSort","","class","user-data-table",3,"dataSource",4,"ngIf"],["class","no-data-message",4,"ngIf"],["showFirstLastButtons","","aria-label","Select page of users",3,"pageSizeOptions"],[1,"spinner-container"],["mode","indeterminate","diameter","50"],["mat-table","","matSort","",1,"user-data-table",3,"dataSource"],["matColumnDef","code"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","username"],["matColumnDef","email"],["matColumnDef","rol"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","","color","accent","matTooltip","Editar Usuario",3,"click"],["mat-icon-button","","color","warn","matTooltip","Eliminar Usuario",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],[1,"mat-cell"],[1,"no-data-message"]],template:function(i,a){if(i&1){let l=J();r(0,"div",1)(1,"div",2)(2,"mat-form-field",3)(3,"mat-label"),n(4,"Filtrar Usuarios"),e(),r(5,"input",4,0),_("keyup",function(W){return B(l),$(a.applyFilter(W))}),e(),r(7,"mat-icon",5),n(8,"search"),e()()(),u(9,bi,2,0,"div",6)(10,Ti,19,4,"table",7)(11,Fi,2,0,"div",8),m(12,"mat-paginator",9),e()}if(i&2){let l=st(6);s(9),d("ngIf",a.isLoading),s(),d("ngIf",!a.isLoading&&a.dataSource.data.length>0),s(),d("ngIf",!a.isLoading&&a.dataSource.data.length===0&&!l.value),s(),d("pageSizeOptions",Ce(4,_i))}},dependencies:[v,O,Zt,$t,Vt,Gt,zt,jt,Qt,Ht,qt,Kt,Yt,Wt,ri,Re,oi,Be,ni,Fe,Te,we,Pe,Ne,Oe,x,y,S,H,X,ye,ii,ti],styles:[".table-container[_ngcontent-%COMP%]{margin:20px;overflow:auto;border-radius:8px;background-color:#fff}.table-header[_ngcontent-%COMP%]{padding:16px;display:flex;justify-content:space-between;align-items:center;background-color:#f5f5f5;border-top-left-radius:8px;border-top-right-radius:8px}.filter-field[_ngcontent-%COMP%]{width:100%;max-width:400px;font-size:.9em}.user-data-table[_ngcontent-%COMP%]{width:100%}th.mat-header-cell[_ngcontent-%COMP%], td.mat-cell[_ngcontent-%COMP%]{padding:12px 16px;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:#e0e0e0}th.mat-header-cell[_ngcontent-%COMP%]{font-weight:500;color:#333;background-color:#fafafa}tr.mat-row[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}.mat-mdc-paginator[_ngcontent-%COMP%]{background-color:#f5f5f5;border-bottom-left-radius:8px;border-bottom-right-radius:8px}.spinner-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:50px;min-height:200px}.no-data-message[_ngcontent-%COMP%]{text-align:center;padding:30px;color:#757575;font-style:italic}td.mat-cell[_ngcontent-%COMP%]   button.mat-icon-button[_ngcontent-%COMP%]{margin-right:4px}"]})};var We=class o{constructor(t,i){this.dialogRef=t;this.data=i}onConfirm(){this.dialogRef.close(!0)}onDismiss(){this.dialogRef.close(!1)}static \u0275fac=function(i){return new(i||o)(le(Ot),le(Nt))};static \u0275cmp=h({type:o,selectors:[["app-confirm-dialog"]],decls:10,vars:4,consts:[["mat-dialog-title","",1,"dialog-title"],[1,"dialog-content"],["align","end",1,"dialog-actions"],["mat-stroked-button","",1,"btn-corp-secondary",3,"click"],["mat-flat-button","","cdkFocusInitial","",1,"btn-corp-primary",3,"click"]],template:function(i,a){i&1&&(r(0,"h2",0),n(1),e(),r(2,"mat-dialog-content",1)(3,"p"),n(4),e()(),r(5,"mat-dialog-actions",2)(6,"button",3),_("click",function(){return a.onDismiss()}),n(7),e(),r(8,"button",4),_("click",function(){return a.onConfirm()}),n(9),e()()),i&2&&(s(),U(" ",a.data.title," "),s(3),p(a.data.message),s(3),U(" ",a.data.cancelText||"Cancel"," "),s(2),U(" ",a.data.confirmText||"Delete"," "))},dependencies:[v,ke,At,Rt,Lt,S,q,x],styles:[".dialog-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-weight:500;color:#d32f2f}.dialog-content[_ngcontent-%COMP%]{line-height:1.6;color:#555}.dialog-actions[_ngcontent-%COMP%]{padding-top:16px}.title-icon[_ngcontent-%COMP%]{vertical-align:middle}"]})};var Oi=()=>[],Ze=class o{store=c(xe);router=c(N);dialog=c(kt);users$;isLoading$;error$;destroy$=new L;constructor(){this.users$=this.store.select(ai).pipe(E(t=>console.log("UserListPageComponent: Users from store:",t))),this.isLoading$=this.store.select(si).pipe(E(t=>console.log("UserListPageComponent: IsLoading from store:",t))),this.error$=this.store.select(Ke).pipe(Q(t=>!!t),E(t=>{console.error("UserListPageComponent: Error from store:",t)}))}ngOnInit(){console.log("UserListPageComponent: ngOnInit - dispatching loadUsers"),this.store.dispatch(re())}handleViewUser(t){this.router.navigate(["/users",t.id])}handleEditUser(t){this.router.navigate(["/users","edit",t.id])}handleDeleteUser(t){this.dialog.open(We,{width:"350px",data:{title:"Confirm Delete",message:`\xBFEst\xE1s seguro que deseas eliminar el usuario "${t.username}" (codigo: ${t.code})? Esta acci\xF3n no se puede deshacer.`}}).afterClosed().pipe(Q(a=>!!a),k(this.destroy$)).subscribe(()=>{this.performDelete(t)})}performDelete(t){this.store.dispatch(oe({userId:t.id||""}))}navigateToCreate(){this.router.navigate(["/users/edit/0"])}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=h({type:o,selectors:[["app-user-list-page"]],decls:11,vars:7,consts:[[1,"page-container"],[1,"page-header"],["mat-flat-button","",1,"btn-corp-primary",3,"click"],[3,"viewUser","editUser","deleteUser","users","isLoading"]],template:function(i,a){if(i&1&&(r(0,"div",0)(1,"div",1)(2,"h1"),n(3,"Gesti\xF3n de usuarios"),e(),r(4,"button",2),_("click",function(){return a.navigateToCreate()}),r(5,"mat-icon"),n(6,"add_circle_outline"),e(),n(7," Crear nuevo usuario "),e()(),r(8,"app-user-table",3),D(9,"async"),D(10,"async"),_("viewUser",function(f){return a.handleViewUser(f)})("editUser",function(f){return a.handleEditUser(f)})("deleteUser",function(f){return a.handleDeleteUser(f)}),e()()),i&2){let l;s(8),d("users",w(9,2,a.users$)||Ce(6,Oi))("isLoading",(l=w(10,4,a.isLoading$))!==null&&l!==void 0?l:!1)}},dependencies:[v,j,V,Ye,S,q,x,y,ke,te],styles:[".page-container[_ngcontent-%COMP%]{padding:24px;background-color:#f9f9f9;min-height:calc(100vh - 64px)}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:15px;flex-wrap:wrap;margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid #e0e0e0}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:2em;font-weight:500}.page-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-weight:500}"]})};function Ai(o,t){o&1&&(r(0,"mat-error"),n(1," Nombre de usuario es requerido. "),e())}function Li(o,t){o&1&&(r(0,"mat-error"),n(1," Email es requerido. "),e())}function Ri(o,t){o&1&&(r(0,"mat-error"),n(1," Formato de email inv\xE1lido. "),e())}function Bi(o,t){o&1&&(r(0,"mat-error"),n(1," Rol es requerido. "),e())}function $i(o,t){o&1&&(M(0),m(1,"mat-divider",19),r(2,"div",2)(3,"h3",3)(4,"mat-icon"),n(5,"featured_play_list"),e(),n(6," Caracter\xEDstica del Negocio "),e(),r(7,"div",20)(8,"mat-form-field",5)(9,"mat-label"),n(10,"Tipo de Negocio"),e(),m(11,"input",21),e(),r(12,"mat-form-field",5)(13,"mat-label"),n(14,"Nombre del Negocio"),e(),m(15,"input",22),e()(),r(16,"mat-form-field",23)(17,"mat-label"),n(18,"Distrito del Negocio"),e(),m(19,"input",24),e(),r(20,"mat-form-field",23)(21,"mat-label"),n(22,"Direcci\xF3n del Negocio"),e(),m(23,"input",25),e(),r(24,"div",20)(25,"mat-form-field",5)(26,"mat-label"),n(27,"N\xFAmero de tel\xE9fono del Negocio"),e(),m(28,"input",26),e(),r(29,"mat-form-field",5)(30,"mat-label"),n(31,"Sector del Negocio"),e(),m(32,"input",27),e()(),r(33,"div",20)(34,"mat-form-field",5)(35,"mat-label"),n(36,"Tipo de documento del Negocio"),e(),m(37,"input",28),e(),r(38,"mat-form-field",5)(39,"mat-label"),n(40,"Correo electr\xF3nico del Negocio"),e(),m(41,"input",29),e()(),r(42,"div",20)(43,"mat-form-field",5)(44,"mat-label"),n(45,"N\xFAmero de documento del Negocio"),e(),m(46,"input",30),e()(),r(47,"div",31)(48,"label",32),n(49,"Asume el 5% POS"),e(),r(50,"mat-checkbox",33),n(51," Confirmar "),e()()(),m(52,"mat-divider",19),r(53,"div",2)(54,"h3",3)(55,"mat-icon"),n(56,"attribution"),e(),n(57," Informaci\xF3n del Propietario "),e(),r(58,"div",20)(59,"mat-form-field",5)(60,"mat-label"),n(61,"Nombre del propietario"),e(),m(62,"input",34),e(),r(63,"mat-form-field",5)(64,"mat-label"),n(65,"N\xFAmero de tel\xE9fono del propietario"),e(),m(66,"input",35),e()(),r(67,"div",20)(68,"mat-form-field",5)(69,"mat-label"),n(70,"Tipo de documento del propietario"),e(),m(71,"input",36),e(),r(72,"mat-form-field",5)(73,"mat-label"),n(74,"N\xFAmero de documento del propietario"),e(),m(75,"input",37),e()(),r(76,"div",20)(77,"mat-form-field",5)(78,"mat-label"),n(79,"Direcci\xF3n de correo electr\xF3nico del propietario"),e(),m(80,"input",38),e()()(),m(81,"mat-divider",19),r(82,"div",2)(83,"h3",3)(84,"mat-icon"),n(85,"account_balance"),e(),n(86," Cuenta bancaria "),e(),r(87,"mat-form-field",23)(88,"mat-label"),n(89,"Cuenta bancaria"),e(),m(90,"input",39),e(),r(91,"mat-form-field",23)(92,"mat-label"),n(93,"Titular del numero de cuenta"),e(),m(94,"input",40),e()(),I())}var se=class o{constructor(t){this.fb=t}userToEdit=null;isLoading=!1;formSubmit=new K;formCancel=new K;userForm;hidePassword=pt(!0);ngOnInit(){this.initForm(),this.userToEdit&&this.userForm.patchValue(this.userToEdit),this.userForm.get("role")?.valueChanges.subscribe(t=>{this.handleRoleChange(t)})}get roleControl(){return this.userForm.get("role")}handleRoleChange(t){}initForm(){this.userForm=this.fb.group({id:[null],username:["",De.required],email:["",[De.required,De.email]],password:["",[]],role:["COMPANY"],business_type:["",[]],business_name:["",[]],business_district:["",[]],business_address:["",[]],business_phone_number:["",[]],business_sector:["",[]],business_document_type:["",[]],business_email:["",[]],assumes_5_percent_pos:[!1,[]],business_document_number:["",[]],owner_name:["",[]],owner_phone_number:["",[]],owner_document_type:["",[]],owner_document_number:["",[]],owner_email_address:["",[]],owner_bank_account:["",[]],name_account_number_owner:["",[]]})}get username(){return this.userForm.get("username")}get email(){return this.userForm.get("email")}onSubmit(){if(this.userForm.valid)if(this.userToEdit&&this.userToEdit.id){let i=b(g(g({},this.userToEdit),this.userForm.value),{id:this.userToEdit.id});console.log("formData",i),this.formSubmit.emit(i)}else{let t=this.userForm.value,{id:i}=t,a=lt(t,["id"]);this.formSubmit.emit(a)}else this.userForm.markAllAsTouched()}onCancel(){this.formCancel.emit()}static \u0275fac=function(i){return new(i||o)(le(yt))};static \u0275cmp=h({type:o,selectors:[["app-user-form"]],inputs:{userToEdit:"userToEdit",isLoading:"isLoading"},outputs:{formSubmit:"formSubmit",formCancel:"formCancel"},decls:51,vars:10,consts:[[1,"multi-section-form-card"],[3,"ngSubmit","formGroup"],[1,"form-section"],[1,"section-title"],[1,"form-grid"],["appearance","outline",1,"form-field","small-field"],["matInput","","formControlName","username","autocomplete","off","required",""],[4,"ngIf"],["matInput","","formControlName","email","type","email","required",""],["matInput","","placeholder","Ingrese su contrase\xF1a","formControlName","password","autocomplete","new-password",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["formControlName","role","required",""],["value","ADMINISTRADOR"],["value","MOTORIZADO"],["value","EMPRESA"],["value","RECEPCIONISTA"],["align","end",1,"form-actions-sticky"],["mat-stroked-button","","type","button",1,"btn-corp-secondary",3,"click"],["mat-flat-button","","type","submit",1,"btn-corp-primary",3,"disabled"],[1,"section-divider"],[1,"form-grid","two-columns"],["matInput","","formControlName","business_type"],["matInput","","formControlName","business_name"],["appearance","outline",1,"form-field","small-field","full-width-mobile"],["matInput","","formControlName","business_district"],["matInput","","formControlName","business_address"],["matInput","","formControlName","business_phone_number"],["matInput","","formControlName","business_sector"],["matInput","","formControlName","business_document_type"],["matInput","","formControlName","business_email"],["matInput","","formControlName","business_document_number"],[1,"form-field-group"],[1,"checkbox-group-label"],["formControlName","assumes_5_percent_pos","color","primary",1,"small-checkbox"],["matInput","","formControlName","owner_name"],["matInput","","formControlName","owner_phone_number"],["matInput","","formControlName","owner_document_type"],["matInput","","formControlName","owner_document_number"],["matInput","","formControlName","owner_email_address"],["matInput","","formControlName","owner_bank_account"],["matInput","","formControlName","name_account_number_owner"]],template:function(i,a){if(i&1&&(r(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),n(3,"Formulario de usuario"),e(),r(4,"mat-card-subtitle"),n(5,"Complete todas las secciones del formulario"),e()(),r(6,"mat-card-content")(7,"form",1),_("ngSubmit",function(){return a.onSubmit()}),r(8,"div",2)(9,"h3",3)(10,"mat-icon"),n(11,"person_outline"),e(),n(12," Informaci\xF3n B\xE1sica "),e(),r(13,"div",4)(14,"mat-form-field",5)(15,"mat-label"),n(16,"Nombre de Usuario"),e(),m(17,"input",6),u(18,Ai,2,0,"mat-error",7),e(),r(19,"mat-form-field",5)(20,"mat-label"),n(21,"Correo"),e(),m(22,"input",8),u(23,Li,2,0,"mat-error",7)(24,Ri,2,0,"mat-error",7),e(),r(25,"mat-form-field",5)(26,"mat-label"),n(27,"contrase\xF1a"),e(),m(28,"input",9),r(29,"button",10),_("click",function(){return a.hidePassword.set(!a.hidePassword())}),r(30,"mat-icon"),n(31),e()()(),r(32,"mat-form-field",5)(33,"mat-label"),n(34,"Rol"),e(),r(35,"mat-select",11)(36,"mat-option",12),n(37,"Administrador"),e(),r(38,"mat-option",13),n(39,"Motorizado"),e(),r(40,"mat-option",14),n(41,"Empresa"),e(),r(42,"mat-option",15),n(43,"Recepcionista"),e()(),u(44,Bi,2,0,"mat-error",7),e()()(),u(45,$i,95,0,"ng-container",7),r(46,"mat-card-actions",16)(47,"button",17),_("click",function(){return a.onCancel()}),n(48," Cancelar "),e(),r(49,"button",18),n(50),e()()()()()),i&2){let l,f,W,ge;s(7),d("formGroup",a.userForm),s(11),d("ngIf",((l=a.userForm.get("username"))==null?null:l.invalid)&&((l=a.userForm.get("username"))==null?null:l.touched)),s(5),d("ngIf",((f=a.userForm.get("email"))==null?null:f.hasError("required"))&&((f=a.userForm.get("email"))==null?null:f.touched)),s(),d("ngIf",((W=a.userForm.get("email"))==null?null:W.hasError("email"))&&((W=a.userForm.get("email"))==null?null:W.touched)),s(4),d("type",a.hidePassword()?"password":"text"),s(3),p(a.hidePassword()?"visibility_off":"visibility"),s(13),d("ngIf",((ge=a.userForm.get("role"))==null?null:ge.invalid)&&((ge=a.userForm.get("role"))==null?null:ge.touched)),s(),d("ngIf",a.roleControl.value==="EMPRESA"),s(4),d("disabled",a.isLoading||a.userForm.invalid),s(),U(" ",a.isLoading?"Guardando...":"Guardar Todo"," ")}},dependencies:[v,O,Dt,St,vt,xt,Ut,It,Et,Mt,Fe,Te,we,wt,Pe,Ne,Oe,S,q,H,z,Ue,ht,Ee,Ie,Me,Se,ei,Xt,Bt,x,y,Le,Ae,Tt,Pt],styles:[".multi-section-form-card[_ngcontent-%COMP%]{max-width:900px;margin:24px auto;padding:16px 24px;border-radius:8px}mat-card-title[_ngcontent-%COMP%]{font-size:1.5em;margin-bottom:4px}mat-card-subtitle[_ngcontent-%COMP%]{margin-bottom:24px;color:#0009}.form-section[_ngcontent-%COMP%]{margin-bottom:32px;gap:10px!important}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:1.2em;font-weight:500;margin-bottom:20px;display:flex;align-items:center;gap:8px;border-bottom:1px solid #e0e0e0;padding-bottom:8px}.section-divider[_ngcontent-%COMP%]{margin-top:16px;margin-bottom:32px}.form-grid[_ngcontent-%COMP%]{display:grid;gap:20px;grid-template-columns:repeat(auto-fit,minmax(250px,1fr))}@media (min-width: 600px){.form-grid.two-columns[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}.form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-form-field-input-control, .form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-floating-label, .form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-select-value{font-size:.875em}.form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-form-field-infix{padding-top:.8em!important;padding-bottom:.6em!important;min-height:auto!important}.form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-floating-label.mdc-floating-label--float-above{transform:translateY(-1.85em) scale(.75)!important}.form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-input-element{padding-top:0;margin-top:0}.form-field-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-top:8px}.form-field-group[_ngcontent-%COMP%]   .checkbox-group-label[_ngcontent-%COMP%]{font-size:.9em;color:#0009;margin-bottom:4px;font-weight:500}.small-checkbox[_ngcontent-%COMP%]     .mdc-form-field{font-size:.9em}.mat-card-actions.form-actions-sticky[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #e0e0e0;background-color:#fff}"]})};var Je=class o{store=c(xe);router=c(N);isSubmitting$;error$;destroy$=new L;constructor(){this.isSubmitting$=this.store.select(li),this.error$=this.store.select(Ke)}ngOnInit(){this.store.dispatch(qe())}handleFormSubmit(t){console.log("UserCreatePageComponent: Form submitted",t),this.store.dispatch(ne({user:t}))}handleFormCancel(){this.router.navigate(["/users"])}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=h({type:o,selectors:[["app-user-create-page"]],decls:9,vars:4,consts:[[1,"page-container","form-page-container"],[1,"page-header"],["mat-icon-button","","routerLink","/users","matTooltip","Back to User List","aria-label","Back to user list"],[3,"formSubmit","formCancel","userToEdit","isLoading"]],template:function(i,a){i&1&&(r(0,"div",0)(1,"div",1)(2,"button",2)(3,"mat-icon"),n(4,"arrow_back"),e()(),r(5,"h1"),n(6,"Create New User"),e()(),r(7,"app-user-form",3),D(8,"async"),_("formSubmit",function(f){return a.handleFormSubmit(f)})("formCancel",function(){return a.handleFormCancel()}),e()()),i&2&&(s(7),d("userToEdit",null)("isLoading",!!w(8,2,a.isSubmitting$)))},dependencies:[v,j,V,ve,se,x,y,S,H],styles:[".page-container[_ngcontent-%COMP%]{padding:24px;background-color:#f9f9f9}.form-page-container[_ngcontent-%COMP%]{max-width:700px;margin:30px auto;background-color:#fff;border-radius:8px;box-shadow:0 2px 10px #0000001a;padding:24px}.page-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid #e0e0e0}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 0 16px;font-size:1.6em;font-weight:500;color:#3f51b5}"]})};function Vi(o,t){if(o&1&&(r(0,"h1"),n(1),e()),o&2){let i=C();s(),U(" ",i.isLoading?"Loading User...":i.isEditMode?"Edit User":"User Details"," ")}}function zi(o,t){if(o&1){let i=J();r(0,"button",8),_("click",function(){B(i);let l=C();return $(l.navigateToEdit())}),r(1,"mat-icon"),n(2,"edit"),e(),n(3," Edit User "),e()}}function Hi(o,t){o&1&&(r(0,"div",9),m(1,"mat-progress-spinner",10),e())}function qi(o,t){if(o&1){let i=J();M(0),r(1,"div",11)(2,"app-user-form",12),D(3,"async"),_("formSubmit",function(l){B(i);let f=C();return $(f.handleFormSubmit(l))})("formCancel",function(){B(i);let l=C();return $(l.handleFormCancel())}),e()(),I()}if(o&2){let i=C();s(2),d("userToEdit",w(3,2,i.user$))("isLoading",i.isLoading)}}function Gi(o,t){if(o&1&&(r(0,"p",13),n(1),e()),o&2){let i=C();s(),U(" User with ID ",i.userId," not found or could not be loaded. ")}}var Xe=class o{route=c(he);router=c(N);userService=c(ie);snackBar=c(ee);userSubject=new _e(null);user$=this.userSubject.asObservable();isLoading=!0;isEditMode=!1;userId=null;destroy$=new L;ngOnInit(){this.route.paramMap.pipe(k(this.destroy$),E(()=>{this.isLoading=!0,this.userSubject.next(null)}),Z(t=>{let i=t.get("id");return i&&i!=="0"?(this.userId=i,this.isEditMode=this.router.url.includes(`/edit/${this.userId}`),this.userService.getUserById(this.userId)):(this.isLoading=!1,F(null))}),R(t=>(this.isLoading=!1,this.snackBar.open("Error fetching user data.","Close",{duration:3e3,panelClass:["error-snackbar"]}),this.router.navigate(["/users"]),F(null))),Q(t=>t!==null)).subscribe(t=>{this.isLoading=!1,console.log("user",t),t?this.userSubject.next(t):this.userId&&(this.snackBar.open(`User with ID ${this.userId} not found.`,"Close",{duration:3e3}),this.router.navigate(["/users"]))})}navigateToEdit(){this.userId&&this.router.navigate(["/users","edit",this.userId])}navigateToView(){this.userId&&this.router.navigate(["/users",this.userId])}handleFormSubmit(t){let i;this.userId?(i=b(g({},t),{id:this.userId}),this.isLoading=!0,this.userService.updateUser(i).pipe(k(this.destroy$)).subscribe({next:a=>{this.isLoading=!1,this.userSubject.next(a),this.snackBar.open("\xA1Actualizado exitosamente!","OK",{duration:3e3,verticalPosition:"top",panelClass:["success-snackbar"]}),this.isEditMode=!1,window.location.href="/users"},error:a=>{this.isLoading=!1,this.snackBar.open("Error al actualizar el usuario. Int\xE9ntalo de nuevo.","Retry",{duration:5e3,verticalPosition:"top",panelClass:["error-snackbar"]}),console.error("Error updating user:",a)}})):(i=g({},t),this.isLoading=!0,this.userService.createUser(i).pipe(k(this.destroy$)).subscribe({next:a=>{this.isLoading=!1,this.userSubject.next(a),this.snackBar.open("guardado exitosamente!","OK",{duration:3e3,verticalPosition:"top",panelClass:["success-snackbar"]}),this.isEditMode=!1,window.location.href="/users"},error:a=>{this.isLoading=!1,this.snackBar.open("Error al actualizar el usuario. Int\xE9ntalo de nuevo.","Retry",{duration:5e3,verticalPosition:"top",panelClass:["error-snackbar"]}),console.error("Error updating user:",a)}}))}handleFormCancel(){this.isEditMode=!1,this.router.navigate(["/users"])}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=h({type:o,selectors:[["app-user-detail-page"]],decls:13,vars:8,consts:[["loadingOrMissingTitle",""],[1,"page-container","detail-page-container"],[1,"page-header"],["mat-icon-button","","routerLink","/users","matTooltip","Back to User List","aria-label","Back to user list"],["mat-flat-button","","class","btn-corp-primary",3,"click",4,"ngIf"],["class","spinner-container",4,"ngIf"],[4,"ngIf"],["class","not-found-message",4,"ngIf"],["mat-flat-button","",1,"btn-corp-primary",3,"click"],[1,"spinner-container"],["mode","indeterminate","diameter","60"],[1,"form-wrapper"],[3,"formSubmit","formCancel","userToEdit","isLoading"],[1,"not-found-message"]],template:function(i,a){i&1&&(r(0,"div",1)(1,"div",2)(2,"button",3)(3,"mat-icon"),n(4,"arrow_back"),e()(),u(5,Vi,2,1,"ng-template",null,0,ut)(7,zi,4,0,"button",4),D(8,"async"),e(),u(9,Hi,2,0,"div",5)(10,qi,4,4,"ng-container",6)(11,Gi,2,1,"p",7),D(12,"async"),e()),i&2&&(s(7),d("ngIf",!a.isLoading&&w(8,4,a.user$)&&!a.isEditMode),s(2),d("ngIf",a.isLoading),s(),d("ngIf",!a.isLoading),s(),d("ngIf",!a.isLoading&&!w(12,6,a.user$)&&a.userId))},dependencies:[v,O,j,V,ve,se,S,q,H,x,y,X,ye,te,z],encapsulation:2})};var di={users:[],isLoading:!1,isSubmitting:!1,error:null};var pi=_t(di,T(re,o=>b(g({},o),{isLoading:!0,error:null})),T($e,(o,{users:t})=>b(g({},o),{users:t,isLoading:!1})),T(je,(o,{error:t})=>b(g({},o),{users:[],isLoading:!1,error:t})),T(ne,o=>b(g({},o),{isSubmitting:!0,error:null})),T(ce,(o,{user:t})=>b(g({},o),{users:[...o.users,t],isSubmitting:!1})),T(Ve,(o,{error:t})=>b(g({},o),{isSubmitting:!1,error:t})),T(qe,o=>b(g({},o),{error:null})),T(oe,o=>b(g({},o),{isLoading:!0,error:null})),T(ze,(o,{userId:t})=>b(g({},o),{users:o.users.filter(i=>i.id!==t),isLoading:!1})),T(He,(o,{error:t})=>b(g({},o),{isLoading:!1,error:t})));var et=class o{actions$=c(bt);userService=c(ie);snackBar=c(ee);router=c(N);loadUsers$=de(()=>this.actions$.pipe(pe(re),E(()=>console.log("UserEffects: loadUsers action dispatched")),rt(()=>this.userService.getUsers().pipe(be(t=>(console.log("UserEffects: Users received from service",t),$e({users:t}))),R(t=>{let i=t.message||"Failed to load users from effect.";return console.error("UserEffects: Error loading users",t),this.snackBar.open(i,"Close",{duration:7e3,panelClass:["error-snackbar"]}),F(je({error:i}))})))));createUser$=de(()=>this.actions$.pipe(pe(ne),E(t=>console.log("UserEffects: createUser action dispatched with user:",t.user)),rt(t=>this.userService.createUser(t.user).pipe(be(i=>(console.log("UserEffects: User created via service",i),ce({user:i}))),R(i=>{let a=i.message||"Failed to create user.";return console.error("UserEffects: Error creating user",i),F(Ve({error:a}))})))));createUserSuccess$=de(()=>this.actions$.pipe(pe(ce),E(t=>{console.log("UserEffects: createUserSuccess action, navigating for user:",t.user),this.snackBar.open(`User "${t.user.username}" created successfully!`,"OK",{duration:3e3,verticalPosition:"top",panelClass:["success-snackbar"]}),this.router.navigate(["/users"])})),{dispatch:!1});deleteUser$=de(()=>this.actions$.pipe(pe(oe),Z(t=>this.userService.deleteUser(t.userId).pipe(E(()=>{this.snackBar.open("User deleted successfully!","OK",{duration:3e3,panelClass:["success-snackbar"],verticalPosition:"top"})}),be(()=>ze({userId:t.userId})),R(i=>{let a=i.message||"An unexpected error occurred.";return this.snackBar.open(a,"Close",{duration:5e3,panelClass:["error-snackbar"],verticalPosition:"top"}),F(He({error:a}))})))));static \u0275fac=function(i){return new(i||o)};static \u0275prov=mt({token:o,factory:o.\u0275fac})};var ci=[gt({name:"users",reducer:pi}),Ct(et)];function Qi(o,t){if(o&1&&(M(0),m(1,"mat-divider",10),r(2,"div",3)(3,"h3",4)(4,"mat-icon"),n(5,"featured_play_list"),e(),n(6," Caracter\xEDstica del Negocio "),e(),r(7,"div",11)(8,"div",6)(9,"span",7),n(10,"Tipo de Negocio:"),e(),r(11,"span",8),n(12),e()(),r(13,"div",6)(14,"span",7),n(15,"Nombre del Negocio:"),e(),r(16,"span",8),n(17),e()()(),r(18,"div",12)(19,"span",7),n(20,"Distrito del Negocio:"),e(),r(21,"span",8),n(22),e()(),r(23,"div",12)(24,"span",7),n(25,"Direcci\xF3n del Negocio:"),e(),r(26,"span",8),n(27),e()(),r(28,"div",11)(29,"div",6)(30,"span",7),n(31,"N\xFAmero de tel\xE9fono del Negocio:"),e(),r(32,"span",8),n(33),e()(),r(34,"div",6)(35,"span",7),n(36,"Sector del Negocio:"),e(),r(37,"span",8),n(38),e()()(),r(39,"div",11)(40,"div",6)(41,"span",7),n(42,"Tipo de documento del Negocio:"),e(),r(43,"span",8),n(44),e()(),r(45,"div",6)(46,"span",7),n(47,"Correo electr\xF3nico del Negocio:"),e(),r(48,"span",8),n(49),e()()(),r(50,"div",11)(51,"div",6)(52,"span",7),n(53,"N\xFAmero de documento del Negocio:"),e(),r(54,"span",8),n(55),e()(),m(56,"div",6),e(),r(57,"div",6)(58,"span",7),n(59,"Asume el 5% POS:"),e(),r(60,"span",8),n(61),e()()(),m(62,"mat-divider",10),r(63,"div",3)(64,"h3",4)(65,"mat-icon"),n(66,"attribution"),e(),n(67," Informaci\xF3n del Propietario "),e(),r(68,"div",11)(69,"div",6)(70,"span",7),n(71,"Nombre del propietario:"),e(),r(72,"span",8),n(73),e()(),r(74,"div",6)(75,"span",7),n(76,"N\xFAmero de tel\xE9fono del propietario:"),e(),r(77,"span",8),n(78),e()()(),r(79,"div",11)(80,"div",6)(81,"span",7),n(82,"Tipo de documento del propietario:"),e(),r(83,"span",8),n(84),e()(),r(85,"div",6)(86,"span",7),n(87,"N\xFAmero de documento del propietario:"),e(),r(88,"span",8),n(89),e()()(),r(90,"div",5)(91,"div",6)(92,"span",7),n(93,"Direcci\xF3n de correo electr\xF3nico del propietario:"),e(),r(94,"span",8),n(95),e()()()(),m(96,"mat-divider",10),r(97,"div",3)(98,"h3",4)(99,"mat-icon"),n(100,"account_balance"),e(),n(101," Cuenta bancaria "),e(),r(102,"div",12)(103,"span",7),n(104,"Cuenta bancaria:"),e(),r(105,"span",8),n(106),e()()(),I()),o&2){let i=C(2);s(12),p(i.userData.business_type||"N/A"),s(5),p(i.userData.business_name||"N/A"),s(5),p(i.userData.business_district||"N/A"),s(5),p(i.userData.business_address||"N/A"),s(6),p(i.userData.business_phone_number||"N/A"),s(5),p(i.userData.business_sector||"N/A"),s(6),p(i.userData.business_document_type||"N/A"),s(5),p(i.userData.business_email||"N/A"),s(6),p(i.userData.business_document_number||"N/A"),s(6),p(i.formatBoolean(i.userData.assumes_5_percent_pos)),s(12),p(i.userData.owner_name||"N/A"),s(5),p(i.userData.owner_phone_number||"N/A"),s(6),p(i.userData.owner_document_type||"N/A"),s(5),p(i.userData.owner_document_number||"N/A"),s(6),p(i.userData.owner_email_address||"N/A"),s(11),p(i.userData.owner_bank_account||"N/A")}}function Ki(o,t){if(o&1&&(r(0,"mat-card",2)(1,"mat-card-header")(2,"mat-card-title"),n(3),e(),r(4,"mat-card-subtitle"),n(5,"Informaci\xF3n registrada"),e()(),r(6,"mat-card-content")(7,"div",3)(8,"h3",4)(9,"mat-icon"),n(10,"person_outline"),e(),n(11," Informaci\xF3n B\xE1sica "),e(),r(12,"div",5)(13,"div",6)(14,"span",7),n(15,"Nombre de Usuario:"),e(),r(16,"span",8),n(17),e()(),r(18,"div",6)(19,"span",7),n(20,"Email:"),e(),r(21,"span",8),n(22),e()(),r(23,"div",6)(24,"span",7),n(25,"Rol:"),e(),r(26,"span",8),n(27),e()()()(),u(28,Qi,107,16,"ng-container",9),e()()),o&2){let i=C();s(3),U("Detalles del Usuario: ",i.userData.username,""),s(14),p(i.userData.username||"N/A"),s(5),p(i.userData.email||"N/A"),s(5),p(i.userData.role||"N/A"),s(),d("ngIf",i.isCompanyRole)}}function Yi(o,t){o&1&&(r(0,"div",13),n(1,` No hay informaci\xF3n de usuario para mostrar.
`),e())}var tt=class o{userData;get isCompanyRole(){return this.userData?.role==="EMPRESA"}formatBoolean(t){return t==null?"N/A":t?"S\xED":"No"}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=h({type:o,selectors:[["app-user-display"]],inputs:{userData:"userData"},decls:2,vars:2,consts:[["class","multi-section-form-card readonly-mode",4,"ngIf"],["class","no-data-message",4,"ngIf"],[1,"multi-section-form-card","readonly-mode"],[1,"form-section"],[1,"section-title"],[1,"details-grid"],[1,"detail-item"],[1,"detail-label"],[1,"detail-value"],[4,"ngIf"],[1,"section-divider"],[1,"details-grid","two-columns"],[1,"detail-item","full-width-mobile"],[1,"no-data-message"]],template:function(i,a){i&1&&u(0,Ki,29,5,"mat-card",0)(1,Yi,2,0,"div",1),i&2&&(d("ngIf",a.userData),s(),d("ngIf",!a.userData))},dependencies:[v,O,z,Ue,Ee,Ie,Me,Se,x,y,Le,Ae],styles:[".multi-section-form-card.readonly-mode[_ngcontent-%COMP%]{max-width:900px;margin:24px auto;padding:16px 24px;border-radius:8px;background-color:#fff;box-shadow:0 2px 4px #0000000d}mat-card-title[_ngcontent-%COMP%]{font-size:1.5em;margin-bottom:4px}mat-card-subtitle[_ngcontent-%COMP%]{margin-bottom:24px;color:#0000008a}.form-section[_ngcontent-%COMP%]{margin-bottom:28px}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:1.15em;font-weight:500;color:#3f51b5;margin-bottom:16px;display:flex;align-items:center;gap:8px;padding-bottom:8px;border-bottom:1px solid #e0e0e0}.section-divider[_ngcontent-%COMP%]{margin-top:12px;margin-bottom:28px}.details-grid[_ngcontent-%COMP%]{display:grid;gap:10px 20px;grid-template-columns:repeat(auto-fit,minmax(280px,1fr))}@media (min-width: 768px){.details-grid.two-columns[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}.detail-item[_ngcontent-%COMP%]{padding:4px 0;display:flex;flex-direction:column;margin-bottom:8px}.detail-label[_ngcontent-%COMP%]{font-size:.78em;color:#0009;margin-bottom:3px;font-weight:500;text-transform:uppercase;letter-spacing:.3px}.detail-value[_ngcontent-%COMP%], .detail-value-multiline[_ngcontent-%COMP%]{font-size:.92em;color:#000000de;word-break:break-word;line-height:1.45}.detail-value-multiline[_ngcontent-%COMP%]{white-space:pre-wrap;background-color:#f9f9f9;padding:8px 12px;border-radius:4px;border:1px solid #efefef;min-height:40px;margin-top:2px}@media (max-width: 599px){.full-width-mobile[_ngcontent-%COMP%]{grid-column:1/-1}}.no-data-message[_ngcontent-%COMP%]{text-align:center;padding:40px;font-style:italic;color:#757575}.mat-card-actions.form-actions-sticky[_ngcontent-%COMP%]{padding:16px 24px!important;border-top:1px solid #e0e0e0}"]})};function Wi(o,t){if(o&1&&(r(0,"p",3),n(1),e()),o&2){let i=C();s(),U(" User with ID ",i.userId," not found or could not be loaded. ")}}var it=class o{route=c(he);router=c(N);userService=c(ie);snackBar=c(ee);appStore=c(Ft);userSubject=new _e(null);user$=this.userSubject.asObservable();userDataToDisplay=null;isLoading=!0;isEditMode=!1;userId=null;destroy$=new L;ngOnInit(){this.route.paramMap.pipe(k(this.destroy$),E(()=>{this.isLoading=!0,this.userSubject.next(null)}),Z(t=>this.appStore.currentUser()?.id?(this.userId=this.appStore.currentUser()?.id||"",this.userService.getUserById(this.userId)):(this.snackBar.open("User ID not provided in URL.","Close",{duration:3e3}),this.router.navigate(["/users"]),F(null))),R(t=>(this.isLoading=!1,this.snackBar.open("Error fetching user data.","Close",{duration:3e3,panelClass:["error-snackbar"]}),this.router.navigate(["/users"]),F(null))),Q(t=>t!==null)).subscribe(t=>{this.isLoading=!1,t?(this.userSubject.next(t),this.userDataToDisplay=t):this.userId&&(this.snackBar.open(`User with ID ${this.userId} not found.`,"Close",{duration:3e3}),this.router.navigate(["/users"]))})}navigateToEdit(){this.userId&&this.router.navigate(["/users","edit",this.userId])}navigateToView(){this.userId&&this.router.navigate(["/users",this.userId])}handleFormSubmit(t){if(!this.userId){this.snackBar.open("No se puede actualizar el usuario: falta el ID de usuario.","Close",{duration:3e3,panelClass:["error-snackbar"]});return}this.isLoading=!0;let i=b(g({},t),{id:this.userId});this.userService.updateUser(i).pipe(k(this.destroy$)).subscribe({next:a=>{this.isLoading=!1,this.userSubject.next(a),this.snackBar.open("\xA1Actualizado exitosamente!","OK",{duration:3e3,verticalPosition:"top",panelClass:["success-snackbar"]}),this.isEditMode=!1,this.router.navigate(["/configuracion/users"])},error:a=>{this.isLoading=!1,this.snackBar.open("Error al actualizar el usuario. Int\xE9ntalo de nuevo.","Retry",{duration:5e3,verticalPosition:"top",panelClass:["error-snackbar"]}),console.error("Error updating user:",a)}})}handleFormCancel(){this.isEditMode=!1,this.router.navigate(["/configuracion/users"])}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=h({type:o,selectors:[["app-user-detail-page"]],decls:4,vars:4,consts:[[1,"page-container","detail-page-container"],[3,"userData"],["class","not-found-message",4,"ngIf"],[1,"not-found-message"]],template:function(i,a){i&1&&(r(0,"div",0),m(1,"app-user-display",1),u(2,Wi,2,1,"p",2),D(3,"async"),e()),i&2&&(s(),d("userData",a.userDataToDisplay),s(),d("ngIf",!a.isLoading&&!w(3,2,a.user$)&&a.userId))},dependencies:[v,O,j,V,tt,S,x,X,te,z],encapsulation:2})};var Vo=[{path:"",providers:[...ci],children:[{path:"",component:Ze,title:"User List"},{path:"create",component:Je,title:"Create New User"},{path:"edit/:id",component:Xe,title:"Edit User"},{path:"detail",component:it,title:"User Details"}]}];export{Vo as USERS_ROUTES};
