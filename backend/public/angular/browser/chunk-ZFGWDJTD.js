import{a as mr}from"./chunk-NZ5TTRYU.js";import{a as ai}from"./chunk-ZKEJYAJT.js";import{a as W}from"./chunk-CGQUN3HI.js";import{a as pr}from"./chunk-NXYDIABO.js";import"./chunk-TICF6Q7F.js";import{a as cr}from"./chunk-JXSQJBTT.js";import{a as lr,b as dr,c as sr}from"./chunk-WEOB6OMV.js";import{a as vt,b as bt,c as xt}from"./chunk-RJIBCMAW.js";import{a as ur,b as gr,c as li}from"./chunk-INNR5TUR.js";import{a as Ot,b as Et,c as yt,d as Ye}from"./chunk-OTTC2AJX.js";import{a as Ui,b as ji}from"./chunk-JOWSY7RZ.js";import{d as Wi,e as Xi,i as jt}from"./chunk-JBWENUMD.js";import{a as zt,b as Gt,c as $t,d as qt}from"./chunk-ZKSEBIMY.js";import{c as Ht,d as ft}from"./chunk-PKHWH5C3.js";import{a as Ki,b as Qi}from"./chunk-GDDGCRCE.js";import{a as Yi,b as Ji,c as Zi}from"./chunk-MZOTBTYR.js";import"./chunk-3PSRRXT4.js";import"./chunk-F5X5MWHG.js";import{a as Wt,b as Xt,c as Kt,d as Qt,e as Yt,f as Jt,g as Zt,h as ei,i as ti,j as ii,k as er,l as ri,m as tr,n as ni,o as rr,p as or}from"./chunk-V54F6JIJ.js";import"./chunk-MS4AQ6UA.js";import{a as Ct,b as Qe,d as oi,e as ir}from"./chunk-4CRKJGVD.js";import{a as ht,b as Be}from"./chunk-SNHOSZ4S.js";import{a as ut,b as gt}from"./chunk-VMNFNLTS.js";import{a as se,b as Ee,c as Ut,e as ye,f as me,g as ce,h as re}from"./chunk-GXNIZWNA.js";import{d as Le}from"./chunk-JJSTB54W.js";import"./chunk-YRCWJJOQ.js";import{a as Ke}from"./chunk-K72O7MSM.js";import{a as nr,b as ar}from"./chunk-N24MSZBW.js";import{b as Hi}from"./chunk-C6HVAWTE.js";import{a as Ne,b as Ve}from"./chunk-5PZ25QHJ.js";import"./chunk-2JNWSY3M.js";import{a as pt,d as te,e as ie}from"./chunk-44LGRUYF.js";import{a as Re,b as _t}from"./chunk-3IGH7FBX.js";import"./chunk-7RWCIHFI.js";import{A as ee,B as Bt,C as ct,D as Ae,G as j,H,b as Y,d as x,f as $,g as J,h as Lt,j as Me,l as Fe,m as We,n as Xe,o as Z,r as le,s as st,t as mt,v as de,x as q,z as U}from"./chunk-ICWTIKD4.js";import"./chunk-BWBG2IHT.js";import"./chunk-U3COC3EF.js";import{a as Li,b as Bi,d as zi,g as Gi,i as $i}from"./chunk-K4QNRRQ5.js";import{a as be,b as xe}from"./chunk-ASKMK2H5.js";import"./chunk-XRPHOQB2.js";import{a as Oe,b as R,c as qi,e as S}from"./chunk-2H2YZZAU.js";import"./chunk-NUMYIFQH.js";import{$ as Pe,$b as Ri,Ac as K,Bb as O,Bc as dt,Cc as Te,Db as p,Ea as w,Eb as C,Ec as y,Gd as z,Hd as k,I as ke,J as we,Ka as Ce,Kb as tt,Lb as it,Mb as rt,Pb as F,Q as ae,Qb as a,Rb as M,S as Di,Sb as _,Sc as Rt,Ta as Pi,Tb as Ti,Ub as Fi,Va as l,Xc as Nt,Yc as Vt,Za as B,Zb as je,_b as Ai,a as fe,aa as $e,ac as Ni,b as et,ba as D,bc as v,c as yi,cb as E,cc as T,da as he,dc as N,fc as ve,gc as at,h as nt,ia as ki,ib as c,jc as Vi,l as Q,lb as Ii,m as Mi,mb as s,na as b,rb as L,t as Se,tb as qe,ub as Ue,uc as lt,va as wi,vb as n,vc as He,w as Si,wa as f,wb as o,wc as A,xa as h,xb as g,yb as P,yc as Ie,zb as I,zc as At}from"./chunk-YUSEJVZ2.js";function Or(i,e){if(i&1&&(n(0,"mat-option",8),a(1),o()),i&2){let r=e.$implicit;s("value",r),l(),_(" ",r," ")}}var di=class i{filtersChanged=new w;filterForm;orderStatuses$;orderService=b(W);fb=b(de);datePipe=b(K);destroy$=new Q;constructor(){let e=new Date,r=new Date(e.getFullYear(),e.getMonth(),1),t=new Date(e.getFullYear(),e.getMonth()+1,0);this.filterForm=this.fb.group({start_date:[r],end_date:[t],status:[null],search_term:[""]}),this.orderStatuses$=this.orderService.getOrderStatuses()}ngOnInit(){this.filterForm.valueChanges.pipe(D(this.destroy$),we(400),ae((e,r)=>JSON.stringify(e)===JSON.stringify(r))).subscribe(()=>{this.applyFilters()})}applyFilters(){let e=this.filterForm.value,r={start_date:e.start_date?this.datePipe.transform(e.start_date,"yyyy-MM-dd"):null,end_date:e.end_date?this.datePipe.transform(e.end_date,"yyyy-MM-dd"):null,status:e.status||null,search_term:e.search_term?.trim()||null};console.log("OrderFiltersComponent: Emitting filters",r),this.filtersChanged.emit(r)}clearFilters(){this.filterForm.reset({start_date:null,end_date:null,status:null,search_term:""})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(r){return new(r||i)};static \u0275cmp=E({type:i,selectors:[["app-order-filters"]],outputs:{filtersChanged:"filtersChanged"},features:[je([ft(),K])],decls:36,vars:9,consts:[["startDatePicker",""],["endDatePicker",""],[1,"filters-container",3,"formGroup"],["appearance","outline"],["matInput","","formControlName","start_date","placeholder","mm/dd/yyyy",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","end_date","placeholder","mm/dd/yyyy",3,"matDatepicker"],["formControlName","status","placeholder","Seleccione estado..."],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"filter-actions"],["appearance","outline",2,"margin-top","15px"],["matInput","","formControlName","search_term","placeholder","Buscar..."],["mat-flat-button","","type","button",1,"btn-corp-primary",3,"click"],["mat-stroked-button","","type","button",1,"btn-corp-secondary",3,"click"]],template:function(r,t){if(r&1){let d=O();n(0,"form",2)(1,"mat-form-field",3)(2,"mat-label"),a(3,"Fecha de entrega inicio"),o(),g(4,"input",4)(5,"mat-datepicker-toggle",5)(6,"mat-datepicker",null,0),o(),n(8,"mat-form-field",3)(9,"mat-label"),a(10,"Fecha de entrega fin"),o(),g(11,"input",6)(12,"mat-datepicker-toggle",5)(13,"mat-datepicker",null,1),o(),n(15,"mat-form-field",3)(16,"mat-label"),a(17,"Estado"),o(),n(18,"mat-select",7)(19,"mat-option",8),a(20,"Todos"),o(),c(21,Or,2,2,"mat-option",9),v(22,"async"),o()(),n(23,"div",10)(24,"mat-form-field",11)(25,"mat-label"),a(26,"Buscar"),o(),g(27,"input",12),o(),n(28,"button",13),p("click",function(){return f(d),h(t.applyFilters())}),n(29,"mat-icon"),a(30,"search"),o(),a(31," Buscar "),o(),n(32,"button",14),p("click",function(){return f(d),h(t.clearFilters())}),n(33,"mat-icon"),a(34,"clear_all"),o(),a(35," Limpiar "),o()()()}if(r&2){let d=F(7),m=F(14);s("formGroup",t.filterForm),l(4),s("matDatepicker",d),l(),s("for",d),l(6),s("matDatepicker",m),l(),s("for",m),l(7),s("value",null),l(2),s("ngForOf",T(22,7,t.orderStatuses$))}},dependencies:[y,He,Ie,q,Fe,Y,$,J,Z,le,H,j,U,Ae,ie,te,Ye,Ot,Et,yt,Ht,Be,ht,Le,S,R,k,z],styles:[".filters-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;align-items:flex-start;padding:6px;background-color:var(--sys-surface-container-low);border-radius:8px;box-shadow:0 1px 3px #00000014}mat-form-field[_ngcontent-%COMP%]{min-width:200px;flex-grow:1}.filter-actions[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center!important;justify-content:center!important;min-width:100%}@media (max-width: 768px){.filters-container[_ngcontent-%COMP%]{flex-direction:column}mat-form-field[_ngcontent-%COMP%]{width:100%;min-width:unset}}@media (max-width: 768px) and (max-width: 480px){mat-form-field[_ngcontent-%COMP%]{width:100%}.filter-actions[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch!important}}"]})};function Er(i,e){if(i&1&&(n(0,"mat-grid-tile")(1,"div",9)(2,"mat-icon",10),a(3,"account_circle"),o(),n(4,"div")(5,"div",11),a(6,"Usuario Creador"),o(),n(7,"div",12),a(8),v(9,"default"),o()()()()),i&2){let r=C();l(8),_(" ",N(9,1,r.data.order.user==null?null:r.data.order.user.username,"N/A")," ")}}function yr(i,e){if(i&1&&(n(0,"mat-grid-tile")(1,"div",9)(2,"mat-icon",10),a(3,"account_circle"),o(),n(4,"div")(5,"div",11),a(6,"Motorizado"),o(),n(7,"div",12),a(8),v(9,"default"),o()()()()),i&2){let r=C();l(8),_(" ",N(9,1,r.data.order.assigned_driver==null?null:r.data.order.assigned_driver.username,"N/A")," ")}}function Sr(i,e){if(i&1&&(n(0,"mat-grid-tile")(1,"div",9)(2,"mat-icon",10),a(3,"explore"),o(),n(4,"div")(5,"div",11),a(6,"Coordenadas"),o(),n(7,"div",12),a(8),o()()()()),i&2){let r=C();l(8),_(" ",r.data.order.delivery_coordinates," ")}}function Mr(i,e){i&1&&g(0,"mat-divider")}function Dr(i,e){if(i&1&&(n(0,"mat-grid-tile")(1,"div",9)(2,"mat-icon",10),a(3,"aspect_ratio"),o(),n(4,"div")(5,"div",11),a(6,"Tama\xF1o Paquete"),o(),n(7,"div",12),a(8),v(9,"titlecase"),o()()()()),i&2){let r=C();l(8),_(" ",T(9,1,r.data.order.package_size_type)," ")}}function kr(i,e){if(i&1&&(n(0,"mat-grid-tile")(1,"div",9)(2,"mat-icon",10),a(3,"fitness_center"),o(),n(4,"div")(5,"div",11),a(6,"Peso (kg)"),o(),n(7,"div",12),a(8),v(9,"number"),o()()()()),i&2){let r=C();l(8),_(" ",N(9,1,r.data.order.package_weight_kg,"1.1-2")," kg ")}}function wr(i,e){if(i&1&&(n(0,"mat-grid-tile")(1,"div",9)(2,"mat-icon",10),a(3,"width_normal"),o(),n(4,"div")(5,"div",11),a(6,"Dimensiones (cm)"),o(),n(7,"div",12),a(8),o()()()()),i&2){let r=C();l(8),Fi(" An: ",r.data.order.package_width_cm," x L: ",r.data.order.package_length_cm," x Al: ",r.data.order.package_height_cm," ")}}function Pr(i,e){if(i&1&&(n(0,"mat-grid-tile")(1,"div",9)(2,"mat-icon",10),a(3,"credit_card"),o(),n(4,"div")(5,"div",11),a(6,"M\xE9todo de Cobro"),o(),n(7,"div",12),a(8),v(9,"titlecase"),o()()()()),i&2){let r=C();l(8),_(" ",T(9,1,r.data.order.payment_method_for_collection)," ")}}function Ir(i,e){if(i&1&&(n(0,"div",23)(1,"div",24)(2,"mat-icon"),a(3,"speaker_notes"),o(),a(4," Observaciones Cliente/Pedido: "),o(),n(5,"p",25),a(6),o()()),i&2){let r=C(2);l(6),M(r.data.order.observations)}}function Tr(i,e){i&1&&g(0,"mat-divider")}function Fr(i,e){if(i&1&&(n(0,"div",23)(1,"div",24)(2,"mat-icon"),a(3,"warehouse"),o(),a(4," Tipo de Transferencia a Almac\xE9n: "),o(),n(5,"p",25),a(6),v(7,"titlecase"),o()()),i&2){let r=C(2);l(6),_(" ",T(7,1,r.data.order.type_order_transfer_to_warehouse)," ")}}function Ar(i,e){if(i&1&&(n(0,"mat-card",5)(1,"mat-card-header",6)(2,"mat-card-title"),a(3,"Observaciones y Log\xEDstica"),o()(),n(4,"mat-card-content"),c(5,Ir,7,1,"div",22)(6,Tr,1,0,"mat-divider",13)(7,Fr,8,3,"div",22),o()()),i&2){let r=C();l(5),s("ngIf",r.data.order.observations),l(),s("ngIf",r.data.order.observations&&r.data.order.type_order_transfer_to_warehouse),l(),s("ngIf",r.data.order.type_order_transfer_to_warehouse)}}var mi=class i{constructor(e,r){this.dialogRef=e;this.data=r;console.log("data",r)}OrderStatusEnum=ai;getStatusBadgeClass(e){return e?`status-${e.toString().toLowerCase().replace(/[\s_]+/g,"-")}`:"status-desconocido"}onClose(){this.dialogRef.close()}openMaps(e){e&&window.open(`https://www.google.com/maps/search/?api=1&query=${e}`,"_blank")}callPhone(e){e&&(window.location.href=`tel:${e}`)}printOrder(){console.log("Imprimiendo pedido (simulado):",this.data.order.code),this.dialogRef.close("print")}static \u0275fac=function(r){return new(r||i)(B(se),B(Ee))};static \u0275cmp=E({type:i,selectors:[["app-order-detail-dialog"]],decls:142,vars:66,consts:[["cdkDrag","","cdkDragRootElement",".cdk-overlay-pane","cdkDragHandle",".dialog-header-draggable",1,"dialog-container"],[1,"dialog-header","dialog-header-draggable"],["mat-dialog-title",""],[1,"order-code-chip"],["tabindex","-1",1,"dialog-content"],["appearance","outlined",1,"info-card"],[1,"compact-card-header"],[1,"status-badge-dialog",3,"ngClass"],["cols","2","rowHeight","80px"],[1,"detail-item"],[1,"detail-icon"],[1,"detail-label"],[1,"detail-value"],[4,"ngIf"],[1,"detail-item",3,"click"],[1,"detail-value","link-like"],[3,"colspan"],[1,"item-description"],[1,"detail-value","bold-value"],["appearance","outlined","class","info-card",4,"ngIf"],["align","end",1,"dialog-actions"],["mat-flat-button","",1,"btn-corp-primary",3,"click"],["class","detail-block",4,"ngIf"],[1,"detail-block"],[1,"detail-label-block"],[1,"detail-value-block"]],template:function(r,t){r&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2),a(3,"Detalles del Pedido"),o(),n(4,"span",3),a(5),o()(),n(6,"mat-dialog-content",4)(7,"mat-card",5)(8,"mat-card-header",6)(9,"mat-card-title"),a(10,"Informaci\xF3n General"),o(),n(11,"span",7),a(12),v(13,"titlecase"),o()(),n(14,"mat-card-content")(15,"mat-grid-list",8)(16,"mat-grid-tile")(17,"div",9)(18,"mat-icon",10),a(19,"local_shipping"),o(),n(20,"div")(21,"div",11),a(22,"Tipo de Env\xEDo"),o(),n(23,"div",12),a(24),v(25,"titlecase"),v(26,"default"),o()()()(),n(27,"mat-grid-tile")(28,"div",9)(29,"mat-icon",10),a(30,"calendar_today"),o(),n(31,"div")(32,"div",11),a(33,"Fecha Registro"),o(),n(34,"div",12),a(35),v(36,"date"),v(37,"default"),o()()()(),n(38,"mat-grid-tile")(39,"div",9)(40,"mat-icon",10),a(41,"event_available"),o(),n(42,"div")(43,"div",11),a(44,"Fecha Entrega Prog."),o(),n(45,"div",12),a(46),v(47,"date"),v(48,"default"),o()()()(),c(49,Er,10,4,"mat-grid-tile",13)(50,yr,10,4,"mat-grid-tile",13),o()()(),n(51,"mat-card",5)(52,"mat-card-header",6)(53,"mat-card-title"),a(54,"Destinatario y Entrega"),o()(),n(55,"mat-card-content")(56,"mat-grid-list",8)(57,"mat-grid-tile")(58,"div",9)(59,"mat-icon",10),a(60,"person_pin"),o(),n(61,"div")(62,"div",11),a(63,"Nombre Destinatario"),o(),n(64,"div",12),a(65),v(66,"default"),o()()()(),n(67,"mat-grid-tile")(68,"div",14),p("click",function(){return t.callPhone(t.data.order.recipient_phone)}),n(69,"mat-icon",10),a(70,"phone_iphone"),o(),n(71,"div")(72,"div",11),a(73,"Tel\xE9fono Destinatario"),o(),n(74,"div",15),a(75),o()()()(),n(76,"mat-grid-tile",16)(77,"div",9)(78,"mat-icon",10),a(79,"location_on"),o(),n(80,"div")(81,"div",11),a(82,"Direcci\xF3n de Entrega"),o(),n(83,"div",12),a(84),v(85,"default"),o()()()(),n(86,"mat-grid-tile")(87,"div",9)(88,"mat-icon",10),a(89,"map"),o(),n(90,"div")(91,"div",11),a(92,"Distrito"),o(),n(93,"div",12),a(94),v(95,"titlecase"),v(96,"default"),o()()()(),c(97,Sr,9,1,"mat-grid-tile",13),o()()(),n(98,"mat-card",5)(99,"mat-card-header",6)(100,"mat-card-title"),a(101,"Detalles del Paquete"),o()(),n(102,"mat-card-content")(103,"p",17),a(104),v(105,"default"),o(),c(106,Mr,1,0,"mat-divider",13),n(107,"mat-grid-list",8),c(108,Dr,10,3,"mat-grid-tile",13)(109,kr,10,4,"mat-grid-tile",13)(110,wr,9,3,"mat-grid-tile",13),o()()(),n(111,"mat-card",5)(112,"mat-card-header",6)(113,"mat-card-title"),a(114,"Informaci\xF3n Financiera"),o()(),n(115,"mat-card-content")(116,"mat-grid-list",8)(117,"mat-grid-tile")(118,"div",9)(119,"mat-icon",10),a(120,"payments"),o(),n(121,"div")(122,"div",11),a(123,"Monto a Cobrar Entrega"),o(),n(124,"div",18),a(125),v(126,"currency"),o()()()(),n(127,"mat-grid-tile")(128,"div",9)(129,"mat-icon",10),a(130,"local_atm"),o(),n(131,"div")(132,"div",11),a(133,"Costo de Env\xEDo"),o(),n(134,"div",18),a(135),v(136,"currency"),o()()()(),c(137,Pr,10,3,"mat-grid-tile",13),o()()(),c(138,Ar,8,3,"mat-card",19),o(),n(139,"mat-dialog-actions",20)(140,"button",21),p("click",function(){return t.onClose()}),a(141," Cerrar "),o()()()),r&2&&(l(5),_("N\xB0: ",t.data.order.code||t.data.order.id,""),l(6),s("ngClass",t.getStatusBadgeClass(t.data.order.status)),l(),_(" ",T(13,23,t.data.order.status)," "),l(12),_(" ",N(26,27,T(25,25,t.data.order.shipment_type),"N/A")," "),l(11),_(" ",N(37,33,N(36,30,t.data.order.createdAt,"dd/MM/yy HH:mm"),"N/A")," "),l(11),_(" ",N(48,39,N(47,36,t.data.order.delivery_date,"dd/MM/yyyy"),"No especificada")," "),l(3),s("ngIf",t.data.order.user==null?null:t.data.order.user.username),l(),s("ngIf",t.data.order.assigned_driver==null?null:t.data.order.assigned_driver.username),l(15),_(" ",N(66,42,t.data.order.recipient_name,"N/A")," "),l(10),_(" ",t.data.order.recipient_phone||"N/A"," "),l(),s("colspan",2),l(8),_(" ",N(85,45,t.data.order.delivery_address,"N/A")," "),l(10),_(" ",N(96,50,T(95,48,t.data.order.delivery_district_name),"N/A")," "),l(3),s("ngIf",t.data.order.delivery_coordinates),l(7),_(" ",N(105,53,t.data.order.item_description,"Sin descripci\xF3n del contenido.")," "),l(2),s("ngIf",t.data.order.package_size_type||t.data.order.package_weight_kg),l(2),s("ngIf",t.data.order.package_size_type),l(),s("ngIf",t.data.order.package_size_type==="custom"&&t.data.order.package_weight_kg),l(),s("ngIf",t.data.order.package_size_type==="custom"&&t.data.order.package_width_cm),l(15),_(" ",ve(126,56,t.data.order.amount_to_collect_at_delivery||0,"PEN","S/ ","1.2-2")," "),l(10),_(" ",ve(136,61,t.data.order.shipping_cost||0,"PEN","S/ ","1.2-2")," "),l(2),s("ngIf",t.data.order.payment_method_for_collection),l(),s("ngIf",t.data.order.observations||t.data.order.type_order_transfer_to_warehouse))},dependencies:[y,lt,A,dt,At,Te,K,re,ye,ce,me,S,R,k,z,Ve,Ne,$i,Li,zi,Gi,Bi,Zi,Ji,Yi,Qe,cr],styles:["[_nghost-%COMP%]{display:block}.dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:calc(100vh - 80px)}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;border-bottom:1px solid #e0e0e0;background-color:#f5f5f5}.dialog-header-draggable[_ngcontent-%COMP%]{cursor:move}h2.mat-mdc-dialog-title[_ngcontent-%COMP%]{margin:0;font-size:1.35em;font-weight:500;color:#455a64}.order-code-chip[_ngcontent-%COMP%]{font-size:.9em;color:#3f51b5;font-weight:500;margin-left:16px;flex-grow:1}.close-button[_ngcontent-%COMP%]{min-width:auto;padding:0;line-height:normal;color:#757575}.dialog-content[_ngcontent-%COMP%]{padding:20px 24px 24px;overflow-y:auto;flex-grow:1;background-color:#fff}.info-card[_ngcontent-%COMP%]{margin-bottom:24px;border:1px solid #eeeeee!important;box-shadow:none!important;border-radius:8px}.info-card[_ngcontent-%COMP%]:last-child{margin-bottom:0}.info-card[_ngcontent-%COMP%]   mat-card-header.compact-card-header[_ngcontent-%COMP%]{padding:12px 16px;display:flex;align-items:center;justify-content:space-between;background-color:#fafafa;border-bottom:1px solid #eeeeee}.info-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:1.1em;font-weight:500;color:#546e7a;margin:0}.info-card[_ngcontent-%COMP%]   .status-badge-dialog[_ngcontent-%COMP%]{padding:4px 10px;border-radius:12px;font-size:.7rem;font-weight:600;text-transform:uppercase;color:#fff;line-height:1.2}.info-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:16px;font-size:.9rem}mat-grid-list[_ngcontent-%COMP%]{padding:0}@media (max-width: 600px){mat-grid-list[_ngcontent-%COMP%]{cols:1!important}}mat-grid-tile[_ngcontent-%COMP%]     .mat-figure{align-items:flex-start;padding:8px}.detail-item[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;gap:10px}.detail-item[_ngcontent-%COMP%]   .detail-icon[_ngcontent-%COMP%]{color:#90a4ae;font-size:20px}.detail-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:column;line-height:1.4}.interactive-detail-item[_ngcontent-%COMP%]{cursor:pointer}.interactive-detail-item[_ngcontent-%COMP%]:hover   .detail-value[_ngcontent-%COMP%]{color:#3f51b5;text-decoration:underline}.link-like[_ngcontent-%COMP%]{color:#5c6bc0;font-weight:500}.detail-label[_ngcontent-%COMP%]{font-size:.75em;color:#616161;margin-bottom:2px;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.detail-value[_ngcontent-%COMP%]{color:#212121;word-break:break-word}.bold-value[_ngcontent-%COMP%]{font-weight:600;font-size:1.05em}.item-description[_ngcontent-%COMP%]{font-style:italic;color:#555;margin-bottom:12px;padding-bottom:12px;border-bottom:1px dashed #e0e0e0;font-size:.9em}.detail-block[_ngcontent-%COMP%]{margin-bottom:16px}.detail-block[_ngcontent-%COMP%]   .detail-label-block[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:.9em;font-weight:500;color:#607d8b;margin-bottom:6px}.detail-block[_ngcontent-%COMP%]   .detail-label-block[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px}.detail-block[_ngcontent-%COMP%]   .detail-value-block[_ngcontent-%COMP%]{font-size:.9em;color:#424242;padding-left:26px;white-space:pre-wrap}.dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #e0e0e0;background-color:#fafafa}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:8px}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-left:0}.status-registrado[_ngcontent-%COMP%]{background-color:#6610f2;color:#fff}.status-recogido[_ngcontent-%COMP%]{background-color:#fd7e14;color:#fff}.status-en-almacen[_ngcontent-%COMP%]{background-color:#0d6efd;color:#fff}.status-en-transito[_ngcontent-%COMP%]{background-color:#0c1a77;color:#d0c8c8}.status-entregado[_ngcontent-%COMP%]{background-color:#198754;color:#fff}.status-anulado[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.status-cancelado[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.status-rechazado-en-punto[_ngcontent-%COMP%]{background-color:#ff6b6b;color:#fff}.status-reprogramado[_ngcontent-%COMP%]{background-color:#adb5bd;color:#212529}.status-desconocido[_ngcontent-%COMP%]{background-color:#9e9e9e;color:#fff}"]})};var Rr=(i,e)=>e.uid;function Nr(i,e){if(i&1&&(n(0,"div",23)(1,"p"),a(2," Actualmente asignado a: "),n(3,"strong"),a(4),o()()()),i&2){let r=e.ngIf;l(4),M(r)}}function Vr(i,e){i&1&&(n(0,"p",24),a(1," Este pedido a\xFAn no tiene un motorizado asignado. "),o())}function Lr(i,e){if(i&1){let r=O();n(0,"button",25),p("click",function(){f(r);let d=C();return h(d.clearSelection())}),n(1,"mat-icon"),a(2,"close"),o()()}}function Br(i,e){i&1&&(n(0,"mat-icon",26),a(1,"person_search"),o())}function zr(i,e){i&1&&g(0,"mat-progress-spinner",27)}function Gr(i,e){if(i&1&&(n(0,"mat-option",16)(1,"div",28)(2,"mat-icon",29),a(3,"two_wheeler"),o(),n(4,"span"),a(5),o()()()),i&2){let r=e.$implicit;s("value",r),l(5),M(r.username)}}function $r(i,e){i&1&&(n(0,"mat-option",17),a(1,"No se encontraron motorizados."),o())}function qr(i,e){i&1&&(n(0,"mat-error"),a(1," Debe seleccionar un motorizado. "),o())}function Ur(i,e){if(i&1&&(n(0,"p",30),a(1," Motorizado seleccionado: "),n(2,"strong"),a(3),o()()),i&2){let r=C();l(3),M(r.selectedDriver.username)}}var pi=class i{constructor(e,r){this.dialogRef=e;this.data=r;this.assignDriverForm=this.fb.group({}),this.filteredDrivers$=this.driverSearchCtrl.valueChanges.pipe(Pe(""),we(300),ae(),$e(t=>(this.isLoadingDrivers=!0,console.log("searchTerm",t),this.orderService.getAvailableDrivers(t||"").pipe(he(()=>this.isLoadingDrivers=!1),ke(()=>(this.isLoadingDrivers=!1,Se([])))))),D(this.destroy$))}assignDriverForm;drivers$=Se([]);isLoadingDrivers=!1;selectedDriver=null;driverSearchCtrl=new Me("");filteredDrivers$;destroy$=new Q;orderService=b(W);fb=b(de);ngOnInit(){this.data.currentDriverId&&this.data.order.assigned_driver&&(this.selectedDriver=this.data.order.assigned_driver,this.driverSearchCtrl.setValue(this.data.order.assigned_driver.username||"",{emitEvent:!1}))}displayDriverName(e){return e&&e.name?e.name:""}onDriverSelected(e){this.selectedDriver=e.option.value}onConfirm(){this.selectedDriver&&this.dialogRef.close({selectedDriver:this.selectedDriver})}onCancel(){this.dialogRef.close()}clearSelection(){this.selectedDriver=null,this.driverSearchCtrl.setValue("")}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(r){return new(r||i)(B(se),B(Ee))};static \u0275cmp=E({type:i,selectors:[["app-assign-driver-dialog"]],decls:35,vars:19,consts:[["noDriverAssigned",""],["autoDriver","matAutocomplete"],["cdkDrag","","cdkDragRootElement",".cdk-overlay-pane","cdkDragHandle",".dialog-header-draggable",1,"dialog-container"],[1,"dialog-header","dialog-header-draggable"],["mat-dialog-title",""],[1,"order-code-chip"],[1,"dialog-content"],["class","current-assignment",4,"ngIf","ngIfElse"],[1,"content-divider"],["novalidate","",3,"formGroup"],["appearance","outline",1,"full-width","driver-search-field"],["type","text","placeholder","Escriba el nombre del motorizado...","aria-label","Motorizado","matInput","",3,"formControl","matAutocomplete"],["matSuffix","","mat-icon-button","","aria-label","Limpiar",3,"click",4,"ngIf"],["matSuffix","",4,"ngIf"],["matSuffix","","mode","indeterminate","diameter","20",4,"ngIf"],[3,"optionSelected","displayWith"],[3,"value"],["disabled",""],[4,"ngIf"],["class","selected-driver-info",4,"ngIf"],["align","end",1,"dialog-actions"],["mat-stroked-button","",1,"cancel-button","btn-corp-secondary",3,"click"],["mat-flat-button","",1,"confirm-button","btn-corp-primary",3,"click","disabled"],[1,"current-assignment"],[1,"no-driver-message"],["matSuffix","","mat-icon-button","","aria-label","Limpiar",3,"click"],["matSuffix",""],["matSuffix","","mode","indeterminate","diameter","20"],[1,"driver-option"],[1,"driver-option-icon"],[1,"selected-driver-info"]],template:function(r,t){if(r&1){let d=O();n(0,"div",2)(1,"div",3)(2,"h2",4),a(3,"Asignar / Cambiar Motorizado"),o(),n(4,"span",5),a(5),o()(),n(6,"mat-dialog-content",6)(7,"section"),c(8,Nr,5,1,"div",7)(9,Vr,2,0,"ng-template",null,0,at),o(),g(11,"mat-divider",8),n(12,"section")(13,"form",9)(14,"mat-form-field",10)(15,"mat-label"),a(16,"Buscar y Seleccionar Motorizado"),o(),g(17,"input",11),c(18,Lr,3,0,"button",12)(19,Br,2,0,"mat-icon",13)(20,zr,1,0,"mat-progress-spinner",14),n(21,"mat-autocomplete",15,1),p("optionSelected",function(u){return f(d),h(t.onDriverSelected(u))}),qe(23,Gr,6,2,"mat-option",16,Rr),v(25,"async"),c(26,$r,2,0,"mat-option",17),v(27,"async"),o(),c(28,qr,2,0,"mat-error",18),o()()(),c(29,Ur,4,1,"p",19),o(),n(30,"mat-dialog-actions",20)(31,"button",21),p("click",function(){return f(d),h(t.onCancel())}),a(32," Cancelar "),o(),n(33,"button",22),p("click",function(){return f(d),h(t.onConfirm())}),a(34),o()()()}if(r&2){let d,m=F(10),u=F(22);l(5),_("Pedido N\xB0: ",t.data.order.code||t.data.order.id,""),l(3),s("ngIf",t.data.order.assigned_driver==null?null:t.data.order.assigned_driver.username)("ngIfElse",m),l(5),s("formGroup",t.assignDriverForm),l(4),s("formControl",t.driverSearchCtrl)("matAutocomplete",u),l(),s("ngIf",t.driverSearchCtrl.value&&!t.isLoadingDrivers),l(),s("ngIf",!t.driverSearchCtrl.value&&!t.isLoadingDrivers),l(),s("ngIf",t.isLoadingDrivers),l(),s("displayWith",t.displayDriverName),l(2),Ue(T(25,15,t.filteredDrivers$)),l(3),L(((d=T(27,17,t.filteredDrivers$))==null?null:d.length)===0&&!t.isLoadingDrivers&&t.driverSearchCtrl.value?26:-1),l(2),s("ngIf",t.assignDriverForm.hasError("required","driverId")&&t.selectedDriver===null),l(),s("ngIf",t.selectedDriver),l(4),s("disabled",!t.selectedDriver||t.isLoadingDrivers),l(),_(" ",t.data.currentDriverId?"Reasignar":"Asignar"," Motorizado ")}},dependencies:[y,A,Ie,q,Fe,Y,$,J,Xe,Z,re,ye,ce,me,H,j,U,ee,Ae,Be,Le,xt,vt,bt,ie,te,S,R,Oe,k,z,xe,be,jt,Ne],styles:["[_nghost-%COMP%]{display:block}.dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:95vh;max-width:90%;padding:16px;box-shadow:0 4px 16px #0000001a}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;margin-bottom:16px;border-bottom:1px solid var(--app-border-color);background-color:var(--app-background-dialog-header)}.dialog-header-draggable[_ngcontent-%COMP%]{cursor:move}h2.mat-mdc-dialog-title[_ngcontent-%COMP%]{margin:0;font-size:1.3em;font-weight:500;color:var(--app-blue-grey-700)}.order-code-chip[_ngcontent-%COMP%]{font-size:.85em;color:var(--app-indigo-500);font-weight:500;margin-left:12px;flex-grow:1}.close-button[_ngcontent-%COMP%]{min-width:auto;padding:0;line-height:normal;color:var(--app-gray-600)}.dialog-content[_ngcontent-%COMP%]{padding:20px 24px 24px;overflow-y:auto;flex-grow:1}.dialog-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:0;margin-bottom:8px;color:var(--app-text-default);font-size:.95em}.dialog-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:500;color:var(--app-text-default)}.current-assignment[_ngcontent-%COMP%]{margin-bottom:16px;padding:10px;background-color:var(--app-blue-50);border-radius:4px;border-left:4px solid var(--app-blue-500)}.no-driver-message[_ngcontent-%COMP%]{font-style:italic;color:var(--app-orange-700);margin-bottom:16px}.content-divider[_ngcontent-%COMP%]{margin:16px 0;border-top-color:var(--app-border-color)}.full-width[_ngcontent-%COMP%]{width:100%}.driver-search-field[_ngcontent-%COMP%]{margin-bottom:8px}.driver-select-container[_ngcontent-%COMP%]{position:relative;min-height:90px}.spinner-container-small[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:10px;color:var(--app-text-secondary);font-size:.9em}.spinner-container-small[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:8px}.mat-mdc-autocomplete-panel[_ngcontent-%COMP%]{max-height:250px!important}.driver-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.driver-option[_ngcontent-%COMP%]   .driver-option-icon[_ngcontent-%COMP%]{color:var(--app-blue-grey-400)}.driver-option[_ngcontent-%COMP%]   .driver-status[_ngcontent-%COMP%]{font-size:.8em;font-style:italic;color:var(--app-orange-700);margin-left:auto}.selected-driver-info[_ngcontent-%COMP%]{margin-top:16px;margin-bottom:16px;padding:8px;background-color:var(--app-green-50);border-left:3px solid var(--app-green-500);border-radius:4px;font-size:.9em}.dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid var(--app-border-color);background-color:var(--sys-surface-container-low);display:flex;flex-direction:row;justify-content:flex-end;gap:8px}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:0!important}@media (max-width: 480px){.dialog-actions[_ngcontent-%COMP%]{gap:10px;flex-direction:row-reverse}}.hidden[_ngcontent-%COMP%]{visibility:hidden;height:0;overflow:hidden}"]})};function jr(i,e){if(i&1&&(n(0,"strong"),a(1),v(2,"date"),o()),i&2){let r=C();l(),_(" ",N(2,1,r.data.order.delivery_date,"dd/MM/yyyy")," ")}}function Hr(i,e){i&1&&(n(0,"span"),a(1,"No programada"),o())}function Wr(i,e){i&1&&(n(0,"mat-error"),a(1,"Debe seleccionar una nueva fecha de entrega."),o())}function Xr(i,e){i&1&&(n(0,"mat-error"),a(1,"El motivo no debe exceder los 250 caracteres."),o())}var ui=class i{constructor(e,r){this.dialogRef=e;this.data=r;this.minDateForReschedule=this.data.minDate||new Date,this.data.minDate||this.minDateForReschedule.setDate(this.minDateForReschedule.getDate()+1),this.rescheduleForm=this.fb.group({newDeliveryDate:[this.data.order.delivery_date?new Date(this.data.order.delivery_date):null,x.required],reason:["",x.maxLength(250)]})}rescheduleForm;minDateForReschedule;formSubmitted=!1;fb=b(de);ngOnInit(){}get newDeliveryDateCtrl(){return this.rescheduleForm.get("newDeliveryDate")}get reasonCtrl(){return this.rescheduleForm.get("reason")}onConfirm(){this.formSubmitted=!0,this.rescheduleForm.valid?this.dialogRef.close({newDeliveryDate:this.newDeliveryDateCtrl?.value,reason:this.reasonCtrl?.value?.trim()||void 0}):this.rescheduleForm.markAllAsTouched()}onCancel(){this.dialogRef.close()}static \u0275fac=function(r){return new(r||i)(B(se),B(Ee))};static \u0275cmp=E({type:i,selectors:[["app-reschedule-order-dialog"]],features:[je([])],decls:36,vars:11,consts:[["noCurrentDate",""],["picker",""],["cdkDrag","","cdkDragRootElement",".cdk-overlay-pane","cdkDragHandle",".dialog-header-draggable",1,"dialog-container"],[1,"dialog-header","dialog-header-draggable"],["mat-dialog-title",""],[1,"order-code-chip"],[3,"ngSubmit","formGroup"],[1,"dialog-content"],[4,"ngIf","ngIfElse"],[1,"content-divider"],["appearance","outline",1,"full-width","date-picker-field"],["matInput","","formControlName","newDeliveryDate","placeholder","Seleccione una fecha","readonly","","required","",3,"matDatepicker","min"],["matSuffix","",3,"for"],["appearance","outline",1,"full-width","reason-field"],["matInput","","formControlName","reason","rows","3","cdkTextareaAutosize","","cdkAutosizeMinRows","2","cdkAutosizeMaxRows","5","placeholder","Ej: Cliente solicit\xF3 cambio, Ruta congestionada..."],["align","end",1,"dialog-actions"],["mat-stroked-button","","type","button",1,"cancel-button","btn-corp-secondary",3,"click"],["mat-flat-button","","type","submit",1,"confirm-button","btn-corp-primary",3,"disabled"]],template:function(r,t){if(r&1){let d=O();n(0,"div",2)(1,"div",3)(2,"h2",4),a(3,"Reprogramar Pedido"),o(),n(4,"span",5),a(5),o()(),n(6,"form",6),p("ngSubmit",function(){return f(d),h(t.onConfirm())}),n(7,"mat-dialog-content",7)(8,"p"),a(9," Cliente: "),n(10,"strong"),a(11),o()(),n(12,"p"),a(13," Fecha de Entrega Actual: "),c(14,jr,3,4,"strong",8)(15,Hr,2,0,"ng-template",null,0,at),o(),g(17,"mat-divider",9),n(18,"mat-form-field",10)(19,"mat-label"),a(20,"Nueva Fecha de Entrega"),o(),g(21,"input",11)(22,"mat-datepicker-toggle",12)(23,"mat-datepicker",null,1),c(25,Wr,2,0,"mat-error"),o(),n(26,"mat-form-field",13)(27,"mat-label"),a(28,"Motivo de Reprogramaci\xF3n (Opcional)"),o(),g(29,"textarea",14),c(30,Xr,2,0,"mat-error"),o()(),n(31,"mat-dialog-actions",15)(32,"button",16),p("click",function(){return f(d),h(t.onCancel())}),a(33," Cancelar "),o(),n(34,"button",17),a(35," Confirmar Reprogramaci\xF3n "),o()()()()}if(r&2){let d=F(16),m=F(24);l(5),_("Pedido N\xB0: ",t.data.order.code||t.data.order.id,""),l(),s("formGroup",t.rescheduleForm),l(5),M(t.data.order.recipient_name),l(3),s("ngIf",t.data.order.delivery_date)("ngIfElse",d),l(7),s("matDatepicker",m)("min",t.minDateForReschedule),l(),s("for",m),l(3),L(t.newDeliveryDateCtrl!=null&&t.newDeliveryDateCtrl.hasError("required")&&(t.newDeliveryDateCtrl!=null&&t.newDeliveryDateCtrl.touched||t.newDeliveryDateCtrl!=null&&t.newDeliveryDateCtrl.dirty||t.formSubmitted)?25:-1),l(5),L(t.reasonCtrl!=null&&t.reasonCtrl.hasError("maxlength")?30:-1),l(4),s("disabled",t.rescheduleForm.invalid)}},dependencies:[y,A,K,q,Fe,Y,$,J,mt,Z,le,re,ye,ce,me,H,j,U,ee,Ae,ie,te,pt,S,R,k,Ye,Ot,Et,yt,Ht,Ve,Ne],styles:["[_nghost-%COMP%]{display:block}.dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:85vh;width:480px;max-width:90vw}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 24px}.dialog-header-draggable[_ngcontent-%COMP%]{cursor:move}h2.mat-mdc-dialog-title[_ngcontent-%COMP%]{margin:0;font-size:1.3em;font-weight:500}.order-code-chip[_ngcontent-%COMP%]{font-size:.85em;font-weight:500;margin-left:12px;flex-grow:1}.close-button[_ngcontent-%COMP%]{min-width:auto;padding:0;line-height:normal}.dialog-content[_ngcontent-%COMP%]{padding:20px 24px 10px;overflow-y:auto;flex-grow:1}.dialog-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:0;margin-bottom:8px;font-size:.95em}.dialog-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:500}.content-divider[_ngcontent-%COMP%]{margin:16px 0 20px}.full-width[_ngcontent-%COMP%]{width:100%}.date-picker-field[_ngcontent-%COMP%]{margin-bottom:20px}.reason-field[_ngcontent-%COMP%]{margin-top:10px}.reason-field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{min-height:50px}.dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;gap:10px}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-left:0}@media (max-width: 480px){.dialog-actions[_ngcontent-%COMP%]{gap:10px;flex-direction:row-reverse}}"]})};function Kr(i,e){i&1&&(n(0,"mat-error"),a(1,"El nuevo costo es obligatorio."),o())}function Qr(i,e){i&1&&(n(0,"mat-error"),a(1,"El costo no puede ser negativo."),o())}function Yr(i,e){i&1&&(n(0,"mat-error"),a(1,"El motivo es obligatorio."),o())}function Jr(i,e){i&1&&(n(0,"mat-error"),a(1,"El motivo debe tener al menos 5 caracteres."),o())}var gi=class i{constructor(e,r,t){this.fb=e;this.dialogRef=r;this.data=t}editCostForm;isLoading=!1;ngOnInit(){this.editCostForm=this.fb.group({shipping_cost:[this.data.currentAmount,[x.required,x.min(0)]],observation:["",[x.required,x.minLength(5)]]})}get shippingCostCtrl(){return this.editCostForm.get("shipping_cost")}get observationCtrl(){return this.editCostForm.get("observation")}onConfirm(){this.editCostForm.valid?this.dialogRef.close({newAmount:parseFloat(this.shippingCostCtrl?.value),observation:this.observationCtrl?.value.trim()}):this.editCostForm.markAllAsTouched()}onCancel(){this.dialogRef.close()}static \u0275fac=function(r){return new(r||i)(B(de),B(se),B(Ee))};static \u0275cmp=E({type:i,selectors:[["app-edit-shipping-cost-dialog"]],decls:31,vars:14,consts:[[1,"dialog-container"],[1,"dialog-header"],["mat-dialog-title",""],[1,"order-code-chip"],[1,"dialog-content",3,"formGroup"],[1,"current-cost-info"],["appearance","outline",1,"full-width"],["matInput","","formControlName","shipping_cost","type","number","min","0","step","0.01","required","","placeholder","0.00"],["matTextPrefix",""],["appearance","outline",1,"full-width","reason-field"],["matInput","","formControlName","observation","rows","2","cdkTextareaAutosize","","cdkAutosizeMinRows","2","cdkAutosizeMaxRows","4","required","","placeholder","Explique brevemente por qu\xE9 se est\xE1 modificando..."],["align","end",1,"dialog-actions"],["mat-stroked-button","",1,"cancel-button","btn-corp-secondary",3,"click"],["mat-flat-button","","color","primary",1,"confirm-button","btn-corp-primary",3,"click","disabled"]],template:function(r,t){r&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2),a(3,"Modificar Monto a Cobrar"),o(),n(4,"span",3),a(5),o()(),n(6,"mat-dialog-content",4)(7,"p",5),a(8," Monto a Cobrar Actual: "),n(9,"strong"),a(10),v(11,"currency"),o()(),n(12,"mat-form-field",6)(13,"mat-label"),a(14,"Nuevo monto a cobrar (S/)"),o(),g(15,"input",7),n(16,"span",8),a(17,"S/"),o(),c(18,Kr,2,0,"mat-error")(19,Qr,2,0,"mat-error"),o(),n(20,"mat-form-field",9)(21,"mat-label"),a(22,"Motivo del Ajuste"),o(),g(23,"textarea",10),c(24,Yr,2,0,"mat-error")(25,Jr,2,0,"mat-error"),o()(),n(26,"mat-dialog-actions",11)(27,"button",12),p("click",function(){return t.onCancel()}),a(28," Cancelar "),o(),n(29,"button",13),p("click",function(){return t.onConfirm()}),a(30),o()()()),r&2&&(l(5),_("Pedido N\xB0: ",t.data.orderCode,""),l(),s("formGroup",t.editCostForm),l(4),M(ve(11,9,t.data.currentAmount,"PEN","S/ ","1.2-2")),l(8),L(t.shippingCostCtrl!=null&&t.shippingCostCtrl.hasError("required")&&(t.shippingCostCtrl!=null&&t.shippingCostCtrl.touched)?18:-1),l(),L(t.shippingCostCtrl!=null&&t.shippingCostCtrl.hasError("min")&&(t.shippingCostCtrl!=null&&t.shippingCostCtrl.touched)?19:-1),l(5),L(t.observationCtrl!=null&&t.observationCtrl.hasError("required")&&(t.observationCtrl!=null&&t.observationCtrl.touched)?24:-1),l(),L(t.observationCtrl!=null&&t.observationCtrl.hasError("minlength")&&(t.observationCtrl!=null&&t.observationCtrl.touched)?25:-1),l(4),s("disabled",t.editCostForm.invalid||t.isLoading),l(),_(" ",t.isLoading?"Guardando...":"Guardar Cambios"," "))},dependencies:[y,Te,q,Y,We,$,J,mt,st,Z,le,re,ye,ce,me,H,j,U,ee,ct,ie,te,pt,S,R,k],styles:['.dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.dialog-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:20px 24px 16px;border-bottom:1px solid #eee;background-color:#f9f9f9}.dialog-header[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]{color:"";font-size:28px;height:28px;width:28px}.dialog-header[_ngcontent-%COMP%]   h2.mat-mdc-dialog-title[_ngcontent-%COMP%]{margin:0;font-size:1.3em;font-weight:500;color:"";flex-grow:1}.order-code-chip[_ngcontent-%COMP%]{font-size:.85em;color:#555;background-color:#f0f0f0;padding:4px 10px;border-radius:16px}.dialog-content[_ngcontent-%COMP%]{padding:24px;min-width:400px}.current-cost-info[_ngcontent-%COMP%]{margin-bottom:24px;font-size:1em;color:#444;padding:10px;background-color:#eceff1;border-radius:4px}.current-cost-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600;color:#263238}.full-width[_ngcontent-%COMP%]{width:100%}.reason-field[_ngcontent-%COMP%]{margin-top:20px}.reason-field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{min-height:70px}.dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #eee;background-color:#f9f9f9}.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{margin-right:8px}']})};function Zr(i,e){i&1&&(n(0,"mat-error"),a(1,"El nuevo costo es obligatorio."),o())}function eo(i,e){i&1&&(n(0,"mat-error"),a(1,"El costo no puede ser negativo."),o())}function to(i,e){i&1&&(n(0,"mat-error"),a(1,"El motivo es obligatorio."),o())}function io(i,e){i&1&&(n(0,"mat-error"),a(1,"El motivo debe tener al menos 5 caracteres."),o())}var _i=class i{constructor(e,r,t){this.fb=e;this.dialogRef=r;this.data=t}editCostForm;isLoading=!1;ngOnInit(){this.editCostForm=this.fb.group({shipping_cost:[this.data.currentShippingCost,[x.required,x.min(0)]],observation_shipping_cost_modification:["",[x.required,x.minLength(5)]]})}get shippingCostCtrl(){return this.editCostForm.get("shipping_cost")}get observationCtrl(){return this.editCostForm.get("observation_shipping_cost_modification")}onConfirm(){this.editCostForm.valid?this.dialogRef.close({newShippingCost:parseFloat(this.shippingCostCtrl?.value),observation:this.observationCtrl?.value.trim()}):this.editCostForm.markAllAsTouched()}onCancel(){this.dialogRef.close()}static \u0275fac=function(r){return new(r||i)(B(de),B(se),B(Ee))};static \u0275cmp=E({type:i,selectors:[["app-edit-shipping-cost-dialog"]],decls:31,vars:14,consts:[[1,"dialog-container"],[1,"dialog-header"],["mat-dialog-title",""],[1,"order-code-chip"],[1,"dialog-content",3,"formGroup"],[1,"current-cost-info"],["appearance","outline",1,"full-width"],["matInput","","formControlName","shipping_cost","type","number","min","0","step","0.01","required","","placeholder","0.00"],["matTextPrefix",""],["appearance","outline",1,"full-width","reason-field"],["matInput","","formControlName","observation_shipping_cost_modification","rows","2","cdkTextareaAutosize","","cdkAutosizeMinRows","2","cdkAutosizeMaxRows","4","required","","placeholder","Explique brevemente por qu\xE9 se est\xE1 modificando el costo..."],["align","end",1,"dialog-actions"],["mat-stroked-button","",1,"cancel-button","btn-corp-secondary",3,"click"],["mat-flat-button","","color","primary",1,"confirm-button","btn-corp-primary",3,"click","disabled"]],template:function(r,t){r&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2),a(3,"Modificar Costo de Env\xEDo"),o(),n(4,"span",3),a(5),o()(),n(6,"mat-dialog-content",4)(7,"p",5),a(8," Costo de Env\xEDo Actual: "),n(9,"strong"),a(10),v(11,"currency"),o()(),n(12,"mat-form-field",6)(13,"mat-label"),a(14,"Nuevo Costo de Env\xEDo (S/)"),o(),g(15,"input",7),n(16,"span",8),a(17,"S/\xA0"),o(),c(18,Zr,2,0,"mat-error")(19,eo,2,0,"mat-error"),o(),n(20,"mat-form-field",9)(21,"mat-label"),a(22,"Motivo del Ajuste de Costo"),o(),g(23,"textarea",10),c(24,to,2,0,"mat-error")(25,io,2,0,"mat-error"),o()(),n(26,"mat-dialog-actions",11)(27,"button",12),p("click",function(){return t.onCancel()}),a(28," Cancelar "),o(),n(29,"button",13),p("click",function(){return t.onConfirm()}),a(30),o()()()),r&2&&(l(5),_("Pedido N\xB0: ",t.data.orderCode,""),l(),s("formGroup",t.editCostForm),l(4),M(ve(11,9,t.data.currentShippingCost,"PEN","S/ ","1.2-2")),l(8),L(t.shippingCostCtrl!=null&&t.shippingCostCtrl.hasError("required")&&(t.shippingCostCtrl!=null&&t.shippingCostCtrl.touched)?18:-1),l(),L(t.shippingCostCtrl!=null&&t.shippingCostCtrl.hasError("min")&&(t.shippingCostCtrl!=null&&t.shippingCostCtrl.touched)?19:-1),l(5),L(t.observationCtrl!=null&&t.observationCtrl.hasError("required")&&(t.observationCtrl!=null&&t.observationCtrl.touched)?24:-1),l(),L(t.observationCtrl!=null&&t.observationCtrl.hasError("minlength")&&(t.observationCtrl!=null&&t.observationCtrl.touched)?25:-1),l(4),s("disabled",t.editCostForm.invalid||t.isLoading),l(),_(" ",t.isLoading?"Guardando...":"Guardar Cambios"," "))},dependencies:[y,Te,q,Y,We,$,J,mt,st,Z,le,re,ye,ce,me,H,j,U,ee,ct,ie,te,pt,S,R,k],styles:['.dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.dialog-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:20px 24px 16px;border-bottom:1px solid #eee;background-color:#f9f9f9}.dialog-header[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]{color:"";font-size:28px;height:28px;width:28px}.dialog-header[_ngcontent-%COMP%]   h2.mat-mdc-dialog-title[_ngcontent-%COMP%]{margin:0;font-size:1.3em;font-weight:500;color:"";flex-grow:1}.order-code-chip[_ngcontent-%COMP%]{font-size:.85em;color:#555;background-color:#f0f0f0;padding:4px 10px;border-radius:16px}.dialog-content[_ngcontent-%COMP%]{padding:24px;min-width:400px}.current-cost-info[_ngcontent-%COMP%]{margin-bottom:24px;font-size:1em;color:#444;padding:10px;background-color:#eceff1;border-radius:4px}.current-cost-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600;color:#263238}.full-width[_ngcontent-%COMP%]{width:100%}.reason-field[_ngcontent-%COMP%]{margin-top:20px}.reason-field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{min-height:70px}.dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #eee;background-color:#f9f9f9}.dialog-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{margin-right:8px}']})};function ro(i,e){i&1&&(n(0,"mat-error"),a(1,"Largo es requerido"),o())}function oo(i,e){i&1&&(n(0,"mat-error"),a(1,"Valor debe ser positivo"),o())}function no(i,e){i&1&&(n(0,"mat-error"),a(1,"Ancho es requerido"),o())}function ao(i,e){i&1&&(n(0,"mat-error"),a(1,"Valor debe ser positivo"),o())}function lo(i,e){i&1&&(n(0,"mat-error"),a(1,"Alto es requerido"),o())}function so(i,e){i&1&&(n(0,"mat-error"),a(1,"Valor debe ser positivo"),o())}function mo(i,e){i&1&&(n(0,"mat-error"),a(1,"Peso es requerido"),o())}function co(i,e){i&1&&(n(0,"mat-error"),a(1,"Valor debe ser positivo"),o())}function po(i,e){i&1&&g(0,"mat-progress-spinner",18)}function uo(i,e){if(i&1){let r=O();n(0,"div",8)(1,"mat-form-field",9)(2,"mat-label"),a(3,"Largo (cm)"),o(),g(4,"input",10),c(5,ro,2,0,"mat-error",11)(6,oo,2,0,"mat-error",11),o(),n(7,"mat-form-field",9)(8,"mat-label"),a(9,"Ancho (cm)"),o(),g(10,"input",12),c(11,no,2,0,"mat-error",11)(12,ao,2,0,"mat-error",11),o(),n(13,"mat-form-field",9)(14,"mat-label"),a(15,"Alto (cm)"),o(),g(16,"input",13),c(17,lo,2,0,"mat-error",11)(18,so,2,0,"mat-error",11),o(),n(19,"mat-form-field",9)(20,"mat-label"),a(21,"Peso (kg)"),o(),g(22,"input",14),c(23,mo,2,0,"mat-error",11)(24,co,2,0,"mat-error",11),o(),n(25,"div",15)(26,"button",16),p("click",function(){f(r);let d=C();return h(d.onCalculateCustomCost())}),c(27,po,1,0,"mat-progress-spinner",17),a(28),o()()()}if(i&2){let r,t,d,m,u,G,X,oe,V=C();l(5),s("ngIf",(r=V.packageFormGroup.get("package_length_cm"))==null?null:r.hasError("required")),l(),s("ngIf",(t=V.packageFormGroup.get("package_length_cm"))==null?null:t.hasError("min")),l(5),s("ngIf",(d=V.packageFormGroup.get("package_width_cm"))==null?null:d.hasError("required")),l(),s("ngIf",(m=V.packageFormGroup.get("package_width_cm"))==null?null:m.hasError("min")),l(5),s("ngIf",(u=V.packageFormGroup.get("package_height_cm"))==null?null:u.hasError("required")),l(),s("ngIf",(G=V.packageFormGroup.get("package_height_cm"))==null?null:G.hasError("min")),l(5),s("ngIf",(X=V.packageFormGroup.get("package_weight_kg"))==null?null:X.hasError("required")),l(),s("ngIf",(oe=V.packageFormGroup.get("package_weight_kg"))==null?null:oe.hasError("min")),l(2),s("disabled",V.isCalculating()),l(),s("ngIf",V.isCalculating()),l(),_(" ",V.isCalculating()?"Calculando...":"CALCULAR"," ")}}function go(i,e){i&1&&(n(0,"div",19)(1,"p"),a(2," Si su paquete excede las medidas y pesos est\xE1ndar y no utiliza la calculadora de env\xEDo, se le cobrar\xE1 en funci\xF3n de esas medidas sin previo aviso. "),o()())}function _o(i,e){if(i&1&&(n(0,"div",20)(1,"p"),a(2),o()()),i&2){let r=e.ngIf;l(2),M(r.info_text)}}var Mt=class i{packageFormGroup;deliveryDistrictId=null;districtsCache=[];shippingCostCalculated=new w;calculationLoading=new w;maxDimensions$;standardPackageLabel=Ce("Est\xE1ndar");volumetric_factor=Ce(0);isCalculating=Ce(!1);orderService=b(W);destroy$=new Q;constructor(){this.maxDimensions$=this.orderService.getMaxPackageDimensions().pipe(he(e=>{e.standard_package_info&&e.volumetric_factor&&(console.log(e.standard_package_info),this.standardPackageLabel.set(e.standard_package_info),this.volumetric_factor.set(e.volumetric_factor))}))}ngOnInit(){if(!this.packageFormGroup){console.error("PackageCalculatorComponent: packageFormGroup input is required.");return}this.packageFormGroup.get("package_size_type")?.valueChanges.pipe(D(this.destroy$),Pe(this.packageFormGroup.get("package_size_type")?.value)).subscribe(e=>{this.toggleCustomDimensionControls(e==="custom")})}toggleCustomDimensionControls(e){["package_width_cm","package_length_cm","package_height_cm","package_weight_kg"].forEach(t=>{let d=this.packageFormGroup.get(t)})}onCalculateCustomCost(){if(this.packageFormGroup.get("package_size_type")?.value!=="custom")return;if(!this.deliveryDistrictId){alert("Por favor, seleccione un distrito de entrega primero.");return}let e=!0;if(["package_width_cm","package_length_cm","package_height_cm","package_weight_kg"].forEach(m=>{let u=this.packageFormGroup.get(m);u?.markAsTouched(),u?.invalid&&(e=!1)}),!e){console.log("Custom dimensions form is invalid");return}this.isCalculating.set(!0),this.calculationLoading.emit(!0);let t={delivery_district_id:this.deliveryDistrictId,package_size_type:"custom",package_width_cm:this.packageFormGroup.get("package_width_cm")?.value,package_length_cm:this.packageFormGroup.get("package_length_cm")?.value,package_height_cm:this.packageFormGroup.get("package_height_cm")?.value,package_weight_kg:this.packageFormGroup.get("package_weight_kg")?.value};if(t.package_width_cm&&t.package_length_cm&&t.package_height_cm&&t.package_weight_kg&&this.volumetric_factor()){let m=t.package_length_cm*t.package_width_cm*t.package_height_cm/this.volumetric_factor(),u=0,G=t.package_weight_kg;if(m>t.package_weight_kg&&(G=m),t.delivery_district_id){let X=this.districtsCache?.find(oe=>oe.id===t.delivery_district_id);if(X){let V=function(_e,De=[]){for(let ze of De)if(_e>=ze.weight_from&&_e<=ze.weight_to)return ze;return 0};var d=V;let oe=this.districtsCache?.filter(_e=>_e.name==X?.name);oe&&(u=V(G,oe)?.price||0)}}console.log("peso_cobrado",G),console.log("precio",u),u===0&&alert("No hay ninguna tarifa asociada con el peso ("+G+") del distrito seleccionado."),this.shippingCostCalculated.emit(u)}else alert("las entradas no son validas");this.isCalculating.set(!1),this.calculationLoading.emit(!1)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(r){return new(r||i)};static \u0275cmp=E({type:i,selectors:[["app-package-calculator"]],inputs:{packageFormGroup:"packageFormGroup",deliveryDistrictId:"deliveryDistrictId",districtsCache:"districtsCache"},outputs:{shippingCostCalculated:"shippingCostCalculated",calculationLoading:"calculationLoading"},decls:12,vars:7,consts:[[1,"package-calculator-container",3,"formGroup"],[1,"section-subtitle"],["formControlName","package_size_type","aria-label","Seleccione el tipo de tama\xF1o del paquete"],["value","standard",1,"package-option"],["value","custom",1,"package-option"],["class","custom-dimensions-grid",4,"ngIf"],["class","warning-paquete-size",4,"ngIf"],["class","max-dimensions-info",4,"ngIf"],[1,"custom-dimensions-grid"],["appearance","outline"],["matInput","","type","number","formControlName","package_length_cm","placeholder","Ingrese el largo","appAutoSelect",""],[4,"ngIf"],["matInput","","type","number","formControlName","package_width_cm","placeholder","Ingrese el ancho","appAutoSelect",""],["matInput","","type","number","formControlName","package_height_cm","placeholder","Ingrese el alto","appAutoSelect",""],["matInput","","type","number","formControlName","package_weight_kg","placeholder","Ingrese el peso","appAutoSelect",""],[1,"calculate-button-container"],["mat-flat-button","","type","button",1,"btn-corp-primary",3,"click","disabled"],["mode","indeterminate","diameter","20","class","button-spinner",4,"ngIf"],["mode","indeterminate","diameter","20",1,"button-spinner"],[1,"warning-paquete-size"],[1,"max-dimensions-info"]],template:function(r,t){if(r&1&&(n(0,"div",0)(1,"h3",1),a(2,"Tama\xF1o del paquete"),o(),n(3,"mat-radio-group",2)(4,"mat-radio-button",3),a(5),o(),n(6,"mat-radio-button",4),a(7,"Otros tama\xF1os : Calcular"),o()(),c(8,uo,29,11,"div",5)(9,go,3,0,"div",6)(10,_o,3,1,"div",7),v(11,"async"),o()),r&2){let d,m;s("formGroup",t.packageFormGroup),l(5),M(t.standardPackageLabel()),l(3),s("ngIf",((d=t.packageFormGroup.get("package_size_type"))==null?null:d.value)==="custom"),l(),s("ngIf",((m=t.packageFormGroup.get("package_size_type"))==null?null:m.value)==="standard"),l(),s("ngIf",T(11,5,t.maxDimensions$))}},dependencies:[y,A,Ie,q,Y,We,$,J,Z,le,H,j,U,ee,ie,te,sr,lr,dr,S,R,xe,be,pr],styles:[".package-calculator-container[_ngcontent-%COMP%]{margin-top:20px;padding:16px;border:1px solid #e0e0e0;border-radius:4px;background-color:#f9f9f9}.section-subtitle[_ngcontent-%COMP%]{font-size:1.1em;font-weight:500;margin-top:0;margin-bottom:16px}mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;margin-bottom:20px}.package-option[_ngcontent-%COMP%]{font-weight:400}.custom-dimensions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:30px;margin-top:16px;align-items:start}.calculate-button-container[_ngcontent-%COMP%]{grid-column:1/-1;display:flex;justify-content:flex-start;margin-top:10px}.calculate-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:120px}.button-spinner[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;margin-right:8px}.max-dimensions-info[_ngcontent-%COMP%]{margin-top:0!important;font-size:16px;color:#575555;text-align:center;padding:8px;background-color:#efefef;border-radius:4px}.warning-paquete-size[_ngcontent-%COMP%]{font-size:17px;font-weight:700;margin:0;text-align:left;color:#d32f2f;display:flex;align-items:center;justify-content:flex-start}"]})};var Cr=(i,e)=>e.id;function fo(i,e){if(i&1){let r=O();n(0,"button",31),p("click",function(){f(r);let d=C();return h(d.clearDriverSelection())}),n(1,"mat-icon"),a(2,"close"),o()()}}function ho(i,e){i&1&&(n(0,"mat-icon",16),a(1,"person_search"),o())}function Co(i,e){i&1&&g(0,"mat-progress-spinner",32)}function vo(i,e){if(i&1&&(n(0,"mat-option",10)(1,"div",33)(2,"span"),a(3),o()()()),i&2){let r=e.$implicit;s("value",r),l(3),M(r.username)}}function bo(i,e){i&1&&(n(0,"mat-option",11),a(1,"No se encontraron motorizados."),o())}function xo(i,e){i&1&&(n(0,"mat-error"),a(1,"Requerido"),o())}function Oo(i,e){i&1&&(n(0,"mat-error"),a(1,"Requerido"),o())}function Eo(i,e){i&1&&(n(0,"mat-error"),a(1,"Requerido"),o())}function yo(i,e){i&1&&(n(0,"mat-error"),a(1,"Tel\xE9fono inv\xE1lido"),o())}function So(i,e){if(i&1){let r=O();n(0,"button",31),p("click",function(){f(r);let d=C();return h(d.clearDistrictSelection())}),n(1,"mat-icon"),a(2,"close"),o()()}}function Mo(i,e){i&1&&(n(0,"mat-icon",16),a(1,"person_search"),o())}function Do(i,e){i&1&&g(0,"mat-progress-spinner",32)}function ko(i,e){if(i&1&&(n(0,"mat-option",10)(1,"div",33)(2,"span"),a(3),o()()()),i&2){let r=e.$implicit;s("value",r),l(3),M(r.name_and_price)}}function wo(i,e){i&1&&(n(0,"mat-option",11),a(1,"No se encontraron distritos."),o())}function Po(i,e){i&1&&(n(0,"mat-error"),a(1,"Requerido"),o())}function Io(i,e){i&1&&(n(0,"mat-error"),a(1,"Requerido"),o())}function To(i,e){i&1&&(n(0,"mat-error"),a(1,"M\xEDnimo 6 caracteres"),o())}function Fo(i,e){i&1&&g(0,"mat-progress-spinner",34)}function Ao(i,e){i&1&&(n(0,"mat-error"),a(1,"Requerido"),o())}function Ro(i,e){i&1&&(n(0,"mat-error"),a(1,"Requerido"),o())}function No(i,e){if(i&1&&(n(0,"mat-form-field",21)(1,"mat-label"),a(2,"Observaci\xF3n de modificaci\xF3n de costo de env\xEDo"),o(),g(3,"textarea",35),c(4,Ro,2,0,"mat-error",12),o()),i&2){let r,t=C();l(4),s("ngIf",(r=t.orderForm.get("observation_shipping_cost_modification"))==null?null:r.hasError("required"))}}var It=class i{order=null;orderSubmit=new w;formValidityChanged=new w;orderForm;minDeliveryDate;originalShippingCost=-1;originalDistrict="";isCalculatingShipping=Ce(!1);appStore=b(Ke);selectedDistrictName=()=>{let e=this.orderForm?.get("delivery_district_id")?.value;return!e||!this.districtsCache?"":this.districtsCache.find(r=>r.id===e)?.name||""};orderService=b(W);fb=b(de);destroy$=new Q;districtsCache=[];isLoadingCompanies=!1;companySearchCtrl=new Me;filteredCompanies$;isLoadingDistricts=!1;districSearchCtrl=new Me;filteredDistricts$;constructor(){this.buildForm(),this.minDeliveryDate=new Date,this.filteredCompanies$=this.companySearchCtrl.valueChanges.pipe(Pe(""),we(300),ae(),$e(e=>(this.isLoadingCompanies=!0,this.orderService.getCompanies(e||"").pipe(he(()=>this.isLoadingCompanies=!1),ke(()=>(this.isLoadingCompanies=!1,Se([])))))),D(this.destroy$)),this.filteredDistricts$=this.districSearchCtrl.valueChanges.pipe(Pe(""),we(900),$e(e=>(this.isLoadingDistricts=!0,this.orderService.getDistricts(e||"",this.orderForm.get("isExpress")?.value).pipe(he(()=>this.isLoadingDistricts=!1),ke(()=>(this.isLoadingDistricts=!1,Se([])))))),D(this.destroy$))}getCheckboxValue(){this.districSearchCtrl.setValue("",{emitEvent:!0}),this.orderForm.markAllAsTouched(),this.orderForm.get("delivery_district_id")?.setValue(null,{emitEvent:!0}),this.packageDetailsFormGroup.get("package_size_type")?.setValue("standard",{emitEvent:!0}),console.log("test",this.orderForm.get("isExpress")?.value),this.orderService.getDeliveryDistricts(this.orderForm.get("isExpress")?.value).subscribe(e=>{this.districtsCache=e})}ngOnInit(){console.log(this.order),this.order&&(console.log(this.order),this.orderService.getDeliveryDistricts(this.order?.isExpress).subscribe(e=>{this.districtsCache=e,this.order&&(this.populateForm(this.order,this.districtsCache),console.log(this.districtsCache))})),this.orderForm.statusChanges.pipe(D(this.destroy$),ae()).subscribe(e=>{this.formValidityChanged.emit(e==="VALID")}),this.orderForm.get("delivery_district_id")?.valueChanges.pipe(D(this.destroy$),ae()).subscribe(e=>{if(e){if(this.packageDetailsFormGroup.get("package_size_type")?.value==="standard"){let t=this.districtsCache.find(d=>d.id===e);t&&this.orderForm.get("shipping_cost")?.setValue(parseFloat(t.price))}else this.orderForm.get("shipping_cost")?.setValue(0);this.checkShippingCostDifference()}}),this.packageDetailsFormGroup.get("package_size_type")?.valueChanges.pipe(D(this.destroy$),ae()).subscribe(e=>{console.log("type",e);let r=this.orderForm.get("delivery_district_id")?.value;if(r&&e==="standard"){let t=this.districtsCache.find(d=>d.id===r);t&&this.orderForm.get("shipping_cost")?.setValue(parseFloat(t.price))}else this.orderForm.get("shipping_cost")?.setValue(0);this.originalShippingCost!==-1&&this.checkShippingCostDifference()})}isCompany(){return this.appStore.currentUser()?.role==="EMPRESA"}displayDriverName(e){return e&&e.username?e.username:""}onDriverSelected(e){this.orderForm.get("company_id")?.setValue(e.option.value.id),this.orderForm.markAllAsTouched()}clearDriverSelection(){this.companySearchCtrl.setValue(""),this.orderForm.markAllAsTouched(),this.orderForm.get("company_id")?.setValue(null)}displayDistricName(e){return e&&e.name_and_price?e.name_and_price:""}onDistrictSelected(e){this.orderForm.get("delivery_district_id")?.setValue(e.option.value.id),this.orderForm.markAllAsTouched()}clearDistrictSelection(){this.districSearchCtrl.setValue(""),this.orderForm.markAllAsTouched(),this.orderForm.get("delivery_district_id")?.setValue(null)}get packageDetailsFormGroup(){return this.orderForm.get("package_details")}buildForm(){this.orderForm=this.fb.group({isExpress:[!1],recipient_name:["",x.required],recipient_phone:["",[x.required,x.pattern("^[0-9]{9}$")]],company_id:[null,x.required],delivery_district_id:[null,x.required],delivery_address:["",[x.required,x.minLength(6)]],package_details:this.fb.group({package_size_type:["standard"],package_width_cm:[0],package_length_cm:[0],package_height_cm:[0],package_weight_kg:[0]}),item_description:["",x.required],observations:[""],shipping_cost:[this.originalShippingCost],observation_shipping_cost_modification:[{value:"",disabled:!0}]})}onShippingCostCalculated(e){this.orderForm.get("shipping_cost")?.setValue(e),this.checkShippingCostDifference()}onPackageCalculationLoading(e){this.isCalculatingShipping.set(e)}onSubmit(){if(this.orderForm.invalid){this.orderForm.markAllAsTouched(),console.log("Order form is invalid:",this.getFormErrors(this.orderForm)),alert("Por favor complete todos los campos requeridos.");return}if(!this.order){console.error("No order to update.");return}if(this.orderForm.get("shipping_cost")?.value===0){alert("El costo de env\xEDo no puede ser 0.");return}let e=this.orderForm.getRawValue(),r={isExpress:e.isExpress||!1,recipient_name:e.recipient_name,recipient_phone:e.recipient_phone,delivery_district_name:this.selectedDistrictName(),delivery_address:e.delivery_address,package_size_type:e.package_details.package_size_type,package_width_cm:e.package_details.package_width_cm,package_length_cm:e.package_details.package_length_cm,package_height_cm:e.package_details.package_height_cm,package_weight_kg:e.package_details.package_weight_kg,shipping_cost:e.shipping_cost,item_description:e.item_description,observations:e.observations,company_id:e.company_id,observation_shipping_cost_modification:e.observation_shipping_cost_modification};console.log("Submitting Updated Order Data:",r),this.orderService.updateOrder(this.order.id,r).pipe(D(this.destroy$)).subscribe({next:t=>{console.log("Order updated successfully",t),this.orderSubmit.emit(t)},error:t=>{console.error("Error updating order",t),alert("Error al actualizar el pedido.")}})}resetFormForNextOrder(){this.companySearchCtrl.setValue(""),this.districSearchCtrl.setValue("");let e=null;this.isCompany()&&(e=this.orderForm.get("company_id")?.value),this.orderForm.reset({company_id:e,delivery_date:null,package_details:{package_size_type:"standard"}}),this.orderForm.get("shipping_cost")?.setValue(0),this.packageDetailsFormGroup.get("package_size_type")?.setValue("standard",{emitEvent:!0}),this.formValidityChanged.emit(this.orderForm.valid)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}populateForm(e,r){let t=r.find(d=>d.name===e.delivery_district_name);this.orderForm.patchValue({isExpress:e.isExpress||!1,recipient_name:e.recipient_name,recipient_phone:e.recipient_phone,company_id:e.company?.id,delivery_district_id:t?.id,delivery_address:e.delivery_address,delivery_coordinates:e.delivery_coordinates,item_description:e.item_description,observations:e.observations,shipping_cost:e.shipping_cost,observation_shipping_cost_modification:""},{emitEvent:!1}),t&&(t.name_and_price=t.name+" - S/ "+parseFloat(t.price).toFixed(2),this.originalDistrict=t.name),this.originalShippingCost=e.shipping_cost||-1,this.packageDetailsFormGroup.patchValue({package_size_type:e.package_size_type,package_width_cm:e.package_width_cm,package_length_cm:e.package_length_cm,package_height_cm:e.package_height_cm,package_weight_kg:e.package_weight_kg},{emitEvent:!1}),e.company&&e.company&&this.companySearchCtrl.setValue(e.company),t&&this.districSearchCtrl.setValue(fe({},t)),this.orderForm.get("shipping_cost")?.setValue(e.shipping_cost)}getFormErrors(e){let r={};return Object.keys(e.controls).forEach(t=>{let d=e.get(t)?.errors;if(d&&(r[t]=d),e.get(t)instanceof Lt){let m=this.getFormErrors(e.get(t));Object.keys(m).length>0&&(r[t]=m)}}),r}checkShippingCostDifference(){let e=this.orderForm.get("shipping_cost")?.value,r=this.orderForm.get("observation_shipping_cost_modification");e!==this.originalShippingCost||this.selectedDistrictName()!==this.originalDistrict?(r?.enable(),r?.setValidators(x.required)):(r?.disable(),r?.clearValidators(),r?.setValue("")),r?.updateValueAndValidity()}static \u0275fac=function(r){return new(r||i)};static \u0275cmp=E({type:i,selectors:[["app-order-edition-form"]],inputs:{order:"order"},outputs:{orderSubmit:"orderSubmit",formValidityChanged:"formValidityChanged"},features:[je([ft(),K])],decls:79,vars:40,consts:[["autoDriver","matAutocomplete"],["autoDistric","matAutocomplete"],[1,"order-creation-form",3,"ngSubmit","formGroup"],["formControlName","isExpress","color","primary",1,"standard-checkbox",3,"click"],["appearance","outline",1,"full-width","driver-search-field"],["type","text","placeholder","Escriba el nombre del la empresa...","aria-label","cliente","matInput","",3,"formControl","matAutocomplete"],["matSuffix","","mat-icon-button","","aria-label","Limpiar",3,"click",4,"ngIf"],["matSuffix","",4,"ngIf"],["matSuffix","","mode","indeterminate","diameter","20",4,"ngIf"],[3,"optionSelected","displayWith"],[3,"value"],["disabled",""],[4,"ngIf"],[1,"form-grid"],["appearance","outline"],["matInput","","formControlName","recipient_name","placeholder","Nombre completo"],["matSuffix",""],["matInput","","formControlName","recipient_phone","type","tel","placeholder",""],["align","end"],["appearance","outline",1,"driver-search-field"],["type","text","placeholder","Escriba el nombre del distrito...","aria-label","distrito","matInput","",3,"formControl","matAutocomplete"],["appearance","outline",1,"full-span-column"],["matInput","","formControlName","delivery_address","placeholder","Ingresar lugar de entrega (M\xEDnimo 6 caracteres)"],[1,"section-divider"],[3,"shippingCostCalculated","calculationLoading","packageFormGroup","districtsCache","deliveryDistrictId"],[1,"shipping-cost-display"],[1,"cost-value"],["mode","indeterminate","diameter","20","class","cost-spinner",4,"ngIf"],["matInput","","formControlName","item_description","placeholder","Detalle del pedido"],["matInput","","formControlName","observations","placeholder","\xBFQu\xE9 env\xEDas?...","rows","3"],["appearance","outline","class","full-span-column",4,"ngIf"],["matSuffix","","mat-icon-button","","aria-label","Limpiar",3,"click"],["matSuffix","","mode","indeterminate","diameter","20"],[1,"driver-option"],["mode","indeterminate","diameter","20",1,"cost-spinner"],["matInput","","formControlName","observation_shipping_cost_modification","placeholder","Ingrese la raz\xF3n de la modificaci\xF3n del costo de env\xEDo","rows","3"]],template:function(r,t){if(r&1){let d=O();n(0,"form",2),p("ngSubmit",function(){return f(d),h(t.onSubmit())}),n(1,"mat-checkbox",3),p("click",function(){return f(d),h(t.getCheckboxValue())}),a(2," Express "),o(),n(3,"mat-form-field",4)(4,"mat-label"),a(5,"Buscar y Seleccionar empresa"),o(),g(6,"input",5),c(7,fo,3,0,"button",6)(8,ho,2,0,"mat-icon",7)(9,Co,1,0,"mat-progress-spinner",8),n(10,"mat-autocomplete",9,0),p("optionSelected",function(u){return f(d),h(t.onDriverSelected(u))}),qe(12,vo,4,2,"mat-option",10,Cr),v(14,"async"),c(15,bo,2,0,"mat-option",11),v(16,"async"),o(),c(17,xo,2,0,"mat-error",12),o(),n(18,"div",13)(19,"mat-form-field",14)(20,"mat-label"),a(21,"Nombre del destinatario"),o(),g(22,"input",15),n(23,"mat-icon",16),a(24,"person_outline"),o(),c(25,Oo,2,0,"mat-error",12),o(),n(26,"mat-form-field",14)(27,"mat-label"),a(28,"Tel\xE9fono del destinatario"),o(),g(29,"input",17),n(30,"mat-icon",16),a(31,"phone_outline"),o(),n(32,"mat-hint",18),a(33,"No se debe agregar el +51"),o(),c(34,Eo,2,0,"mat-error",12)(35,yo,2,0,"mat-error",12),o(),n(36,"mat-form-field",19)(37,"mat-label"),a(38,"Buscar y Seleccionar distrito"),o(),g(39,"input",20),c(40,So,3,0,"button",6)(41,Mo,2,0,"mat-icon",7)(42,Do,1,0,"mat-progress-spinner",8),n(43,"mat-autocomplete",9,1),p("optionSelected",function(u){return f(d),h(t.onDistrictSelected(u))}),qe(45,ko,4,2,"mat-option",10,Cr),v(47,"async"),c(48,wo,2,0,"mat-option",11),v(49,"async"),o(),c(50,Po,2,0,"mat-error",12),o(),n(51,"mat-form-field",21)(52,"mat-label"),a(53,"Direcci\xF3n de entrega"),o(),g(54,"input",22),c(55,Io,2,0,"mat-error",12)(56,To,2,0,"mat-error",12),o()(),g(57,"mat-divider",23),n(58,"app-package-calculator",24),p("shippingCostCalculated",function(u){return f(d),h(t.onShippingCostCalculated(u))})("calculationLoading",function(u){return f(d),h(t.onPackageCalculationLoading(u))}),o(),n(59,"div",25),a(60," Costo de env\xEDo = "),n(61,"span",26),a(62),v(63,"number"),o(),c(64,Fo,1,0,"mat-progress-spinner",27),o(),g(65,"mat-divider",23),n(66,"div",13)(67,"mat-form-field",21)(68,"mat-label"),a(69,"\xBFQu\xE9 env\xEDa?"),o(),g(70,"input",28),n(71,"mat-icon",16),a(72,"inventory_2_outline"),o(),c(73,Ao,2,0,"mat-error",12),o(),n(74,"mat-form-field",21)(75,"mat-label"),a(76,"Observaciones (Opcional)"),o(),g(77,"textarea",29),o(),c(78,No,5,1,"mat-form-field",30),o()()}if(r&2){let d,m,u,G,X,oe,V,_e,De,ze,Dt,kt,wt,Ei=F(11),Ft=F(44);s("formGroup",t.orderForm),l(6),s("formControl",t.companySearchCtrl)("matAutocomplete",Ei),l(),s("ngIf",t.companySearchCtrl.value&&!t.isLoadingCompanies),l(),s("ngIf",!t.companySearchCtrl.value&&!t.isLoadingCompanies),l(),s("ngIf",t.isLoadingCompanies),l(),s("displayWith",t.displayDriverName),l(2),Ue(T(14,29,t.filteredCompanies$)),l(3),L(((d=T(16,31,t.filteredCompanies$))==null?null:d.length)===0&&!t.isLoadingCompanies&&t.companySearchCtrl.value?15:-1),l(2),s("ngIf",(m=t.orderForm.get("company_id"))==null?null:m.hasError("required")),l(8),s("ngIf",(u=t.orderForm.get("recipient_name"))==null?null:u.hasError("required")),l(9),s("ngIf",(G=t.orderForm.get("recipient_phone"))==null?null:G.hasError("required")),l(),s("ngIf",(X=t.orderForm.get("recipient_phone"))==null?null:X.hasError("pattern")),l(4),s("formControl",t.districSearchCtrl)("matAutocomplete",Ft),l(),s("ngIf",t.districSearchCtrl.value&&!t.isLoadingDistricts),l(),s("ngIf",!t.districSearchCtrl.value&&!t.isLoadingDistricts),l(),s("ngIf",t.isLoadingDistricts),l(),s("displayWith",t.displayDistricName),l(2),Ue(T(47,33,t.filteredDistricts$)),l(3),L(((oe=T(49,35,t.filteredDistricts$))==null?null:oe.length)===0&&!t.isLoadingDistricts&&t.districSearchCtrl.value?48:-1),l(2),s("ngIf",(V=t.orderForm.get("delivery_district_id"))==null?null:V.hasError("required")),l(5),s("ngIf",(_e=t.orderForm.get("delivery_address"))==null?null:_e.hasError("required")),l(),s("ngIf",(De=t.orderForm.get("delivery_address"))==null?null:De.hasError("minlength")),l(2),s("packageFormGroup",t.packageDetailsFormGroup)("districtsCache",t.districtsCache)("deliveryDistrictId",(ze=t.orderForm.get("delivery_district_id"))==null?null:ze.value),l(4),_("S/ ",N(63,37,(Dt=t.orderForm.get("shipping_cost"))==null?null:Dt.value,"1.2-2"),""),l(2),s("ngIf",t.isCalculatingShipping()),l(9),s("ngIf",(kt=t.orderForm.get("item_description"))==null?null:kt.hasError("required")),l(5),s("ngIf",(wt=t.orderForm.get("observation_shipping_cost_modification"))==null?null:wt.enabled)}},dependencies:[y,A,Ie,dt,q,Fe,Y,$,J,Xe,Z,le,H,j,U,Bt,ee,Ae,ie,te,Be,Le,Ye,S,Oe,k,z,Ve,Ne,Mt,xe,be,xt,vt,bt,gt,ut],styles:[".order-creation-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;padding:10px 20px 20px}.form-section-title[_ngcontent-%COMP%]{font-size:1.5em;font-weight:500;color:#333;margin-bottom:10px;padding-bottom:10px;border-bottom:1px solid #eee}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px 24px}@media (max-width: 600px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.full-span-column[_ngcontent-%COMP%]{grid-column:1/-1}mat-form-field[_ngcontent-%COMP%]{width:100%}.section-divider[_ngcontent-%COMP%]{margin:24px 0}.shipping-cost-display[_ngcontent-%COMP%]{font-size:1.3em;font-weight:700;text-align:right;color:#d32f2f;display:flex;align-items:center;justify-content:flex-end;gap:8px}@media (max-width: 600px){.shipping-cost-display[_ngcontent-%COMP%]{text-align:left;justify-content:flex-start}}.add-order-button-container[_ngcontent-%COMP%]{margin-top:24px;text-align:center}.add-order-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:12px 24px;font-size:1.1em;letter-spacing:.5px}mat-hint[align=end][_ngcontent-%COMP%]{font-size:.75em;opacity:.7}"]})};function Vo(i,e){if(i&1){let r=O();n(0,"app-order-edition-form",9,0),p("orderSubmit",function(d){f(r);let m=C();return h(m.onOrderUpdated(d))})("formValidityChanged",function(d){f(r);let m=C();return h(m.onFormValidityChanged(d))}),o()}if(i&2){let r=C();s("order",r.order)}}var fi=class i{constructor(e,r){this.dialogRef=e;this.data=r}orderEditionForm;snackBar=b(Re);isFormValid=!1;orderService=b(W);order=null;ngOnInit(){this.orderService.getOrderById(this.data.orderId).subscribe({next:e=>{e&&(this.order=e)},error:e=>{console.error("Error fetching order:",e),this.snackBar.open("Error al cargar el pedido.","Cerrar",{duration:3e3})}})}onCancel(){this.dialogRef.close()}onOrderUpdated(e){this.dialogRef.close(e),this.snackBar.open("Pedido actualizado exitosamente.","Cerrar",{duration:3e3})}onFormValidityChanged(e){this.isFormValid=e}static \u0275fac=function(r){return new(r||i)(B(se),B(Ee))};static \u0275cmp=E({type:i,selectors:[["app-order-edition-dialog"]],viewQuery:function(r,t){if(r&1&&tt(It,5),r&2){let d;it(d=rt())&&(t.orderEditionForm=d.first)}},decls:14,vars:3,consts:[["orderEditionForm",""],["color","primary"],[1,"spacer"],["mat-icon-button","","aria-label","Cerrar di\xE1logo",3,"click"],[1,"mat-typography"],[3,"order","orderSubmit","formValidityChanged",4,"ngIf"],["align","end"],["mat-button","",1,"btn-corp-secondary",3,"click"],["mat-raised-button","","color","primary",1,"btn-corp-primary",3,"click","disabled"],[3,"orderSubmit","formValidityChanged","order"]],template:function(r,t){r&1&&(n(0,"mat-toolbar",1)(1,"span"),a(2),o(),g(3,"span",2),n(4,"button",3),p("click",function(){return t.onCancel()}),n(5,"mat-icon"),a(6,"close"),o()()(),n(7,"mat-dialog-content",4),c(8,Vo,2,1,"app-order-edition-form",5),o(),n(9,"mat-dialog-actions",6)(10,"button",7),p("click",function(){return t.onCancel()}),a(11," Cancelar "),o(),n(12,"button",8),p("click",function(){return t.orderEditionForm.onSubmit()}),a(13," Guardar Cambios "),o()()),r&2&&(l(2),_("Editar Pedido: ",t.order==null?null:t.order.code,""),l(6),s("ngIf",t.order),l(4),s("disabled",!t.isFormValid))},dependencies:[y,A,S,R,Oe,k,z,ji,Ui,re,ce,me,It],styles:[".mat-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:0 16px;min-height:56px}.spacer[_ngcontent-%COMP%]{flex:1 1 auto}.mat-dialog-content[_ngcontent-%COMP%]{padding:20px 24px;overflow-y:auto}.mat-dialog-actions[_ngcontent-%COMP%]{padding:8px 24px 20px;display:flex;justify-content:flex-end;gap:8px}"]})};var zo=()=>[10,25,50,100],Go=i=>({"highlight-row":!1,"row-cancelled-strikethrough":i});function $o(i,e){i&1&&(n(0,"div",33),g(1,"mat-progress-spinner",34),o())}function qo(i,e){i&1&&(n(0,"th",35),a(1,"N\xB0 Pedido"),o())}function Uo(i,e){if(i&1&&(n(0,"td",36),a(1),o()),i&2){let r=e.$implicit;l(),_(" ",r.code," ")}}function jo(i,e){i&1&&(n(0,"th",35),a(1,"Empresa"),o())}function Ho(i,e){if(i&1&&(n(0,"td",37),a(1),o()),i&2){let r=e.$implicit;s("matTooltip",r.company==null?null:r.company.username),l(),_(" ",r.company==null?null:r.company.username," ")}}function Wo(i,e){i&1&&(n(0,"th",35),a(1,"Tipo"),o())}function Xo(i,e){if(i&1&&(n(0,"td",38),a(1),o()),i&2){let r=e.$implicit;l(),_(" ",r.shipment_type," ")}}function Ko(i,e){i&1&&(n(0,"th",35),a(1,"Destinatario"),o())}function Qo(i,e){if(i&1&&(n(0,"td",37),a(1),o()),i&2){let r=e.$implicit;s("matTooltip",r.recipient_name),l(),_(" ",r.recipient_name," ")}}function Yo(i,e){i&1&&(n(0,"th",35),a(1,"Telefono"),o())}function Jo(i,e){if(i&1&&(n(0,"td",39),a(1),o()),i&2){let r=e.$implicit;l(),_(" ",r.recipient_phone," ")}}function Zo(i,e){i&1&&(n(0,"th",40),a(1," Estado "),o())}function en(i,e){if(i&1&&(n(0,"td",38)(1,"span",41),a(2),o()()),i&2){let r=e.$implicit,t=C();l(),s("ngClass",t.getStatusClass(r.status)),l(),_(" ",r.status," ")}}function tn(i,e){i&1&&(n(0,"th",35),a(1,"Distrito"),o())}function rn(i,e){i&1&&(n(0,"span",43),a(1),o()),i&2&&(l(),M("Express"))}function on(i,e){if(i&1&&(n(0,"td",38),a(1),c(2,rn,2,1,"span",42),o()),i&2){let r=e.$implicit;l(),_(" ",r.delivery_district_name," "),l(),s("ngIf",r.isExpress)}}function nn(i,e){i&1&&(n(0,"th",35),a(1,"Direcci\xF3n"),o())}function an(i,e){if(i&1&&(n(0,"td",38),a(1),o()),i&2){let r=e.$implicit;l(),_(" ",r.delivery_address," ")}}function ln(i,e){i&1&&(n(0,"th",35),a(1," F. Entrega Prog. "),o())}function dn(i,e){if(i&1&&(n(0,"td",44),a(1),v(2,"date"),o()),i&2){let r=e.$implicit;l(),_(" ",r.delivery_date?N(2,1,r.delivery_date,"dd/MM/yy"):"-"," ")}}function sn(i,e){i&1&&(n(0,"th",45),a(1," Motorizado "),o())}function mn(i,e){if(i&1&&(n(0,"td",38),a(1),o()),i&2){let r=e.$implicit;l(),_(" ",r.assigned_driver==null?null:r.assigned_driver.username," ")}}function cn(i,e){i&1&&(n(0,"th",46),a(1," Cobrar "),o())}function pn(i,e){if(i&1&&(n(0,"td",47),a(1),v(2,"currency"),o()),i&2){let r=e.$implicit;l(),_(" ",ve(2,1,r.amount_to_collect_at_delivery,"PEN","","1.2-2")," ")}}function un(i,e){i&1&&(n(0,"th",35),a(1,"Codigo Tracking"),o())}function gn(i,e){if(i&1&&(n(0,"td",38),a(1),o()),i&2){let r=e.$implicit;l(),_(" ",r.tracking_code," ")}}function _n(i,e){i&1&&(n(0,"th",48),a(1," Acciones "),o())}function fn(i,e){if(i&1){let r=O();n(0,"button",53),p("click",function(){f(r);let d=C().$implicit,m=C();return h(m.editOrder(d))}),n(1,"mat-icon"),a(2,"edit"),o(),n(3,"span"),a(4,"Editar Pedido"),o()()}}function hn(i,e){if(i&1){let r=O();n(0,"button",53),p("click",function(){f(r);let d=C().$implicit,m=C();return h(m.openEditAmountToCollectModal(d))}),n(1,"mat-icon"),a(2,"attach_money"),o(),n(3,"span"),a(4,"Modificar el monto a cobrar"),o()()}}function Cn(i,e){if(i&1){let r=O();n(0,"button",53),p("click",function(){f(r);let d=C().$implicit,m=C();return h(m.openEditShippingCostModal(d))}),n(1,"mat-icon"),a(2,"attach_money"),o(),n(3,"span"),a(4,"Modificar el costo env\xEDo"),o()()}}function vn(i,e){if(i&1){let r=O();n(0,"button",53),p("click",function(){f(r);let d=C().$implicit,m=C();return h(m.openChangeStatusModal(d))}),n(1,"mat-icon"),a(2,"swap_horiz"),o(),n(3,"span"),a(4,"Cambiar Estado General"),o()()}}function bn(i,e){if(i&1){let r=O();n(0,"button",53),p("click",function(){f(r);let d=C().$implicit,m=C();return h(m.openRescheduleOrderModal(d))}),n(1,"mat-icon"),a(2,"event_repeat"),o(),n(3,"span"),a(4,"Reprogramar"),o()()}}function xn(i,e){if(i&1){let r=O();n(0,"button",53),p("click",function(){f(r);let d=C().$implicit,m=C();return h(m.openAssignDriverModal(d))}),n(1,"mat-icon"),a(2,"person_pin_circle"),o(),n(3,"span"),a(4),o()()}if(i&2){let r=C().$implicit;l(4),_("",r.assigned_driver?"Reasignar":"Asignar"," Motorizado")}}function On(i,e){if(i&1){let r=O();n(0,"td",49)(1,"button",50)(2,"mat-icon"),a(3,"more_vert"),o()(),n(4,"mat-menu",51,0),c(6,fn,5,0,"button",52)(7,hn,5,0,"button",52)(8,Cn,5,0,"button",52),n(9,"button",53),p("click",function(){let d=f(r).$implicit,m=C();return h(m.onViewOrderDetails(d))}),n(10,"mat-icon"),a(11,"visibility"),o(),n(12,"span"),a(13,"Ver Detalles Completos"),o()(),c(14,vn,5,0,"button",52)(15,bn,5,0,"button",52)(16,xn,5,1,"button",52),n(17,"button",53),p("click",function(){let d=f(r).$implicit,m=C();return h(m.onViewPdfA4(d))}),n(18,"mat-icon"),a(19,"picture_as_pdf"),o(),n(20,"span"),a(21,"PDF Rotulado"),o()(),n(22,"button",53),p("click",function(){let d=f(r).$implicit,m=C();return h(m.onViewPdfTicket80mm(d))}),n(23,"mat-icon"),a(24,"picture_as_pdf"),o(),n(25,"span"),a(26,"PDF formato ticket"),o()(),n(27,"button",53),p("click",function(){let d=f(r).$implicit,m=C();return h(m.onSeguimiento(d))}),n(28,"mat-icon"),a(29,"timeline"),o(),n(30,"span"),a(31,"Seguimiento"),o()()()()}if(i&2){let r=e.$implicit,t=F(5),d=C();l(),s("matMenuTriggerFor",t),l(5),s("ngIf",d.isAdmin()),l(),s("ngIf",d.isAdminOrReceptionist()),l(),s("ngIf",d.isAdminOrReceptionist()),l(6),s("ngIf",d.hasPermision(r)),l(),s("ngIf",d.isAdminOrReceptionist()),l(),s("ngIf",d.isAdminOrReceptionist())}}function En(i,e){i&1&&g(0,"tr",54)}function yn(i,e){if(i&1&&g(0,"tr",55),i&2){let r=e.$implicit,t=C();s("ngClass",Ri(1,Go,r.status===t.OrderStatus.ANULADO))}}function Sn(i,e){if(i&1&&(n(0,"tr",56)(1,"td",57),a(2," No se encontraron pedidos que coincidan con los filtros. "),o()()),i&2){let r=C();l(),Ii("colspan",r.displayedColumns.length)}}var hi=class i{appStore=b(Ke);router=b(Rt);orders=[];isLoading=!1;totalCount=0;pageSize=10;pageIndex=0;pageChanged=new w;sortChanged=new w;statusChanged=new w;motorizedChanged=new w;rescheduleChanged=new w;viewPdfClicked=new w;viewDetailsClicked=new w;amountToCollectChanged=new w;shippingCostChanged=new w;orderChanged=new w;displayedColumns=["code","company","shipment_type","recipient_name","recipient_phone","status","delivery_district_name","delivery_address","delivery_date","motorizado","amount_to_collect_at_delivery","tracking_code","actions"];dataSource=new tr;paginator;sort;dialog=b(Ut);snackBar=b(Re);OrderStatus=ai;constructor(){}ngOnChanges(e){e.orders&&this.orders&&(this.dataSource.data=this.orders)}ngAfterViewInit(){}onViewPdfA4(e){let r=Vt.apiUrl+"/orders/"+e.id+"/pdf-a4";window.open(r,"_blank")}onViewPdfA4Landscape(e){let r=Vt.apiUrl+"/orders/"+e.id+"/pdf-a4-landscape";window.open(r,"_blank")}onViewPdfTicket80mm(e){let r=Vt.apiUrl+"/orders/"+e.id+"/pdf-ticket-80mm";window.open(r,"_blank")}onSeguimiento(e){window.open("/tracking?code="+e.tracking_code,"_blank")}changeOrderStatus(e,r){console.log(`Changing status of order ${e.code} to ${r}`),this.statusChanged.emit({orderId:e.id,newStatus:r})}getStatusClass(e){return e?`status-${e.toLowerCase().replace(/[\s_]+/g,"-")}`:"status-desconocido"}openChangeStatusModal(e){let r=this.getAvailableStatuses(e);if(r.length===0){this.snackBar.open("No hay cambios de estado disponibles para este pedido.","OK",{duration:3e3});return}this.dialog.open(mr,{width:"450px",data:{order:e,availableStatuses:r},disableClose:!0}).afterClosed().subscribe(d=>{if(d&&d.newStatus){console.log("Dialog result:",d);let m={newStatus:d.newStatus,reason:d.reason||"",proofOfDeliveryImageUrl:"",shippingCostPaymentMethod:"",collectionPaymentMethod:""};d.newStatus==="ENTREGADO"&&(d.proofOfDeliveryImageUrl&&(m.proofOfDeliveryImageUrl=d.proofOfDeliveryImageUrl),d.shippingCostPaymentMethod&&(m.shippingCostPaymentMethod=d.shippingCostPaymentMethod),d.collectionPaymentMethod&&(m.collectionPaymentMethod=d.collectionPaymentMethod)),console.log("updatePayload",m),this.statusChanged.emit(fe({orderId:e.id},m))}else console.log("Cambio de estado cancelado o sin selecci\xF3n.")})}getAvailableStatuses(e){let r=this.appStore.currentUser()?.role;e.status,"REGISTRADO";let t=["EN ALMACEN"];r==="MOTORIZADO"&&"REGISTRADO"&&(t=[]);let d=[];if(r==="ADMINISTRADOR")switch(e.status){case"ENTREGADO":return["ANULADO"];case"RECHAZADO EN PUNTO":return["ANULADO"];default:return["REGISTRADO","RECOGIDO","EN ALMACEN","EN TRANSITO","ENTREGADO","RECHAZADO EN PUNTO","REPROGRAMADO"]}switch(e.status){case"REGISTRADO":return["RECOGIDO",...t,...d];case"RECOGIDO":return["EN ALMACEN",...d];case"EN ALMACEN":return["EN TRANSITO",...d];case"EN TRANSITO":return["ENTREGADO","RECHAZADO EN PUNTO","REPROGRAMADO",...d];case"REPROGRAMADO":return["EN TRANSITO",...d];default:return[]}}onViewOrderDetails(e){this.viewDetailsClicked.emit(e),this.dialog.open(mi,{width:"750px",maxWidth:"90vw",maxHeight:"90vh",data:{order:e},panelClass:"order-detail-dialog-responsive",autoFocus:"dialog"})}onUploadProof(e){console.log("Upload proof for order:",e.code),this.snackBar.open('Funci\xF3n "Subir Prueba" no implementada.',"OK",{duration:2e3})}onReschedule(e){console.log("Reschedule order:",e.code),this.snackBar.open('Funci\xF3n "Reprogramar" no implementada.',"OK",{duration:2e3})}openAssignDriverModal(e){console.log(`Open modal to assign driver for order: ${e.code}`),this.dialog.open(pi,{width:"550px",data:{order:e,currentDriverId:e.assigned_driver?.uid},disableClose:!0}).afterClosed().subscribe(t=>{t&&t.selectedDriver?(console.log("Driver selected from dialog:",e.id,t.selectedDriver),this.motorizedChanged.emit({orderId:e.id,motorizedId:t.selectedDriver.id})):console.log("Assign driver cancelled or no driver selected.")})}openRescheduleOrderModal(e){console.log(`Open modal to reschedule order: ${e.code}`);let r=new Date;r.setDate(r.getDate()),this.dialog.open(ui,{width:"500px",data:{order:e,minDate:r},disableClose:!0}).afterClosed().subscribe(d=>{d&&d.newDeliveryDate?(console.log("Reschedule details from dialog:",d),this.rescheduleChanged.emit({orderId:e.id,newDate:d.newDeliveryDate,reason:d.reason})):console.log("Reschedule cancelled or no new date selected.")})}hasPermision(e){let r=this.appStore.currentUser()?.role;return r==="MOTORIZADO"&&(e.status==="REGISTRADO"||e.assigned_driver?.id===this.appStore.currentUser()?.id)||r==="ADMINISTRADOR"||r==="RECEPCIONISTA"}isAdminOrReceptionist(){let e=this.appStore.currentUser()?.role;return e==="ADMINISTRADOR"||e==="RECEPCIONISTA"}isAdmin(){return this.appStore.currentUser()?.role==="ADMINISTRADOR"}editOrder(e){if(!e.id){console.error("Order ID is missing for editing.",e),this.snackBar.open("No se puede editar el pedido: faltan datos.","Cerrar",{duration:3e3});return}this.dialog.open(fi,{width:"800px",data:{orderId:e.id.toString()},disableClose:!0}).afterClosed().subscribe(t=>{t?(console.log("Order updated via dialog:",t),this.orderChanged.emit(t)):console.log("Edici\xF3n de pedido cancelada.")})}openEditAmountToCollectModal(e){if(!e.id){console.error("Order ID or current monto a cabrar is missing for editing.",e),this.snackBar.open("No se puede modificar el monto a cabrar: faltan datos del pedido.","Cerrar",{duration:3e3});return}this.dialog.open(gi,{width:"500px",data:{orderCode:e.code,currentAmount:e.amount_to_collect_at_delivery},disableClose:!0}).afterClosed().subscribe(t=>{t?(console.log("Edit Shipping Cost Dialog result:",t),this.amountToCollectChanged.emit({orderId:e.id,newAmount:t.newAmount,observation:t.observation})):console.log("Edici\xF3n de costo de env\xEDo cancelada.")})}openEditShippingCostModal(e){if(!e.id||e.shipping_cost===void 0||e.shipping_cost===null){console.error("Order ID or current shipping cost is missing for editing.",e),this.snackBar.open("No se puede modificar el costo: faltan datos del pedido.","Cerrar",{duration:3e3});return}this.dialog.open(_i,{width:"500px",data:{orderCode:e.code||e.id.toString(),currentShippingCost:e.shipping_cost},disableClose:!0}).afterClosed().subscribe(t=>{t?(console.log("Edit Shipping Cost Dialog result:",t),this.shippingCostChanged.emit({orderId:e.id,newShippingCost:t.newShippingCost,observation:t.observation})):console.log("Edici\xF3n de costo de env\xEDo cancelada.")})}static \u0275fac=function(r){return new(r||i)};static \u0275cmp=E({type:i,selectors:[["app-order-table"]],viewQuery:function(r,t){if(r&1&&(tt(oi,5),tt(ni,5)),r&2){let d;it(d=rt())&&(t.paginator=d.first),it(d=rt())&&(t.sort=d.first)}},inputs:{orders:"orders",isLoading:"isLoading",totalCount:"totalCount",pageSize:"pageSize",pageIndex:"pageIndex"},outputs:{pageChanged:"pageChanged",sortChanged:"sortChanged",statusChanged:"statusChanged",motorizedChanged:"motorizedChanged",rescheduleChanged:"rescheduleChanged",viewPdfClicked:"viewPdfClicked",viewDetailsClicked:"viewDetailsClicked",amountToCollectChanged:"amountToCollectChanged",shippingCostChanged:"shippingCostChanged",orderChanged:"orderChanged"},features:[wi],decls:46,vars:10,consts:[["orderActionMenu","matMenu"],[1,"table-wrapper","mat-elevation-z4"],["class","spinner-overlay",4,"ngIf"],["mat-table","","matSort","",1,"orders-table",3,"matSortChange","dataSource"],["matColumnDef","code"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","",4,"matCellDef"],["matColumnDef","company"],["mat-cell","","class","truncate-texts",3,"matTooltip",4,"matCellDef"],["matColumnDef","shipment_type"],["mat-cell","",4,"matCellDef"],["matColumnDef","recipient_name"],["matColumnDef","recipient_phone"],["mat-cell","","class","truncate-texts",4,"matCellDef"],["matColumnDef","status"],["mat-header-cell","","mat-sort-header","","class","status-column-header",4,"matHeaderCellDef"],["matColumnDef","delivery_district_name"],["matColumnDef","delivery_address"],["matColumnDef","delivery_date"],["mat-cell","","style","min-width: 120px; border: 0px solid black; text-align: left",4,"matCellDef"],["matColumnDef","motorizado"],["mat-header-cell","","mat-sort-header","motorizado",4,"matHeaderCellDef"],["matColumnDef","amount_to_collect_at_delivery"],["mat-header-cell","","mat-sort-header","","class","align-right",4,"matHeaderCellDef"],["mat-cell","","class","align-right amount-cell",4,"matCellDef"],["matColumnDef","tracking_code"],["matColumnDef","actions"],["mat-header-cell","","class","actions-column-header",4,"matHeaderCellDef"],["mat-cell","","class","actions-cell",4,"matCellDef"],["mat-header-row","","class","header-row-sticky",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","data-row",3,"ngClass",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","","aria-label","Seleccione p\xE1gina de pedidos",3,"page","length","pageSize","pageIndex","pageSizeOptions"],[1,"spinner-overlay"],["mode","indeterminate","diameter","60"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,""],["mat-cell","",1,"truncate-texts",3,"matTooltip"],["mat-cell",""],["mat-cell","",1,"truncate-texts"],["mat-header-cell","","mat-sort-header","",1,"status-column-header"],[1,"status-badge",3,"ngClass"],["style",`
            background-color: #f97c06;
            color: white;
            border-radius: 9px;
            margin: 15px;
            padding: 3px;
          `,4,"ngIf"],[2,"background-color","#f97c06","color","white","border-radius","9px","margin","15px","padding","3px"],["mat-cell","",2,"min-width","120px","border","0px solid black","text-align","left"],["mat-header-cell","","mat-sort-header","motorizado"],["mat-header-cell","","mat-sort-header","",1,"align-right"],["mat-cell","",1,"align-right","amount-cell"],["mat-header-cell","",1,"actions-column-header"],["mat-cell","",1,"actions-cell"],["mat-icon-button","","aria-label","M\xE1s acciones del pedido",1,"action-icon-neutral",3,"matMenuTriggerFor"],["xPosition","before"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],["mat-header-row","",1,"header-row-sticky"],["mat-row","",1,"data-row",3,"ngClass"],[1,"mat-row"],[1,"no-data-cell"]],template:function(r,t){r&1&&(n(0,"div",1),c(1,$o,2,0,"div",2),n(2,"table",3),p("matSortChange",function(m){return t.sortChanged.emit(m)}),P(3,4),c(4,qo,2,0,"th",5)(5,Uo,2,1,"td",6),I(),P(6,7),c(7,jo,2,0,"th",5)(8,Ho,2,2,"td",8),I(),P(9,9),c(10,Wo,2,0,"th",5)(11,Xo,2,1,"td",10),I(),P(12,11),c(13,Ko,2,0,"th",5)(14,Qo,2,2,"td",8),I(),P(15,12),c(16,Yo,2,0,"th",5)(17,Jo,2,1,"td",13),I(),P(18,14),c(19,Zo,2,0,"th",15)(20,en,3,2,"td",10),I(),P(21,16),c(22,tn,2,0,"th",5)(23,on,3,2,"td",10),I(),P(24,17),c(25,nn,2,0,"th",5)(26,an,2,1,"td",10),I(),P(27,18),c(28,ln,2,0,"th",5)(29,dn,3,4,"td",19),I(),P(30,20),c(31,sn,2,0,"th",21)(32,mn,2,1,"td",10),I(),P(33,22),c(34,cn,2,0,"th",23)(35,pn,3,6,"td",24),I(),P(36,25),c(37,un,2,0,"th",5)(38,gn,2,1,"td",10),I(),P(39,26),c(40,_n,2,0,"th",27)(41,On,32,7,"td",28),I(),c(42,En,1,0,"tr",29)(43,yn,1,3,"tr",30)(44,Sn,3,1,"tr",31),o(),n(45,"mat-paginator",32),p("page",function(m){return t.pageChanged.emit(m)}),o()()),r&2&&(l(),s("ngIf",t.isLoading),l(),s("dataSource",t.dataSource),l(40),s("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),l(),s("matRowDefColumns",t.displayedColumns),l(2),s("length",t.totalCount)("pageSize",t.pageSize)("pageIndex",t.pageIndex)("pageSizeOptions",Ai(9,zo)))},dependencies:[y,lt,A,Te,K,ri,Wt,Kt,Zt,Qt,Xt,ei,Yt,Jt,ti,ii,er,ir,oi,or,ni,rr,xe,be,S,Oe,k,z,Qe,Ct,qt,Gt,zt,$t,re,_t,Ve],styles:['[_nghost-%COMP%]{display:block}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;background-color:var(--sys-surface);color:var(--sys-on-surface);margin-top:20px;box-shadow:0 4px 20px #00000014;transition:box-shadow .3s ease-in-out}.table-wrapper[_ngcontent-%COMP%]:hover{box-shadow:0 6px 25px #0000001f}.spinner-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background-color:rgba(var(--sys-surface),.85);display:flex;justify-content:center;align-items:center;z-index:100;border-radius:12px}.orders-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th.mat-header-cell[_ngcontent-%COMP%]{font-weight:600;color:var(--sys-on-surface-variant);background-color:var(--sys-surface-container-low);padding:14px 18px;border-bottom:1px solid var(--sys-outline-variant);text-transform:uppercase;font-size:.8rem;letter-spacing:.5px}td.mat-cell[_ngcontent-%COMP%]{padding:12px 18px;border-bottom:1px solid var(--sys-outline-variant);color:var(--sys-on-surface-variant);font-size:.9rem}.header-row-sticky[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10;background-color:var(--sys-surface-container-low)}.highlight-row[_ngcontent-%COMP%]{background-color:var(--sys-primary-container)!important;font-weight:500}.align-right[_ngcontent-%COMP%]{text-align:right;justify-content:flex-end}.amount-cell[_ngcontent-%COMP%]{font-weight:500}.actions-column-header[_ngcontent-%COMP%]{text-align:center!important}.actions-cell[_ngcontent-%COMP%]{text-align:center;white-space:nowrap}.actions-cell[_ngcontent-%COMP%]   button.mat-icon-button[_ngcontent-%COMP%]{margin:0 2px;color:var(--sys-on-surface-variant);transition:color .2s ease}.actions-cell[_ngcontent-%COMP%]   button.mat-icon-button[_ngcontent-%COMP%]:hover{color:var(--sys-primary)}.action-icon-delivered[_ngcontent-%COMP%]{color:#4caf50}.action-icon-delivered[_ngcontent-%COMP%]:hover{color:#388e3c}.action-icon-neutral[_ngcontent-%COMP%]{color:var(--sys-on-surface-variant)}.action-icon-neutral[_ngcontent-%COMP%]:hover{color:var(--sys-on-surface)}.no-data-cell[_ngcontent-%COMP%]{text-align:center;padding:50px;font-style:italic;color:var(--sys-on-surface-variant);font-size:1rem}.mat-mdc-paginator[_ngcontent-%COMP%]{background-color:var(--sys-surface-container-low);border-bottom-left-radius:12px;border-bottom-right-radius:12px;color:var(--sys-on-surface-variant);border-top:1px solid var(--sys-outline-variant);padding:8px 0}.truncate-text[_ngcontent-%COMP%]{max-width:180px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:inline-block;vertical-align:middle}.code-cell[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#3f51b5;text-decoration:none;font-weight:500}.code-cell[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.status-badge[_ngcontent-%COMP%]{padding:5px 12px;border-radius:16px;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;display:inline-flex;align-items:center;line-height:1}.status-registrado[_ngcontent-%COMP%]{background-color:#6610f2;color:#fff}.status-recogido[_ngcontent-%COMP%]{background-color:#fd7e14;color:#fff}.status-en-almacen[_ngcontent-%COMP%]{background-color:#0d6efd;color:#fff;white-space:nowrap}.status-en-transito[_ngcontent-%COMP%]{background-color:#0c1a77;color:#d0c8c8;white-space:nowrap}.status-entregado[_ngcontent-%COMP%]{background-color:#198754;color:#fff}.status-anulado[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff;white-space:nowrap}.status-cancelado[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.status-rechazado-en-punto[_ngcontent-%COMP%]{background-color:#ff6b6b;color:#fff;white-space:nowrap}.status-reprogramado[_ngcontent-%COMP%]{background-color:#adb5bd;color:#212529}.status-desconocido[_ngcontent-%COMP%]{background-color:#9e9e9e;color:#fff}@media (max-width: 768px){th.mat-header-cell[_ngcontent-%COMP%], td.mat-cell[_ngcontent-%COMP%]{padding:8px 12px;font-size:.75rem}}td.mat-cell[_ngcontent-%COMP%]{padding:10px 16px!important;color:#000!important;font-family:Montserrat,sans-serif!important;border-bottom:1px solid #c11616!important;border-right:1px solid #f0f0f0!important}td.mat-cell[_ngcontent-%COMP%]:last-child{border-right:none}.data-row[_ngcontent-%COMP%]{position:relative;transition:background-color .15s ease-in-out}.data-row[_ngcontent-%COMP%]:hover:not(.row-cancelled-strikethrough){background-color:#eef2f7}.data-row.row-cancelled-strikethrough[_ngcontent-%COMP%]{color:#9e9e9e;opacity:.75}.data-row.row-cancelled-strikethrough[_ngcontent-%COMP%]:after{content:"";position:absolute;left:8px;right:8px;top:50%;height:1.5px;background-color:#d32f2f;transform:translateY(-50%);z-index:1;pointer-events:none}']})};var Dn=(i,e)=>({"success-message":i,"error-message":e});function kn(i,e){if(i&1&&(n(0,"span",17),a(1),o()),i&2){let r=C();l(),M(r.fileName)}}function wn(i,e){if(i&1&&(n(0,"div",18)(1,"p"),a(2),o(),g(3,"mat-progress-bar",19),o()),i&2){let r=C();l(2),_("Importando archivo... ",r.uploadProgress,"%"),l(),s("value",r.uploadProgress)}}function Pn(i,e){if(i&1&&(n(0,"div",26)(1,"mat-icon",27),a(2,"error_outline"),o(),n(3,"div",28),a(4),o()()),i&2){let r=e.$implicit;l(4),Ti(" Fila ",r.row,": ",r.message," ")}}function In(i,e){if(i&1&&(n(0,"div",23)(1,"h4"),a(2,"Detalles de Errores:"),o(),n(3,"mat-list",24),c(4,Pn,5,2,"div",25),o()()),i&2){let r=C(2);l(4),s("ngForOf",r.importResult.errors)}}function Tn(i,e){if(i&1&&(n(0,"div",20)(1,"h3",21),a(2),o(),c(3,In,5,1,"div",22),o()),i&2){let r=C();l(),s("ngClass",Ni(3,Dn,r.importResult.success,!r.importResult.success)),l(),_(" ",r.importResult.message," "),l(),s("ngIf",r.importResult.errors&&r.importResult.errors.length>0)}}var Fn={"TIPO DE ENVIO":"type_order_transfer_to_warehouse","NOMBRE DEL DESTINATARIO":"recipient_name","TELEFONO DESTINATARIO 9 DIGITOS":"recipient_phone",DISTRITO:"delivery_district_name","DIRECCION DE ENTREGA":"delivery_address","FECHA DE ENTREGA (DIA/MES/A\xD1O)":"delivery_date","DETALLE DEL PRODUCTO":"item_description","MONTO A COBRAR":"amount_to_collect_at_delivery","FORMA DE PAGO":"payment_method_for_collection",OBSERVACION:"observations"},hc=Object.keys(Fn),Ci=class i{importCompleted=new w;selectedFile=null;fileName=null;isUploading=!1;uploadProgress=0;importResult=null;orderService=b(W);snackBar=b(Re);dialogRef=b(se);settingsService=b(Hi);destroy$=new Q;enlace=null;constructor(){}ngOnInit(){this.settingsService.loadSettings().pipe(D(this.destroy$)).subscribe({next:e=>{e.length&&(this.enlace=e[0].excel_import_template_url)},error:e=>{console.log("err",e)}})}onFileSelected(e){let t=e.currentTarget.files;t&&t.length>0?(this.selectedFile=t[0],this.fileName=this.selectedFile.name,this.importResult=null,console.log("File selected:",this.selectedFile)):(this.selectedFile=null,this.fileName=null)}downloadTemplate(){return this.snackBar.open("Plantilla con validaci\xF3n descargada.","OK",{duration:2e3}),this.enlace||""}processImport(){return nt(this,null,function*(){if(!this.selectedFile){this.snackBar.open("Por favor, selecciona un archivo Excel.","OK",{duration:3e3,panelClass:["warn-snackbar"]});return}this.isUploading=!0,this.uploadProgress=0,this.importResult=null;let e=setInterval(()=>{this.uploadProgress<90&&(this.uploadProgress+=10)},200);try{let r=yield this.readFileAndParseToJson(this.selectedFile);if(r=r.filter(t=>t.CARGA==="CARGAR"),console.log("Parsed Excel to JSON:",r),r.length===0)throw new Error("El archivo Excel no contiene datos (despu\xE9s de las cabeceras) o el formato es incorrecto.");this.orderService.importOrdersFromParsedJson(r).subscribe({next:t=>{clearInterval(e),this.uploadProgress=100,this.importResult=t,t.success&&t.importedCount&&t.importedCount>0?(this.snackBar.open(t.message,"OK",{duration:4e3,panelClass:["success-snackbar"]}),this.importCompleted.emit(!0)):(this.snackBar.open(t.message||"Algunos pedidos no pudieron ser importados o hubo errores.","OK",{duration:6e3,panelClass:["warn-snackbar"]}),t.errors&&t.errors.length>0&&console.warn("Import errors from backend:",t.errors)),this.isUploading=!1},error:t=>{clearInterval(e),this.isUploading=!1,this.uploadProgress=0,this.importResult={success:!1,message:t.message||"Error en el servidor durante la importaci\xF3n."},this.snackBar.open(this.importResult.message,"OK",{duration:3e3,panelClass:["error-snackbar"]}),console.error("Error importing orders:",t)}})}catch(r){clearInterval(e),this.isUploading=!1,this.uploadProgress=0,this.importResult={success:!1,message:r.message||"Error al procesar el archivo Excel."},this.snackBar.open(this.importResult.message,"OK",{duration:3e3,panelClass:["error-snackbar"]}),console.error("Error processing file:",r)}})}readFileAndParseToJson(e){return new Promise((r,t)=>{if(!e){t(new Error("No se proporcion\xF3 ning\xFAn archivo."));return}let d=new FileReader;d.onload=m=>{try{let u=m.target.result,G=ur(u,{type:"binary",cellDates:!0}),X=G.SheetNames[0];if(!X){t(new Error("El archivo Excel no contiene hojas."));return}let oe=G.Sheets[X],V=li.sheet_to_json(oe,{raw:!1,defval:null});r(V.filter(_e=>Object.values(_e).some(De=>De!==null&&De!=="")))}catch(u){console.error("Error al leer el contenido de la hoja de Excel:",u),t(new Error("No se pudo leer el contenido de la hoja de Excel. Formato incorrecto."))}},d.onerror=m=>{console.error("Error en FileReader:",m),t(new Error("Ocurri\xF3 un error al intentar leer el archivo."))},d.readAsBinaryString(e)})}closeDialog(){this.dialogRef.close()}static \u0275fac=function(r){return new(r||i)};static \u0275cmp=E({type:i,selectors:[["app-order-import-modal"]],outputs:{importCompleted:"importCompleted"},decls:113,vars:8,consts:[["fileInput",""],[1,"import-modal-container"],["mat-dialog-title",""],[1,"mat-typography"],[1,"instructions"],[2,"margin-bottom","10px"],["mat-flat-button","","target","_blank","matTooltip","Descargar la plantilla en formato .xlsx (.xls tambi\xE9n soportado)",1,"template-button","btn-corp-primary",3,"href"],[1,"column-descriptions"],[1,"file-input-container"],["mat-raised-button","",1,"btn-corp-primary",2,"height","60px",3,"click","disabled"],["hidden","","type","file","accept",".xlsx, .xls",3,"change"],["class","file-name-display",4,"ngIf"],["class","upload-progress-container",4,"ngIf"],["class","import-results",4,"ngIf"],["align","end"],["mat-stroked-button","",1,"btn-corp-secondary",3,"click","disabled"],["mat-flat-button","",1,"btn-corp-primary",3,"click","disabled"],[1,"file-name-display"],[1,"upload-progress-container"],["mode","determinate",3,"value"],[1,"import-results"],[3,"ngClass"],["class","error-details",4,"ngIf"],[1,"error-details"],["dense",""],["class","error-item",4,"ngFor","ngForOf"],[1,"error-item"],["matListItemIcon","","color","warn"],[2,"overflow-wrap","break-word !important"]],template:function(r,t){if(r&1){let d=O();n(0,"div",1)(1,"h2",2),a(2,"Importar Pedidos desde Excel"),o(),n(3,"mat-dialog-content",3)(4,"p",4),a(5," Sigue estos pasos para importar tus pedidos de forma masiva: "),o(),n(6,"ol")(7,"li")(8,"div",5),a(9," Descarga la plantilla de Excel para asegurar el formato correcto de los datos. "),o(),n(10,"a",6)(11,"mat-icon"),a(12,"cloud_download"),o(),a(13," Descargar Plantilla "),o()(),n(14,"li"),a(15," Completa la plantilla con la informaci\xF3n de tus pedidos. Aseg\xFArate de que el orden y nombre de las columnas coincidan con la plantilla. "),o(),n(16,"li")(17,"strong"),a(18,"Descripci\xF3n de las Columnas Esperadas en la Plantilla:"),o(),n(19,"ul",7)(20,"li")(21,"strong"),a(22,"TIPO DE ENVIO:"),o(),a(23," Indica la modalidad del env\xEDo. Valores comunes: "),n(24,"code"),a(25,"CONTRAENTREGA"),o(),a(26,", "),n(27,"code"),a(28,"SOLO ENTREGAR"),o(),a(29,","),n(30,"code"),a(31,"CAMBIO"),o(),a(32,","),n(33,"code"),a(34,"RECOJO"),o(),a(35,". *(Esta columna podr\xEDa tener una lista desplegable en la plantilla).* "),o(),n(36,"li")(37,"strong"),a(38,"NOMBRE DEL DESTINATARIO:"),o(),a(39," Nombre completo de la persona que recibir\xE1 el pedido. "),o(),n(40,"li")(41,"strong"),a(42,"TELEFONO DESTINATARIO 9 DIGITOS:"),o(),a(43," N\xFAmero de celular del destinatario, debe contener exactamente 9 d\xEDgitos. "),o(),n(44,"li")(45,"strong"),a(46,"DISTRITO (SELECCIONE SOLO DEL LISTADO):"),o(),a(47," El distrito de entrega. Es crucial seleccionar uno de los distritos v\xE1lidos que se mostrar\xE1n en la lista desplegable de esta columna en la plantilla. "),o(),n(48,"li")(49,"strong"),a(50,"DIRECCION DE ENTREGA:"),o(),a(51," Direcci\xF3n completa y detallada donde se entregar\xE1 el pedido (calle, n\xFAmero, urbanizaci\xF3n, referencia, etc.). "),o(),n(52,"li")(53,"strong"),a(54,"FECHA DE ENTREGA (DIA/MES/A\xD1O):"),o(),a(55," Fecha programada para la entrega del pedido. Utiliza el formato DD/MM/AAAA (ej. 25/12/2023). "),o(),n(56,"li")(57,"strong"),a(58,"DETALLE DEL PRODUCTO:"),o(),a(59,' Descripci\xF3n breve pero clara de lo que se est\xE1 enviando (ej. "Ropa y Zapatillas", "Documentos Urgentes", "Regalo Sorpresa"). '),o(),n(60,"li")(61,"strong"),a(62,"MONTO A COBRAR:"),o(),a(63," Si el env\xEDo es "),n(64,"code"),a(65,"CONTRAENTREGA"),o(),a(66,", indica aqu\xED el monto exacto que el courier debe cobrar al destinatario. Si es "),n(67,"code"),a(68,"SOLO ENTREGAR"),o(),a(69,", este campo puede dejarse vac\xEDo o con 0. "),o(),n(70,"li")(71,"strong"),a(72,"FORMA DE PAGO:"),o(),a(73,' Indica c\xF3mo se realizar\xE1 el pago del "MONTO A COBRAR" si aplica. Ejemplos: '),n(74,"code"),a(75,"EFECTIVO"),o(),a(76,", "),n(77,"code"),a(78,"YAPE"),o(),a(79,", "),n(80,"code"),a(81,"PLIN"),o(),a(82,", "),n(83,"code"),a(84,"TRANSFERENCIA"),o(),a(85,". Si es no se realizar\xE1 cobro, puedes indicarlo con la opcion "),n(86,"code"),a(87,"NO COBRAR"),o()(),n(88,"li")(89,"strong"),a(90,"OBSERVACION:"),o(),a(91,' Cualquier nota o indicaci\xF3n adicional importante para el courier o para la gesti\xF3n del pedido (ej. "Entregar solo al titular", "Llamar antes de llegar", "Paquete fr\xE1gil"). '),o()()(),n(92,"li"),a(93,"Guarda el archivo en formato .xlsx o .xls."),o(),n(94,"li"),a(95,'Selecciona el archivo completo y haz clic en "Importar Pedidos".'),o()(),n(96,"div",8)(97,"button",9),p("click",function(){f(d);let u=F(102);return h(u.click())}),n(98,"mat-icon"),a(99,"attach_file"),o(),a(100," Seleccionar Archivo Excel "),o(),n(101,"input",10,0),p("change",function(u){return f(d),h(t.onFileSelected(u))}),o(),c(103,kn,2,1,"span",11),o(),c(104,wn,4,2,"div",12)(105,Tn,4,6,"div",13),o(),n(106,"mat-dialog-actions",14)(107,"button",15),p("click",function(){return f(d),h(t.closeDialog())}),a(108," Cerrar "),o(),n(109,"button",16),p("click",function(){return f(d),h(t.processImport())}),n(110,"mat-icon"),a(111,"upload"),o(),a(112),o()()()}r&2&&(l(10),s("href",t.enlace,Pi),l(87),s("disabled",t.isUploading),l(6),s("ngIf",t.fileName),l(),s("ngIf",t.isUploading),l(),s("ngIf",t.importResult),l(2),s("disabled",t.isUploading),l(2),s("disabled",!t.selectedFile||t.isUploading),l(3),_(" ",t.isUploading?"Importando...":"Importar Pedidos"," "))},dependencies:[y,lt,He,A,re,ye,ce,me,S,qi,R,k,z,Qi,Ki,jt,Xi,Wi,Qe,Ct],styles:[".import-modal-container[_ngcontent-%COMP%]{width:100%;max-width:650px}mat-dialog-content[_ngcontent-%COMP%]{padding-top:0;line-height:1.6;font-size:.95em;max-height:70vh;overflow-y:auto}.instructions[_ngcontent-%COMP%]{margin-bottom:16px;font-weight:500}ol[_ngcontent-%COMP%]{padding-left:20px;margin-bottom:24px}ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:12px}.template-button[_ngcontent-%COMP%]{margin-left:8px;vertical-align:middle;transform:translateY(-2px)}.file-input-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;margin-bottom:24px;padding:16px;border:1px dashed #ccc;border-radius:4px;background-color:#f9f9f9}@media (max-width: 500px){.file-input-container[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.file-input-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;margin-bottom:8px}}.file-name-display[_ngcontent-%COMP%]{font-style:italic;color:#555;word-break:break-all}.upload-progress-container[_ngcontent-%COMP%]{margin:20px 0}.upload-progress-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:8px;font-weight:500}.import-results[_ngcontent-%COMP%]{margin-top:24px;padding:16px;border-radius:4px;border:1px solid #ddd}.import-results[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;margin-bottom:12px;font-weight:600}.success-message[_ngcontent-%COMP%]{color:#2e7d32;border-left:4px solid #2e7d32;padding-left:12px}.error-message[_ngcontent-%COMP%]{color:#c62828;border-left:4px solid #c62828;padding-left:12px}.error-details[_ngcontent-%COMP%]{margin-top:16px}.error-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:8px;font-size:1em;font-weight:500}.error-item[_ngcontent-%COMP%]{padding-bottom:8px!important;border-bottom:1px dotted #eee}.error-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.error-item[_ngcontent-%COMP%]   .mat-mdc-list-item-line[_ngcontent-%COMP%]{white-space:normal!important}.error-data-preview[_ngcontent-%COMP%]{font-size:.8em;color:#757575;display:block;margin-top:4px}mat-dialog-actions[_ngcontent-%COMP%]{padding:8px 24px 16px!important}@media (max-height: 600px){mat-dialog-content[_ngcontent-%COMP%]{max-height:55vh}}ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px}.column-descriptions[_ngcontent-%COMP%]{list-style-type:disc;margin-top:8px;margin-bottom:16px;font-size:.9em;background-color:#f9f9f9;padding:10px 15px 10px 30px;border-radius:4px}.column-descriptions[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:8px;line-height:1.5}.column-descriptions[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#3f51b5}.column-descriptions[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background-color:#e0e0e0;padding:1px 4px;border-radius:3px;font-family:monospace}"]})};var An="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-TFG-8",Rn=".xlsx",vi=class i{constructor(){}exportAsExcelFile(e,r,t="Sheet1"){if(!e||e.length===0){console.warn("No data provided for Excel export.");return}let d=li.json_to_sheet(e),m={Sheets:{[t]:d},SheetNames:[t]},u=gr(m,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(u,r)}saveAsExcelFile(e,r){let t=new Blob([e],{type:An}),d=window.URL.createObjectURL(t),m=document.createElement("a");m.href=d,m.download=`${r}${Rn}`,document.body.appendChild(m),m.click(),document.body.removeChild(m),window.URL.revokeObjectURL(d)}static \u0275fac=function(r){return new(r||i)};static \u0275prov=ki({token:i,factory:i.\u0275fac,providedIn:"root"})};function Nn(i,e){if(i&1){let r=O();n(0,"div",8)(1,"mat-slide-toggle",9),p("change",function(d){f(r);let m=C();return h(m.onToggleMyOrders(d))}),a(2," Mis pedidos "),o()()}if(i&2){let r=C();l(),s("checked",r.showMyOrders)}}var bi=class i{orderService=b(W);snackBar=b(Re);dialog=b(Ut);excelExportService=b(vi);datePipe=b(K);appStore=b(Ke);orders=[];isLoading=!1;totalOrderCount=0;currentPageIndex=0;currentPageSize=10;currentSortField="registration_date";currentSortDirection="desc";showMyOrders=!1;isExpress=!1;now=new Date;firstDay=new Date(this.now.getFullYear(),this.now.getMonth(),1);lastDay=new Date(this.now.getFullYear(),this.now.getMonth()+1,0);filterCriteriaSubject=new Mi({start_date:this.datePipe.transform(this.firstDay,"yyyy-MM-dd"),end_date:this.datePipe.transform(this.lastDay,"yyyy-MM-dd"),status:null});destroy$=new Q;constructor(){}ngOnInit(){this.filterCriteriaSubject.pipe(D(this.destroy$),he(()=>this.currentPageIndex=0)).subscribe(()=>{this.fetchOrders()})}isDriver(){return this.appStore.currentUser()?.role==="MOTORIZADO"}onToggleMyOrders(e){this.showMyOrders=e.checked;let r=this.filterCriteriaSubject.value;this.filterCriteriaSubject.next(et(fe({},r),{myOrders:this.showMyOrders}))}onToggleIsExpress(e){this.isExpress=e.checked;let r=this.filterCriteriaSubject.value;this.filterCriteriaSubject.next(et(fe({},r),{isExpress:this.isExpress}))}getAllFilteredOrdersForExport(){return nt(this,null,function*(){try{let e=this.filterCriteriaSubject.value;return(yield Si(this.orderService.getOrders2(e,this.currentSortField,this.currentSortDirection).pipe(D(this.destroy$))))||[]}catch(e){return console.error("Error fetching all filtered orders for export:",e),this.snackBar.open("Failed to fetch data for export.","Close",{duration:3e3,panelClass:["error-snackbar"]}),[]}})}exportDataToExcel(){return nt(this,null,function*(){this.isLoading=!0,this.snackBar.open("Preparando la exportaci\xF3n a Excel, esto puede tardar un momento...","",{duration:0});try{let e=yield this.getAllFilteredOrdersForExport();if(e&&e.length>0){let r=e.map(t=>({"TIPO DE ENVIO":t.shipment_type,"NOMBRE DEL DESTINATARIO":t.recipient_name,"TELEFONO DESTINATARIO 9 DIGITOS":t.recipient_phone,DISTRITO:t.delivery_district_name,"DIRECCION DE ENTREGA":t.delivery_address,"FECHA DE REGISTRO":t.createdAt?this.datePipe.transform(t.createdAt,"dd/MM/yyyy"):"N/A","FECHA DE ENTREGA":t.delivery_date,"DETALLE DEL PRODUCTO":t.item_description,"COSTO DE ENVIO":t.shipping_cost,"MONTO A COBRAR":t.amount_to_collect_at_delivery,"FORMA DE PAGO":t.payment_method_for_collection,OBSERVACION:t.observations||""}));this.excelExportService.exportAsExcelFile(r,"Listado_Pedidos_Filtrados","Pedidos"),this.snackBar.dismiss(),this.snackBar.open("\xA1Archivo Excel exportado exitosamente!","OK",{duration:3500,panelClass:["success-snackbar"]})}else this.snackBar.dismiss(),this.snackBar.open("No hay datos disponibles para exportar con los filtros actuales.","OK",{duration:3e3})}catch(e){console.error("Error during Excel export process:",e),this.snackBar.dismiss(),this.snackBar.open("An error occurred during Excel export.","Close",{duration:3e3,panelClass:["error-snackbar"]})}finally{this.isLoading=!1}})}exportDataToExcel2(){return nt(this,null,function*(){this.isLoading=!0,this.snackBar.open("Preparando la exportaci\xF3n a Excel, esto puede tardar un momento...","",{duration:0});let e=yield Si(this.orderService.getStandardPackageMeasurements().pipe(D(this.destroy$)));try{let r=yield this.getAllFilteredOrdersForExport();if(r&&r.length>0){let t=r.map(d=>{let m=e.sta_height_cm,u=e.sta_length_cm,G=e.sta_width_cm,X=e.sta_weight_kg;return d.package_size_type==="custom"&&(m=d.package_height_cm,u=d.package_length_cm,G=d.package_width_cm,X=d.package_weight_kg),{pedido_id:d.code,peso_kg:X,largo_cm:u,ancho_cm:G,alto_cm:m,direccion:d.delivery_address+"-"+d.delivery_district_name}});this.excelExportService.exportAsExcelFile(t,"Listado_Pedidos_Filtrados","Pedidos"),this.snackBar.dismiss(),this.snackBar.open("\xA1Archivo Excel exportado exitosamente!","OK",{duration:3500,panelClass:["success-snackbar"]})}else this.snackBar.dismiss(),this.snackBar.open("No hay datos disponibles para exportar con los filtros actuales.","OK",{duration:3e3})}catch(r){console.error("Error during Excel export process:",r),this.snackBar.dismiss(),this.snackBar.open("An error occurred during Excel export.","Close",{duration:3e3,panelClass:["error-snackbar"]})}finally{this.isLoading=!1}})}fetchOrders(){this.isLoading=!0;let e=this.filterCriteriaSubject.value,r=fe({},e);this.showMyOrders?r.myOrders=!0:delete r.myOrders,console.log(e,this.isExpress),this.isExpress?r.isExpress=!0:delete r.isExpress,this.orderService.getOrders(r,this.currentPageIndex+1,this.currentPageSize,this.currentSortField,this.currentSortDirection).pipe(D(this.destroy$),ke(t=>(this.snackBar.open(t.message||"Failed to load orders.","Close",{duration:5e3,panelClass:["error-snackbar"]}),this.isLoading=!1,[]))).subscribe(t=>{this.orders=t.items,this.totalOrderCount=t.total_count||0,this.isLoading=!1,console.log("Orders fetched:",t)})}openImportModal(){let e=this.dialog.open(Ci,{width:"90%",maxWidth:"700px",autoFocus:!1});e.componentInstance.importCompleted.subscribe(r=>{r&&(console.log("Import completed, reloading orders..."),this.fetchOrders())}),e.afterClosed().subscribe(r=>{console.log("The import dialog was closed",r)})}handleEditOrderChanged(e){this.fetchOrders()}handleStatusChanged(e){this.isLoading=!0,console.log("OrderListPage: Status change requested",e),this.orderService.updateOrderStatus(e.orderId,e.newStatus,e.reason||"",e.proofOfDeliveryImageUrl,e.shippingCostPaymentMethod,e.collectionPaymentMethod).subscribe({next:r=>{this.snackBar.open(`Estado del pedido ${r.code} actualizado a ${e.newStatus}.`,"OK",{duration:3e3,panelClass:["success-snackbar"]}),this.fetchOrders()},error:r=>{this.snackBar.open(`Error al actualizar estado: ${r.message||"Intente de nuevo"}`,"Cerrar",{duration:5e3,panelClass:["error-snackbar"]}),this.isLoading=!1},complete:()=>{this.isLoading=!1}})}handleMotorizedChanged(e){console.log("orderId",e.orderId),console.log("motorizedId",e.motorizedId),this.orderService.assignDriverToOrder(e.orderId,e.motorizedId).subscribe({next:r=>{this.snackBar.open(`Motorizado ${r.assigned_driver?.username} asignado al pedido ${r.code}.`,"OK",{duration:3e3,panelClass:["success-snackbar"]}),this.fetchOrders()},error:r=>{this.snackBar.open(`Error al asignar motorizado: ${r.message||"Intente de nuevo"}`,"Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}})}handleRescheduleChanged(e){let r=new Date(e.newDate).toISOString();this.orderService.rescheduleOrder(e.orderId,r||"",e.reason).subscribe({next:t=>{this.snackBar.open(`Pedido ${t.code} reprogramado para ${this.datePipe.transform(t.delivery_date,"dd/MM/yyyy")}.`,"OK",{duration:3500,panelClass:["success-snackbar"]}),this.fetchOrders()},error:t=>{this.snackBar.open(`Error al reprogramar pedido: ${t.message||"Intente de nuevo"}`,"Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}})}handleAmountToCollectChanged(e){this.isLoading=!0,console.log("OrderListPage: Shipping cost change requested",e),this.orderService.updateOrderAmountToCollect(e.orderId,e.newAmount,e.observation).subscribe({next:r=>{this.snackBar.open(`Monto a cobrar del pedido ${r.code} actualizado.`,"OK",{duration:3e3,panelClass:["success-snackbar"]}),this.fetchOrders()},error:r=>{this.snackBar.open(`Error al actualizar costo: ${r.message||"Intente de nuevo"}`,"Cerrar",{duration:5e3,panelClass:["error-snackbar"]}),this.isLoading=!1},complete:()=>{this.isLoading=!1}})}handleShippingCostChanged(e){this.isLoading=!0,console.log("OrderListPage: Shipping cost change requested",e),this.orderService.updateOrderShippingCost(e.orderId,e.newShippingCost,e.observation).subscribe({next:r=>{this.snackBar.open(`Costo de env\xEDo del pedido ${r.code} actualizado.`,"OK",{duration:3e3,panelClass:["success-snackbar"]}),this.fetchOrders()},error:r=>{this.snackBar.open(`Error al actualizar costo: ${r.message||"Intente de nuevo"}`,"Cerrar",{duration:5e3,panelClass:["error-snackbar"]}),this.isLoading=!1},complete:()=>{this.isLoading=!1}})}onFiltersChanged(e){console.log("OrderListPage: Filters changed",e),this.filterCriteriaSubject.next(e)}onPageChanged(e){console.log("OrderListPage: Page changed",e),this.currentPageIndex=e.pageIndex,this.currentPageSize=e.pageSize,this.fetchOrders()}onSortChanged(e){console.log("OrderListPage: Sort changed",e),this.currentSortField=e.active,this.currentSortDirection=e.direction,this.currentPageIndex=0,this.fetchOrders()}handleMassiveActions(e){console.log("Massive action selected:",e),this.snackBar.open(`Action: ${e} not implemented yet.`,"OK",{duration:3e3})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(r){return new(r||i)};static \u0275cmp=E({type:i,selectors:[["app-order-list-page"]],decls:26,vars:8,consts:[["massiveActionsMenu","matMenu"],[1,"page-content-wrapper"],[1,"page-title-bar"],[1,"page-title"],[1,"breadcrumbs"],[3,"filtersChanged"],[1,"table-controls-bar"],["class","my-orders-toggle",4,"ngIf"],[1,"my-orders-toggle"],[3,"change","checked"],[1,"records-info"],[1,"actions-group"],["mat-flat-button","",1,"btn-corp-primary","acciones-masivas",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[3,"pageChanged","sortChanged","statusChanged","motorizedChanged","rescheduleChanged","amountToCollectChanged","shippingCostChanged","orderChanged","orders","isLoading","totalCount","pageSize","pageIndex"]],template:function(r,t){if(r&1){let d=O();n(0,"div",1)(1,"div",2)(2,"h1",3),a(3,"Listado de pedidos"),o(),g(4,"div",4),o(),n(5,"app-order-filters",5),p("filtersChanged",function(u){return f(d),h(t.onFiltersChanged(u))}),o(),n(6,"div",6),c(7,Nn,3,1,"div",7),n(8,"div",8)(9,"mat-slide-toggle",9),p("change",function(u){return f(d),h(t.onToggleIsExpress(u))}),a(10," Pedidos Express "),o()(),g(11,"div",10),n(12,"div",11)(13,"button",12),a(14," Acciones Masivas "),n(15,"mat-icon"),a(16,"arrow_drop_down"),o()(),n(17,"mat-menu",null,0)(19,"button",13),p("click",function(){return f(d),h(t.exportDataToExcel())}),a(20," Exportar a Excel "),o(),n(21,"button",13),p("click",function(){return f(d),h(t.exportDataToExcel2())}),a(22," Exportar para el sistema de planificaci\xF3n rutas "),o(),n(23,"button",13),p("click",function(){return f(d),h(t.openImportModal())}),a(24," Importar desde Excel "),o()()()(),n(25,"app-order-table",14),p("pageChanged",function(u){return f(d),h(t.onPageChanged(u))})("sortChanged",function(u){return f(d),h(t.onSortChanged(u))})("statusChanged",function(u){return f(d),h(t.handleStatusChanged(u))})("motorizedChanged",function(u){return f(d),h(t.handleMotorizedChanged(u))})("rescheduleChanged",function(u){return f(d),h(t.handleRescheduleChanged(u))})("amountToCollectChanged",function(u){return f(d),h(t.handleAmountToCollectChanged(u))})("shippingCostChanged",function(u){return f(d),h(t.handleShippingCostChanged(u))})("orderChanged",function(u){return f(d),h(t.handleEditOrderChanged(u))}),o()()}if(r&2){let d=F(18);l(7),s("ngIf",t.isDriver()),l(2),s("checked",t.isExpress),l(4),s("matMenuTriggerFor",d),l(12),s("orders",t.orders)("isLoading",t.isLoading)("totalCount",t.totalOrderCount)("pageSize",t.currentPageSize)("pageIndex",t.currentPageIndex)}},dependencies:[y,A,Nt,di,hi,_t,S,R,k,z,qt,Gt,zt,$t,ar,nr],styles:[".page-content-wrapper[_ngcontent-%COMP%]{padding:20px 24px;background-color:var(--sys-surface-container-lowest);color:var(--sys-on-surface);min-height:calc(100vh - 64px)}.page-title-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px}.page-title[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:var(--sys-on-surface);margin:0}.breadcrumbs[_ngcontent-%COMP%]{font-size:14px;color:var(--sys-on-surface-variant)}.breadcrumbs[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--sys-primary);text-decoration:none}.breadcrumbs[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.breadcrumbs[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:5px}.table-controls-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;background-color:var(--sys-surface-container-low);padding:8px 16px}.records-info[_ngcontent-%COMP%]{font-size:.9em;color:#555}.actions-group[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.orders-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:20px}.acciones-masivas[_ngcontent-%COMP%]{padding:25px!important}@media (min-width: 768px){.orders-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}.acciones-masivas[_ngcontent-%COMP%]{padding:20px!important}}"]})};var xr=(i,e)=>e.id;function Vn(i,e){if(i&1){let r=O();n(0,"button",43),p("click",function(){f(r);let d=C(2);return h(d.clearDriverSelection())}),n(1,"mat-icon"),a(2,"close"),o()()}}function Ln(i,e){i&1&&(n(0,"mat-icon",12),a(1,"person_search"),o())}function Bn(i,e){i&1&&g(0,"mat-progress-spinner",44)}function zn(i,e){if(i&1&&(n(0,"mat-option",22)(1,"div",45)(2,"span"),a(3),o()()()),i&2){let r=e.$implicit;s("value",r),l(3),M(r.username)}}function Gn(i,e){i&1&&(n(0,"mat-option",23),a(1,"No se encontraron motorizados."),o())}function $n(i,e){i&1&&(n(0,"mat-error"),a(1,"Requerido"),o())}function qn(i,e){if(i&1){let r=O();n(0,"mat-form-field",41)(1,"mat-label"),a(2,"Buscar y Seleccionar empresa"),o(),g(3,"input",42),c(4,Vn,3,0,"button",18)(5,Ln,2,0,"mat-icon",19)(6,Bn,1,0,"mat-progress-spinner",20),n(7,"mat-autocomplete",21,2),p("optionSelected",function(d){f(r);let m=C();return h(m.onDriverSelected(d))}),qe(9,zn,4,2,"mat-option",22,xr),v(11,"async"),c(12,Gn,2,0,"mat-option",23),v(13,"async"),o(),c(14,$n,2,0,"mat-error",13),o()}if(i&2){let r,t,d=F(8),m=C();l(3),s("formControl",m.driverSearchCtrl)("matAutocomplete",d),l(),s("ngIf",m.driverSearchCtrl.value&&!m.isLoadingDrivers),l(),s("ngIf",!m.driverSearchCtrl.value&&!m.isLoadingDrivers),l(),s("ngIf",m.isLoadingDrivers),l(),s("displayWith",m.displayDriverName),l(2),Ue(T(11,8,m.filteredDrivers$)),l(3),L(((r=T(13,10,m.filteredDrivers$))==null?null:r.length)===0&&!m.isLoadingDrivers&&m.driverSearchCtrl.value?12:-1),l(2),s("ngIf",(t=m.orderForm.get("company_id"))==null?null:t.hasError("required"))}}function Un(i,e){if(i&1&&(n(0,"mat-option",22),a(1),o()),i&2){let r=e.$implicit;s("value",r),l(),M(r)}}function jn(i,e){i&1&&(n(0,"mat-error"),a(1,"Requerido"),o())}function Hn(i,e){i&1&&(n(0,"mat-error"),a(1,"Requerido"),o())}function Wn(i,e){i&1&&(n(0,"mat-error"),a(1,"Tel\xE9fono inv\xE1lido"),o())}function Xn(i,e){if(i&1){let r=O();n(0,"button",43),p("click",function(){f(r);let d=C();return h(d.clearDistrictSelection())}),n(1,"mat-icon"),a(2,"close"),o()()}}function Kn(i,e){i&1&&(n(0,"mat-icon",12),a(1,"person_search"),o())}function Qn(i,e){i&1&&g(0,"mat-progress-spinner",44)}function Yn(i,e){if(i&1&&(n(0,"mat-option",22)(1,"div",45)(2,"span"),a(3),o()()()),i&2){let r=e.$implicit;s("value",r),l(3),M(r.name_and_price)}}function Jn(i,e){i&1&&(n(0,"mat-option",23),a(1,"No se encontraron distritos."),o())}function Zn(i,e){i&1&&(n(0,"mat-error"),a(1,"Requerido"),o())}function ea(i,e){i&1&&(n(0,"mat-error"),a(1,"Requerido"),o())}function ta(i,e){i&1&&(n(0,"mat-error"),a(1,"M\xEDnimo 6 caracteres"),o())}function ia(i,e){i&1&&(n(0,"mat-error"),a(1,"Requerido"),o())}function ra(i,e){i&1&&g(0,"mat-progress-spinner",46)}function oa(i,e){i&1&&(n(0,"mat-error"),a(1,"Requerido"),o())}function na(i,e){i&1&&(n(0,"mat-error"),a(1,"Requerido"),o())}function aa(i,e){i&1&&(n(0,"mat-error"),a(1,"Monto no puede ser negativo"),o())}function la(i,e){if(i&1&&(n(0,"mat-option",22),a(1),o()),i&2){let r=e.$implicit;s("value",r),l(),M(r)}}var Tt=class i{orderSubmit=new w;formValidityChanged=new w;orderForm;minDeliveryDate;shipmentTypes=["CONTRAENTREGA","SOLO ENTREGAR","CAMBIO","RECOJO"];paymentMethodsForCollection=["NO COBRAR","EFECTIVO","YAPE","PLIN","TRANSFERENCIA"];isCalculatingShipping=Ce(!1);appStore=b(Ke);selectedDistrictName=()=>{let e=this.orderForm?.get("delivery_district_id")?.value;return!e||!this.districtsCache?"":this.districtsCache.find(r=>r.id===e)?.name||""};orderService=b(W);fb=b(de);destroy$=new Q;districtsCache=[];drivers$=Se([]);isLoadingDrivers=!1;driverSearchCtrl=new Me("");filteredDrivers$;ditricts$=Se([]);isLoadingDistricts=!1;districSearchCtrl=new Me("");filteredDistricts$;constructor(){this.minDeliveryDate=new Date,this.orderService.getDeliveryDistricts().subscribe(e=>{this.districtsCache=e}),this.buildForm(),this.filteredDrivers$=this.driverSearchCtrl.valueChanges.pipe(Pe(""),we(900),ae(),$e(e=>(this.isLoadingDrivers=!0,console.log("searchTerm",e),this.orderService.getCompanies(e||"").pipe(he(()=>this.isLoadingDrivers=!1),ke(()=>(this.isLoadingDrivers=!1,Se([])))))),D(this.destroy$)),this.filteredDistricts$=this.districSearchCtrl.valueChanges.pipe(Pe(""),we(900),$e(e=>(this.isLoadingDistricts=!0,console.log("searchTerm",e),this.orderService.getDistricts(e||"",this.orderForm.get("isExpress")?.value).pipe(he(()=>this.isLoadingDistricts=!1),ke(()=>(this.isLoadingDistricts=!1,Se([])))))),D(this.destroy$))}getCheckboxValue(){this.districSearchCtrl.setValue("",{emitEvent:!0}),this.orderForm.markAllAsTouched(),this.orderForm.get("delivery_district_id")?.setValue(null,{emitEvent:!0}),this.packageDetailsFormGroup.get("package_size_type")?.setValue("standard",{emitEvent:!0}),this.orderService.getDeliveryDistricts(this.orderForm.get("isExpress")?.value).subscribe(e=>{this.districtsCache=e}),console.log("test"),console.log(this.getFormErrors(this.orderForm))}isCompany(){return this.appStore.currentUser()?.role==="EMPRESA"}displayDriverName(e){return e&&e.username?e.username:""}onDriverSelected(e){this.orderForm.get("company_id")?.setValue(e.option.value.id),this.orderForm.markAllAsTouched()}clearDriverSelection(){this.driverSearchCtrl.setValue(""),this.orderForm.markAllAsTouched(),this.orderForm.get("company_id")?.setValue(null)}displayDistricName(e){return e&&e.name_and_price?e.name_and_price:""}onDistrictSelected(e){this.orderForm.get("delivery_district_id")?.setValue(e.option.value.id),this.orderForm.markAllAsTouched()}clearDistrictSelection(){this.districSearchCtrl.setValue(""),this.orderForm.markAllAsTouched(),this.orderForm.get("delivery_district_id")?.setValue(null)}ngOnInit(){this.orderForm.statusChanges.pipe(D(this.destroy$),ae()).subscribe(e=>{this.formValidityChanged.emit(e==="VALID")}),this.orderForm.get("delivery_district_id")?.valueChanges.pipe(D(this.destroy$),ae()).subscribe(e=>{if(console.log("District changed to:",e),e)if(this.packageDetailsFormGroup.get("package_size_type")?.value==="standard"){let t=this.districtsCache.find(d=>d.id===e);t&&this.orderForm.get("shipping_cost")?.setValue(parseFloat(t.price))}else this.orderForm.get("shipping_cost")?.setValue(0)}),this.packageDetailsFormGroup.get("package_size_type")?.valueChanges.pipe(D(this.destroy$),ae()).subscribe(e=>{console.log("type",e);let r=this.orderForm.get("delivery_district_id")?.value;if(r&&e==="standard"){let t=this.districtsCache.find(d=>d.id===r);t&&this.orderForm.get("shipping_cost")?.setValue(parseFloat(t.price))}else this.orderForm.get("shipping_cost")?.setValue(0)})}get packageDetailsFormGroup(){return this.orderForm.get("package_details")}buildForm(){let e=null;this.isCompany()&&(e=this.appStore.currentUser()?.id),this.orderForm=this.fb.group({isExpress:[!1],shipment_type:[this.shipmentTypes[0],x.required],recipient_name:["",x.required],recipient_phone:["",[x.required,x.pattern("^[0-9]{9}$")]],company_id:[e,x.required],delivery_district_id:[null,x.required],delivery_address:["",[x.required,x.minLength(6)]],delivery_coordinates:[""],delivery_date:[null,x.required],package_details:this.fb.group({package_size_type:["standard",x.required],package_width_cm:[0],package_length_cm:[0],package_height_cm:[0],package_weight_kg:[0]}),shipping_cost:[0],item_description:["",x.required],amount_to_collect_at_delivery:[0,[x.required,x.min(0)]],payment_method_for_collection:[this.paymentMethodsForCollection[0],x.required],observations:[""]})}onShippingCostCalculated(e){this.orderForm.get("shipping_cost")?.setValue(e),console.log("Shipping cost updated in OrderCreationForm:",e)}onPackageCalculationLoading(e){this.isCalculatingShipping.set(e)}onSubmit(){if(this.orderForm.invalid){this.orderForm.markAllAsTouched(),console.log("Order form is invalid:",this.getFormErrors(this.orderForm)),alert("Por favor complete todos los campos requeridos.");return}if(this.orderForm.get("shipping_cost")?.value===0){alert("El costo de env\xEDo no puede ser 0.");return}let e=this.orderForm.getRawValue(),r=et(fe(fe({},e),e.package_details),{shipping_cost:this.orderForm.get("shipping_cost")?.value,delivery_district_name:this.selectedDistrictName(),temp_id:`temp-${Date.now()}-${Math.random().toString(36).substring(2,7)}`});console.log("Submitting New Order Data:",r),this.orderSubmit.emit(r)}resetFormForNextOrder(){this.driverSearchCtrl.setValue(""),this.districSearchCtrl.setValue("");let e=null;this.isCompany()&&(e=this.orderForm.get("company_id")?.value);let r=this.orderForm.get("shipment_type")?.value||this.shipmentTypes[0],t=this.paymentMethodsForCollection[0];this.orderForm.reset({isExpress:!1,company_id:e,shipment_type:r,delivery_date:null,package_details:{package_size_type:"standard"},shipping_cost:0,amount_to_collect_at_delivery:0,payment_method_for_collection:t}),this.packageDetailsFormGroup.get("package_size_type")?.setValue("standard",{emitEvent:!0}),this.formValidityChanged.emit(this.orderForm.valid)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}getFormErrors(e){let r={};return Object.keys(e.controls).forEach(t=>{let d=e.get(t)?.errors;if(d&&(r[t]=d),e.get(t)instanceof Lt){let m=this.getFormErrors(e.get(t));Object.keys(m).length>0&&(r[t]=m)}}),r}static \u0275fac=function(r){return new(r||i)};static \u0275cmp=E({type:i,selectors:[["app-order-creation-form"]],outputs:{orderSubmit:"orderSubmit",formValidityChanged:"formValidityChanged"},features:[je([ft(),K])],decls:107,vars:37,consts:[["autoDistric","matAutocomplete"],["deliveryDatePicker",""],["autoDriver","matAutocomplete"],[1,"order-creation-form",3,"ngSubmit","formGroup"],[1,"form-section-title"],["formControlName","isExpress","color","primary",1,"standard-checkbox",3,"click"],["appearance","outline","class","full-width driver-search-field",4,"ngIf"],[1,"form-grid"],["appearance","outline"],["formControlName","shipment_type"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","recipient_name","placeholder","Nombre completo"],["matSuffix",""],[4,"ngIf"],["matInput","","formControlName","recipient_phone","type","tel","placeholder",""],["align","end"],["appearance","outline",1,"driver-search-field"],["type","text","placeholder","Escriba el nombre del distrito...","aria-label","distrito","matInput","",3,"formControl","matAutocomplete"],["matSuffix","","mat-icon-button","","aria-label","Limpiar",3,"click",4,"ngIf"],["matSuffix","",4,"ngIf"],["matSuffix","","mode","indeterminate","diameter","20",4,"ngIf"],[3,"optionSelected","displayWith"],[3,"value"],["disabled",""],["appearance","outline",1,"full-span-column"],["matInput","","formControlName","delivery_address","placeholder","Ingresar lugar de entrega (M\xEDnimo 6 caracteres)"],["matInput","","formControlName","delivery_coordinates","placeholder","-12.070,-77.012"],["matInput","","formControlName","delivery_date",3,"matDatepicker","min"],["matSuffix","",3,"for"],[1,"section-divider"],[3,"shippingCostCalculated","calculationLoading","packageFormGroup","districtsCache","deliveryDistrictId"],[1,"shipping-cost-display"],[1,"cost-value"],["mode","indeterminate","diameter","20","class","cost-spinner",4,"ngIf"],["matInput","","formControlName","item_description","placeholder","Detalle del pedido"],["matInput","","formControlName","amount_to_collect_at_delivery","type","number","min","0","placeholder","S/"],["matPrefix",""],["formControlName","payment_method_for_collection"],["matInput","","formControlName","observations","placeholder","\xBFQu\xE9 env\xEDas?...","rows","3"],[1,"add-order-button-container"],["mat-flat-button","","type","submit",1,"btn-corp-primary",3,"disabled"],["appearance","outline",1,"full-width","driver-search-field"],["type","text","placeholder","Escriba el nombre del la empresa...","aria-label","cliente","matInput","",3,"formControl","matAutocomplete"],["matSuffix","","mat-icon-button","","aria-label","Limpiar",3,"click"],["matSuffix","","mode","indeterminate","diameter","20"],[1,"driver-option"],["mode","indeterminate","diameter","20",1,"cost-spinner"]],template:function(r,t){if(r&1){let d=O();n(0,"form",3),p("ngSubmit",function(){return f(d),h(t.onSubmit())}),n(1,"h2",4),a(2,"Registrar pedido"),o(),n(3,"mat-checkbox",5),p("click",function(){return f(d),h(t.getCheckboxValue())}),a(4," Express "),o(),c(5,qn,15,12,"mat-form-field",6),n(6,"div",7)(7,"mat-form-field",8)(8,"mat-label"),a(9,"Tipo de env\xEDo"),o(),n(10,"mat-select",9),c(11,Un,2,2,"mat-option",10),o()(),n(12,"mat-form-field",8)(13,"mat-label"),a(14,"Nombre del destinatario"),o(),g(15,"input",11),n(16,"mat-icon",12),a(17,"person_outline"),o(),c(18,jn,2,0,"mat-error",13),o(),n(19,"mat-form-field",8)(20,"mat-label"),a(21,"Tel\xE9fono del destinatario"),o(),g(22,"input",14),n(23,"mat-icon",12),a(24,"phone_outline"),o(),n(25,"mat-hint",15),a(26,"No se debe agregar el +51"),o(),c(27,Hn,2,0,"mat-error",13)(28,Wn,2,0,"mat-error",13),o(),n(29,"mat-form-field",16)(30,"mat-label"),a(31,"Buscar y Seleccionar distrito"),o(),g(32,"input",17),c(33,Xn,3,0,"button",18)(34,Kn,2,0,"mat-icon",19)(35,Qn,1,0,"mat-progress-spinner",20),n(36,"mat-autocomplete",21,0),p("optionSelected",function(u){return f(d),h(t.onDistrictSelected(u))}),qe(38,Yn,4,2,"mat-option",22,xr),v(40,"async"),c(41,Jn,2,0,"mat-option",23),v(42,"async"),o(),c(43,Zn,2,0,"mat-error",13),o(),n(44,"mat-form-field",24)(45,"mat-label"),a(46,"Direcci\xF3n de entrega"),o(),g(47,"input",25),n(48,"mat-hint",15),a(49,"No acepta caracteres especiales se borran autom\xE1ticos"),o(),c(50,ea,2,0,"mat-error",13)(51,ta,2,0,"mat-error",13),o(),n(52,"mat-form-field",8)(53,"mat-label"),a(54,"Coordenadas (Opcional)"),o(),g(55,"input",26),n(56,"mat-icon",12),a(57,"location_on_outline"),o()(),n(58,"mat-form-field",8)(59,"mat-label"),a(60,"Fecha Entrega"),o(),g(61,"input",27)(62,"mat-datepicker-toggle",28)(63,"mat-datepicker",null,1),c(65,ia,2,0,"mat-error",13),o()(),g(66,"mat-divider",29),n(67,"app-package-calculator",30),p("shippingCostCalculated",function(u){return f(d),h(t.onShippingCostCalculated(u))})("calculationLoading",function(u){return f(d),h(t.onPackageCalculationLoading(u))}),o(),n(68,"div",31),a(69," Costo de env\xEDo = "),n(70,"span",32),a(71),v(72,"number"),o(),c(73,ra,1,0,"mat-progress-spinner",33),o(),g(74,"mat-divider",29),n(75,"div",7)(76,"mat-form-field",24)(77,"mat-label"),a(78,"\xBFQu\xE9 env\xEDa?"),o(),g(79,"input",34),n(80,"mat-icon",12),a(81,"inventory_2_outline"),o(),c(82,oa,2,0,"mat-error",13),o(),n(83,"mat-form-field",8)(84,"mat-label"),a(85,"Monto total a cobrar"),o(),g(86,"input",35),n(87,"span",36),a(88,"S/ "),o(),c(89,na,2,0,"mat-error",13)(90,aa,2,0,"mat-error",13),o(),n(91,"mat-form-field",8)(92,"mat-label"),a(93,"M\xE9todo de Pago (para cobro en entrega)"),o(),n(94,"mat-select",37),c(95,la,2,2,"mat-option",10),o()(),n(96,"mat-form-field",24)(97,"mat-label"),a(98,"Observaciones (Opcional)"),o(),g(99,"textarea",38),o()(),n(100,"div",39)(101,"button",40)(102,"mat-icon"),a(103,"add_shopping_cart"),o(),a(104," AGREGAR PEDIDO AL LISTADO "),n(105,"mat-icon"),a(106,"arrow_downward"),o()()()()}if(r&2){let d,m,u,G,X,oe,V,_e,De,ze,Dt,kt,wt,Ei=F(37),Ft=F(64);s("formGroup",t.orderForm),l(5),s("ngIf",!t.isCompany()),l(6),s("ngForOf",t.shipmentTypes),l(7),s("ngIf",(d=t.orderForm.get("recipient_name"))==null?null:d.hasError("required")),l(9),s("ngIf",(m=t.orderForm.get("recipient_phone"))==null?null:m.hasError("required")),l(),s("ngIf",(u=t.orderForm.get("recipient_phone"))==null?null:u.hasError("pattern")),l(4),s("formControl",t.districSearchCtrl)("matAutocomplete",Ei),l(),s("ngIf",t.districSearchCtrl.value&&!t.isLoadingDistricts),l(),s("ngIf",!t.districSearchCtrl.value&&!t.isLoadingDistricts),l(),s("ngIf",t.isLoadingDistricts),l(),s("displayWith",t.displayDistricName),l(2),Ue(T(40,30,t.filteredDistricts$)),l(3),L(((G=T(42,32,t.filteredDistricts$))==null?null:G.length)===0&&!t.isLoadingDistricts&&t.districSearchCtrl.value?41:-1),l(2),s("ngIf",(X=t.orderForm.get("delivery_district_id"))==null?null:X.hasError("required")),l(7),s("ngIf",(oe=t.orderForm.get("delivery_address"))==null?null:oe.hasError("required")),l(),s("ngIf",(V=t.orderForm.get("delivery_address"))==null?null:V.hasError("minlength")),l(10),s("matDatepicker",Ft)("min",t.minDeliveryDate),l(),s("for",Ft),l(3),s("ngIf",(_e=t.orderForm.get("delivery_date"))==null?null:_e.hasError("required")),l(2),s("packageFormGroup",t.packageDetailsFormGroup)("districtsCache",t.districtsCache)("deliveryDistrictId",(De=t.orderForm.get("delivery_district_id"))==null?null:De.value),l(4),_("S/ ",N(72,34,(ze=t.orderForm.get("shipping_cost"))==null?null:ze.value,"1.2-2"),""),l(2),s("ngIf",t.isCalculatingShipping()),l(9),s("ngIf",(Dt=t.orderForm.get("item_description"))==null?null:Dt.hasError("required")),l(7),s("ngIf",(kt=t.orderForm.get("amount_to_collect_at_delivery"))==null?null:kt.hasError("required")),l(),s("ngIf",(wt=t.orderForm.get("amount_to_collect_at_delivery"))==null?null:wt.hasError("min")),l(5),s("ngForOf",t.paymentMethodsForCollection),l(6),s("disabled",t.orderForm.invalid)}},dependencies:[y,He,A,Ie,dt,q,Fe,Y,We,$,J,st,Xe,Z,le,H,j,U,Bt,ee,ct,Ae,ie,te,Be,ht,Le,Ye,Ot,Et,yt,S,R,Oe,k,z,Ve,Ne,Mt,xe,be,xt,vt,bt,gt,ut],styles:[".order-creation-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;padding:10px 20px 20px}.form-section-title[_ngcontent-%COMP%]{font-size:1.5em;font-weight:500;color:#333;margin-bottom:10px;padding-bottom:10px;border-bottom:1px solid #eee}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px 24px}@media (max-width: 600px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.full-span-column[_ngcontent-%COMP%]{grid-column:1/-1}mat-form-field[_ngcontent-%COMP%]{width:100%}.section-divider[_ngcontent-%COMP%]{margin:24px 0}.shipping-cost-display[_ngcontent-%COMP%]{font-size:1.3em;font-weight:700;text-align:right;color:#d32f2f;display:flex;align-items:center;justify-content:flex-end;gap:8px}@media (max-width: 600px){.shipping-cost-display[_ngcontent-%COMP%]{text-align:left;justify-content:flex-start}}.add-order-button-container[_ngcontent-%COMP%]{margin-top:24px;text-align:center}.add-order-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:12px 24px;font-size:1.1em;letter-spacing:.5px}mat-hint[align=end][_ngcontent-%COMP%]{font-size:.75em;opacity:.7}.standard-checkbox[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0}"]})};function da(i,e){i&1&&(n(0,"div",3),a(1," A\xFAn no has agregado pedidos. "),o())}function sa(i,e){i&1&&(n(0,"th",22),a(1,"Nombre"),o())}function ma(i,e){if(i&1&&(n(0,"td",23)(1,"span",24),a(2),o()()),i&2){let r=e.$implicit;l(),s("matTooltip",r.recipient_name)("matTooltipDisabled",r.recipient_name.length<=20),l(),_(" ",r.recipient_name," ")}}function ca(i,e){i&1&&(n(0,"th",22),a(1,"Tel\xE9fono"),o())}function pa(i,e){if(i&1&&(n(0,"td",23),a(1),o()),i&2){let r=e.$implicit;l(),M(r.recipient_phone)}}function ua(i,e){i&1&&(n(0,"th",22),a(1,"F. Entrega"),o())}function ga(i,e){if(i&1&&(n(0,"td",23),a(1),v(2,"date"),o()),i&2){let r=e.$implicit;l(),_(" ",N(2,1,r.delivery_date,"dd/MM/yy")," ")}}function _a(i,e){i&1&&(n(0,"th",22),a(1,"Distrito"),o())}function fa(i,e){if(i&1&&(n(0,"td",23),a(1),o()),i&2){let r=e.$implicit;l(),_(" ",r.delivery_district_name," ")}}function ha(i,e){i&1&&(n(0,"th",22),a(1,"Direcci\xF3n"),o())}function Ca(i,e){if(i&1&&(n(0,"td",23)(1,"span",24),a(2),o()()),i&2){let r=e.$implicit;l(),s("matTooltip",r.delivery_address)("matTooltipDisabled",r.delivery_address.length<=25),l(),_(" ",r.delivery_address," ")}}function va(i,e){i&1&&(n(0,"th",22),a(1,"Producto"),o())}function ba(i,e){if(i&1&&(n(0,"td",23)(1,"span",24),a(2),o()()),i&2){let r=e.$implicit;l(),s("matTooltip",r.item_description)("matTooltipDisabled",r.item_description.length<=20),l(),_(" ",r.item_description," ")}}function xa(i,e){i&1&&(n(0,"th",22),a(1,"Cobrar"),o())}function Oa(i,e){if(i&1&&(n(0,"td",25),a(1),v(2,"currency"),o()),i&2){let r=e.$implicit;l(),_(" ",ve(2,1,r.amount_to_collect_at_delivery,"PEN","S/ ","1.2-2")," ")}}function Ea(i,e){i&1&&(n(0,"th",22),a(1,"Costo env\xEDo"),o())}function ya(i,e){if(i&1&&(n(0,"td",25),a(1),v(2,"currency"),o()),i&2){let r=e.$implicit;l(),_(" ",ve(2,1,r.shipping_cost,"PEN","S/ ","1.2-2")," ")}}function Sa(i,e){i&1&&(n(0,"th",22),a(1,"M\xE9todo de Pago"),o())}function Ma(i,e){if(i&1&&(n(0,"td",23),a(1),o()),i&2){let r=e.$implicit;l(),_(" ",r.payment_method_for_collection," ")}}function Da(i,e){i&1&&(n(0,"th",22),a(1,"Observaci\xF3n"),o())}function ka(i,e){if(i&1&&(n(0,"td",23)(1,"span",24),a(2),o()()),i&2){let r=e.$implicit;l(),s("matTooltip",r.observations)("matTooltipDisabled",!r.observations||r.observations.length<=20),l(),_(" ",r.observations||"-"," ")}}function wa(i,e){i&1&&(n(0,"th",22),a(1,"Quitar"),o())}function Pa(i,e){if(i&1){let r=O();n(0,"td",23)(1,"button",26),p("click",function(){let d=f(r).$implicit,m=C(2);return h(m.onRemoveOrder(d.temp_id))}),n(2,"mat-icon"),a(3,"remove_circle_outline"),o()()()}}function Ia(i,e){i&1&&g(0,"tr",27)}function Ta(i,e){i&1&&g(0,"tr",28)}function Fa(i,e){if(i&1&&(n(0,"div",4)(1,"table",5),P(2,6),c(3,sa,2,0,"th",7)(4,ma,3,3,"td",8),I(),P(5,9),c(6,ca,2,0,"th",7)(7,pa,2,1,"td",8),I(),P(8,10),c(9,ua,2,0,"th",7)(10,ga,3,4,"td",8),I(),P(11,11),c(12,_a,2,0,"th",7)(13,fa,2,1,"td",8),I(),P(14,12),c(15,ha,2,0,"th",7)(16,Ca,3,3,"td",8),I(),P(17,13),c(18,va,2,0,"th",7)(19,ba,3,3,"td",8),I(),P(20,14),c(21,xa,2,0,"th",7)(22,Oa,3,6,"td",15),I(),P(23,16),c(24,Ea,2,0,"th",7)(25,ya,3,6,"td",15),I(),P(26,17),c(27,Sa,2,0,"th",7)(28,Ma,2,1,"td",8),I(),P(29,18),c(30,Da,2,0,"th",7)(31,ka,3,3,"td",8),I(),P(32,19),c(33,wa,2,0,"th",7)(34,Pa,4,0,"td",8),I(),c(35,Ia,1,0,"tr",20)(36,Ta,1,0,"tr",21),o()()),i&2){let r=C();l(),s("dataSource",r.pendingOrders),l(34),s("matHeaderRowDef",r.displayedColumns)("matHeaderRowDefSticky",!0),l(),s("matRowDefColumns",r.displayedColumns)}}var xi=class i{pendingOrders=[];removeOrder=new w;displayedColumns=["recipient_name","recipient_phone","delivery_date","delivery_district_name","delivery_address","item_description","amount_to_collect_at_delivery","shipping_cost","payment_method_for_collection","observations","actions"];constructor(){}onRemoveOrder(e){e&&this.removeOrder.emit(e)}static \u0275fac=function(r){return new(r||i)};static \u0275cmp=E({type:i,selectors:[["app-temporary-orders-table"]],inputs:{pendingOrders:"pendingOrders"},outputs:{removeOrder:"removeOrder"},decls:4,vars:2,consts:[["ordersTable",""],[1,"temporary-orders-container","mat-elevation-z1"],["class","no-orders-message",4,"ngIf","ngIfElse"],[1,"no-orders-message"],[1,"table-responsive-wrapper"],["mat-table","",1,"temporary-orders-table",3,"dataSource"],["matColumnDef","recipient_name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","recipient_phone"],["matColumnDef","delivery_date"],["matColumnDef","delivery_district_name"],["matColumnDef","delivery_address"],["matColumnDef","item_description"],["matColumnDef","amount_to_collect_at_delivery"],["mat-cell","","class","align-right",4,"matCellDef"],["matColumnDef","shipping_cost"],["matColumnDef","payment_method_for_collection"],["matColumnDef","observations"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"truncate-text",3,"matTooltip","matTooltipDisabled"],["mat-cell","",1,"align-right"],["mat-icon-button","","color","warn","matTooltip","Quitar pedido",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(r,t){if(r&1&&(n(0,"div",1),c(1,da,2,0,"div",2)(2,Fa,37,4,"ng-template",null,0,at),o()),r&2){let d=F(3);l(),s("ngIf",t.pendingOrders.length===0)("ngIfElse",d)}},dependencies:[y,A,Te,K,ri,Wt,Kt,Zt,Qt,Xt,ei,Yt,Jt,ti,ii,S,Oe,k,z,Qe,Ct],styles:[".table-responsive-wrapper[_ngcontent-%COMP%]{background-color:#6c757d!important;overflow:auto}.temporary-orders-container[_ngcontent-%COMP%]{margin-top:30px;padding:0;background-color:#fff;border-radius:8px;overflow:hidden;box-shadow:0 1px 3px #0000001f,0 1px 2px #0000003d}.list-title[_ngcontent-%COMP%]{font-size:1.2em;font-weight:500;color:#fff;background-color:#d32f2f;padding:12px 16px;margin:0;border-top-left-radius:8px;border-top-right-radius:8px}.temporary-orders-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th.mat-header-cell[_ngcontent-%COMP%], td.mat-cell[_ngcontent-%COMP%]{padding:10px 12px;border-bottom:1px solid #e0e0e0;vertical-align:middle;text-align:left}th.mat-header-cell[_ngcontent-%COMP%]{font-weight:500;color:#000000bf;background-color:#f5f5f5;white-space:nowrap}td.mat-cell[_ngcontent-%COMP%]{color:#000000de;font-size:.9em}[matColumnDef=amount_to_collect_at_delivery].mat-header-cell[_ngcontent-%COMP%], [matColumnDef=amount_to_collect_at_delivery].mat-cell[_ngcontent-%COMP%], [matColumnDef=shipping_cost].mat-header-cell[_ngcontent-%COMP%], [matColumnDef=shipping_cost].mat-cell[_ngcontent-%COMP%]{text-align:right;justify-content:flex-end}[matColumnDef=actions][_ngcontent-%COMP%]{width:80px}[matColumnDef=actions].mat-header-cell[_ngcontent-%COMP%], [matColumnDef=actions].mat-cell[_ngcontent-%COMP%]{text-align:center;justify-content:center}.truncate-text[_ngcontent-%COMP%]{display:block;max-width:120px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.no-orders-message[_ngcontent-%COMP%]{text-align:center;padding:30px;font-style:italic;color:#6c757d;background-color:#f8f9fa;border-bottom-left-radius:8px;border-bottom-right-radius:8px}"]})};function Aa(i,e){if(i&1&&(n(0,"mat-option",16),a(1),v(2,"titlecase"),o()),i&2){let r=e.$implicit;s("value",r),l(),_(" ",T(2,2,r.replace("_"," "))," ")}}function Ra(i,e){i&1&&(n(0,"mat-error"),a(1," Debe seleccionar una opci\xF3n de traslado. "),o())}function Na(i,e){i&1&&(n(0,"mat-error",17),a(1," Debe aceptar los t\xE9rminos y condiciones. "),o())}function Va(i,e){i&1&&g(0,"mat-progress-spinner",18)}function La(i,e){if(i&1){let r=O();n(0,"div",4)(1,"div",5)(2,"mat-form-field",6)(3,"mat-label"),a(4,"\xBFC\xF3mo se har\xE1 el traslado de los pedidos al almac\xE9n?"),o(),n(5,"mat-select",7),c(6,Aa,3,4,"mat-option",8),o(),c(7,Ra,2,0,"mat-error",9),o()(),n(8,"div",10)(9,"mat-checkbox",7),a(10," acepto los "),n(11,"a",11),a(12,"t\xE9rminos y condiciones"),o()(),c(13,Na,2,0,"mat-error",12),o(),n(14,"div",13)(15,"button",14),p("click",function(){f(r);let d=C();return h(d.submitAllOrders())}),c(16,Va,1,0,"mat-progress-spinner",15),a(17),o()()()}if(i&2){let r=C();l(5),s("formControl",r.pickupOptionControl),l(),s("ngForOf",r.pickupOptions),l(),s("ngIf",r.pickupOptionControl.hasError("required")&&r.pickupOptionControl.touched),l(2),s("formControl",r.termsAcceptedControl),l(4),s("ngIf",r.termsAcceptedControl.hasError("required")&&r.termsAcceptedControl.touched),l(2),s("disabled",r.pendingOrders().length===0||!r.termsAcceptedControl.value||!r.pickupOptionControl.valid||r.isSubmittingBatch()),l(),s("ngIf",r.isSubmittingBatch()),l(),_(" ",r.isSubmittingBatch()?"Generando Pedidos...":"Haz click aqu\xED para guardar los pedidos"," ")}}var Oi=class i{orderCreationFormComponent;pendingOrders=Ce([]);isSubmittingBatch=Ce(!1);isOrderFormValid=Ce(!1);pickupOptionControl=new Me("RECOGER EN DOMICILIO",x.required);termsAcceptedControl=new Me(!1,x.requiredTrue);pickupOptions=["RECOGER EN DOMICILIO","ENTREGAR EN ALMACEN"];orderService=b(W);router=b(Rt);snackBar=b(Re);cdr=b(Vi);destroy$=new Q;constructor(){}ngOnInit(){}handleOrderAdded(e){this.pendingOrders.update(r=>[...r,e]),this.snackBar.open("Pedido agregado al listado.","OK",{duration:2e3,verticalPosition:"top"}),this.orderCreationFormComponent&&this.orderCreationFormComponent.resetFormForNextOrder(),this.cdr.detectChanges()}handleRemoveOrder(e){this.pendingOrders.update(r=>r.filter(t=>t.temp_id!==e)),this.snackBar.open("Pedido quitado del listado.","OK",{duration:2e3,verticalPosition:"top"})}onOrderFormValidityChanged(e){this.isOrderFormValid.set(e)}submitAllOrders(){if(this.pendingOrders().length===0){this.snackBar.open("No hay pedidos en el listado para enviar.","Cerrar",{duration:3e3,verticalPosition:"top"});return}if(!this.pickupOptionControl.valid){this.snackBar.open("Por favor, seleccione c\xF3mo se har\xE1 el traslado.","Cerrar",{duration:3e3,verticalPosition:"top"}),this.pickupOptionControl.markAsTouched();return}if(!this.termsAcceptedControl.value){this.snackBar.open("Debe aceptar los t\xE9rminos y condiciones.","Cerrar",{duration:3e3,verticalPosition:"top"}),this.termsAcceptedControl.markAsTouched();return}console.log(this.pendingOrders().map(t=>{let u=t,{temp_id:d}=u;return yi(u,["temp_id"])})),this.isSubmittingBatch.set(!0);let r={orders:this.pendingOrders().map(t=>{let u=t,{temp_id:d}=u;return yi(u,["temp_id"])}).map(t=>et(fe({},t),{type_order_transfer_to_warehouse:this.pickupOptionControl.value})),pickup_option:this.pickupOptionControl.value||"RECOGER EN DOMICILIO",terms_accepted:!0};this.orderService.createBatchOrders(r).pipe(D(this.destroy$),Di(()=>this.isSubmittingBatch.set(!1))).subscribe({next:t=>{this.snackBar.open(t.message||"Pedidos generados exitosamente!","OK",{duration:4e3,verticalPosition:"top",panelClass:["success-snackbar"]}),this.pendingOrders.set([]),this.pickupOptionControl.reset("RECOGER_DOMICILIO"),this.termsAcceptedControl.reset(!1),this.router.navigate(["/orders"])},error:t=>{this.snackBar.open(t.message||"Error al generar los pedidos. Intente nuevamente.","Cerrar",{duration:5e3,verticalPosition:"top",panelClass:["error-snackbar"]}),console.error("Error submitting batch orders:",t)}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(r){return new(r||i)};static \u0275cmp=E({type:i,selectors:[["app-order-create-page"]],viewQuery:function(r,t){if(r&1&&tt(Tt,5),r&2){let d;it(d=rt())&&(t.orderCreationFormComponent=d.first)}},decls:4,vars:2,consts:[[1,"page-content-wrapper","order-create-page"],[3,"orderSubmit","formValidityChanged"],[3,"removeOrder","pendingOrders"],["class","final-submission-section mat-elevation-z1",4,"ngIf"],[1,"final-submission-section","mat-elevation-z1"],[1,"pickup-option-section"],["appearance","outline",1,"full-width"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"terms-section"],["href","/terms-and-conditions","target","_blank",2,"color","#012147","font-weight","bold"],["class","terms-error",4,"ngIf"],[1,"submit-batch-button-container"],["mat-flat-button","",1,"submit-all-button","btn-corp-primary",3,"click","disabled"],["mode","indeterminate","diameter","24","class","button-spinner",4,"ngIf"],[3,"value"],[1,"terms-error"],["mode","indeterminate","diameter","24",1,"button-spinner"]],template:function(r,t){r&1&&(n(0,"div",0)(1,"app-order-creation-form",1),p("orderSubmit",function(m){return t.handleOrderAdded(m)})("formValidityChanged",function(m){return t.onOrderFormValidityChanged(m)}),o(),n(2,"app-temporary-orders-table",2),p("removeOrder",function(m){return t.handleRemoveOrder(m)}),o(),c(3,La,18,8,"div",3),o()),r&2&&(l(2),s("pendingOrders",t.pendingOrders()),l(),s("ngIf",t.pendingOrders().length>0))},dependencies:[y,He,A,At,Nt,q,$,Xe,Tt,xi,_t,S,R,k,gt,ut,Be,j,U,ee,ht,Le,H,xe,be],styles:[".order-create-page[_ngcontent-%COMP%]{padding:0;background-color:#f4f6f8}.final-submission-section[_ngcontent-%COMP%]{margin-top:30px;padding:24px;background-color:#fff;border-radius:8px;display:flex;flex-direction:column;gap:20px}.pickup-option-section[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%}.terms-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.terms-section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-weight:500}.terms-section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.terms-section[_ngcontent-%COMP%]   .terms-error[_ngcontent-%COMP%]{font-size:.75em;margin-top:4px}.submit-batch-button-container[_ngcontent-%COMP%]{margin-top:16px;text-align:center}.submit-batch-button-container[_ngcontent-%COMP%]   .submit-all-button[_ngcontent-%COMP%]{padding:25px 28px!important;font-size:1.1em;font-weight:500;letter-spacing:.5px;min-width:250px}.button-spinner[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;margin-right:10px}"]})};var g0=[{path:"",component:bi},{path:"create",component:Oi}];export{g0 as ORDERS_ROUTES};
