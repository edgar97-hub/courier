import{f as X,g as r}from"./chunk-6HWJN4XJ.js";import{ha as m}from"./chunk-NTZTTLCP.js";var L="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-TFG-8",E=".xlsx",p=class f{constructor(){}exportAsExcelFile(c,n,i="Sheet1"){if(!c||c.length===0){console.warn("No data provided for Excel export.");return}let a=r.json_to_sheet(c),l=this.calculateColumnWidths(a);a["!cols"]=l;let t={Sheets:{[i]:a},SheetNames:[i]},e=X(t,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(e,n)}exportCashMovementSummaryAndDetailsToExcel(c,n,i,a="Movimientos de Caja"){let l=r.book_new(),t=r.aoa_to_sheet([]),e=1;t["!merges"]||(t["!merges"]=[]),t["!merges"].push({s:{r:e-1,c:0},e:{r:e-1,c:3}}),t["A"+e]={v:"Movimientos de Caja",t:"s",s:{font:{bold:!0,sz:14}}},e++,e++,c.slice(0,2).forEach(o=>{t["A"+e]={v:o.label,t:"s"},t["C"+e]={v:o.value,t:"s"},e++}),e++;let h=c.slice(2,-3),v=h.map(o=>o.Tipo),s=1;t["A"+e]={v:"",t:"s"},v.forEach(o=>{let d=r.encode_cell({r:e-1,c:s});t[d]={v:o,t:"s",s:{font:{bold:!0}}},s++}),e++,s=0,t["A"+e]={v:"Ingreso",t:"s",s:{font:{bold:!0}}},s++,h.forEach(o=>{let d=r.encode_cell({r:e-1,c:s});t[d]={v:parseFloat(o.Ingreso),t:"n"},s++}),e++,s=0,t["A"+e]={v:"Egreso",t:"s",s:{font:{bold:!0}}},s++,h.forEach(o=>{let d=r.encode_cell({r:e-1,c:s});t[d]={v:parseFloat(o.Egreso),t:"n"},s++}),e++,s=0,t["A"+e]={v:"Saldo",t:"s",s:{font:{bold:!0}}},s++,h.forEach(o=>{let d=r.encode_cell({r:e-1,c:s});t[d]={v:parseFloat(o.Saldo),t:"n"},s++}),e++,e++,c.slice(-3).forEach(o=>{t["!merges"]||(t["!merges"]=[]),t["!merges"].push({s:{r:e-1,c:0},e:{r:e-1,c:2}}),t["A"+e]={v:o.label,t:"s",s:{font:{bold:!0}}},t["C"+e]={v:"S/",t:"s",s:{font:{bold:!0}}},t["D"+e]={v:o.value,t:"n",s:{font:{bold:!0}}},e++}),e++,e++;let S=Object.keys(n[0]||{});r.sheet_add_aoa(t,[S],{origin:`A${e}`}),t["A"+e].s={font:{bold:!0}},e++,r.sheet_add_json(t,n,{origin:`A${e}`,skipHeader:!0});let u=this.calculateColumnWidths(t);u[0]?u[0].wch=5:u.unshift({wch:5}),console.log("columnWidths",u),t["!cols"]=u,r.book_append_sheet(l,t,a);let b=X(l,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(b,i)}saveAsExcelFile(c,n){let i=new Blob([c],{type:L}),a=window.URL.createObjectURL(i),l=document.createElement("a");l.href=a,l.download=`${n}${E}`,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(a)}calculateColumnWidths(c){let n=[];return r.sheet_to_json(c,{header:1,raw:!1}).forEach(a=>{a.forEach((l,t)=>{let e=String(l||""),h=n[t]?n[t].wch:0;e.length>h&&(n[t]={wch:e.length+2})})}),n}static \u0275fac=function(n){return new(n||f)};static \u0275prov=m({token:f,factory:f.\u0275fac,providedIn:"root"})};export{p as a};
