import"./chunk-F5X5MWHG.js";import{a as Vt,b as jt,c as zt,d as Gt,e as qt,f as Ht,g as Qt,h as Kt,i as Yt,j as Zt,k as Wt,l as Jt,m as Xt,n as Je,o as oi,p as ni}from"./chunk-V54F6JIJ.js";import"./chunk-MS4AQ6UA.js";import{a as T,b as $,c as Pe,d as be,e as It,f as yt,h as O,i as wt,j as Ce,k as Pt,l as he,m as Ft}from"./chunk-MVFKV7TJ.js";import{a as ti,b as ii,d as We,e as ri}from"./chunk-4CRKJGVD.js";import{a as ei,b as Ze}from"./chunk-SNHOSZ4S.js";import{a as qe,b as He}from"./chunk-VMNFNLTS.js";import{a as de}from"./chunk-MJEF5JPU.js";import"./chunk-BYXBJQAS.js";import{a as Nt,b as kt,c as Lt,e as At,f as Rt,g as Bt,h as Qe}from"./chunk-GXNIZWNA.js";import{d as $t}from"./chunk-JJSTB54W.js";import"./chunk-YRCWJJOQ.js";import{a as Dt}from"./chunk-K72O7MSM.js";import{a as Ke,b as Ye}from"./chunk-5PZ25QHJ.js";import"./chunk-2JNWSY3M.js";import{d as ae,e as se}from"./chunk-44LGRUYF.js";import{a as me,b as le}from"./chunk-3IGH7FBX.js";import"./chunk-7RWCIHFI.js";import{A as Ot,D as Ge,G as oe,H as ne,b as Le,d as Q,f as Ae,g as Re,l as Be,o as $e,r as Ve,t as Tt,v as je,x as ze,z as re}from"./chunk-ICWTIKD4.js";import"./chunk-BWBG2IHT.js";import"./chunk-U3COC3EF.js";import{a as Fe,b as Te,d as Oe,e as De,f as Ne,g as ke,i as H}from"./chunk-K4QNRRQ5.js";import{a as te,b as ie}from"./chunk-ASKMK2H5.js";import"./chunk-XRPHOQB2.js";import{a as K,b as A,e as v}from"./chunk-2H2YZZAU.js";import"./chunk-NUMYIFQH.js";import{Bb as z,Db as p,Ea as N,Eb as b,Ec as h,G as Z,Gd as w,Hd as U,I as j,Ka as Me,Kb as bt,Lb as Ct,Mb as ht,Pb as vt,Qb as n,Qc as ye,R as _t,Rb as B,Sb as S,Sc as L,Tc as we,Va as m,Xc as q,Za as W,_b as Ie,a as c,aa as ee,b as _,ba as R,bc as I,c as Ut,cb as C,cc as y,da as M,gc as Mt,ia as St,ib as g,l as V,lb as Et,m as xe,mb as d,na as u,t as D,va as xt,vb as r,wa as P,wb as e,wc as k,x as Ee,xa as F,xb as s,yb as x,yc as G,zb as E}from"./chunk-YUSEJVZ2.js";var pe=T("[User Page/API] Load Users"),Xe=T("[User API] Load Users Success",$()),et=T("[User API] Load Users Failure",$()),ue=T("[User Create Page] Create User",$()),ve=T("[User API] Create User Success",$()),tt=T("[User API] Create User Failure",$()),ce=T("[User Page] Delete User",$()),it=T("[User API] Delete User Success",$()),rt=T("[User API] Delete User Failure",$()),ot=T("[User Store] Clear User Error");var at=It("users"),ai=be(at,i=>i.users),si=be(at,i=>i.isLoading),st=be(at,i=>i.error),mi=be(at,i=>i.isSubmitting);var _i=()=>[5,10,25,100];function bi(i,t){i&1&&(r(0,"div",10),s(1,"mat-progress-spinner",11),e())}function Ci(i,t){i&1&&(r(0,"th",26),n(1,"N\xB0"),e())}function hi(i,t){if(i&1&&(r(0,"td",27),n(1),e()),i&2){let o=t.$implicit;m(),B(o.code)}}function vi(i,t){i&1&&(r(0,"th",28),n(1," Nombre "),e())}function Ui(i,t){if(i&1&&(r(0,"td",27),n(1),e()),i&2){let o=t.$implicit;m(),B(o.username)}}function Si(i,t){i&1&&(r(0,"th",29),n(1,"Correo"),e())}function xi(i,t){if(i&1&&(r(0,"td",27),n(1),e()),i&2){let o=t.$implicit;m(),B(o.email)}}function Ei(i,t){i&1&&(r(0,"th",29),n(1,"Rol"),e())}function Mi(i,t){if(i&1&&(r(0,"td",27),n(1),e()),i&2){let o=t.$implicit;m(),B(o.role||"N/A")}}function Ii(i,t){i&1&&(r(0,"th",30),n(1,"Acciones"),e())}function yi(i,t){if(i&1){let o=z();r(0,"td",27)(1,"button",31),p("click",function(){let l=P(o).$implicit,f=b(2);return F(f.onEdit(l))}),r(2,"mat-icon"),n(3,"edit"),e()(),r(4,"button",32),p("click",function(){let l=P(o).$implicit,f=b(2);return F(f.onDelete(l))}),r(5,"mat-icon"),n(6,"delete"),e()()()}}function wi(i,t){i&1&&s(0,"tr",33)}function Pi(i,t){i&1&&s(0,"tr",34)}function Fi(i,t){if(i&1&&(r(0,"tr",35)(1,"td",36),n(2),e()()),i&2){let o=b(2),a=vt(6);m(),Et("colspan",o.displayedColumns.length),m(),S(' No data matching the filter "',a.value,'" ')}}function Ti(i,t){if(i&1&&(r(0,"table",12),x(1,13),g(2,Ci,2,0,"th",14)(3,hi,2,1,"td",15),E(),x(4,16),g(5,vi,2,0,"th",17)(6,Ui,2,1,"td",15),E(),x(7,18),g(8,Si,2,0,"th",19)(9,xi,2,1,"td",15),E(),x(10,20),g(11,Ei,2,0,"th",19)(12,Mi,2,1,"td",15),E(),x(13,21),g(14,Ii,2,0,"th",22)(15,yi,7,0,"td",15),E(),g(16,wi,1,0,"tr",23)(17,Pi,1,0,"tr",24)(18,Fi,3,2,"tr",25),e()),i&2){let o=b();d("dataSource",o.dataSource),m(16),d("matHeaderRowDef",o.displayedColumns)("matHeaderRowDefSticky",!0),m(),d("matRowDefColumns",o.displayedColumns)}}function Oi(i,t){i&1&&(r(0,"div",37),n(1," No users found. Try dispatching the load action or check your API. "),e())}var mt=class i{users=[];isLoading=!1;displayedColumns=["code","username","email","rol","actions"];dataSource=new Xt;paginator;sort;ngOnChanges(t){t.users&&this.users?(console.log("UserTableComponent: Users received via @Input()",this.users),this.dataSource.data=this.users):t.users&&!this.users&&(this.dataSource.data=[])}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.dataSource.sortingDataAccessor=(t,o)=>t[o]}applyFilter(t){let o=t.target.value;this.dataSource.filter=o.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}viewUser=new N;editUser=new N;deleteUser=new N;onView(t){this.viewUser.emit(t)}onEdit(t){this.editUser.emit(t)}onDelete(t){this.deleteUser.emit(t)}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=C({type:i,selectors:[["app-user-table"]],viewQuery:function(o,a){if(o&1&&(bt(We,5),bt(Je,5)),o&2){let l;Ct(l=ht())&&(a.paginator=l.first),Ct(l=ht())&&(a.sort=l.first)}},inputs:{users:"users",isLoading:"isLoading"},outputs:{viewUser:"viewUser",editUser:"editUser",deleteUser:"deleteUser"},features:[xt],decls:13,vars:5,consts:[["input",""],[1,"table-container","mat-elevation-z4"],[1,"table-header"],["appearance","outline",1,"filter-field"],["matInput","","placeholder","Search...",3,"keyup"],["matSuffix",""],["class","spinner-container",4,"ngIf"],["mat-table","","matSort","","class","user-data-table",3,"dataSource",4,"ngIf"],["class","no-data-message",4,"ngIf"],["showFirstLastButtons","","aria-label","Select page of users",3,"pageSizeOptions"],[1,"spinner-container"],["mode","indeterminate","diameter","50"],["mat-table","","matSort","",1,"user-data-table",3,"dataSource"],["matColumnDef","code"],["mat-header-cell","","mat-sort-header","code",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","username"],["mat-header-cell","","mat-sort-header","username",4,"matHeaderCellDef"],["matColumnDef","email"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","rol"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["mat-header-cell","","mat-sort-header","code"],["mat-cell",""],["mat-header-cell","","mat-sort-header","username"],["mat-header-cell","","mat-sort-header",""],["mat-header-cell",""],["mat-icon-button","","color","accent","matTooltip","Editar Usuario",3,"click"],["mat-icon-button","","color","warn","matTooltip","Eliminar Usuario",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],[1,"mat-cell"],[1,"no-data-message"]],template:function(o,a){if(o&1){let l=z();r(0,"div",1)(1,"div",2)(2,"mat-form-field",3)(3,"mat-label"),n(4,"Filtrar Usuarios"),e(),r(5,"input",4,0),p("keyup",function(X){return P(l),F(a.applyFilter(X))}),e(),r(7,"mat-icon",5),n(8,"search"),e()()(),g(9,bi,2,0,"div",6)(10,Ti,19,4,"table",7)(11,Oi,2,0,"div",8),s(12,"mat-paginator",9),e()}if(o&2){let l=vt(6);m(9),d("ngIf",a.isLoading),m(),d("ngIf",!a.isLoading&&a.dataSource.data.length>0),m(),d("ngIf",!a.isLoading&&a.dataSource.data.length===0&&!l.value),m(),d("pageSizeOptions",Ie(4,_i))}},dependencies:[h,k,Jt,Vt,zt,Qt,Gt,jt,Kt,qt,Ht,Yt,Zt,Wt,ri,We,ni,Je,oi,ne,oe,re,Ge,se,ae,U,w,v,K,ie,te,ii,ti],styles:[".table-container[_ngcontent-%COMP%]{margin:20px;overflow:auto;border-radius:8px}.table-header[_ngcontent-%COMP%]{padding:16px;display:flex;justify-content:space-between;align-items:center;border-top-left-radius:8px;border-top-right-radius:8px}.filter-field[_ngcontent-%COMP%]{width:100%;max-width:400px;font-size:.9em}.user-data-table[_ngcontent-%COMP%]{width:100%}th.mat-header-cell[_ngcontent-%COMP%], td.mat-cell[_ngcontent-%COMP%]{padding:12px 16px;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:#e0e0e0}th.mat-header-cell[_ngcontent-%COMP%]{font-weight:500;color:#333;background-color:#fafafa}tr.mat-row[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}.mat-mdc-paginator[_ngcontent-%COMP%]{border-bottom-left-radius:8px;border-bottom-right-radius:8px}.spinner-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:50px;min-height:200px}.no-data-message[_ngcontent-%COMP%]{text-align:center;padding:30px;color:#757575;font-style:italic}td.mat-cell[_ngcontent-%COMP%]   button.mat-icon-button[_ngcontent-%COMP%]{margin-right:4px}"]})};var lt=class i{constructor(t,o){this.dialogRef=t;this.data=o}onConfirm(){this.dialogRef.close(!0)}onDismiss(){this.dialogRef.close(!1)}static \u0275fac=function(o){return new(o||i)(W(Nt),W(kt))};static \u0275cmp=C({type:i,selectors:[["app-confirm-dialog"]],decls:10,vars:4,consts:[["mat-dialog-title","",1,"dialog-title"],[1,"dialog-content"],["align","end",1,"dialog-actions"],["mat-stroked-button","",1,"btn-corp-secondary",3,"click"],["mat-flat-button","","cdkFocusInitial","",1,"btn-corp-primary",3,"click"]],template:function(o,a){o&1&&(r(0,"h2",0),n(1),e(),r(2,"mat-dialog-content",1)(3,"p"),n(4),e()(),r(5,"mat-dialog-actions",2)(6,"button",3),p("click",function(){return a.onDismiss()}),n(7),e(),r(8,"button",4),p("click",function(){return a.onConfirm()}),n(9),e()()),o&2&&(m(),S(" ",a.data.title," "),m(3),B(a.data.message),m(3),S(" ",a.data.cancelText||"Cancel"," "),m(2),S(" ",a.data.confirmText||"Delete"," "))},dependencies:[h,Qe,At,Bt,Rt,v,A,U],styles:[".dialog-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-weight:500;color:#d32f2f}.dialog-content[_ngcontent-%COMP%]{line-height:1.6;color:#555}.dialog-actions[_ngcontent-%COMP%]{padding-top:16px}.title-icon[_ngcontent-%COMP%]{vertical-align:middle}"]})};var Di=()=>[],dt=class i{store=u(Pe);router=u(L);dialog=u(Lt);users$;isLoading$;error$;destroy$=new V;constructor(){this.users$=this.store.select(ai).pipe(M(t=>console.log("UserListPageComponent: Users from store:",t))),this.isLoading$=this.store.select(si).pipe(M(t=>console.log("UserListPageComponent: IsLoading from store:",t))),this.error$=this.store.select(st).pipe(Z(t=>!!t),M(t=>{console.error("UserListPageComponent: Error from store:",t)}))}ngOnInit(){console.log("UserListPageComponent: ngOnInit - dispatching loadUsers"),this.store.dispatch(pe())}handleViewUser(t){this.router.navigate(["/users",t.id])}handleEditUser(t){this.router.navigate(["/users","edit",t.id])}handleDeleteUser(t){this.dialog.open(lt,{width:"350px",data:{title:"Confirm Delete",message:`\xBFEst\xE1s seguro que deseas eliminar el usuario "${t.username}" (codigo: ${t.code})? Esta acci\xF3n no se puede deshacer.`}}).afterClosed().pipe(Z(a=>!!a),R(this.destroy$)).subscribe(()=>{this.performDelete(t)})}performDelete(t){this.store.dispatch(ce({userId:t.id||""}))}navigateToCreate(){this.router.navigate(["/users/edit/0"])}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=C({type:i,selectors:[["app-user-list-page"]],decls:11,vars:7,consts:[[1,"page-container"],[1,"page-header"],["mat-flat-button","",1,"btn-corp-primary",3,"click"],[3,"viewUser","editUser","deleteUser","users","isLoading"]],template:function(o,a){if(o&1&&(r(0,"div",0)(1,"div",1)(2,"h1"),n(3,"Gesti\xF3n de usuarios"),e(),r(4,"button",2),p("click",function(){return a.navigateToCreate()}),r(5,"mat-icon"),n(6,"add_circle_outline"),e(),n(7," Crear nuevo usuario "),e()(),r(8,"app-user-table",3),I(9,"async"),I(10,"async"),p("viewUser",function(f){return a.handleViewUser(f)})("editUser",function(f){return a.handleEditUser(f)})("deleteUser",function(f){return a.handleDeleteUser(f)}),e()()),o&2){let l;m(8),d("users",y(9,2,a.users$)||Ie(6,Di))("isLoading",(l=y(10,4,a.isLoading$))!==null&&l!==void 0?l:!1)}},dependencies:[h,G,q,mt,v,A,U,w,Qe,le],styles:[".page-container[_ngcontent-%COMP%]{padding:24px;min-height:calc(100vh - 64px)}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:15px;flex-wrap:wrap;margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid #e0e0e0}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:2em;font-weight:500}.page-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-weight:500}"]})};function Ri(i,t){i&1&&(r(0,"mat-error"),n(1," Nombre de usuario es requerido. "),e())}function Bi(i,t){i&1&&(r(0,"mat-error"),n(1," Email es requerido. "),e())}function $i(i,t){i&1&&(r(0,"mat-error"),n(1," Formato de email inv\xE1lido. "),e())}function Vi(i,t){i&1&&(r(0,"mat-error"),n(1," Rol es requerido. "),e())}function ji(i,t){i&1&&(r(0,"mat-form-field",5)(1,"mat-label"),n(2,"Codigo Conductor"),e(),s(3,"input",21),e())}function zi(i,t){i&1&&(x(0),s(1,"mat-divider",22),r(2,"div",2)(3,"h3",3)(4,"mat-icon"),n(5,"featured_play_list"),e(),n(6," Caracter\xEDstica del Negocio "),e(),r(7,"div",23)(8,"mat-form-field",5)(9,"mat-label"),n(10,"Tipo de Negocio"),e(),s(11,"input",24),e(),r(12,"mat-form-field",5)(13,"mat-label"),n(14,"Nombre del Negocio"),e(),s(15,"input",25),e()(),r(16,"mat-form-field",26)(17,"mat-label"),n(18,"Distrito del Negocio"),e(),s(19,"input",27),e(),r(20,"mat-form-field",26)(21,"mat-label"),n(22,"Direcci\xF3n del Negocio"),e(),s(23,"input",28),e(),r(24,"div",23)(25,"mat-form-field",5)(26,"mat-label"),n(27,"N\xFAmero de tel\xE9fono del Negocio"),e(),s(28,"input",29),e(),r(29,"mat-form-field",5)(30,"mat-label"),n(31,"Sector del Negocio"),e(),s(32,"input",30),e()(),r(33,"div",23)(34,"mat-form-field",5)(35,"mat-label"),n(36,"Tipo de documento del Negocio"),e(),s(37,"input",31),e(),r(38,"mat-form-field",5)(39,"mat-label"),n(40,"Correo electr\xF3nico del Negocio"),e(),s(41,"input",32),e()(),r(42,"div",23)(43,"mat-form-field",5)(44,"mat-label"),n(45,"N\xFAmero de documento del Negocio"),e(),s(46,"input",33),e()(),r(47,"div",34)(48,"label",35),n(49,"Asume el 5% POS"),e(),r(50,"mat-checkbox",36),n(51," Confirmar "),e()()(),s(52,"mat-divider",22),r(53,"div",2)(54,"h3",3)(55,"mat-icon"),n(56,"attribution"),e(),n(57," Informaci\xF3n del Propietario "),e(),r(58,"div",23)(59,"mat-form-field",5)(60,"mat-label"),n(61,"Nombre del propietario"),e(),s(62,"input",37),e(),r(63,"mat-form-field",5)(64,"mat-label"),n(65,"N\xFAmero de tel\xE9fono del propietario"),e(),s(66,"input",38),e()(),r(67,"div",23)(68,"mat-form-field",5)(69,"mat-label"),n(70,"Tipo de documento del propietario"),e(),s(71,"input",39),e(),r(72,"mat-form-field",5)(73,"mat-label"),n(74,"N\xFAmero de documento del propietario"),e(),s(75,"input",40),e()(),r(76,"div",23)(77,"mat-form-field",5)(78,"mat-label"),n(79,"Direcci\xF3n de correo electr\xF3nico del propietario"),e(),s(80,"input",41),e()()(),s(81,"mat-divider",22),r(82,"div",2)(83,"h3",3)(84,"mat-icon"),n(85,"account_balance"),e(),n(86," Cuenta bancaria "),e(),r(87,"mat-form-field",26)(88,"mat-label"),n(89,"Cuenta bancaria"),e(),s(90,"input",42),e(),r(91,"mat-form-field",26)(92,"mat-label"),n(93,"Titular del numero de cuenta"),e(),s(94,"input",43),e()(),E())}var _e=class i{constructor(t){this.fb=t}userToEdit=null;isLoading=!1;formSubmit=new N;formCancel=new N;userForm;hidePassword=Me(!0);ngOnInit(){this.initForm(),this.userToEdit&&this.userForm.patchValue(this.userToEdit),this.userForm.get("role")?.valueChanges.subscribe(t=>{this.handleRoleChange(t)})}get roleControl(){return this.userForm.get("role")}handleRoleChange(t){}initForm(){this.userForm=this.fb.group({id:[null],username:["",Q.required],email:["",[Q.required,Q.email]],password:["",[]],role:["COMPANY"],driverCode:["",[]],business_type:["",[]],business_name:["",[]],business_district:["",[]],business_address:["",[]],business_phone_number:["",[]],business_sector:["",[]],business_document_type:["",[]],business_email:["",[]],assumes_5_percent_pos:[!1,[]],business_document_number:["",[]],owner_name:["",[]],owner_phone_number:["",[]],owner_document_type:["",[]],owner_document_number:["",[]],owner_email_address:["",[]],owner_bank_account:["",[]],name_account_number_owner:["",[]]})}get username(){return this.userForm.get("username")}get email(){return this.userForm.get("email")}onSubmit(){if(this.userForm.valid)if(this.userToEdit&&this.userToEdit.id){let o=_(c(c({},this.userToEdit),this.userForm.value),{id:this.userToEdit.id});console.log("formData",o),this.formSubmit.emit(o)}else{let t=this.userForm.value,{id:o}=t,a=Ut(t,["id"]);this.formSubmit.emit(a)}else this.userForm.markAllAsTouched()}onCancel(){this.formCancel.emit()}static \u0275fac=function(o){return new(o||i)(W(je))};static \u0275cmp=C({type:i,selectors:[["app-user-form"]],inputs:{userToEdit:"userToEdit",isLoading:"isLoading"},outputs:{formSubmit:"formSubmit",formCancel:"formCancel"},decls:54,vars:11,consts:[[1,"multi-section-form-card"],[3,"ngSubmit","formGroup"],[1,"form-section"],[1,"section-title"],[1,"form-grid"],["appearance","outline",1,"form-field","small-field"],["matInput","","formControlName","username","autocomplete","off","required",""],[4,"ngIf"],["matInput","","formControlName","email","type","email","required",""],["matInput","","placeholder","Ingrese su contrase\xF1a","formControlName","password","autocomplete","new-password",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["formControlName","role","required",""],["value","ADMINISTRADOR"],["value","MOTORIZADO"],["value","EMPRESA"],["value","RECEPCIONISTA"],["value","EMPRESA_DISTRIBUIDOR"],["appearance","outline","class","form-field small-field",4,"ngIf"],["align","end",1,"form-actions-sticky"],["mat-stroked-button","","type","button",1,"btn-corp-secondary",3,"click"],["mat-flat-button","","type","submit",1,"btn-corp-primary",3,"disabled"],["matInput","","formControlName","driverCode","autocomplete","off","required",""],[1,"section-divider"],[1,"form-grid","two-columns"],["matInput","","formControlName","business_type"],["matInput","","formControlName","business_name"],["appearance","outline",1,"form-field","small-field","full-width-mobile"],["matInput","","formControlName","business_district"],["matInput","","formControlName","business_address"],["matInput","","formControlName","business_phone_number"],["matInput","","formControlName","business_sector"],["matInput","","formControlName","business_document_type"],["matInput","","formControlName","business_email"],["matInput","","formControlName","business_document_number"],[1,"form-field-group"],[1,"checkbox-group-label"],["formControlName","assumes_5_percent_pos","color","primary",1,"small-checkbox"],["matInput","","formControlName","owner_name"],["matInput","","formControlName","owner_phone_number"],["matInput","","formControlName","owner_document_type"],["matInput","","formControlName","owner_document_number"],["matInput","","formControlName","owner_email_address"],["matInput","","formControlName","owner_bank_account"],["matInput","","formControlName","name_account_number_owner"]],template:function(o,a){if(o&1&&(r(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),n(3,"Formulario de usuario"),e(),r(4,"mat-card-subtitle"),n(5,"Complete todas las secciones del formulario"),e()(),r(6,"mat-card-content")(7,"form",1),p("ngSubmit",function(){return a.onSubmit()}),r(8,"div",2)(9,"h3",3)(10,"mat-icon"),n(11,"person_outline"),e(),n(12," Informaci\xF3n B\xE1sica "),e(),r(13,"div",4)(14,"mat-form-field",5)(15,"mat-label"),n(16,"Nombre de Usuario"),e(),s(17,"input",6),g(18,Ri,2,0,"mat-error",7),e(),r(19,"mat-form-field",5)(20,"mat-label"),n(21,"Correo"),e(),s(22,"input",8),g(23,Bi,2,0,"mat-error",7)(24,$i,2,0,"mat-error",7),e(),r(25,"mat-form-field",5)(26,"mat-label"),n(27,"contrase\xF1a"),e(),s(28,"input",9),r(29,"button",10),p("click",function(){return a.hidePassword.set(!a.hidePassword())}),r(30,"mat-icon"),n(31),e()()(),r(32,"mat-form-field",5)(33,"mat-label"),n(34,"Rol"),e(),r(35,"mat-select",11)(36,"mat-option",12),n(37,"Administrador"),e(),r(38,"mat-option",13),n(39,"Motorizado"),e(),r(40,"mat-option",14),n(41,"Empresa"),e(),r(42,"mat-option",15),n(43,"Recepcionista"),e(),r(44,"mat-option",16),n(45,"EMPRESA y DISTRIBUIDOR"),e()(),g(46,Vi,2,0,"mat-error",7),e(),g(47,ji,4,0,"mat-form-field",17),e()(),g(48,zi,95,0,"ng-container",7),r(49,"mat-card-actions",18)(50,"button",19),p("click",function(){return a.onCancel()}),n(51," Cancelar "),e(),r(52,"button",20),n(53),e()()()()()),o&2){let l,f,X,Se;m(7),d("formGroup",a.userForm),m(11),d("ngIf",((l=a.userForm.get("username"))==null?null:l.invalid)&&((l=a.userForm.get("username"))==null?null:l.touched)),m(5),d("ngIf",((f=a.userForm.get("email"))==null?null:f.hasError("required"))&&((f=a.userForm.get("email"))==null?null:f.touched)),m(),d("ngIf",((X=a.userForm.get("email"))==null?null:X.hasError("email"))&&((X=a.userForm.get("email"))==null?null:X.touched)),m(4),d("type",a.hidePassword()?"password":"text"),m(3),B(a.hidePassword()?"visibility_off":"visibility"),m(15),d("ngIf",((Se=a.userForm.get("role"))==null?null:Se.invalid)&&((Se=a.userForm.get("role"))==null?null:Se.touched)),m(),d("ngIf",a.roleControl.value==="MOTORIZADO"),m(),d("ngIf",a.roleControl.value==="EMPRESA"),m(4),d("disabled",a.isLoading||a.userForm.invalid),m(),S(" ",a.isLoading?"Guardando...":"Guardar Todo"," ")}},dependencies:[h,k,ze,Be,Le,Ae,Re,Tt,$e,Ve,ne,oe,re,Ot,Ge,se,ae,v,A,K,H,Fe,Ne,Oe,ke,De,Te,Ze,ei,$t,U,w,Ye,Ke,He,qe],styles:[".multi-section-form-card[_ngcontent-%COMP%]{max-width:900px;margin:24px auto;padding:16px 24px;border-radius:8px}mat-card-title[_ngcontent-%COMP%]{font-size:1.5em;margin-bottom:4px}mat-card-subtitle[_ngcontent-%COMP%]{margin-bottom:24px;color:#0009}.form-section[_ngcontent-%COMP%]{margin-bottom:32px;gap:10px!important}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:1.2em;font-weight:500;margin-bottom:20px;display:flex;align-items:center;gap:8px;border-bottom:1px solid #e0e0e0;padding-bottom:8px}.section-divider[_ngcontent-%COMP%]{margin-top:16px;margin-bottom:32px}.form-grid[_ngcontent-%COMP%]{display:grid;gap:20px;grid-template-columns:repeat(auto-fit,minmax(250px,1fr))}@media (min-width: 600px){.form-grid.two-columns[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}.form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-form-field-input-control, .form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-floating-label, .form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-select-value{font-size:.875em}.form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-form-field-infix{padding-top:.8em!important;padding-bottom:.6em!important;min-height:auto!important}.form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-floating-label.mdc-floating-label--float-above{transform:translateY(-1.85em) scale(.75)!important}.form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-input-element{padding-top:0;margin-top:0}.form-field-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-top:8px}.form-field-group[_ngcontent-%COMP%]   .checkbox-group-label[_ngcontent-%COMP%]{font-size:.9em;color:#0009;margin-bottom:4px;font-weight:500}.small-checkbox[_ngcontent-%COMP%]     .mdc-form-field{font-size:.9em}.form-actions-sticky[_ngcontent-%COMP%]{display:flex;gap:10px!important}"]})};var pt=class i{store=u(Pe);router=u(L);isSubmitting$;error$;destroy$=new V;constructor(){this.isSubmitting$=this.store.select(mi),this.error$=this.store.select(st)}ngOnInit(){this.store.dispatch(ot())}handleFormSubmit(t){console.log("UserCreatePageComponent: Form submitted",t),this.store.dispatch(ue({user:t}))}handleFormCancel(){this.router.navigate(["/users"])}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=C({type:i,selectors:[["app-user-create-page"]],decls:9,vars:4,consts:[[1,"page-container","form-page-container"],[1,"page-header"],["mat-icon-button","","routerLink","/users","matTooltip","Back to User List","aria-label","Back to user list"],[3,"formSubmit","formCancel","userToEdit","isLoading"]],template:function(o,a){o&1&&(r(0,"div",0)(1,"div",1)(2,"button",2)(3,"mat-icon"),n(4,"arrow_back"),e()(),r(5,"h1"),n(6,"Create New User"),e()(),r(7,"app-user-form",3),I(8,"async"),p("formSubmit",function(f){return a.handleFormSubmit(f)})("formCancel",function(){return a.handleFormCancel()}),e()()),o&2&&(m(7),d("userToEdit",null)("isLoading",!!y(8,2,a.isSubmitting$)))},dependencies:[h,G,q,we,_e,U,w,v,K],styles:[".page-container[_ngcontent-%COMP%]{padding:24px;background-color:#f9f9f9}.form-page-container[_ngcontent-%COMP%]{max-width:700px;margin:30px auto;background-color:#fff;border-radius:8px;box-shadow:0 2px 10px #0000001a;padding:24px}.page-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid #e0e0e0}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 0 16px;font-size:1.6em;font-weight:500;color:#3f51b5}"]})};function qi(i,t){if(i&1&&(r(0,"h1"),n(1),e()),i&2){let o=b();m(),S(" ",o.isLoading?"Loading User...":o.isEditMode?"Edit User":"User Details"," ")}}function Hi(i,t){if(i&1){let o=z();r(0,"button",8),p("click",function(){P(o);let l=b();return F(l.navigateToEdit())}),r(1,"mat-icon"),n(2,"edit"),e(),n(3," Edit User "),e()}}function Qi(i,t){i&1&&(r(0,"div",9),s(1,"mat-progress-spinner",10),e())}function Ki(i,t){if(i&1){let o=z();x(0),r(1,"div",11)(2,"app-user-form",12),I(3,"async"),p("formSubmit",function(l){P(o);let f=b();return F(f.handleFormSubmit(l))})("formCancel",function(){P(o);let l=b();return F(l.handleFormCancel())}),e()(),E()}if(i&2){let o=b();m(2),d("userToEdit",y(3,2,o.user$))("isLoading",o.isLoading)}}function Yi(i,t){if(i&1&&(r(0,"p",13),n(1),e()),i&2){let o=b();m(),S(" User with ID ",o.userId," not found or could not be loaded. ")}}var ut=class i{route=u(ye);router=u(L);userService=u(de);snackBar=u(me);userSubject=new xe(null);user$=this.userSubject.asObservable();isLoading=!0;isEditMode=!1;userId=null;destroy$=new V;ngOnInit(){this.route.paramMap.pipe(R(this.destroy$),M(()=>{this.isLoading=!0,this.userSubject.next(null)}),ee(t=>{let o=t.get("id");return o&&o!=="0"?(this.userId=o,this.isEditMode=this.router.url.includes(`/edit/${this.userId}`),this.userService.getUserById(this.userId)):(this.isLoading=!1,D(null))}),j(t=>(this.isLoading=!1,this.snackBar.open("Error fetching user data.","Close",{duration:3e3,panelClass:["error-snackbar"]}),this.router.navigate(["/users"]),D(null))),Z(t=>t!==null)).subscribe(t=>{this.isLoading=!1,console.log("user",t),t?this.userSubject.next(t):this.userId&&(this.snackBar.open(`User with ID ${this.userId} not found.`,"Close",{duration:3e3}),this.router.navigate(["/users"]))})}navigateToEdit(){this.userId&&this.router.navigate(["/users","edit",this.userId])}navigateToView(){this.userId&&this.router.navigate(["/users",this.userId])}handleFormSubmit(t){let o;this.userId?(o=_(c({},t),{id:this.userId}),this.isLoading=!0,this.userService.updateUser(o).pipe(R(this.destroy$)).subscribe({next:a=>{this.isLoading=!1,this.userSubject.next(a),this.snackBar.open("\xA1Actualizado exitosamente!","OK",{duration:3e3,verticalPosition:"top",panelClass:["success-snackbar"]}),this.isEditMode=!1,window.location.href="/users"},error:a=>{this.isLoading=!1,this.snackBar.open("Error al actualizar el usuario. Int\xE9ntalo de nuevo.","Retry",{duration:5e3,verticalPosition:"top",panelClass:["error-snackbar"]}),console.error("Error updating user:",a)}})):(o=c({},t),this.isLoading=!0,this.userService.createUser(o).pipe(R(this.destroy$)).subscribe({next:a=>{this.isLoading=!1,this.userSubject.next(a),this.snackBar.open("guardado exitosamente!","OK",{duration:3e3,verticalPosition:"top",panelClass:["success-snackbar"]}),this.isEditMode=!1,window.location.href="/users"},error:a=>{this.isLoading=!1,this.snackBar.open("Error al actualizar el usuario. Int\xE9ntalo de nuevo.","Retry",{duration:5e3,verticalPosition:"top",panelClass:["error-snackbar"]}),console.error("Error updating user:",a)}}))}handleFormCancel(){this.isEditMode=!1,this.router.navigate(["/users"])}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=C({type:i,selectors:[["app-user-detail-page"]],decls:13,vars:8,consts:[["loadingOrMissingTitle",""],[1,"page-container","detail-page-container"],[1,"page-header"],["mat-icon-button","","routerLink","/users","matTooltip","Back to User List","aria-label","Back to user list"],["mat-flat-button","","class","btn-corp-primary",3,"click",4,"ngIf"],["class","spinner-container",4,"ngIf"],[4,"ngIf"],["class","not-found-message",4,"ngIf"],["mat-flat-button","",1,"btn-corp-primary",3,"click"],[1,"spinner-container"],["mode","indeterminate","diameter","60"],[1,"form-wrapper"],[3,"formSubmit","formCancel","userToEdit","isLoading"],[1,"not-found-message"]],template:function(o,a){o&1&&(r(0,"div",1)(1,"div",2)(2,"button",3)(3,"mat-icon"),n(4,"arrow_back"),e()(),g(5,qi,2,1,"ng-template",null,0,Mt)(7,Hi,4,0,"button",4),I(8,"async"),e(),g(9,Qi,2,0,"div",5)(10,Ki,4,4,"ng-container",6)(11,Yi,2,1,"p",7),I(12,"async"),e()),o&2&&(m(7),d("ngIf",!a.isLoading&&y(8,4,a.user$)&&!a.isEditMode),m(2),d("ngIf",a.isLoading),m(),d("ngIf",!a.isLoading),m(),d("ngIf",!a.isLoading&&!y(12,6,a.user$)&&a.userId))},dependencies:[h,k,G,q,we,_e,v,A,K,U,w,ie,te,le,H],encapsulation:2})};var ci={users:[],isLoading:!1,isSubmitting:!1,error:null};var fi=wt(ci,O(pe,i=>_(c({},i),{isLoading:!0,error:null})),O(Xe,(i,{users:t})=>_(c({},i),{users:t,isLoading:!1})),O(et,(i,{error:t})=>_(c({},i),{users:[],isLoading:!1,error:t})),O(ue,i=>_(c({},i),{isSubmitting:!0,error:null})),O(ve,(i,{user:t})=>_(c({},i),{users:[...i.users,t],isSubmitting:!1})),O(tt,(i,{error:t})=>_(c({},i),{isSubmitting:!1,error:t})),O(ot,i=>_(c({},i),{error:null})),O(ce,i=>_(c({},i),{isLoading:!0,error:null})),O(it,(i,{userId:t})=>_(c({},i),{users:i.users.filter(o=>o.id!==t),isLoading:!1})),O(rt,(i,{error:t})=>_(c({},i),{isLoading:!1,error:t})));var ct=class i{actions$=u(Pt);userService=u(de);snackBar=u(me);router=u(L);loadUsers$=Ce(()=>this.actions$.pipe(he(pe),M(()=>console.log("UserEffects: loadUsers action dispatched")),_t(()=>this.userService.getUsers().pipe(Ee(t=>(console.log("UserEffects: Users received from service",t),Xe({users:t}))),j(t=>{let o=t.message||"Failed to load users from effect.";return console.error("UserEffects: Error loading users",t),this.snackBar.open(o,"Close",{duration:7e3,panelClass:["error-snackbar"]}),D(et({error:o}))})))));createUser$=Ce(()=>this.actions$.pipe(he(ue),M(t=>console.log("UserEffects: createUser action dispatched with user:",t.user)),_t(t=>this.userService.createUser(t.user).pipe(Ee(o=>(console.log("UserEffects: User created via service",o),ve({user:o}))),j(o=>{let a=o.message||"Failed to create user.";return console.error("UserEffects: Error creating user",o),D(tt({error:a}))})))));createUserSuccess$=Ce(()=>this.actions$.pipe(he(ve),M(t=>{console.log("UserEffects: createUserSuccess action, navigating for user:",t.user),this.snackBar.open(`User "${t.user.username}" created successfully!`,"OK",{duration:3e3,verticalPosition:"top",panelClass:["success-snackbar"]}),this.router.navigate(["/users"])})),{dispatch:!1});deleteUser$=Ce(()=>this.actions$.pipe(he(ce),ee(t=>this.userService.deleteUser(t.userId).pipe(M(()=>{this.snackBar.open("User deleted successfully!","OK",{duration:3e3,panelClass:["success-snackbar"],verticalPosition:"top"})}),Ee(()=>it({userId:t.userId})),j(o=>{let a=o.message||"An unexpected error occurred.";return this.snackBar.open(a,"Close",{duration:5e3,panelClass:["error-snackbar"],verticalPosition:"top"}),D(rt({error:a}))})))));static \u0275fac=function(o){return new(o||i)};static \u0275prov=St({token:i,factory:i.\u0275fac})};var gi=[yt({name:"users",reducer:fi}),Ft(ct)];function Zi(i,t){i&1&&(x(0),s(1,"mat-divider",12),r(2,"div",2)(3,"h3",3)(4,"mat-icon"),n(5,"featured_play_list"),e(),n(6," Caracter\xEDstica del Negocio "),e(),r(7,"div",13)(8,"mat-form-field",5)(9,"mat-label"),n(10,"Tipo de Negocio"),e(),s(11,"input",14),e(),r(12,"mat-form-field",5)(13,"mat-label"),n(14,"Nombre del Negocio"),e(),s(15,"input",15),e()(),r(16,"mat-form-field",16)(17,"mat-label"),n(18,"Distrito del Negocio"),e(),s(19,"input",17),e(),r(20,"mat-form-field",16)(21,"mat-label"),n(22,"Direcci\xF3n del Negocio"),e(),s(23,"input",18),e(),r(24,"div",13)(25,"mat-form-field",5)(26,"mat-label"),n(27,"N\xFAmero de tel\xE9fono del Negocio"),e(),s(28,"input",19),e(),r(29,"mat-form-field",5)(30,"mat-label"),n(31,"Sector del Negocio"),e(),s(32,"input",20),e()(),r(33,"div",13)(34,"mat-form-field",5)(35,"mat-label"),n(36,"Tipo de documento del Negocio"),e(),s(37,"input",21),e(),r(38,"mat-form-field",5)(39,"mat-label"),n(40,"Correo electr\xF3nico del Negocio"),e(),s(41,"input",22),e()(),r(42,"div",13)(43,"mat-form-field",5)(44,"mat-label"),n(45,"N\xFAmero de documento del Negocio"),e(),s(46,"input",23),e()(),r(47,"div",24)(48,"label",25),n(49,"Asume el 5% POS"),e(),r(50,"mat-checkbox",26),n(51," Confirmar "),e()()(),s(52,"mat-divider",12),r(53,"div",2)(54,"h3",3)(55,"mat-icon"),n(56,"attribution"),e(),n(57," Informaci\xF3n del Propietario "),e(),r(58,"div",13)(59,"mat-form-field",5)(60,"mat-label"),n(61,"Nombre del propietario"),e(),s(62,"input",27),e(),r(63,"mat-form-field",5)(64,"mat-label"),n(65,"N\xFAmero de tel\xE9fono del propietario"),e(),s(66,"input",28),e()(),r(67,"div",13)(68,"mat-form-field",5)(69,"mat-label"),n(70,"Tipo de documento del propietario"),e(),s(71,"input",29),e(),r(72,"mat-form-field",5)(73,"mat-label"),n(74,"N\xFAmero de documento del propietario"),e(),s(75,"input",30),e()(),r(76,"div",13)(77,"mat-form-field",5)(78,"mat-label"),n(79,"Direcci\xF3n de correo electr\xF3nico del propietario"),e(),s(80,"input",31),e()()(),s(81,"mat-divider",12),r(82,"div",2)(83,"h3",3)(84,"mat-icon"),n(85,"account_balance"),e(),n(86," Cuenta bancaria "),e(),r(87,"mat-form-field",16)(88,"mat-label"),n(89,"Cuenta bancaria"),e(),s(90,"input",32),e(),r(91,"mat-form-field",16)(92,"mat-label"),n(93,"Titular del numero de cuenta"),e(),s(94,"input",33),e()(),E())}var ft=class i{constructor(t){this.fb=t}userToEdit=null;isLoading=!1;formSubmit=new N;formCancel=new N;userForm;hidePassword=Me(!0);ngOnInit(){this.initForm(),this.userToEdit&&this.userForm.patchValue(this.userToEdit),this.userForm.get("role")?.valueChanges.subscribe(t=>{this.handleRoleChange(t)})}get roleControl(){return this.userForm.get("role")}get isCompanyRole(){return this.userForm.get("role")?.value==="EMPRESA"||this.userForm.get("role")?.value==="EMPRESA_DISTRIBUIDOR"}handleRoleChange(t){}initForm(){this.userForm=this.fb.group({id:[null],username:["",Q.required],email:["",[Q.required,Q.email]],password:["",[]],role:["COMPANY"],business_type:["",[]],business_name:["",[]],business_district:["",[]],business_address:["",[]],business_phone_number:["",[]],business_sector:["",[]],business_document_type:["",[]],business_email:["",[]],assumes_5_percent_pos:[!1,[]],business_document_number:["",[]],owner_name:["",[]],owner_phone_number:["",[]],owner_document_type:["",[]],owner_document_number:["",[]],owner_email_address:["",[]],owner_bank_account:["",[]],name_account_number_owner:["",[]]}),this.userForm.get("username")?.disable(),this.userForm.get("email")?.disable(),this.userForm.get("assumes_5_percent_pos")?.disable(),this.userForm.get("owner_name")?.disable(),this.userForm.get("owner_phone_number")?.disable(),this.userForm.get("owner_document_type")?.disable(),this.userForm.get("owner_document_number")?.disable(),this.userForm.get("owner_email_address")?.disable(),this.userForm.get("owner_bank_account")?.disable(),this.userForm.get("name_account_number_owner")?.disable()}get username(){return this.userForm.get("username")}get email(){return this.userForm.get("email")}onSubmit(){if(this.userToEdit&&this.userToEdit.id){let t=_(c(c({},this.userToEdit),this.userForm.value),{id:this.userToEdit.id});console.log("formData",t),this.formSubmit.emit(t)}}onCancel(){this.formCancel.emit()}static \u0275fac=function(o){return new(o||i)(W(je))};static \u0275cmp=C({type:i,selectors:[["app-user-form"]],inputs:{userToEdit:"userToEdit",isLoading:"isLoading"},outputs:{formSubmit:"formSubmit",formCancel:"formCancel"},decls:28,vars:4,consts:[[1,"multi-section-form-card"],[3,"ngSubmit","formGroup"],[1,"form-section"],[1,"section-title"],[1,"form-grid"],["appearance","outline",1,"form-field","small-field"],["matInput","","formControlName","username","autocomplete","off"],["matInput","","formControlName","email","type","email","readonly",""],[4,"ngIf"],["align","end",1,"form-actions-sticky"],["mat-stroked-button","","type","button",1,"btn-corp-secondary",3,"click"],["mat-flat-button","","type","submit",1,"btn-corp-primary",3,"disabled"],[1,"section-divider"],[1,"form-grid","two-columns"],["matInput","","formControlName","business_type"],["matInput","","formControlName","business_name"],["appearance","outline",1,"form-field","small-field","full-width-mobile"],["matInput","","formControlName","business_district"],["matInput","","formControlName","business_address"],["matInput","","formControlName","business_phone_number"],["matInput","","formControlName","business_sector"],["matInput","","formControlName","business_document_type"],["matInput","","formControlName","business_email"],["matInput","","formControlName","business_document_number"],[1,"form-field-group"],[1,"checkbox-group-label"],["formControlName","assumes_5_percent_pos","color","primary",1,"small-checkbox"],["matInput","","formControlName","owner_name"],["matInput","","formControlName","owner_phone_number"],["matInput","","formControlName","owner_document_type"],["matInput","","formControlName","owner_document_number"],["matInput","","formControlName","owner_email_address"],["matInput","","formControlName","owner_bank_account"],["matInput","","formControlName","name_account_number_owner"]],template:function(o,a){o&1&&(r(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),n(3,"Formulario de usuario"),e(),r(4,"mat-card-subtitle"),n(5,"Complete la seccion de Caracter\xEDstica del Negocio "),e()(),r(6,"mat-card-content")(7,"form",1),p("ngSubmit",function(){return a.onSubmit()}),r(8,"div",2)(9,"h3",3)(10,"mat-icon"),n(11,"person_outline"),e(),n(12," Informaci\xF3n B\xE1sica "),e(),r(13,"div",4)(14,"mat-form-field",5)(15,"mat-label"),n(16,"Nombre de Usuario"),e(),s(17,"input",6),e(),r(18,"mat-form-field",5)(19,"mat-label"),n(20,"Correo"),e(),s(21,"input",7),e()()(),g(22,Zi,95,0,"ng-container",8),r(23,"mat-card-actions",9)(24,"button",10),p("click",function(){return a.onCancel()}),n(25," Cancelar "),e(),r(26,"button",11),n(27),e()()()()()),o&2&&(m(7),d("formGroup",a.userForm),m(15),d("ngIf",a.isCompanyRole),m(4),d("disabled",a.isLoading||a.userForm.invalid),m(),S(" ",a.isLoading?"Guardando...":"Guardar"," "))},dependencies:[h,k,ze,Be,Le,Ae,Re,$e,Ve,ne,oe,re,se,ae,v,A,H,Fe,Ne,Oe,ke,De,Te,Ze,U,w,Ye,Ke,He,qe],styles:[".multi-section-form-card[_ngcontent-%COMP%]{max-width:900px;margin:24px auto;padding:16px 24px;border-radius:8px}mat-card-title[_ngcontent-%COMP%]{font-size:1.5em;margin-bottom:4px}mat-card-subtitle[_ngcontent-%COMP%]{margin-bottom:24px;color:#0009}.form-section[_ngcontent-%COMP%]{margin-bottom:32px;gap:10px!important}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:1.2em;font-weight:500;margin-bottom:20px;display:flex;align-items:center;gap:8px;border-bottom:1px solid #e0e0e0;padding-bottom:8px}.section-divider[_ngcontent-%COMP%]{margin-top:16px;margin-bottom:32px}.form-grid[_ngcontent-%COMP%]{display:grid;gap:20px;grid-template-columns:repeat(auto-fit,minmax(250px,1fr))}@media (min-width: 600px){.form-grid.two-columns[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}.form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-form-field-input-control, .form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-floating-label, .form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-select-value{font-size:.875em}.form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-form-field-infix{padding-top:.8em!important;padding-bottom:.6em!important;min-height:auto!important}.form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-floating-label.mdc-floating-label--float-above{transform:translateY(-1.85em) scale(.75)!important}.form-field.small-field[_ngcontent-%COMP%]     .mat-mdc-input-element{padding-top:0;margin-top:0}.form-field-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-top:8px}.form-field-group[_ngcontent-%COMP%]   .checkbox-group-label[_ngcontent-%COMP%]{font-size:.9em;color:#0009;margin-bottom:4px;font-weight:500}.small-checkbox[_ngcontent-%COMP%]     .mdc-form-field{font-size:.9em}.form-actions-sticky[_ngcontent-%COMP%]{display:flex;gap:10px!important}"]})};function Wi(i,t){i&1&&(r(0,"div",4),s(1,"mat-progress-spinner",5),e())}function Ji(i,t){if(i&1){let o=z();x(0),r(1,"div",6)(2,"app-user-form",7),I(3,"async"),p("formSubmit",function(l){P(o);let f=b();return F(f.handleFormSubmit(l))})("formCancel",function(){P(o);let l=b();return F(l.handleFormCancel())}),e()(),E()}if(i&2){let o=b();m(2),d("userToEdit",y(3,2,o.user$))("isLoading",o.isLoading)}}function Xi(i,t){if(i&1&&(r(0,"p",8),n(1),e()),i&2){let o=b();m(),S(" User with ID ",o.userId," not found or could not be loaded. ")}}var gt=class i{route=u(ye);router=u(L);userService=u(de);snackBar=u(me);appStore=u(Dt);userSubject=new xe(null);user$=this.userSubject.asObservable();isLoading=!0;isEditMode=!1;userId=null;destroy$=new V;ngOnInit(){this.route.paramMap.pipe(R(this.destroy$),M(()=>{this.isLoading=!0,this.userSubject.next(null)}),ee(t=>this.appStore.currentUser()?.id?(this.userId=this.appStore.currentUser()?.id||"",this.userService.getUserById(this.userId)):(this.isLoading=!1,D(null))),j(t=>(this.isLoading=!1,this.snackBar.open("Error fetching user data.","Close",{duration:3e3,panelClass:["error-snackbar"]}),D(null))),Z(t=>t!==null)).subscribe(t=>{this.isLoading=!1,console.log("user",t),t?this.userSubject.next(t):this.userId&&this.snackBar.open(`User with ID ${this.userId} not found.`,"Close",{duration:3e3})})}navigateToEdit(){this.userId&&this.router.navigate(["/users","edit",this.userId])}navigateToView(){this.userId&&this.router.navigate(["/users",this.userId])}handleFormSubmit(t){let o;this.userId&&(o=_(c({},t),{id:this.userId}),this.isLoading=!0,this.userService.updateUserCompany(o).pipe(R(this.destroy$)).subscribe({next:a=>{this.isLoading=!1,this.userSubject.next(a),this.snackBar.open("\xA1Actualizado exitosamente!","OK",{duration:3e3,verticalPosition:"top",panelClass:["success-snackbar"]}),this.isEditMode=!1,this.router.navigate(["/dashboard"])},error:a=>{this.isLoading=!1,this.snackBar.open("Error al actualizar el usuario. Int\xE9ntalo de nuevo.","Retry",{duration:5e3,verticalPosition:"top",panelClass:["error-snackbar"]}),console.error("Error updating user:",a)}}))}handleFormCancel(){this.isEditMode=!1,this.router.navigate(["/dashboard"])}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=C({type:i,selectors:[["app-user-detail-page"]],decls:5,vars:5,consts:[[1,"page-container","detail-page-container"],["class","spinner-container",4,"ngIf"],[4,"ngIf"],["class","not-found-message",4,"ngIf"],[1,"spinner-container"],["mode","indeterminate","diameter","60"],[1,"form-wrapper"],[3,"formSubmit","formCancel","userToEdit","isLoading"],[1,"not-found-message"]],template:function(o,a){o&1&&(r(0,"div",0),g(1,Wi,2,0,"div",1)(2,Ji,4,4,"ng-container",2)(3,Xi,2,1,"p",3),I(4,"async"),e()),o&2&&(m(),d("ngIf",a.isLoading),m(),d("ngIf",!a.isLoading),m(),d("ngIf",!a.isLoading&&!y(4,3,a.user$)&&a.userId))},dependencies:[h,k,G,q,ft,v,U,ie,te,le,H],encapsulation:2})};var na=[{path:"",providers:[...gi],children:[{path:"",component:dt,title:"User List"},{path:"create",component:pt,title:"Create New User"},{path:"edit/:id",component:ut,title:"Edit User"},{path:"detail",component:gt,title:"User Details"}]}];export{na as USERS_ROUTES};
