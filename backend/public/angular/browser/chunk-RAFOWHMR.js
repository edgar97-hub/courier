import{a as he,d as Ce}from"./chunk-TRQX2VTV.js";import"./chunk-MS4AQ6UA.js";import{a as _e,b as fe}from"./chunk-L3MNFWQQ.js";import{d as ue}from"./chunk-CX2S64UM.js";import"./chunk-NYSIFWHP.js";import"./chunk-XWEPEJ6M.js";import{d as pe,e as se}from"./chunk-VDNF5TAH.js";import{F as ce,G as me,b as J,d as u,f as K,g as Q,l as X,m as Y,o as Z,r as ee,s as te,t as ie,v as ae,w as re,x as ne,y as oe,z as le}from"./chunk-BP5QNQX2.js";import"./chunk-RNIK75VC.js";import"./chunk-H2LMHOSF.js";import{a as $,b as R,d as L,e as V,g as W,h as j,i as B}from"./chunk-5WTBZVHG.js";import{a as U,b as H}from"./chunk-STLZB7OE.js";import"./chunk-G4FQLWAW.js";import"./chunk-6A3NYOL4.js";import{$b as y,Ab as G,Ac as A,Bd as de,Cd as ge,Ha as C,Mb as n,Nb as x,Ob as k,Ra as o,Zb as v,_a as w,_b as M,aa as I,eb as d,ib as c,j as S,ka as b,rb as r,rc as q,sb as e,sc as T,tb as _,uc as N,v as D,xc as z,zb as F}from"./chunk-KWE5B57V.js";function ve(t,i){if(t&1&&(r(0,"mat-option",21)(1,"div",22)(2,"span"),n(3),e(),n(4),r(5,"span",23),n(6),v(7,"number"),e()()()),t&2){let a=i.$implicit;c("value",a.id),o(3),k("",a.name," "),o(),k(" \xA0","-","\xA0 "),o(2),k("S/ ",y(7,4,a.price,"1.2-2"),"")}}function xe(t,i){t&1&&(r(0,"mat-error"),n(1," Seleccione un distrito. "),e())}function be(t,i){t&1&&(r(0,"mat-error"),n(1,"Requerido"),e())}function Me(t,i){t&1&&(r(0,"mat-error"),n(1,"M\xEDn. 1"),e())}function ye(t,i){t&1&&(r(0,"mat-error"),n(1,"Requerido"),e())}function Pe(t,i){t&1&&(r(0,"mat-error"),n(1,"M\xEDn. 1"),e())}function Ee(t,i){t&1&&(r(0,"mat-error"),n(1,"Requerido"),e())}function Oe(t,i){t&1&&(r(0,"mat-error"),n(1,"M\xEDn. 1"),e())}function Se(t,i){t&1&&(r(0,"mat-error"),n(1,"Requerido"),e())}function De(t,i){t&1&&(r(0,"mat-error"),n(1,"M\xEDn. 0.1"),e())}function Ie(t,i){t&1&&_(0,"mat-progress-spinner",24)}function we(t,i){if(t&1&&(r(0,"div",25)(1,"span",26),n(2,"Costo de Env\xEDo:"),e(),r(3,"span",27),n(4),v(5,"number"),e()()),t&2){let a=G();o(4),k("S/ ",y(5,1,a.shippingCostCalculated(),"1.2-2"),"")}}function Fe(t,i){if(t&1&&(r(0,"div",28)(1,"span"),n(2),e()()),t&2){let a=i.ngIf;o(2),x(a.info_text)}}var ke=class t{packageFormGroup;deliveryDistrictId=null;listaDeDistritos=[];maxDimensions$;standardPackageLabel=C("");volumetric_factor=C(0);shippingCostCalculated=C(0);isCalculating=C(!1);orderService=b(he);destroy$=new S;fb=b(ae);deliveryDistricts$;constructor(){this.deliveryDistricts$=this.orderService.getDeliveryDistricts().pipe(D(i=>(this.listaDeDistritos=i,i.filter(a=>a.isStandard)))),this.packageFormGroup=this.fb.group({package_size_type:["custom",u.required],package_width_cm:[0,u.required],package_length_cm:[0,u.required],package_height_cm:[0,u.required],package_weight_kg:[0,u.required],delivery_district_id:[null,u.required]}),this.maxDimensions$=this.orderService.getMaxPackageDimensions().pipe(I(i=>{if(i.standard_package_info&&i.volumetric_factor){let a="La medida est\xE1ndar es "+i.sta_length_cm+"cmx"+i.sta_width_cm+"cmx"+i.sta_height_cm+"cm "+i.sta_weight_kg+"kg";this.standardPackageLabel.set(a),this.volumetric_factor.set(i.volumetric_factor)}}))}ngOnInit(){}onCalculateCustomCost(){if(console.log("this.packageFormGroup.get",this.packageFormGroup.get("delivery_district_id")?.value),!this.packageFormGroup.get("delivery_district_id")?.value){alert("Por favor, seleccione un distrito de entrega primero.");return}["package_width_cm","package_length_cm","package_height_cm","package_weight_kg"].forEach(p=>{let m=this.packageFormGroup.get(p);if(m?.markAsTouched(),m?.invalid){console.log("Custom dimensions form is invalid");return}});let a={delivery_district_id:this.packageFormGroup.get("delivery_district_id")?.value,package_size_type:"custom",package_width_cm:this.packageFormGroup.get("package_width_cm")?.value,package_length_cm:this.packageFormGroup.get("package_length_cm")?.value,package_height_cm:this.packageFormGroup.get("package_height_cm")?.value,package_weight_kg:this.packageFormGroup.get("package_weight_kg")?.value};function l(p,m){for(let s of m)if(p>=s.weight_from&&p<=s.weight_to)return s}if(a.package_width_cm&&a.package_length_cm&&a.package_height_cm&&a.package_weight_kg&&this.volumetric_factor()){this.isCalculating.set(!0);let p=a.package_length_cm*a.package_width_cm*a.package_height_cm/this.volumetric_factor(),m=0,s=a.package_weight_kg;p>a.package_weight_kg&&(s=p);let f=this.listaDeDistritos?.find(g=>g.id===a.delivery_district_id);if(f){let g=this.listaDeDistritos?.filter(h=>h.name===f?.name);g&&(m=l(s,g)?.price||0)}m===0&&alert("No hay ninguna tarifa asociada con el peso ("+s+") del distrito seleccionado."),console.log("peso_cobrado",s),console.log("precio",m),this.shippingCostCalculated.set(m),this.isCalculating.set(!1)}else alert("las entradas no son validas")}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=w({type:t,selectors:[["app-terms-conditions-display"]],decls:53,vars:20,consts:[["appearance","outlined",1,"calculator-card"],[1,"calculator-card-header"],["mat-card-avatar","",1,"header-avatar"],[1,"calculator-card-content"],[3,"formGroup"],[1,"standard-package-info"],["appearance","outline",1,"full-width-field"],["formControlName","delivery_district_id","required",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"custom-dimensions-grid"],["appearance","outline"],["matInput","","type","number","formControlName","package_length_cm","placeholder","0","required","","min","1"],["matInput","","type","number","formControlName","package_width_cm","placeholder","0","required","","min","1"],["matInput","","type","number","formControlName","package_height_cm","placeholder","0","required","","min","1"],["matInput","","type","number","formControlName","package_weight_kg","placeholder","0.0","required","","min","0.1","step","0.1"],[1,"calculate-action-container"],["mat-flat-button","","type","button",1,"calculate-button","btn-corp-primary",3,"click"],["mode","indeterminate","diameter","20","class","button-spinner",4,"ngIf"],["class","shipping-cost-result",4,"ngIf"],["class","info-banner max-dimensions-info",4,"ngIf"],[3,"value"],[1,"district-option"],[1,"district-price"],["mode","indeterminate","diameter","20",1,"button-spinner"],[1,"shipping-cost-result"],[1,"cost-label"],[1,"cost-value"],[1,"info-banner","max-dimensions-info"]],template:function(a,l){if(a&1&&(r(0,"mat-card",0)(1,"mat-card-header",1)(2,"div",2)(3,"mat-icon"),n(4,"calculate"),e()(),r(5,"mat-card-title"),n(6,"Calculadora de Costo de Env\xEDo"),e(),r(7,"mat-card-subtitle"),n(8,"Estime el costo de su env\xEDo"),e()(),r(9,"mat-card-content",3)(10,"form",4)(11,"p",5),n(12),e(),r(13,"mat-form-field",6)(14,"mat-label"),n(15,"Distrito de entrega"),e(),r(16,"mat-select",7),d(17,ve,8,7,"mat-option",8),v(18,"async"),e(),d(19,xe,2,0,"mat-error",9),e(),r(20,"div",10)(21,"mat-form-field",11)(22,"mat-label"),n(23,"Largo (cm)"),e(),_(24,"input",12),d(25,be,2,0,"mat-error",9)(26,Me,2,0,"mat-error",9),e(),r(27,"mat-form-field",11)(28,"mat-label"),n(29,"Ancho (cm)"),e(),_(30,"input",13),d(31,ye,2,0,"mat-error",9)(32,Pe,2,0,"mat-error",9),e(),r(33,"mat-form-field",11)(34,"mat-label"),n(35,"Alto (cm)"),e(),_(36,"input",14),d(37,Ee,2,0,"mat-error",9)(38,Oe,2,0,"mat-error",9),e(),r(39,"mat-form-field",11)(40,"mat-label"),n(41,"Peso (kg)"),e(),_(42,"input",15),d(43,Se,2,0,"mat-error",9)(44,De,2,0,"mat-error",9),e()(),r(45,"div",16)(46,"button",17),F("click",function(){return l.onCalculateCustomCost()}),d(47,Ie,1,0,"mat-progress-spinner",18),r(48,"span"),n(49),e()(),d(50,we,6,4,"div",19),e(),d(51,Fe,3,1,"div",20),v(52,"async"),e()()()),a&2){let p,m,s,f,g,h,P,E,O;o(10),c("formGroup",l.packageFormGroup),o(2),x(l.standardPackageLabel()),o(5),c("ngForOf",M(18,16,l.deliveryDistricts$)),o(2),c("ngIf",(p=l.packageFormGroup.get("delivery_district_id"))==null?null:p.hasError("required")),o(6),c("ngIf",(m=l.packageFormGroup.get("package_length_cm"))==null?null:m.hasError("required")),o(),c("ngIf",(s=l.packageFormGroup.get("package_length_cm"))==null?null:s.hasError("min")),o(5),c("ngIf",(f=l.packageFormGroup.get("package_width_cm"))==null?null:f.hasError("required")),o(),c("ngIf",(g=l.packageFormGroup.get("package_width_cm"))==null?null:g.hasError("min")),o(5),c("ngIf",(h=l.packageFormGroup.get("package_height_cm"))==null?null:h.hasError("required")),o(),c("ngIf",(P=l.packageFormGroup.get("package_height_cm"))==null?null:P.hasError("min")),o(5),c("ngIf",(E=l.packageFormGroup.get("package_weight_kg"))==null?null:E.hasError("required")),o(),c("ngIf",(O=l.packageFormGroup.get("package_weight_kg"))==null?null:O.hasError("min")),o(3),c("ngIf",l.isCalculating()),o(2),x(l.isCalculating()?"Calculando...":"CALCULAR COSTO"),o(),c("ngIf",l.shippingCostCalculated()!==null&&l.shippingCostCalculated()!==void 0),o(),c("ngIf",M(52,18,l.maxDimensions$))}},dependencies:[A,q,T,N,z,H,U,ge,de,B,$,j,L,W,V,R,me,ce,oe,le,Ce,ne,X,J,Y,K,Q,ie,te,Z,ee,re,se,pe,fe,_e,ue],styles:["[_nghost-%COMP%]{display:block}.calculator-card[_ngcontent-%COMP%]{max-width:700px;margin:24px auto;border-radius:12px;border:1px solid #e0e0e0;background-color:#fff;box-shadow:0 4px 12px #00000014}.calculator-card-header[_ngcontent-%COMP%]{padding:20px 14px;border-bottom:1px solid #eeeeee;background-color:#f8f9fa}.calculator-card-header[_ngcontent-%COMP%]   .header-avatar[_ngcontent-%COMP%]{background-color:#012147;color:#fff;display:flex;justify-content:center;align-items:center}.calculator-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:1.6em;font-weight:500;color:#263238}.calculator-card-header[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{font-size:.95em;color:#546e7a}.standard-package-info[_ngcontent-%COMP%]{font-size:1em;color:#455a64;margin-bottom:15px;padding:12px;background-color:#eceff1;border-left:4px solid #f97c06;border-radius:4px}.full-width-field[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}.district-option[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;align-items:center}.district-option[_ngcontent-%COMP%]   .district-price[_ngcontent-%COMP%]{font-weight:500;color:#424242;font-size:.9em}.custom-dimensions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:20px;margin-top:10px;margin-bottom:14px;align-items:start}.custom-dimensions-grid[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin-bottom:0}.calculate-action-container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;margin-top:10px;margin-bottom:10px}.calculate-button[_ngcontent-%COMP%]{padding:10px 24px;font-size:1em;font-weight:500;border-radius:6px;color:#f7f8fe;background-color:#f97c06;border:0px;cursor:pointer}.info-banner[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin-top:24px;padding:12px 16px;border-radius:6px;font-size:.9em}.max-dimensions-info[_ngcontent-%COMP%]{background-color:#f5f5f5;color:#616161;border:1px solid #e0e0e0}.max-dimensions-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#78909c}.shipping-cost-result[_ngcontent-%COMP%]{margin-top:28px;padding:16px;border-radius:8px;border:1px solid #e0e0e0;text-align:center;background-color:#f9f9f9}.shipping-cost-result[_ngcontent-%COMP%]   .cost-label[_ngcontent-%COMP%]{font-size:1.1em;color:#37474f;display:block;margin-bottom:8px}.shipping-cost-result[_ngcontent-%COMP%]   .cost-value[_ngcontent-%COMP%]{font-size:2em;font-weight:700;color:#d32f2f}.shipping-cost-result[_ngcontent-%COMP%]   .error-label[_ngcontent-%COMP%]{color:#c62828}.shipping-cost-result[_ngcontent-%COMP%]   .error-value[_ngcontent-%COMP%]{font-size:1em;color:#c62828;font-weight:500}"]})};export{ke as PackageCalculatorComponent};
